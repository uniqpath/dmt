(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function ge(){}const ti=t=>t;function so(t,e){for(const n in e)t[n]=e[n];return t}function Zf(t){return t()}function di(){return Object.create(null)}function yt(t){t.forEach(Zf)}function Yn(t){return typeof t=="function"}function at(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let tr;function hi(t,e){return tr||(tr=document.createElement("a")),tr.href=e,t===tr.href}function oo(t){return Object.keys(t).length===0}function Rt(t,...e){if(t==null)return ge;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function lo(t){let e;return Rt(t,n=>e=n)(),e}function wt(t,e,n){t.$$.on_destroy.push(Rt(e,n))}function Gf(t,e,n,r){if(t){const i=Vf(t,e,n,r);return t[0](i)}}function Vf(t,e,n,r){return t[1]&&r?so(n.ctx.slice(),t[1](r(e))):n.ctx}function Qf(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const s=[],l=Math.max(e.dirty.length,i.length);for(let c=0;c<l;c+=1)s[c]=e.dirty[c]|i[c];return s}return e.dirty|i}return e.dirty}function Xf(t,e,n,r,i,s){if(i){const l=Vf(e,n,r,s);t.p(l,i)}}function es(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function _i(t){const e=typeof t=="string"&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const ts=typeof window<"u";let ns=ts?()=>window.performance.now():()=>Date.now(),ni=ts?t=>requestAnimationFrame(t):ge;const zn=new Set;function rs(t){zn.forEach(e=>{e.c(t)||(zn.delete(e),e.f())}),zn.size!==0&&ni(rs)}function is(t){let e;return zn.size===0&&ni(rs),{promise:new Promise(n=>{zn.add(e={c:t,f:n})}),abort(){zn.delete(e)}}}function O(t,e){t.appendChild(e)}function fs(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function co(t){const e=M("style");return ao(fs(t),e),e.sheet}function ao(t,e){return O(t.head||t,e),e.sheet}function C(t,e,n){t.insertBefore(e,n||null)}function T(t){t.parentNode&&t.parentNode.removeChild(t)}function wn(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function M(t){return document.createElement(t)}function B(t){return document.createTextNode(t)}function F(){return B(" ")}function bt(){return B("")}function Se(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function ss(t){return function(e){return e.preventDefault(),t.call(this,e)}}function pi(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function L(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function uo(t){return Array.from(t.childNodes)}function Ie(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function bi(t,e){t.value=e??""}function nr(t,e,n,r){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function ce(t,e,n){t.classList[n?"add":"remove"](e)}function ho(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}const ir=new Map;let fr=0;function _o(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function po(t,e){const n={stylesheet:co(e),rules:{}};return ir.set(t,n),n}function os(t,e,n,r,i,s,l,c=0){const u=16.666/r;let h=`{
`;for(let P=0;P<=1;P+=u){const k=e+(n-e)*s(P);h+=P*100+`%{${l(k,1-k)}}
`}const p=h+`100% {${l(n,1-n)}}
}`,b=`__svelte_${_o(p)}_${c}`,m=fs(t),{stylesheet:y,rules:w}=ir.get(m)||po(m,t);w[b]||(w[b]=!0,y.insertRule(`@keyframes ${b} ${p}`,y.cssRules.length));const S=t.style.animation||"";return t.style.animation=`${S?`${S}, `:""}${b} ${r}ms linear ${i}ms 1 both`,fr+=1,b}function jr(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=n.length-r.length;i&&(t.style.animation=r.join(", "),fr-=i,fr||bo())}function bo(){ni(()=>{fr||(ir.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&T(e)}),ir.clear())})}let Qn;function Vn(t){Qn=t}function vo(){if(!Qn)throw new Error("Function called outside component initialization");return Qn}function mo(t){vo().$$.on_mount.push(t)}const In=[],vi=[];let Kn=[];const mi=[],yo=Promise.resolve();let Br=!1;function go(){Br||(Br=!0,yo.then(ls))}function jt(t){Kn.push(t)}const Sr=new Set;let $n=0;function ls(){if($n!==0)return;const t=Qn;do{try{for(;$n<In.length;){const e=In[$n];$n++,Vn(e),xo(e.$$)}}catch(e){throw In.length=0,$n=0,e}for(Vn(null),In.length=0,$n=0;vi.length;)vi.pop()();for(let e=0;e<Kn.length;e+=1){const n=Kn[e];Sr.has(n)||(Sr.add(n),n())}Kn.length=0}while(In.length);for(;mi.length;)mi.pop()();Br=!1,Sr.clear(),Vn(t)}function xo(t){if(t.fragment!==null){t.update(),yt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(jt)}}function wo(t){const e=[],n=[];Kn.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Kn=e}let Zn;function cs(){return Zn||(Zn=Promise.resolve(),Zn.then(()=>{Zn=null})),Zn}function sr(t,e,n){t.dispatchEvent(ho(`${e?"intro":"outro"}${n}`))}const rr=new Set;let gn;function kt(){gn={r:0,c:[],p:gn}}function Ct(){gn.r||yt(gn.c),gn=gn.p}function re(t,e){t&&t.i&&(rr.delete(t),t.i(e))}function we(t,e,n,r){if(t&&t.o){if(rr.has(t))return;rr.add(t),gn.c.push(()=>{rr.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const as={duration:0};function hn(t,e,n){const r={direction:"in"};let i=e(t,n,r),s=!1,l,c,u=0;function h(){l&&jr(t,l)}function p(){const{delay:m=0,duration:y=300,easing:w=ti,tick:S=ge,css:P}=i||as;P&&(l=os(t,0,1,y,m,w,P,u++)),S(0,1);const k=ns()+m,G=k+y;c&&c.abort(),s=!0,jt(()=>sr(t,!0,"start")),c=is(X=>{if(s){if(X>=G)return S(1,0),sr(t,!0,"end"),h(),s=!1;if(X>=k){const j=w((X-k)/y);S(j,1-j)}}return s})}let b=!1;return{start(){b||(b=!0,jr(t),Yn(i)?(i=i(r),cs().then(p)):p())},invalidate(){b=!1},end(){s&&(h(),s=!1)}}}function Ao(t,e,n){const r={direction:"out"};let i=e(t,n,r),s=!0,l;const c=gn;c.r+=1;function u(){const{delay:h=0,duration:p=300,easing:b=ti,tick:m=ge,css:y}=i||as;y&&(l=os(t,1,0,p,h,b,y));const w=ns()+h,S=w+p;jt(()=>sr(t,!1,"start")),is(P=>{if(s){if(P>=S)return m(0,1),sr(t,!1,"end"),--c.r||yt(c.c),!1;if(P>=w){const k=b((P-w)/p);m(1-k,k)}}return s})}return Yn(i)?cs().then(()=>{i=i(r),u()}):u(),{end(h){h&&i.tick&&i.tick(1,0),s&&(l&&jr(t,l),s=!1)}}}function Ke(t){t&&t.c()}function je(t,e,n,r){const{fragment:i,after_update:s}=t.$$;i&&i.m(e,n),r||jt(()=>{const l=t.$$.on_mount.map(Zf).filter(Yn);t.$$.on_destroy?t.$$.on_destroy.push(...l):yt(l),t.$$.on_mount=[]}),s.forEach(jt)}function Be(t,e){const n=t.$$;n.fragment!==null&&(wo(n.after_update),yt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Eo(t,e){t.$$.dirty[0]===-1&&(In.push(t),go(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ut(t,e,n,r,i,s,l,c=[-1]){const u=Qn;Vn(t);const h=t.$$={fragment:null,ctx:[],props:s,update:ge,not_equal:i,bound:di(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:di(),dirty:c,skip_bound:!1,root:e.target||u.$$.root};l&&l(h.root);let p=!1;if(h.ctx=n?n(t,e.props||{},(b,m,...y)=>{const w=y.length?y[0]:m;return h.ctx&&i(h.ctx[b],h.ctx[b]=w)&&(!h.skip_bound&&h.bound[b]&&h.bound[b](w),p&&Eo(t,b)),m}):[],h.update(),p=!0,yt(h.before_update),h.fragment=r?r(h.ctx):!1,e.target){if(e.hydrate){const b=uo(e.target);h.fragment&&h.fragment.l(b),b.forEach(T)}else h.fragment&&h.fragment.c();e.intro&&re(t.$$.fragment),je(t,e.target,e.anchor,e.customElement),ls()}Vn(u)}class dt{$destroy(){Be(this,1),this.$destroy=ge}$on(e,n){if(!Yn(n))return ge;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!oo(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Pn=[];function So(t,e){return{subscribe:tn(t,e).subscribe}}function tn(t,e=ge){let n;const r=new Set;function i(c){if(at(t,c)&&(t=c,n)){const u=!Pn.length;for(const h of r)h[1](),Pn.push(h,t);if(u){for(let h=0;h<Pn.length;h+=2)Pn[h][0](Pn[h+1]);Pn.length=0}}}function s(c){i(c(t))}function l(c,u=ge){const h=[c,u];return r.add(h),r.size===1&&(n=e(i)||ge),c(t),()=>{r.delete(h),r.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:l}}function Oo(t,e,n){const r=!Array.isArray(t),i=r?[t]:t,s=e.length<2;return So(n,l=>{let c=!1;const u=[];let h=0,p=ge;const b=()=>{if(h)return;p();const y=e(r?u[0]:u,l);s?l(y):p=Yn(y)?y:ge},m=i.map((y,w)=>Rt(y,S=>{u[w]=S,h&=~(1<<w),c&&b()},()=>{h|=1<<w}));return c=!0,b(),function(){yt(m),p(),c=!1}})}function To(t){const e=t-1;return e*e*e+1}function us(t,{delay:e=0,duration:n=400,easing:r=ti}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:s=>`opacity: ${s*i}`}}function xn(t,{delay:e=0,duration:n=400,easing:r=To,x:i=0,y:s=0,opacity:l=0}={}){const c=getComputedStyle(t),u=+c.opacity,h=c.transform==="none"?"":c.transform,p=u*(1-l),[b,m]=_i(i),[y,w]=_i(s);return{delay:e,duration:n,easing:r,css:(S,P)=>`
			transform: ${h} translate(${(1-S)*b}${m}, ${(1-S)*y}${w});
			opacity: ${u-p*P}`}}function ko(t){function e(r,...i){const s=r.subscribe(...i);return s.unsubscribe?()=>s.unsubscribe():s}function n(r){let i;return e(r,s=>i=s)(),i}return(r,i,s,l,c)=>{const{errors:u}=n(t),h=new Date,p=`${h.getHours()}:${`0${h.getMinutes()}`.slice(-2)}`;c&&c.stack?u.push({msg:r,stacktrace:c.stack,time:p}):u.push({msg:`"${r}" (No more info because of CORS, fix: 1) check for the same error on device where gui runs on :80... 2) if more possible errors from this source, then rethrow - see example in dmt-connect/browser/connect around JSON.parse(msg))`,corsProblem:!0,time:p}),t.set({errors:u})}}function Co(t,e="asc"){return function(r,i){if(!r.hasOwnProperty(t)||!i.hasOwnProperty(t))return 0;const s=typeof r[t]=="string"?r[t].toUpperCase():r[t],l=typeof i[t]=="string"?i[t].toUpperCase():i[t];let c=0;return s>l?c=1:s<l&&(c=-1),e==="desc"?c*-1:c}}function Ro(t,e){localStorage.getItem(e)=="true"&&t.set(!0),localStorage.getItem(e)=="false"&&t.set(!1),t.subscribe(n=>{localStorage.setItem(e,n.toString())})}function yi(t){console.log(`${new Date().toLocaleString()} → ${t}`)}yi.write=yi;const ds=tn(!0);Ro(ds,"show_all_nearby_devices");const hs=tn({errors:[]}),_s=tn(!1);function or(t,{defaultSymbol:e="",showTimeLimitIndicator:n=!1}={}){return!t||!t.currentMedia||t.paused?e:n&&t.timeLimit>0?"⏱️":t.currentMedia.mediaType=="video"?"▶":"♫"}function No(t){let e;return{c(){e=B("disconnected")},m(n,r){C(n,e,r)},p:ge,d(n){n&&T(e)}}}function Do(t){let e,n=or(t[2])+"",r,i,s,l,c,u=t[4]==!1&&gi();return{c(){e=M("span"),r=B(n),i=F(),s=M("h2"),l=B(t[1]),c=F(),u&&u.c(),L(e,"class","play_symbol svelte-5h63c7"),L(s,"class","svelte-5h63c7"),ce(s,"disconnected",t[4]==!1)},m(h,p){C(h,e,p),O(e,r),C(h,i,p),C(h,s,p),O(s,l),O(s,c),u&&u.m(s,null)},p(h,p){p&4&&n!==(n=or(h[2])+"")&&Ie(r,n),p&2&&Ie(l,h[1]),h[4]==!1?u||(u=gi(),u.c(),u.m(s,null)):u&&(u.d(1),u=null),p&16&&ce(s,"disconnected",h[4]==!1)},d(h){h&&T(e),h&&T(i),h&&T(s),u&&u.d()}}}function gi(t){let e;return{c(){e=M("span"),L(e,"class","disconnected svelte-5h63c7")},m(n,r){C(n,e,r)},d(n){n&&T(e)}}}function xi(t){let e,n,r,i=t[3].ip+"",s;return{c(){e=M("div"),n=M("span"),n.textContent="IP Address",r=F(),s=B(i),L(n,"class","svelte-5h63c7"),L(e,"class","device_stat svelte-5h63c7")},m(l,c){C(l,e,c),O(e,n),O(e,r),O(e,s)},p(l,c){c&8&&i!==(i=l[3].ip+"")&&Ie(s,i)},d(l){l&&T(e)}}}function wi(t){let e,n,r,i=t[3].cpuUsage+"",s,l;return{c(){var c,u,h;e=M("div"),n=M("span"),n.textContent="CPU Usage",r=F(),s=B(i),l=B("%"),L(n,"class","svelte-5h63c7"),L(e,"class","device_stat cpu_usage svelte-5h63c7"),ce(e,"warn1",((c=t[3])==null?void 0:c.cpuUsage)>=50),ce(e,"warn2",((u=t[3])==null?void 0:u.cpuUsage)>=70),ce(e,"warn3",((h=t[3])==null?void 0:h.cpuUsage)>=80)},m(c,u){C(c,e,u),O(e,n),O(e,r),O(e,s),O(e,l)},p(c,u){var h,p,b;u&8&&i!==(i=c[3].cpuUsage+"")&&Ie(s,i),u&8&&ce(e,"warn1",((h=c[3])==null?void 0:h.cpuUsage)>=50),u&8&&ce(e,"warn2",((p=c[3])==null?void 0:p.cpuUsage)>=70),u&8&&ce(e,"warn3",((b=c[3])==null?void 0:b.cpuUsage)>=80)},d(c){c&&T(e)}}}function Ai(t){let e,n,r,i=t[3].cpuTemp+"",s,l;return{c(){e=M("div"),n=M("span"),n.textContent="CPU Temperature",r=F(),s=B(i),l=B("°C"),L(n,"class","svelte-5h63c7"),L(e,"class","device_stat svelte-5h63c7")},m(c,u){C(c,e,u),O(e,n),O(e,r),O(e,s),O(e,l)},p(c,u){u&8&&i!==(i=c[3].cpuTemp+"")&&Ie(s,i)},d(c){c&&T(e)}}}function Ei(t){var l,c;let e,n,r,i=(((l=t[3])==null?void 0:l.wifiAP)||((c=t[3])==null?void 0:c.apssid))+"",s;return{c(){e=M("div"),n=M("span"),n.textContent="Wifi",r=F(),s=B(i),L(n,"class","svelte-5h63c7"),L(e,"class","wifi_ap svelte-5h63c7")},m(u,h){C(u,e,h),O(e,n),O(e,r),O(e,s)},p(u,h){var p,b;h&8&&i!==(i=(((p=u[3])==null?void 0:p.wifiAP)||((b=u[3])==null?void 0:b.apssid))+"")&&Ie(s,i)},d(u){u&&T(e)}}}function $o(t){var S,P,k,G,X;let e,n,r,i,s,l,c;function u(j,q){if(j[1])return Do;if(j[4]!=null)return No}let h=u(t),p=h&&h(t),b=((S=t[3])==null?void 0:S.ip)&&xi(t),m=((P=t[3])==null?void 0:P.cpuUsage)&&wi(t),y=((k=t[3])==null?void 0:k.cpuTemp)&&Ai(t),w=(((G=t[3])==null?void 0:G.wifiAP)||((X=t[3])==null?void 0:X.apssid))&&Ei(t);return{c(){e=M("div"),p&&p.c(),r=F(),b&&b.c(),i=F(),m&&m.c(),s=F(),y&&y.c(),l=F(),w&&w.c(),c=bt(),L(e,"class","device_title svelte-5h63c7")},m(j,q){C(j,e,q),p&&p.m(e,null),C(j,r,q),b&&b.m(j,q),C(j,i,q),m&&m.m(j,q),C(j,s,q),y&&y.m(j,q),C(j,l,q),w&&w.m(j,q),C(j,c,q)},p(j,[q]){var z,be,ye,ue,De;h===(h=u(j))&&p?p.p(j,q):(p&&p.d(1),p=h&&h(j),p&&(p.c(),p.m(e,null))),(z=j[3])!=null&&z.ip?b?b.p(j,q):(b=xi(j),b.c(),b.m(i.parentNode,i)):b&&(b.d(1),b=null),(be=j[3])!=null&&be.cpuUsage?m?m.p(j,q):(m=wi(j),m.c(),m.m(s.parentNode,s)):m&&(m.d(1),m=null),(ye=j[3])!=null&&ye.cpuTemp?y?y.p(j,q):(y=Ai(j),y.c(),y.m(l.parentNode,l)):y&&(y.d(1),y=null),(ue=j[3])!=null&&ue.wifiAP||(De=j[3])!=null&&De.apssid?w?w.p(j,q):(w=Ei(j),w.c(),w.m(c.parentNode,c)):w&&(w.d(1),w=null)},i(j){n||jt(()=>{n=hn(e,xn,{}),n.start()})},o:ge,d(j){j&&T(e),p&&p.d(),j&&T(r),b&&b.d(j),j&&T(i),m&&m.d(j),j&&T(s),y&&y.d(j),j&&T(l),w&&w.d(j),j&&T(c)}}}function Po(t,e,n){let r,i,s=ge,l=()=>(s(),s=Rt(c,y=>n(4,i=y)),c);t.$$.on_destroy.push(()=>s());let{connected:c}=e;l();let{nearbyDevices:u}=e,{deviceName:h}=e,{device:p}=e,{activeDeviceKey:b}=e,{player:m}=e;return t.$$set=y=>{"connected"in y&&l(n(0,c=y.connected)),"nearbyDevices"in y&&n(5,u=y.nearbyDevices),"deviceName"in y&&n(1,h=y.deviceName),"device"in y&&n(6,p=y.device),"activeDeviceKey"in y&&n(7,b=y.activeDeviceKey),"player"in y&&n(2,m=y.player)},t.$$.update=()=>{t.$$.dirty&160&&n(3,r=u.find(y=>y.deviceKey==b))},[c,h,m,r,i,u,p,b]}class Io extends dt{constructor(e){super(),ut(this,e,Po,$o,at,{connected:0,nearbyDevices:5,deviceName:1,device:6,activeDeviceKey:7,player:2})}}function Or(t,e=2){return Array(Math.max(e-String(t).length+1,0)).join(0)+t}function Mn(t){t=Math.round(t);const e=Math.floor(t/3600),n=t%3600,r=Math.floor(n/60);return t=n%60,e?`${e}h ${Or(r)}min ${Or(t)}s`:`${r}:${Or(t)}`}function Mo(t){let e=Mn(t[0].currentMedia.duration)+"",n;return{c(){n=B(e)},m(r,i){C(r,n,i)},p(r,i){i&1&&e!==(e=Mn(r[0].currentMedia.duration)+"")&&Ie(n,e)},d(r){r&&T(n)}}}function Uo(t){let e=Mn(Math.floor(t[0].timeposition))+"",n,r,i=Mn(t[0].currentMedia.duration)+"",s,l,c,u=Math.round(t[0].percentposition)+"",h,p;return{c(){n=B(e),r=B(" / "),s=B(i),l=B(" — "),c=M("span"),h=B(u),p=B("%"),L(c,"class","svelte-b6jwnj")},m(b,m){C(b,n,m),C(b,r,m),C(b,s,m),C(b,l,m),C(b,c,m),O(c,h),O(c,p)},p(b,m){m&1&&e!==(e=Mn(Math.floor(b[0].timeposition))+"")&&Ie(n,e),m&1&&i!==(i=Mn(b[0].currentMedia.duration)+"")&&Ie(s,i),m&1&&u!==(u=Math.round(b[0].percentposition)+"")&&Ie(h,u)},d(b){b&&T(n),b&&T(r),b&&T(s),b&&T(l),b&&T(c)}}}function Lo(t){let e;return{c(){e=B("(radio)")},m(n,r){C(n,e,r)},p:ge,d(n){n&&T(e)}}}function jo(t){let e;function n(s,l){if(s[0].isStream)return Lo;if(s[0].timeposition)return Uo;if(s[0].duration)return Mo}let r=n(t),i=r&&r(t);return{c(){e=M("section"),i&&i.c(),L(e,"class","progress svelte-b6jwnj"),ce(e,"faded",t[0].paused)},m(s,l){C(s,e,l),i&&i.m(e,null)},p(s,[l]){r===(r=n(s))&&i?i.p(s,l):(i&&i.d(1),i=r&&r(s),i&&(i.c(),i.m(e,null))),l&1&&ce(e,"faded",s[0].paused)},i:ge,o:ge,d(s){s&&T(e),i&&i.d()}}}function Bo(t,e,n){let{player:r}=e;return t.$$set=i=>{"player"in i&&n(0,r=i.player)},[r]}class zo extends dt{constructor(e){super(),ut(this,e,Bo,jo,at,{player:0})}}function Si(t){let e,n,r,i;function s(u,h){if(u[2]&&u[6])return qo;if(u[6])return Ko}let l=s(t),c=l&&l(t);return r=new zo({props:{player:t[0]}}),{c(){e=M("div"),c&&c.c(),n=F(),Ke(r.$$.fragment),L(e,"class","wrapper svelte-120eh85")},m(u,h){C(u,e,h),c&&c.m(e,null),O(e,n),je(r,e,null),i=!0},p(u,h){l===(l=s(u))&&c?c.p(u,h):(c&&c.d(1),c=l&&l(u),c&&(c.c(),re(c,1),c.m(e,n)));const p={};h&1&&(p.player=u[0]),r.$set(p)},i(u){i||(re(c),re(r.$$.fragment,u),i=!0)},o(u){we(r.$$.fragment,u),i=!1},d(u){u&&T(e),c&&c.d(),Be(r)}}}function Ko(t){let e,n;return{c(){e=M("section"),e.textContent="[ No media loaded ]",L(e,"class","no_media svelte-120eh85")},m(r,i){C(r,e,i)},p:ge,i(r){n||jt(()=>{n=hn(e,xn,{}),n.start()})},o:ge,d(r){r&&T(e)}}}function qo(t){let e,n,r=or(t[0],{showTimeLimitIndicator:!0})+"",i,s,l,c,u,h,p=t[3]&&Oi(t);return{c(){var b;e=M("section"),n=M("span"),i=B(r),s=F(),l=B(t[2]),c=F(),u=M("div"),p&&p.c(),L(n,"class","play_symbol svelte-120eh85"),L(u,"class","file_path svelte-120eh85"),L(e,"class","current_media svelte-120eh85"),ce(e,"playing",!t[0].paused),ce(e,"within_limit",!t[0].isStream&&t[0].limit),ce(e,"last_in_limit",!t[0].isStream&&t[0].limit==1),ce(e,"error",t[5]==t[3]&&((b=t[4])==null?void 0:b.error))},m(b,m){C(b,e,m),O(e,n),O(n,i),O(e,s),O(e,l),O(e,c),O(e,u),p&&p.m(u,null)},p(b,m){var y;m&1&&r!==(r=or(b[0],{showTimeLimitIndicator:!0})+"")&&Ie(i,r),m&4&&Ie(l,b[2]),b[3]?p?p.p(b,m):(p=Oi(b),p.c(),p.m(u,null)):p&&(p.d(1),p=null),m&1&&ce(e,"playing",!b[0].paused),m&1&&ce(e,"within_limit",!b[0].isStream&&b[0].limit),m&1&&ce(e,"last_in_limit",!b[0].isStream&&b[0].limit==1),m&56&&ce(e,"error",b[5]==b[3]&&((y=b[4])==null?void 0:y.error))},i(b){h||jt(()=>{h=hn(e,xn,{}),h.start()})},o:ge,d(b){b&&T(e),p&&p.d()}}}function Oi(t){let e=Ti(t[3])+"",n;return{c(){n=B(e)},m(r,i){C(r,n,i)},p(r,i){i&8&&e!==(e=Ti(r[3])+"")&&Ie(n,e)},d(r){r&&T(n)}}}function Yo(t){let e,n,r=t[0]&&Si(t);return{c(){r&&r.c(),e=bt()},m(i,s){r&&r.m(i,s),C(i,e,s),n=!0},p(i,[s]){i[0]?r?(r.p(i,s),s&1&&re(r,1)):(r=Si(i),r.c(),re(r,1),r.m(e.parentNode,e)):r&&(kt(),we(r,1,1,()=>{r=null}),Ct())},i(i){n||(re(r),n=!0)},o(i){we(r),n=!1},d(i){r&&r.d(i),i&&T(e)}}}function Ti(t){return t.replace("/root/DMTMountedMedia","")}function Fo(t,e,n){let r,i=ge,s=()=>(i(),i=Rt(c,y=>n(6,r=y)),c);t.$$.on_destroy.push(()=>i());let{player:l}=e,{connected:c}=e;s();let{store:u}=e,{songTitle:h}=e,{songPath:p}=e,{playlistCurrentMedia:b}=e,{playlistSongPath:m}=e;return t.$$set=y=>{"player"in y&&n(0,l=y.player),"connected"in y&&s(n(1,c=y.connected)),"store"in y&&n(7,u=y.store),"songTitle"in y&&n(2,h=y.songTitle),"songPath"in y&&n(3,p=y.songPath),"playlistCurrentMedia"in y&&n(4,b=y.playlistCurrentMedia),"playlistSongPath"in y&&n(5,m=y.playlistSongPath)},[l,c,h,p,b,m,r,u]}class Ho extends dt{constructor(e){super(),ut(this,e,Fo,Yo,at,{player:0,connected:1,store:7,songTitle:2,songPath:3,playlistCurrentMedia:4,playlistSongPath:5})}}function ki(t){let e;function n(s,l){return s[1].paused?Wo:Jo}let r=n(t),i=r(t);return{c(){i.c(),e=bt()},m(s,l){i.m(s,l),C(s,e,l)},p(s,l){r===(r=n(s))&&i?i.p(s,l):(i.d(1),i=r(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){i.d(s),s&&T(e)}}}function Jo(t){let e,n,r,i=(t[2]||"")+"",s,l,c,u;return{c(){e=M("button"),n=B("● Pause "),r=M("span"),s=B(i),L(r,"class","svelte-p9vgzg"),L(e,"class","pause svelte-p9vgzg"),e.disabled=l=!t[5]},m(h,p){C(h,e,p),O(e,n),O(e,r),O(r,s),c||(u=Se(e,"click",t[8]),c=!0)},p(h,p){p&4&&i!==(i=(h[2]||"")+"")&&Ie(s,i),p&32&&l!==(l=!h[5])&&(e.disabled=l)},d(h){h&&T(e),c=!1,u()}}}function Wo(t){let e,n,r,i=(t[2]||"")+"",s,l,c,u;return{c(){e=M("button"),n=B("▶ Play "),r=M("span"),s=B(i),L(r,"class","svelte-p9vgzg"),L(e,"class","play svelte-p9vgzg"),e.disabled=l=!t[5]},m(h,p){C(h,e,p),O(e,n),O(e,r),O(r,s),c||(u=Se(e,"click",t[7]),c=!0)},p(h,p){p&4&&i!==(i=(h[2]||"")+"")&&Ie(s,i),p&32&&l!==(l=!h[5])&&(e.disabled=l)},d(h){h&&T(e),c=!1,u()}}}function Ci(t){let e,n=t[1].volume+"",r;return{c(){e=M("div"),r=B(n),L(e,"class","volume_level svelte-p9vgzg"),ce(e,"faded",t[1].paused)},m(i,s){C(i,e,s),O(e,r)},p(i,s){s&2&&n!==(n=i[1].volume+"")&&Ie(r,n),s&2&&ce(e,"faded",i[1].paused)},d(i){i&&T(e)}}}function Ri(t){let e,n,r=t[1].isStream?"Close radio":"Stop",i,s,l,c;return{c(){e=M("button"),n=B("■ "),i=B(r),L(e,"class","stop svelte-p9vgzg"),e.disabled=s=!t[5],ce(e,"radio",t[1].isStream)},m(u,h){C(u,e,h),O(e,n),O(e,i),l||(c=Se(e,"click",t[11]),l=!0)},p(u,h){h&2&&r!==(r=u[1].isStream?"Close radio":"Stop")&&Ie(i,r),h&32&&s!==(s=!u[5])&&(e.disabled=s),h&2&&ce(e,"radio",u[1].isStream)},d(u){u&&T(e),l=!1,c()}}}function Ni(t){let e,n,r,i,s,l,c,u,h,p,b=(t[1].repeatCount||"")+"",m,y,w,S;return{c(){e=M("button"),n=B("Shuffle"),i=F(),s=M("button"),l=B("Similar"),u=F(),h=M("button"),p=B("Repeat "),m=B(b),L(e,"class","shuffle svelte-p9vgzg"),e.disabled=r=!t[5],L(s,"class","similar svelte-p9vgzg"),s.disabled=c=!t[5],L(h,"class","repeat svelte-p9vgzg"),h.disabled=y=!t[5],ce(h,"repeat_set",t[1].repeatCount>0)},m(P,k){C(P,e,k),O(e,n),C(P,i,k),C(P,s,k),O(s,l),C(P,u,k),C(P,h,k),O(h,p),O(h,m),w||(S=[Se(e,"click",t[12]),Se(s,"click",t[13]),Se(h,"click",t[14])],w=!0)},p(P,k){k&32&&r!==(r=!P[5])&&(e.disabled=r),k&32&&c!==(c=!P[5])&&(s.disabled=c),k&2&&b!==(b=(P[1].repeatCount||"")+"")&&Ie(m,b),k&32&&y!==(y=!P[5])&&(h.disabled=y),k&2&&ce(h,"repeat_set",P[1].repeatCount>0)},d(P){P&&T(e),P&&T(i),P&&T(s),P&&T(u),P&&T(h),w=!1,yt(S)}}}function Di(t){let e,n,r,i,s,l,c,u,h;return{c(){e=M("button"),n=B("« 20s"),i=F(),s=M("button"),l=B("20s »"),L(e,"class","backward svelte-p9vgzg"),e.disabled=r=!t[5],L(s,"class","forward svelte-p9vgzg"),s.disabled=c=!t[5]},m(p,b){C(p,e,b),O(e,n),C(p,i,b),C(p,s,b),O(s,l),u||(h=[Se(e,"click",t[15]),Se(s,"click",t[16])],u=!0)},p(p,b){b&32&&r!==(r=!p[5])&&(e.disabled=r),b&32&&c!==(c=!p[5])&&(s.disabled=c)},d(p){p&&T(e),p&&T(i),p&&T(s),u=!1,yt(h)}}}function $i(t){let e;function n(s,l){return s[1].isStream?Go:Zo}let r=n(t),i=r(t);return{c(){i.c(),e=bt()},m(s,l){i.m(s,l),C(s,e,l)},p(s,l){r===(r=n(s))&&i?i.p(s,l):(i.d(1),i=r(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){i.d(s),s&&T(e)}}}function Zo(t){let e,n,r,i,s,l,c=(t[1].limit>0||t[1].timeLimit>0)&&Pi(t),u=t[1].limit>0&&Ii(t);function h(m,y){return m[1].timeLimit>0?Qo:Vo}let p=h(t),b=p(t);return{c(){c&&c.c(),e=F(),u&&u.c(),n=F(),r=M("button"),b.c(),L(r,"class","limit svelte-p9vgzg"),r.disabled=i=!t[5],ce(r,"limit_set",t[1].limit>0),ce(r,"time_limit_set",t[1].timeLimit>0)},m(m,y){c&&c.m(m,y),C(m,e,y),u&&u.m(m,y),C(m,n,y),C(m,r,y),b.m(r,null),s||(l=Se(r,"click",t[6]),s=!0)},p(m,y){m[1].limit>0||m[1].timeLimit>0?c?c.p(m,y):(c=Pi(m),c.c(),c.m(e.parentNode,e)):c&&(c.d(1),c=null),m[1].limit>0?u?u.p(m,y):(u=Ii(m),u.c(),u.m(n.parentNode,n)):u&&(u.d(1),u=null),p===(p=h(m))&&b?b.p(m,y):(b.d(1),b=p(m),b&&(b.c(),b.m(r,null))),y&32&&i!==(i=!m[5])&&(r.disabled=i),y&2&&ce(r,"limit_set",m[1].limit>0),y&2&&ce(r,"time_limit_set",m[1].timeLimit>0)},d(m){c&&c.d(m),m&&T(e),u&&u.d(m),m&&T(n),m&&T(r),b.d(),s=!1,l()}}}function Go(t){let e,n,r,i,s,l=t[1].timeLimit>0&&Mi(t);function c(p,b){return p[1].timeLimit>0?el:Xo}let u=c(t),h=u(t);return{c(){l&&l.c(),e=F(),n=M("button"),h.c(),L(n,"class","limit svelte-p9vgzg"),n.disabled=r=!t[5],ce(n,"time_limit_set",t[1].timeLimit>0)},m(p,b){l&&l.m(p,b),C(p,e,b),C(p,n,b),h.m(n,null),i||(s=Se(n,"click",t[6]),i=!0)},p(p,b){p[1].timeLimit>0?l?l.p(p,b):(l=Mi(p),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),u===(u=c(p))&&h?h.p(p,b):(h.d(1),h=u(p),h&&(h.c(),h.m(n,null))),b&32&&r!==(r=!p[5])&&(n.disabled=r),b&2&&ce(n,"time_limit_set",p[1].timeLimit>0)},d(p){l&&l.d(p),p&&T(e),p&&T(n),h.d(),i=!1,s()}}}function Pi(t){let e,n,r,i,s;return{c(){e=M("button"),n=B("🗑️ Cancel"),L(e,"class","remove_limit svelte-p9vgzg"),e.disabled=r=!t[5],ce(e,"remove_time_limit",t[1].timeLimit>0)},m(l,c){C(l,e,c),O(e,n),i||(s=Se(e,"click",t[18]),i=!0)},p(l,c){c&32&&r!==(r=!l[5])&&(e.disabled=r),c&2&&ce(e,"remove_time_limit",l[1].timeLimit>0)},d(l){l&&T(e),i=!1,s()}}}function Ii(t){let e,n,r,i,s;return{c(){e=M("button"),n=B("⏱️ Limit"),L(e,"class","set_time_limit svelte-p9vgzg"),e.disabled=r=!t[5]},m(l,c){C(l,e,c),O(e,n),i||(s=Se(e,"click",t[19]),i=!0)},p(l,c){c&32&&r!==(r=!l[5])&&(e.disabled=r)},d(l){l&&T(e),i=!1,s()}}}function Vo(t){let e,n=(t[1].limit||"")+"",r;return{c(){e=B("Limit "),r=B(n)},m(i,s){C(i,e,s),C(i,r,s)},p(i,s){s&2&&n!==(n=(i[1].limit||"")+"")&&Ie(r,n)},d(i){i&&T(e),i&&T(r)}}}function Qo(t){let e,n,r=lr(t[1])+"",i;return{c(){e=M("span"),n=B("⏱️ "),i=B(r)},m(s,l){C(s,e,l),O(e,n),O(e,i)},p(s,l){l&2&&r!==(r=lr(s[1])+"")&&Ie(i,r)},d(s){s&&T(e)}}}function Mi(t){let e,n,r,i,s;return{c(){e=M("button"),n=B("🗑️ Cancel"),L(e,"class","remove_limit svelte-p9vgzg"),e.disabled=r=!t[5],ce(e,"remove_time_limit",t[1].timeLimit>0)},m(l,c){C(l,e,c),O(e,n),i||(s=Se(e,"click",t[17]),i=!0)},p(l,c){c&32&&r!==(r=!l[5])&&(e.disabled=r),c&2&&ce(e,"remove_time_limit",l[1].timeLimit>0)},d(l){l&&T(e),i=!1,s()}}}function Xo(t){let e;return{c(){e=M("span"),e.textContent="⏱️ Limit"},m(n,r){C(n,e,r)},p:ge,d(n){n&&T(e)}}}function el(t){let e,n,r=lr(t[1])+"",i;return{c(){e=M("span"),n=B("⏱️ "),i=B(r)},m(s,l){C(s,e,l),O(e,n),O(e,i)},p(s,l){l&2&&r!==(r=lr(s[1])+"")&&Ie(i,r)},d(s){s&&T(e)}}}function tl(t){let e,n,r,i,s,l,c,u,h,p,b,m,y,w,S,P,k,G,X=t[3]&&ki(t),j=t[5]&&t[1].volume!=null&&Ci(t),q=t[3]&&Ri(t),z=!t[1].isStream&&t[3]&&Ni(t),be=!t[1].isStream&&t[3]&&Di(t),ye=t[3]&&$i(t);return{c(){e=M("section"),X&&X.c(),n=F(),r=M("button"),i=B("Vol ↓"),l=F(),c=M("button"),u=B("Vol ↑"),p=F(),j&&j.c(),b=F(),m=M("section"),q&&q.c(),y=F(),z&&z.c(),w=F(),S=M("section"),be&&be.c(),P=F(),ye&&ye.c(),L(r,"class","volume svelte-p9vgzg"),r.disabled=s=!t[5],L(c,"class","volume svelte-p9vgzg"),c.disabled=h=!t[5],L(e,"class","main svelte-p9vgzg"),L(m,"class","svelte-p9vgzg"),L(S,"class","svelte-p9vgzg")},m(ue,De){C(ue,e,De),X&&X.m(e,null),O(e,n),O(e,r),O(r,i),O(e,l),O(e,c),O(c,u),O(e,p),j&&j.m(e,null),C(ue,b,De),C(ue,m,De),q&&q.m(m,null),O(m,y),z&&z.m(m,null),C(ue,w,De),C(ue,S,De),be&&be.m(S,null),O(S,P),ye&&ye.m(S,null),k||(G=[Se(r,"click",t[9]),Se(c,"click",t[10])],k=!0)},p(ue,[De]){ue[3]?X?X.p(ue,De):(X=ki(ue),X.c(),X.m(e,n)):X&&(X.d(1),X=null),De&32&&s!==(s=!ue[5])&&(r.disabled=s),De&32&&h!==(h=!ue[5])&&(c.disabled=h),ue[5]&&ue[1].volume!=null?j?j.p(ue,De):(j=Ci(ue),j.c(),j.m(e,null)):j&&(j.d(1),j=null),ue[3]?q?q.p(ue,De):(q=Ri(ue),q.c(),q.m(m,y)):q&&(q.d(1),q=null),!ue[1].isStream&&ue[3]?z?z.p(ue,De):(z=Ni(ue),z.c(),z.m(m,null)):z&&(z.d(1),z=null),!ue[1].isStream&&ue[3]?be?be.p(ue,De):(be=Di(ue),be.c(),be.m(S,P)):be&&(be.d(1),be=null),ue[3]?ye?ye.p(ue,De):(ye=$i(ue),ye.c(),ye.m(S,null)):ye&&(ye.d(1),ye=null)},i:ge,o:ge,d(ue){ue&&T(e),X&&X.d(),j&&j.d(),ue&&T(b),ue&&T(m),q&&q.d(),z&&z.d(),ue&&T(w),ue&&T(S),be&&be.d(),ye&&ye.d(),k=!1,yt(G)}}}function lr(t){return t.timeLimit>2?`${Math.round(t.timeLimit)} min`:`${Math.round(t.timeLimit*60)} s`}function nl(t,e,n){let r,i=ge,s=()=>(i(),i=Rt(l,ue=>n(5,r=ue)),l);t.$$.on_destroy.push(()=>i());let{connected:l}=e;s();let{player:c}=e,{deviceName:u}=e,{songTitle:h}=e,{fnAction:p}=e;function b(){c.isStream||c.timeLimit>0?p("time_limit"):p("limit")}const m=()=>p("play"),y=()=>p("pause"),w=()=>p("volume_down"),S=()=>p("volume_up"),P=()=>p("stop"),k=()=>p("shuffle"),G=()=>p("similar"),X=()=>p("repeat"),j=()=>p("backward"),q=()=>p("forward"),z=()=>p("remove_time_limit"),be=()=>p("remove_limit"),ye=()=>p("time_limit");return t.$$set=ue=>{"connected"in ue&&s(n(0,l=ue.connected)),"player"in ue&&n(1,c=ue.player),"deviceName"in ue&&n(2,u=ue.deviceName),"songTitle"in ue&&n(3,h=ue.songTitle),"fnAction"in ue&&n(4,p=ue.fnAction)},[l,c,u,h,p,r,b,m,y,w,S,P,k,G,X,j,q,z,be,ye]}class rl extends dt{constructor(e){super(),ut(this,e,nl,tl,at,{connected:0,player:1,deviceName:2,songTitle:3,fnAction:4})}}const cr=tn(),dn=tn();function ps(){cr.set(""),dn.set(null)}const Gn=tn();function bs(){Gn.set(null)}const il=""+new URL("close-28a6104f.png",import.meta.url).href,fl=""+new URL("magnifying_glass-a4a7aab7.svg",import.meta.url).href;function Ui(t){let e,n,r,i,s,l;return{c(){e=M("button"),n=B("▼ SET NEXT"),e.disabled=r=!t[2],L(e,"class","svelte-11smw5j")},m(c,u){C(c,e,u),O(e,n),s||(l=Se(e,"click",ss(t[5])),s=!0)},p(c,u){u&4&&r!==(r=!c[2])&&(e.disabled=r)},i(c){i||jt(()=>{i=hn(e,xn,{}),i.start()})},o:ge,d(c){c&&T(e),s=!1,l()}}}function sl(t){var P,k;let e,n,r,i,s,l,c,u,h,p,b,m=((P=t[1])==null?void 0:P.trim())&&((k=t[3])==null?void 0:k.length),y,w,S=m&&Ui(t);return{c(){var G;e=M("form"),n=M("div"),r=M("input"),s=F(),l=M("img"),u=F(),h=M("img"),b=F(),S&&S.c(),L(r,"id","search"),L(r,"placeholder","Playlist Search"),L(r,"type","text"),r.disabled=i=!t[2],L(r,"class","svelte-11smw5j"),L(l,"class","magnifying_glass svelte-11smw5j"),hi(l.src,c=fl)||L(l,"src",c),L(h,"class","clear_search svelte-11smw5j"),hi(h.src,p=il)||L(h,"src",p),ce(h,"invisible",!((G=t[1])!=null&&G.trim())),L(n,"class","input_wrapper svelte-11smw5j"),L(e,"class","svelte-11smw5j")},m(G,X){C(G,e,X),O(e,n),O(n,r),bi(r,t[1]),O(n,s),O(n,l),O(n,u),O(n,h),O(e,b),S&&S.m(e,null),y||(w=[Se(r,"input",t[8]),Se(r,"keyup",t[4]),Se(h,"click",ps)],y=!0)},p(G,[X]){var j,q,z;X&4&&i!==(i=!G[2])&&(r.disabled=i),X&2&&r.value!==G[1]&&bi(r,G[1]),X&2&&ce(h,"invisible",!((j=G[1])!=null&&j.trim())),X&10&&(m=((q=G[1])==null?void 0:q.trim())&&((z=G[3])==null?void 0:z.length)),m?S?(S.p(G,X),X&10&&re(S,1)):(S=Ui(G),S.c(),re(S,1),S.m(e,null)):S&&(S.d(1),S=null)},i(G){re(S)},o:ge,d(G){G&&T(e),S&&S.d(),y=!1,yt(w)}}}function ol(t,e,n){let r,i,s=ge,l=()=>(s(),s=Rt(u,k=>n(2,i=k)),u),c;wt(t,cr,k=>n(1,r=k)),wt(t,dn,k=>n(3,c=k)),t.$$.on_destroy.push(()=>s());let{connected:u}=e;l();let{store:h}=e,{fnAction:p}=e,b;function m(k){h.remoteObject("player").call("playlistSearch",{query:r}).then(G=>{G?k==b&&dn.set(G):dn.set(null)}).catch(console.log)}let y;function w(){bs(),clearTimeout(y),r!=null&&r.trim()?(b=Math.random(),y=setTimeout(()=>{m(b)},300)):(b=null,dn.set(null))}function S(){h.remoteObject("player").call("bump",{query:r}).then(()=>{dn.set(null)}).catch(console.log)}function P(){r=this.value,cr.set(r)}return t.$$set=k=>{"connected"in k&&l(n(0,u=k.connected)),"store"in k&&n(6,h=k.store),"fnAction"in k&&n(7,p=k.fnAction)},[u,r,i,c,w,S,h,p,P]}class ll extends dt{constructor(e){super(),ut(this,e,ol,sl,at,{connected:0,store:6,fnAction:7})}}function cl(t){let e,n,r,i,s,l;return{c(){e=M("div"),n=M("button"),n.textContent="Play",r=F(),i=M("button"),i.textContent="Bump",L(n,"class","svelte-27xey9"),L(i,"class","svelte-27xey9"),L(e,"class","controls svelte-27xey9")},m(c,u){C(c,e,u),O(e,n),O(e,r),O(e,i),s||(l=[Se(n,"click",pi(t[4])),Se(i,"click",pi(t[5]))],s=!0)},p:ge,i:ge,o:ge,d(c){c&&T(e),s=!1,yt(l)}}}function al(t,e,n){let{fnAction:r}=e,{entry:i}=e;function s(h){window.scrollTo({top:0,behavior:"smooth"}),ps(),r("next",{songId:h})}function l(h){r("bump",{args:h})}const c=()=>{s(i.id)},u=()=>{l(i.id)};return t.$$set=h=>{"fnAction"in h&&n(3,r=h.fnAction),"entry"in h&&n(0,i=h.entry)},[i,s,l,r,c,u]}class ul extends dt{constructor(e){super(),ut(this,e,al,cl,at,{fnAction:3,entry:0})}}function Li(t){let e,n,r=t[0].metadata.duration+"",i,s;return{c(){e=M("span"),n=B("["),i=B(r),s=B("]"),L(e,"class","duration svelte-5kr8d6")},m(l,c){C(l,e,c),O(e,n),O(e,i),O(e,s)},p(l,c){c&1&&r!==(r=l[0].metadata.duration+"")&&Ie(i,r)},d(l){l&&T(e)}}}function dl(t){var G,X;let e,n,r,i=t[0].title+"",s,l,c,u=ji(t[0].path)+"",h,p,b,m,y,w,S,P,k=((X=(G=t[0])==null?void 0:G.metadata)==null?void 0:X.duration)&&Li(t);return m=new ul({props:{entry:t[0],fnAction:t[1]}}),{c(){e=M("div"),n=M("div"),k&&k.c(),r=F(),s=B(i),l=F(),c=M("div"),h=B(u),p=F(),b=M("div"),Ke(m.$$.fragment),L(c,"class","file_path svelte-5kr8d6"),L(b,"class","controls svelte-5kr8d6"),L(n,"class","entry svelte-5kr8d6"),ce(n,"selected",t[0].id==t[3]),ce(n,"just_bumped",!t[2]&&t[0].justBumped),ce(n,"within_limit",!t[2]&&t[0].withinLimit),ce(n,"is_search_result",t[2]),ce(n,"error",t[0].error),L(e,"class","entry_wrapper svelte-5kr8d6")},m(j,q){C(j,e,q),O(e,n),k&&k.m(n,null),O(n,r),O(n,s),O(n,l),O(n,c),O(c,h),O(n,p),O(n,b),je(m,b,null),w=!0,S||(P=Se(n,"click",t[5]),S=!0)},p(j,[q]){var be,ye;(ye=(be=j[0])==null?void 0:be.metadata)!=null&&ye.duration?k?k.p(j,q):(k=Li(j),k.c(),k.m(n,r)):k&&(k.d(1),k=null),(!w||q&1)&&i!==(i=j[0].title+"")&&Ie(s,i),(!w||q&1)&&u!==(u=ji(j[0].path)+"")&&Ie(h,u);const z={};q&1&&(z.entry=j[0]),q&2&&(z.fnAction=j[1]),m.$set(z),(!w||q&9)&&ce(n,"selected",j[0].id==j[3]),(!w||q&5)&&ce(n,"just_bumped",!j[2]&&j[0].justBumped),(!w||q&5)&&ce(n,"within_limit",!j[2]&&j[0].withinLimit),(!w||q&4)&&ce(n,"is_search_result",j[2]),(!w||q&1)&&ce(n,"error",j[0].error)},i(j){w||(re(m.$$.fragment,j),y||jt(()=>{y=hn(n,xn,{}),y.start()}),w=!0)},o(j){we(m.$$.fragment,j),w=!1},d(j){j&&T(e),k&&k.d(),Be(m),S=!1,P()}}}function ji(t){return t.replace("/root/DMTMountedMedia","")}function hl(t,e,n){let r;wt(t,Gn,h=>n(3,r=h));let{entry:i}=e,{fnAction:s}=e,{isSearchResult:l}=e;function c(h){h==lo(Gn)?Gn.set(null):Gn.set(h)}const u=()=>{c(i.id)};return t.$$set=h=>{"entry"in h&&n(0,i=h.entry),"fnAction"in h&&n(1,s=h.fnAction),"isSearchResult"in h&&n(2,l=h.isSearchResult)},[i,s,l,r,c,u]}class vs extends dt{constructor(e){super(),ut(this,e,hl,dl,at,{entry:0,fnAction:1,isSearchResult:2})}}function Bi(t,e,n){const r=t.slice();return r[7]=e[n],r}function zi(t){let e,n,r,i;const s=[pl,_l],l=[];function c(u,h){return u[2].length?0:1}return e=c(t),n=l[e]=s[e](t),{c(){n.c(),r=bt()},m(u,h){l[e].m(u,h),C(u,r,h),i=!0},p(u,h){let p=e;e=c(u),e===p?l[e].p(u,h):(kt(),we(l[p],1,1,()=>{l[p]=null}),Ct(),n=l[e],n?n.p(u,h):(n=l[e]=s[e](u),n.c()),re(n,1),n.m(r.parentNode,r))},i(u){i||(re(n),i=!0)},o(u){we(n),i=!1},d(u){l[e].d(u),u&&T(r)}}}function _l(t){let e,n;return{c(){e=M("h3"),e.textContent="[ No matches ]",L(e,"class","no_matches svelte-11vb31n")},m(r,i){C(r,e,i)},p:ge,i(r){n||jt(()=>{n=hn(e,xn,{}),n.start()})},o:ge,d(r){r&&T(e)}}}function pl(t){let e,n,r,i,s,l,c;function u(S,P){return S[2].length>yn?vl:bl}let h=u(t),p=h(t),b=t[2].slice(0,yn),m=[];for(let S=0;S<b.length;S+=1)m[S]=Ki(Bi(t,b,S));const y=S=>we(m[S],1,1,()=>{m[S]=null});let w=t[2].length>yn&&qi(t);return{c(){e=M("h3"),p.c(),n=F();for(let S=0;S<m.length;S+=1)m[S].c();r=F(),i=M("div"),w&&w.c(),s=F(),l=M("span"),l.textContent="💡 Use comma (,) to separate multiple additive search terms.",L(e,"class","svelte-11vb31n"),L(l,"class","deemph svelte-11vb31n"),L(i,"class","result_count svelte-11vb31n")},m(S,P){C(S,e,P),p.m(e,null),C(S,n,P);for(let k=0;k<m.length;k+=1)m[k]&&m[k].m(S,P);C(S,r,P),C(S,i,P),w&&w.m(i,null),O(i,s),O(i,l),c=!0},p(S,P){if(h===(h=u(S))&&p?p.p(S,P):(p.d(1),p=h(S),p&&(p.c(),p.m(e,null))),P&6){b=S[2].slice(0,yn);let k;for(k=0;k<b.length;k+=1){const G=Bi(S,b,k);m[k]?(m[k].p(G,P),re(m[k],1)):(m[k]=Ki(G),m[k].c(),re(m[k],1),m[k].m(r.parentNode,r))}for(kt(),k=b.length;k<m.length;k+=1)y(k);Ct()}S[2].length>yn?w?w.p(S,P):(w=qi(S),w.c(),w.m(i,s)):w&&(w.d(1),w=null)},i(S){if(!c){for(let P=0;P<b.length;P+=1)re(m[P]);c=!0}},o(S){m=m.filter(Boolean);for(let P=0;P<m.length;P+=1)we(m[P]);c=!1},d(S){S&&T(e),p.d(),S&&T(n),wn(m,S),S&&T(r),S&&T(i),w&&w.d()}}}function bl(t){let e=t[2].length+"",n,r,i=t[2].length==1?"match":"matches",s;return{c(){n=B(e),r=F(),s=B(i)},m(l,c){C(l,n,c),C(l,r,c),C(l,s,c)},p(l,c){c&4&&e!==(e=l[2].length+"")&&Ie(n,e),c&4&&i!==(i=l[2].length==1?"match":"matches")&&Ie(s,i)},d(l){l&&T(n),l&&T(r),l&&T(s)}}}function vl(t){let e,n,r;return{c(){e=B("First "),n=B(yn),r=B(" matches")},m(i,s){C(i,e,s),C(i,n,s),C(i,r,s)},p:ge,d(i){i&&T(e),i&&T(n),i&&T(r)}}}function Ki(t){let e,n;return e=new vs({props:{entry:t[7],fnAction:t[1],isSearchResult:"true"}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p(r,i){const s={};i&4&&(s.entry=r[7]),i&2&&(s.fnAction=r[1]),e.$set(s)},i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function qi(t){let e,n,r=t[2].length-yn+"",i,s;return{c(){e=M("div"),n=B("… there are "),i=B(r),s=B(" more matches")},m(l,c){C(l,e,c),O(e,n),O(e,i),O(e,s)},p(l,c){c&4&&r!==(r=l[2].length-yn+"")&&Ie(i,r)},d(l){l&&T(e)}}}function ml(t){let e,n,r=t[2]&&zi(t);return{c(){r&&r.c(),e=bt()},m(i,s){r&&r.m(i,s),C(i,e,s),n=!0},p(i,[s]){i[2]?r?(r.p(i,s),s&4&&re(r,1)):(r=zi(i),r.c(),re(r,1),r.m(e.parentNode,e)):r&&(kt(),we(r,1,1,()=>{r=null}),Ct())},i(i){n||(re(r),n=!0)},o(i){we(r),n=!1},d(i){r&&r.d(i),i&&T(e)}}}const yn=20;function yl(t,e,n){let r,i=ge,s=()=>(i(),i=Rt(c,p=>n(4,r=p)),c),l;wt(t,dn,p=>n(2,l=p)),t.$$.on_destroy.push(()=>i());let{store:c}=e;s();let{connected:u}=e,{fnAction:h}=e;return t.$$set=p=>{"store"in p&&s(n(0,c=p.store)),"connected"in p&&n(3,u=p.connected),"fnAction"in p&&n(1,h=p.fnAction)},t.$$.update=()=>{t.$$.dirty&16&&r.playlist,t.$$.dirty&16&&r.playlistMetadata},[c,h,l,u,r]}class gl extends dt{constructor(e){super(),ut(this,e,yl,ml,at,{store:0,connected:3,fnAction:1})}}function Yi(t){let e,n=t[1]=="tv"&&Fi(t);return{c(){n&&n.c(),e=bt()},m(r,i){n&&n.m(r,i),C(r,e,i)},p(r,i){r[1]=="tv"?n?n.p(r,i):(n=Fi(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(r){n&&n.d(r),r&&T(e)}}}function Fi(t){let e,n,r,i,s,l,c,u,h,p,b,m,y,w,S,P,k,G;return{c(){e=M("div"),n=M("button"),n.textContent="Celovečerne risanke",r=F(),i=M("button"),i.textContent="Booba",s=F(),l=M("button"),l.textContent="Rusty Rivets",c=F(),u=M("button"),u.textContent="Jellystone",h=F(),p=M("button"),p.textContent="Pajek Lukas",b=F(),m=M("button"),m.textContent="Medvedek Paddington",y=F(),w=M("button"),w.textContent="Wolfoo",S=F(),P=M("button"),P.textContent="Arpo",L(n,"class","svelte-84hcn8"),L(i,"class","svelte-84hcn8"),L(l,"class","svelte-84hcn8"),L(u,"class","svelte-84hcn8"),L(p,"class","svelte-84hcn8"),L(m,"class","svelte-84hcn8"),L(w,"class","svelte-84hcn8"),L(P,"class","svelte-84hcn8"),L(e,"class","sublist svelte-84hcn8")},m(X,j){C(X,e,j),O(e,n),O(e,r),O(e,i),O(e,s),O(e,l),O(e,c),O(e,u),O(e,h),O(e,p),O(e,b),O(e,m),O(e,y),O(e,w),O(e,S),O(e,P),k||(G=[Se(n,"click",t[6]),Se(i,"click",t[7]),Se(l,"click",t[8]),Se(u,"click",t[9]),Se(p,"click",t[10]),Se(m,"click",t[11]),Se(w,"click",t[12]),Se(P,"click",t[13])],k=!0)},p:ge,d(X){X&&T(e),k=!1,yt(G)}}}function xl(t){let e,n=t[2]&&t[3]&&Yi(t);return{c(){n&&n.c(),e=bt()},m(r,i){n&&n.m(r,i),C(r,e,i)},p(r,[i]){r[2]&&r[3]?n?n.p(r,i):(n=Yi(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ge,o:ge,d(r){n&&n.d(r),r&&T(e)}}}function wl(t,e,n){let r,i,s=ge,l=()=>(s(),s=Rt(u,X=>n(3,i=X)),u);wt(t,_s,X=>n(2,r=X)),t.$$.on_destroy.push(()=>s());function c(X){h("sublist",{tag:X})}let{connected:u}=e;l();let{fnAction:h}=e,{deviceName:p}=e;const b=()=>{c("cartoons-slo/")},m=()=>{c("Booba")},y=()=>{c("Rusty Rivets")},w=()=>{c("Jellystone")},S=()=>{c("Lucas the spider")},P=()=>{c("Adventure Paddington")},k=()=>{c("Wolfoo")},G=()=>{c("Arpo")};return t.$$set=X=>{"connected"in X&&l(n(0,u=X.connected)),"fnAction"in X&&n(5,h=X.fnAction),"deviceName"in X&&n(1,p=X.deviceName)},[u,p,r,i,c,h,b,m,y,w,S,P,k,G]}class Al extends dt{constructor(e){super(),ut(this,e,wl,xl,at,{connected:0,fnAction:5,deviceName:1})}}function Hi(t,e,n){const r=t.slice();return r[10]=e[n],r}function Ji(t){let e,n,r,i,s,l,c=t[4].playlistLength+"",u,h,p,b,m,y,w,S,P,k=t[7]&&Wi(t);m=new Al({props:{connected:t[1],deviceName:t[3],fnAction:t[2]}});let G=t[5].filter(Vi).slice(0,1.5*Gi),X=[];for(let q=0;q<G.length;q+=1)X[q]=Zi(Hi(t,G,q));const j=q=>we(X[q],1,1,()=>{X[q]=null});return{c(){e=M("h3"),n=B("Playlist @ "),r=B(t[3]),i=F(),s=M("span"),l=B("("),u=B(c),h=B(")"),p=F(),k&&k.c(),b=F(),Ke(m.$$.fragment),y=F();for(let q=0;q<X.length;q+=1)X[q].c();w=F(),S=M("div"),S.textContent="...",L(s,"class","svelte-146wfrf"),L(e,"class","svelte-146wfrf")},m(q,z){C(q,e,z),O(e,n),O(e,r),O(e,i),O(e,s),O(s,l),O(s,u),O(s,h),O(e,p),k&&k.m(e,null),C(q,b,z),je(m,q,z),C(q,y,z);for(let be=0;be<X.length;be+=1)X[be]&&X[be].m(q,z);C(q,w,z),C(q,S,z),P=!0},p(q,z){(!P||z&8)&&Ie(r,q[3]),(!P||z&16)&&c!==(c=q[4].playlistLength+"")&&Ie(u,c),q[7]?k?k.p(q,z):(k=Wi(q),k.c(),k.m(e,null)):k&&(k.d(1),k=null);const be={};if(z&2&&(be.connected=q[1]),z&8&&(be.deviceName=q[3]),z&4&&(be.fnAction=q[2]),m.$set(be),z&36){G=q[5].filter(Vi).slice(0,1.5*Gi);let ye;for(ye=0;ye<G.length;ye+=1){const ue=Hi(q,G,ye);X[ye]?(X[ye].p(ue,z),re(X[ye],1)):(X[ye]=Zi(ue),X[ye].c(),re(X[ye],1),X[ye].m(w.parentNode,w))}for(kt(),ye=G.length;ye<X.length;ye+=1)j(ye);Ct()}},i(q){if(!P){re(m.$$.fragment,q);for(let z=0;z<G.length;z+=1)re(X[z]);P=!0}},o(q){we(m.$$.fragment,q),X=X.filter(Boolean);for(let z=0;z<X.length;z+=1)we(X[z]);P=!1},d(q){q&&T(e),k&&k.d(),q&&T(b),Be(m,q),q&&T(y),wn(X,q),q&&T(w),q&&T(S)}}}function Wi(t){let e,n,r,i,s,l;return{c(){e=B("| "),n=M("a"),r=B("▶ Next"),L(n,"href","#"),L(n,"class","next svelte-146wfrf"),L(n,"disabled",i=!t[7])},m(c,u){C(c,e,u),C(c,n,u),O(n,r),s||(l=Se(n,"click",ss(t[8])),s=!0)},p(c,u){u&128&&i!==(i=!c[7])&&L(n,"disabled",i)},d(c){c&&T(e),c&&T(n),s=!1,l()}}}function Zi(t){let e,n;return e=new vs({props:{entry:t[10],fnAction:t[2]}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p(r,i){const s={};i&32&&(s.entry=r[10]),i&4&&(s.fnAction=r[2]),e.$set(s)},i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function El(t){var i;let e,n,r=!t[6]&&((i=t[5])==null?void 0:i.length)&&Ji(t);return{c(){r&&r.c(),e=bt()},m(s,l){r&&r.m(s,l),C(s,e,l),n=!0},p(s,[l]){var c;!s[6]&&((c=s[5])!=null&&c.length)?r?(r.p(s,l),l&96&&re(r,1)):(r=Ji(s),r.c(),re(r,1),r.m(e.parentNode,e)):r&&(kt(),we(r,1,1,()=>{r=null}),Ct())},i(s){n||(re(r),n=!0)},o(s){we(r),n=!1},d(s){r&&r.d(s),s&&T(e)}}}const Gi=20,Vi=({current:t,past:e})=>!t&&!e;function Sl(t,e,n){let r,i,s,l=ge,c=()=>(l(),l=Rt(m,k=>n(9,s=k)),m),u,h,p=ge,b=()=>(p(),p=Rt(y,k=>n(7,h=k)),y);wt(t,dn,k=>n(6,u=k)),t.$$.on_destroy.push(()=>l()),t.$$.on_destroy.push(()=>p());let{store:m}=e;c();let{connected:y}=e;b();let{fnAction:w}=e,{deviceName:S}=e;function P(){window.scrollTo({top:0,behavior:"smooth"}),w("next")}return t.$$set=k=>{"store"in k&&c(n(0,m=k.store)),"connected"in k&&b(n(1,y=k.connected)),"fnAction"in k&&n(2,w=k.fnAction),"deviceName"in k&&n(3,S=k.deviceName)},t.$$.update=()=>{t.$$.dirty&512&&n(5,r=s.playlist),t.$$.dirty&512&&n(4,i=s.playlistMetadata)},[m,y,w,S,i,r,u,h,P,s]}class Ol extends dt{constructor(e){super(),ut(this,e,Sl,El,at,{store:0,connected:1,fnAction:2,deviceName:3})}}function Tl(t){let e,n,r,i,s,l,c;return n=new ll({props:{connected:t[1],store:t[0],fnAction:t[2]}}),i=new gl({props:{connected:t[1],store:t[0],fnAction:t[2]}}),l=new Ol({props:{connected:t[1],store:t[0],fnAction:t[2],deviceName:t[3]}}),{c(){e=M("div"),Ke(n.$$.fragment),r=F(),Ke(i.$$.fragment),s=F(),Ke(l.$$.fragment),L(e,"class","searchable_playlist svelte-1op3n77")},m(u,h){C(u,e,h),je(n,e,null),O(e,r),je(i,e,null),O(e,s),je(l,e,null),c=!0},p(u,[h]){const p={};h&2&&(p.connected=u[1]),h&1&&(p.store=u[0]),h&4&&(p.fnAction=u[2]),n.$set(p);const b={};h&2&&(b.connected=u[1]),h&1&&(b.store=u[0]),h&4&&(b.fnAction=u[2]),i.$set(b);const m={};h&2&&(m.connected=u[1]),h&1&&(m.store=u[0]),h&4&&(m.fnAction=u[2]),h&8&&(m.deviceName=u[3]),l.$set(m)},i(u){c||(re(n.$$.fragment,u),re(i.$$.fragment,u),re(l.$$.fragment,u),c=!0)},o(u){we(n.$$.fragment,u),we(i.$$.fragment,u),we(l.$$.fragment,u),c=!1},d(u){u&&T(e),Be(n),Be(i),Be(l)}}}function kl(t,e,n){let{store:r}=e,{connected:i}=e,{fnAction:s}=e,{deviceName:l}=e;return t.$$set=c=>{"store"in c&&n(0,r=c.store),"connected"in c&&n(1,i=c.connected),"fnAction"in c&&n(2,s=c.fnAction),"deviceName"in c&&n(3,l=c.deviceName)},[r,i,s,l]}class Cl extends dt{constructor(e){super(),ut(this,e,kl,Tl,at,{store:0,connected:1,fnAction:2,deviceName:3})}}function Qi(t){let e,n,r,i,s,l,c,u,h,p,b,m,y,w;return{c(){e=M("h3"),n=B("Play internet radio @ "),r=B(t[2]),i=F(),s=M("div"),l=M("button"),l.textContent="Rock",c=F(),u=M("button"),u.textContent="Jazz",h=F(),p=M("button"),p.textContent="Psytrance",b=F(),m=M("button"),m.textContent="Goatrance",L(l,"class","svelte-tpf42f"),L(u,"class","svelte-tpf42f"),L(p,"class","svelte-tpf42f"),L(m,"class","svelte-tpf42f"),L(s,"class","radios svelte-tpf42f")},m(S,P){C(S,e,P),O(e,n),O(e,r),C(S,i,P),C(S,s,P),O(s,l),O(s,c),O(s,u),O(s,h),O(s,p),O(s,b),O(s,m),y||(w=[Se(l,"click",t[4]),Se(u,"click",t[5]),Se(p,"click",t[6]),Se(m,"click",t[7])],y=!0)},p(S,P){P&4&&Ie(r,S[2])},d(S){S&&T(e),S&&T(i),S&&T(s),y=!1,yt(w)}}}function Rl(t){let e,n=t[3]&&Qi(t);return{c(){n&&n.c(),e=bt()},m(r,i){n&&n.m(r,i),C(r,e,i)},p(r,[i]){r[3]?n?n.p(r,i):(n=Qi(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ge,o:ge,d(r){n&&n.d(r),r&&T(e)}}}function Nl(t,e,n){let r,i=ge,s=()=>(i(),i=Rt(l,y=>n(3,r=y)),l);t.$$.on_destroy.push(()=>i());let{connected:l}=e;s();let{fnAction:c}=e,{deviceName:u}=e;const h=()=>{c("play_radio",{radioId:"rock"})},p=()=>{c("play_radio",{radioId:"jazz"})},b=()=>{c("play_radio",{radioId:"progressive-trance"})},m=()=>{c("play_radio",{radioId:"goa-trance"})};return t.$$set=y=>{"connected"in y&&s(n(0,l=y.connected)),"fnAction"in y&&n(1,c=y.fnAction),"deviceName"in y&&n(2,u=y.deviceName)},[l,c,u,r,h,p,b,m]}class Dl extends dt{constructor(e){super(),ut(this,e,Nl,Rl,at,{connected:0,fnAction:1,deviceName:2})}}function Xi(t){let e,n;return e=new Dl({props:{connected:t[0],fnAction:t[4],deviceName:t[1]}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p(r,i){const s={};i&1&&(s.connected=r[0]),i&16&&(s.fnAction=r[4]),i&2&&(s.deviceName=r[1]),e.$set(s)},i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function ef(t){let e,n;return e=new Cl({props:{connected:t[0],store:t[3],fnAction:t[4],deviceName:t[1]}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p(r,i){const s={};i&1&&(s.connected=r[0]),i&8&&(s.store=r[3]),i&16&&(s.fnAction=r[4]),i&2&&(s.deviceName=r[1]),e.$set(s)},i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function $l(t){var p;let e,n,r,i,s,l,c;e=new Ho({props:{connected:t[0],store:t[3],player:t[2],songTitle:t[9],songPath:t[8],playlistCurrentMedia:t[6],playlistSongPath:t[5],fnAction:t[4]}}),r=new rl({props:{connected:t[0],player:t[2],fnAction:t[4],songTitle:t[9],deviceName:t[1]}});let u=t[1]!="tv-ap2"&&Xi(t),h=!t[2].isStream&&((p=t[7])==null?void 0:p.length)&&ef(t);return{c(){Ke(e.$$.fragment),n=F(),Ke(r.$$.fragment),i=F(),u&&u.c(),s=F(),h&&h.c(),l=bt()},m(b,m){je(e,b,m),C(b,n,m),je(r,b,m),C(b,i,m),u&&u.m(b,m),C(b,s,m),h&&h.m(b,m),C(b,l,m),c=!0},p(b,[m]){var S;const y={};m&1&&(y.connected=b[0]),m&8&&(y.store=b[3]),m&4&&(y.player=b[2]),m&512&&(y.songTitle=b[9]),m&256&&(y.songPath=b[8]),m&64&&(y.playlistCurrentMedia=b[6]),m&32&&(y.playlistSongPath=b[5]),m&16&&(y.fnAction=b[4]),e.$set(y);const w={};m&1&&(w.connected=b[0]),m&4&&(w.player=b[2]),m&16&&(w.fnAction=b[4]),m&512&&(w.songTitle=b[9]),m&2&&(w.deviceName=b[1]),r.$set(w),b[1]!="tv-ap2"?u?(u.p(b,m),m&2&&re(u,1)):(u=Xi(b),u.c(),re(u,1),u.m(s.parentNode,s)):u&&(kt(),we(u,1,1,()=>{u=null}),Ct()),!b[2].isStream&&((S=b[7])!=null&&S.length)?h?(h.p(b,m),m&132&&re(h,1)):(h=ef(b),h.c(),re(h,1),h.m(l.parentNode,l)):h&&(kt(),we(h,1,1,()=>{h=null}),Ct())},i(b){c||(re(e.$$.fragment,b),re(r.$$.fragment,b),re(u),re(h),c=!0)},o(b){we(e.$$.fragment,b),we(r.$$.fragment,b),we(u),we(h),c=!1},d(b){Be(e,b),b&&T(n),Be(r,b),b&&T(i),u&&u.d(b),b&&T(s),h&&h.d(b),b&&T(l)}}}function Pl(t,e,n){let r,i,s,l,c,u,h,p,b,m,y=ge,w=()=>(y(),y=Rt(G,j=>n(14,m=j)),G);t.$$.on_destroy.push(()=>y());let{connected:S}=e,{deviceName:P}=e,{player:k}=e,{store:G}=e;w();let{fnAction:X}=e;return t.$$set=j=>{"connected"in j&&n(0,S=j.connected),"deviceName"in j&&n(1,P=j.deviceName),"player"in j&&n(2,k=j.player),"store"in j&&w(n(3,G=j.store)),"fnAction"in j&&n(4,X=j.fnAction)},t.$$.update=()=>{t.$$.dirty&4&&n(13,r=k.currentMedia||{}),t.$$.dirty&8192&&n(12,i=r.artist&&r.song?`${r.artist} - ${r.song}`:r.song),t.$$.dirty&8192&&n(10,s=r.songPath),t.$$.dirty&16384&&n(7,l=m.playlist),t.$$.dirty&128&&n(6,c=(l||[]).find(({current:j})=>j)),t.$$.dirty&64&&n(11,u=c==null?void 0:c.title),t.$$.dirty&64&&n(5,h=c==null?void 0:c.path),t.$$.dirty&6144&&n(9,p=i||u),t.$$.dirty&1056&&n(8,b=s||h)},[S,P,k,G,X,h,c,l,b,p,s,u,i,r,m]}class Il extends dt{constructor(e){super(),ut(this,e,Pl,$l,at,{connected:0,deviceName:1,player:2,store:3,fnAction:4})}}function tf(t,e,n){const r=t.slice();return r[15]=e[n],r}function nf(t){let e,n=t[3],r=[];for(let i=0;i<n.length;i+=1)r[i]=sf(tf(t,n,i));return{c(){e=M("div");for(let i=0;i<r.length;i+=1)r[i].c();L(e,"class","nearby_devices svelte-f8wsgm")},m(i,s){C(i,e,s);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(i,s){if(s&251){n=i[3];let l;for(l=0;l<n.length;l+=1){const c=tf(i,n,l);r[l]?r[l].p(c,s):(r[l]=sf(c),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(i){i&&T(e),wn(r,i)}}}function rf(t){let e;return{c(){e=M("span"),e.textContent="!",L(e,"class","error svelte-f8wsgm")},m(n,r){C(n,e,r)},d(n){n&&T(e)}}}function ff(t){let e,n=t[15].mediaType=="music"?"♫":"▶",r;return{c(){e=M("span"),r=B(n),L(e,"class","play_symbol svelte-f8wsgm")},m(i,s){C(i,e,s),O(e,r)},p(i,s){s&8&&n!==(n=i[15].mediaType=="music"?"♫":"▶")&&Ie(r,n)},d(i){i&&T(e)}}}function sf(t){let e,n,r,i=t[15].deviceName+"",s,l,c,u,h=t[15].hasErrors&&rf(),p=t[15].playing&&ff(t);return{c(){e=M("button"),h&&h.c(),n=F(),p&&p.c(),r=F(),s=B(i),l=F(),L(e,"class","svelte-f8wsgm"),ce(e,"active",t[15].deviceKey==t[0]),ce(e,"local_device",t[15].thisDevice),ce(e,"playing",t[15].playing),ce(e,"late_pong1",t[4]-t[5][t[15].deviceKey]>2e3),ce(e,"late_pong2",t[4]-t[5][t[15].deviceKey]>2500),ce(e,"late_pong3",t[4]-t[5][t[15].deviceKey]>3500),ce(e,"connected",t[6][t[15].deviceKey]),ce(e,"disconnected",t[6][t[15].deviceKey]==!1),ce(e,"cpu_usage_warn1",t[15].cpuUsage>50),ce(e,"cpu_usage_warn2",t[15].cpuUsage>70),ce(e,"cpu_usage_warn3",t[15].cpuUsage>80)},m(b,m){C(b,e,m),h&&h.m(e,null),O(e,n),p&&p.m(e,null),O(e,r),O(e,s),O(e,l),c||(u=Se(e,"click",function(){Yn(t[7]({store:t[1],device:t[15]}))&&t[7]({store:t[1],device:t[15]}).apply(this,arguments)}),c=!0)},p(b,m){t=b,t[15].hasErrors?h||(h=rf(),h.c(),h.m(e,n)):h&&(h.d(1),h=null),t[15].playing?p?p.p(t,m):(p=ff(t),p.c(),p.m(e,r)):p&&(p.d(1),p=null),m&8&&i!==(i=t[15].deviceName+"")&&Ie(s,i),m&9&&ce(e,"active",t[15].deviceKey==t[0]),m&8&&ce(e,"local_device",t[15].thisDevice),m&8&&ce(e,"playing",t[15].playing),m&56&&ce(e,"late_pong1",t[4]-t[5][t[15].deviceKey]>2e3),m&56&&ce(e,"late_pong2",t[4]-t[5][t[15].deviceKey]>2500),m&56&&ce(e,"late_pong3",t[4]-t[5][t[15].deviceKey]>3500),m&72&&ce(e,"connected",t[6][t[15].deviceKey]),m&72&&ce(e,"disconnected",t[6][t[15].deviceKey]==!1),m&8&&ce(e,"cpu_usage_warn1",t[15].cpuUsage>50),m&8&&ce(e,"cpu_usage_warn2",t[15].cpuUsage>70),m&8&&ce(e,"cpu_usage_warn3",t[15].cpuUsage>80)},d(b){b&&T(e),h&&h.d(),p&&p.d(),c=!1,u()}}}function Ml(t){let e,n=t[3].length&&nf(t);return{c(){n&&n.c(),e=bt()},m(r,i){n&&n.m(r,i),C(r,e,i)},p(r,[i]){r[3].length?n?n.p(r,i):(n=nf(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ge,o:ge,d(r){n&&n.d(r),r&&T(e)}}}function Ul(t,e,n){let r,i,s,l,c;wt(t,ds,k=>n(12,i=k));let{nearbyDevices:u}=e,{activeDeviceKey:h}=e,{store:p}=e,{log:b}=e;function m({store:k,device:G}){cr.set(null),dn.set(null),localStorage.setItem("current_device_key",G.deviceKey),k.switch(G)}const y=tn({});wt(t,y,k=>n(5,l=k)),p.on("pong",({deviceKey:k})=>{y.update(G=>(G[k]=Date.now(),G))});const w=tn({});wt(t,w,k=>n(6,c=k)),w.alreadyDone={};const S=tn(Date.now());wt(t,S,k=>n(4,s=k));function P(){S.set(Date.now()),setTimeout(P,300)}return P(),t.$$set=k=>{"nearbyDevices"in k&&n(10,u=k.nearbyDevices),"activeDeviceKey"in k&&n(0,h=k.activeDeviceKey),"store"in k&&n(1,p=k.store),"log"in k&&n(11,b=k.log)},t.$$.update=()=>{t.$$.dirty&7175&&n(3,r=u.filter(({deviceName:k,playing:G,deviceKey:X,thisDevice:j,ip:q,isRPi:z})=>(X==h||G||i)&&(z||j)).map(k=>{const{ip:G,deviceKey:X,deviceName:j,thisDevice:q,playing:z}=k;return w.alreadyDone[X]||(n(2,w.alreadyDone[X]=!0,w),setTimeout(()=>{b(`${G} Preconnecting ${j}`);const ye=p.preconnect({host:G,deviceKey:X,thisDevice:q});ye.__prevSubUnsubscribe?ye.__prevSubUnsubscribe():ye.on("decommission",()=>{b(`dmt-mobile: Decommissioned connector ${j} @ ${G}`),n(2,w.alreadyDone[X]=!1,w),ye.__prevSubUnsubscribe&&ye.__prevSubUnsubscribe()}),ye.__prevSubUnsubscribe=ye.connected.subscribe(ue=>{w.update(De=>(De[X]=ue,De))})},0)),k}))},[h,p,w,r,s,l,c,m,y,S,u,b,i]}class Ll extends dt{constructor(e){super(),ut(this,e,Ul,Ml,at,{nearbyDevices:10,activeDeviceKey:0,store:1,log:11})}}var jl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ms(t,e,n){return n={path:e,exports:{},require:function(r,i){return ys(r,i??n.path)}},t(n,n.exports),n.exports}function Bl(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}),e}function ys(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var zl={},Kl=Object.freeze({__proto__:null,default:zl}),ql=Bl(Kl),Zt=ms(function(t){(function(e){var n=function(o){var d,a=new Float64Array(16);if(o)for(d=0;d<o.length;d++)a[d]=o[d];return a},r=function(){throw new Error("no PRNG")},i=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var l=n(),c=n([1]),u=n([56129,1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function w(o,d,a,f){o[d]=a>>24&255,o[d+1]=a>>16&255,o[d+2]=a>>8&255,o[d+3]=a&255,o[d+4]=f>>24&255,o[d+5]=f>>16&255,o[d+6]=f>>8&255,o[d+7]=f&255}function S(o,d,a,f,_){var g,x=0;for(g=0;g<_;g++)x|=o[d+g]^a[f+g];return(1&x-1>>>8)-1}function P(o,d,a,f){return S(o,d,a,f,16)}function k(o,d,a,f){return S(o,d,a,f,32)}function G(o,d,a,f){for(var _=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,N=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,U=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,Q=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,Y=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,Ce=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,J=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,ie=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,fe=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,he=a[16]&255|(a[17]&255)<<8|(a[18]&255)<<16|(a[19]&255)<<24,ae=a[20]&255|(a[21]&255)<<8|(a[22]&255)<<16|(a[23]&255)<<24,se=a[24]&255|(a[25]&255)<<8|(a[26]&255)<<16|(a[27]&255)<<24,le=a[28]&255|(a[29]&255)<<8|(a[30]&255)<<16|(a[31]&255)<<24,oe=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,W=_,ee=g,H=x,Z=N,V=U,K=Q,A=Y,E=Ce,$=J,R=ie,D=fe,I=he,ne=ae,_e=se,ve=le,pe=oe,v,xe=0;xe<20;xe+=2)v=W+ne|0,V^=v<<7|v>>>32-7,v=V+W|0,$^=v<<9|v>>>32-9,v=$+V|0,ne^=v<<13|v>>>32-13,v=ne+$|0,W^=v<<18|v>>>32-18,v=K+ee|0,R^=v<<7|v>>>32-7,v=R+K|0,_e^=v<<9|v>>>32-9,v=_e+R|0,ee^=v<<13|v>>>32-13,v=ee+_e|0,K^=v<<18|v>>>32-18,v=D+A|0,ve^=v<<7|v>>>32-7,v=ve+D|0,H^=v<<9|v>>>32-9,v=H+ve|0,A^=v<<13|v>>>32-13,v=A+H|0,D^=v<<18|v>>>32-18,v=pe+I|0,Z^=v<<7|v>>>32-7,v=Z+pe|0,E^=v<<9|v>>>32-9,v=E+Z|0,I^=v<<13|v>>>32-13,v=I+E|0,pe^=v<<18|v>>>32-18,v=W+Z|0,ee^=v<<7|v>>>32-7,v=ee+W|0,H^=v<<9|v>>>32-9,v=H+ee|0,Z^=v<<13|v>>>32-13,v=Z+H|0,W^=v<<18|v>>>32-18,v=K+V|0,A^=v<<7|v>>>32-7,v=A+K|0,E^=v<<9|v>>>32-9,v=E+A|0,V^=v<<13|v>>>32-13,v=V+E|0,K^=v<<18|v>>>32-18,v=D+R|0,I^=v<<7|v>>>32-7,v=I+D|0,$^=v<<9|v>>>32-9,v=$+I|0,R^=v<<13|v>>>32-13,v=R+$|0,D^=v<<18|v>>>32-18,v=pe+ve|0,ne^=v<<7|v>>>32-7,v=ne+pe|0,_e^=v<<9|v>>>32-9,v=_e+ne|0,ve^=v<<13|v>>>32-13,v=ve+_e|0,pe^=v<<18|v>>>32-18;W=W+_|0,ee=ee+g|0,H=H+x|0,Z=Z+N|0,V=V+U|0,K=K+Q|0,A=A+Y|0,E=E+Ce|0,$=$+J|0,R=R+ie|0,D=D+fe|0,I=I+he|0,ne=ne+ae|0,_e=_e+se|0,ve=ve+le|0,pe=pe+oe|0,o[0]=W>>>0&255,o[1]=W>>>8&255,o[2]=W>>>16&255,o[3]=W>>>24&255,o[4]=ee>>>0&255,o[5]=ee>>>8&255,o[6]=ee>>>16&255,o[7]=ee>>>24&255,o[8]=H>>>0&255,o[9]=H>>>8&255,o[10]=H>>>16&255,o[11]=H>>>24&255,o[12]=Z>>>0&255,o[13]=Z>>>8&255,o[14]=Z>>>16&255,o[15]=Z>>>24&255,o[16]=V>>>0&255,o[17]=V>>>8&255,o[18]=V>>>16&255,o[19]=V>>>24&255,o[20]=K>>>0&255,o[21]=K>>>8&255,o[22]=K>>>16&255,o[23]=K>>>24&255,o[24]=A>>>0&255,o[25]=A>>>8&255,o[26]=A>>>16&255,o[27]=A>>>24&255,o[28]=E>>>0&255,o[29]=E>>>8&255,o[30]=E>>>16&255,o[31]=E>>>24&255,o[32]=$>>>0&255,o[33]=$>>>8&255,o[34]=$>>>16&255,o[35]=$>>>24&255,o[36]=R>>>0&255,o[37]=R>>>8&255,o[38]=R>>>16&255,o[39]=R>>>24&255,o[40]=D>>>0&255,o[41]=D>>>8&255,o[42]=D>>>16&255,o[43]=D>>>24&255,o[44]=I>>>0&255,o[45]=I>>>8&255,o[46]=I>>>16&255,o[47]=I>>>24&255,o[48]=ne>>>0&255,o[49]=ne>>>8&255,o[50]=ne>>>16&255,o[51]=ne>>>24&255,o[52]=_e>>>0&255,o[53]=_e>>>8&255,o[54]=_e>>>16&255,o[55]=_e>>>24&255,o[56]=ve>>>0&255,o[57]=ve>>>8&255,o[58]=ve>>>16&255,o[59]=ve>>>24&255,o[60]=pe>>>0&255,o[61]=pe>>>8&255,o[62]=pe>>>16&255,o[63]=pe>>>24&255}function X(o,d,a,f){for(var _=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,N=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,U=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,Q=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,Y=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,Ce=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,J=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,ie=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,fe=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,he=a[16]&255|(a[17]&255)<<8|(a[18]&255)<<16|(a[19]&255)<<24,ae=a[20]&255|(a[21]&255)<<8|(a[22]&255)<<16|(a[23]&255)<<24,se=a[24]&255|(a[25]&255)<<8|(a[26]&255)<<16|(a[27]&255)<<24,le=a[28]&255|(a[29]&255)<<8|(a[30]&255)<<16|(a[31]&255)<<24,oe=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,W=_,ee=g,H=x,Z=N,V=U,K=Q,A=Y,E=Ce,$=J,R=ie,D=fe,I=he,ne=ae,_e=se,ve=le,pe=oe,v,xe=0;xe<20;xe+=2)v=W+ne|0,V^=v<<7|v>>>32-7,v=V+W|0,$^=v<<9|v>>>32-9,v=$+V|0,ne^=v<<13|v>>>32-13,v=ne+$|0,W^=v<<18|v>>>32-18,v=K+ee|0,R^=v<<7|v>>>32-7,v=R+K|0,_e^=v<<9|v>>>32-9,v=_e+R|0,ee^=v<<13|v>>>32-13,v=ee+_e|0,K^=v<<18|v>>>32-18,v=D+A|0,ve^=v<<7|v>>>32-7,v=ve+D|0,H^=v<<9|v>>>32-9,v=H+ve|0,A^=v<<13|v>>>32-13,v=A+H|0,D^=v<<18|v>>>32-18,v=pe+I|0,Z^=v<<7|v>>>32-7,v=Z+pe|0,E^=v<<9|v>>>32-9,v=E+Z|0,I^=v<<13|v>>>32-13,v=I+E|0,pe^=v<<18|v>>>32-18,v=W+Z|0,ee^=v<<7|v>>>32-7,v=ee+W|0,H^=v<<9|v>>>32-9,v=H+ee|0,Z^=v<<13|v>>>32-13,v=Z+H|0,W^=v<<18|v>>>32-18,v=K+V|0,A^=v<<7|v>>>32-7,v=A+K|0,E^=v<<9|v>>>32-9,v=E+A|0,V^=v<<13|v>>>32-13,v=V+E|0,K^=v<<18|v>>>32-18,v=D+R|0,I^=v<<7|v>>>32-7,v=I+D|0,$^=v<<9|v>>>32-9,v=$+I|0,R^=v<<13|v>>>32-13,v=R+$|0,D^=v<<18|v>>>32-18,v=pe+ve|0,ne^=v<<7|v>>>32-7,v=ne+pe|0,_e^=v<<9|v>>>32-9,v=_e+ne|0,ve^=v<<13|v>>>32-13,v=ve+_e|0,pe^=v<<18|v>>>32-18;o[0]=W>>>0&255,o[1]=W>>>8&255,o[2]=W>>>16&255,o[3]=W>>>24&255,o[4]=K>>>0&255,o[5]=K>>>8&255,o[6]=K>>>16&255,o[7]=K>>>24&255,o[8]=D>>>0&255,o[9]=D>>>8&255,o[10]=D>>>16&255,o[11]=D>>>24&255,o[12]=pe>>>0&255,o[13]=pe>>>8&255,o[14]=pe>>>16&255,o[15]=pe>>>24&255,o[16]=A>>>0&255,o[17]=A>>>8&255,o[18]=A>>>16&255,o[19]=A>>>24&255,o[20]=E>>>0&255,o[21]=E>>>8&255,o[22]=E>>>16&255,o[23]=E>>>24&255,o[24]=$>>>0&255,o[25]=$>>>8&255,o[26]=$>>>16&255,o[27]=$>>>24&255,o[28]=R>>>0&255,o[29]=R>>>8&255,o[30]=R>>>16&255,o[31]=R>>>24&255}function j(o,d,a,f){G(o,d,a,f)}function q(o,d,a,f){X(o,d,a,f)}var z=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function be(o,d,a,f,_,g,x){var N=new Uint8Array(16),U=new Uint8Array(64),Q,Y;for(Y=0;Y<16;Y++)N[Y]=0;for(Y=0;Y<8;Y++)N[Y]=g[Y];for(;_>=64;){for(j(U,N,x,z),Y=0;Y<64;Y++)o[d+Y]=a[f+Y]^U[Y];for(Q=1,Y=8;Y<16;Y++)Q=Q+(N[Y]&255)|0,N[Y]=Q&255,Q>>>=8;_-=64,d+=64,f+=64}if(_>0)for(j(U,N,x,z),Y=0;Y<_;Y++)o[d+Y]=a[f+Y]^U[Y];return 0}function ye(o,d,a,f,_){var g=new Uint8Array(16),x=new Uint8Array(64),N,U;for(U=0;U<16;U++)g[U]=0;for(U=0;U<8;U++)g[U]=f[U];for(;a>=64;){for(j(x,g,_,z),U=0;U<64;U++)o[d+U]=x[U];for(N=1,U=8;U<16;U++)N=N+(g[U]&255)|0,g[U]=N&255,N>>>=8;a-=64,d+=64}if(a>0)for(j(x,g,_,z),U=0;U<a;U++)o[d+U]=x[U];return 0}function ue(o,d,a,f,_){var g=new Uint8Array(32);q(g,f,_,z);for(var x=new Uint8Array(8),N=0;N<8;N++)x[N]=f[N+16];return ye(o,d,a,x,g)}function De(o,d,a,f,_,g,x){var N=new Uint8Array(32);q(N,g,x,z);for(var U=new Uint8Array(8),Q=0;Q<8;Q++)U[Q]=g[Q+16];return be(o,d,a,f,_,U,N)}var ot=function(o){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var d,a,f,_,g,x,N,U;d=o[0]&255|(o[1]&255)<<8,this.r[0]=d&8191,a=o[2]&255|(o[3]&255)<<8,this.r[1]=(d>>>13|a<<3)&8191,f=o[4]&255|(o[5]&255)<<8,this.r[2]=(a>>>10|f<<6)&7939,_=o[6]&255|(o[7]&255)<<8,this.r[3]=(f>>>7|_<<9)&8191,g=o[8]&255|(o[9]&255)<<8,this.r[4]=(_>>>4|g<<12)&255,this.r[5]=g>>>1&8190,x=o[10]&255|(o[11]&255)<<8,this.r[6]=(g>>>14|x<<2)&8191,N=o[12]&255|(o[13]&255)<<8,this.r[7]=(x>>>11|N<<5)&8065,U=o[14]&255|(o[15]&255)<<8,this.r[8]=(N>>>8|U<<8)&8191,this.r[9]=U>>>5&127,this.pad[0]=o[16]&255|(o[17]&255)<<8,this.pad[1]=o[18]&255|(o[19]&255)<<8,this.pad[2]=o[20]&255|(o[21]&255)<<8,this.pad[3]=o[22]&255|(o[23]&255)<<8,this.pad[4]=o[24]&255|(o[25]&255)<<8,this.pad[5]=o[26]&255|(o[27]&255)<<8,this.pad[6]=o[28]&255|(o[29]&255)<<8,this.pad[7]=o[30]&255|(o[31]&255)<<8};ot.prototype.blocks=function(o,d,a){for(var f=this.fin?0:2048,_,g,x,N,U,Q,Y,Ce,J,ie,fe,he,ae,se,le,oe,W,ee,H,Z=this.h[0],V=this.h[1],K=this.h[2],A=this.h[3],E=this.h[4],$=this.h[5],R=this.h[6],D=this.h[7],I=this.h[8],ne=this.h[9],_e=this.r[0],ve=this.r[1],pe=this.r[2],v=this.r[3],xe=this.r[4],Re=this.r[5],Ne=this.r[6],me=this.r[7],Te=this.r[8],ke=this.r[9];a>=16;)_=o[d+0]&255|(o[d+1]&255)<<8,Z+=_&8191,g=o[d+2]&255|(o[d+3]&255)<<8,V+=(_>>>13|g<<3)&8191,x=o[d+4]&255|(o[d+5]&255)<<8,K+=(g>>>10|x<<6)&8191,N=o[d+6]&255|(o[d+7]&255)<<8,A+=(x>>>7|N<<9)&8191,U=o[d+8]&255|(o[d+9]&255)<<8,E+=(N>>>4|U<<12)&8191,$+=U>>>1&8191,Q=o[d+10]&255|(o[d+11]&255)<<8,R+=(U>>>14|Q<<2)&8191,Y=o[d+12]&255|(o[d+13]&255)<<8,D+=(Q>>>11|Y<<5)&8191,Ce=o[d+14]&255|(o[d+15]&255)<<8,I+=(Y>>>8|Ce<<8)&8191,ne+=Ce>>>5|f,J=0,ie=J,ie+=Z*_e,ie+=V*(5*ke),ie+=K*(5*Te),ie+=A*(5*me),ie+=E*(5*Ne),J=ie>>>13,ie&=8191,ie+=$*(5*Re),ie+=R*(5*xe),ie+=D*(5*v),ie+=I*(5*pe),ie+=ne*(5*ve),J+=ie>>>13,ie&=8191,fe=J,fe+=Z*ve,fe+=V*_e,fe+=K*(5*ke),fe+=A*(5*Te),fe+=E*(5*me),J=fe>>>13,fe&=8191,fe+=$*(5*Ne),fe+=R*(5*Re),fe+=D*(5*xe),fe+=I*(5*v),fe+=ne*(5*pe),J+=fe>>>13,fe&=8191,he=J,he+=Z*pe,he+=V*ve,he+=K*_e,he+=A*(5*ke),he+=E*(5*Te),J=he>>>13,he&=8191,he+=$*(5*me),he+=R*(5*Ne),he+=D*(5*Re),he+=I*(5*xe),he+=ne*(5*v),J+=he>>>13,he&=8191,ae=J,ae+=Z*v,ae+=V*pe,ae+=K*ve,ae+=A*_e,ae+=E*(5*ke),J=ae>>>13,ae&=8191,ae+=$*(5*Te),ae+=R*(5*me),ae+=D*(5*Ne),ae+=I*(5*Re),ae+=ne*(5*xe),J+=ae>>>13,ae&=8191,se=J,se+=Z*xe,se+=V*v,se+=K*pe,se+=A*ve,se+=E*_e,J=se>>>13,se&=8191,se+=$*(5*ke),se+=R*(5*Te),se+=D*(5*me),se+=I*(5*Ne),se+=ne*(5*Re),J+=se>>>13,se&=8191,le=J,le+=Z*Re,le+=V*xe,le+=K*v,le+=A*pe,le+=E*ve,J=le>>>13,le&=8191,le+=$*_e,le+=R*(5*ke),le+=D*(5*Te),le+=I*(5*me),le+=ne*(5*Ne),J+=le>>>13,le&=8191,oe=J,oe+=Z*Ne,oe+=V*Re,oe+=K*xe,oe+=A*v,oe+=E*pe,J=oe>>>13,oe&=8191,oe+=$*ve,oe+=R*_e,oe+=D*(5*ke),oe+=I*(5*Te),oe+=ne*(5*me),J+=oe>>>13,oe&=8191,W=J,W+=Z*me,W+=V*Ne,W+=K*Re,W+=A*xe,W+=E*v,J=W>>>13,W&=8191,W+=$*pe,W+=R*ve,W+=D*_e,W+=I*(5*ke),W+=ne*(5*Te),J+=W>>>13,W&=8191,ee=J,ee+=Z*Te,ee+=V*me,ee+=K*Ne,ee+=A*Re,ee+=E*xe,J=ee>>>13,ee&=8191,ee+=$*v,ee+=R*pe,ee+=D*ve,ee+=I*_e,ee+=ne*(5*ke),J+=ee>>>13,ee&=8191,H=J,H+=Z*ke,H+=V*Te,H+=K*me,H+=A*Ne,H+=E*Re,J=H>>>13,H&=8191,H+=$*xe,H+=R*v,H+=D*pe,H+=I*ve,H+=ne*_e,J+=H>>>13,H&=8191,J=(J<<2)+J|0,J=J+ie|0,ie=J&8191,J=J>>>13,fe+=J,Z=ie,V=fe,K=he,A=ae,E=se,$=le,R=oe,D=W,I=ee,ne=H,d+=16,a-=16;this.h[0]=Z,this.h[1]=V,this.h[2]=K,this.h[3]=A,this.h[4]=E,this.h[5]=$,this.h[6]=R,this.h[7]=D,this.h[8]=I,this.h[9]=ne},ot.prototype.finish=function(o,d){var a=new Uint16Array(10),f,_,g,x;if(this.leftover){for(x=this.leftover,this.buffer[x++]=1;x<16;x++)this.buffer[x]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(f=this.h[1]>>>13,this.h[1]&=8191,x=2;x<10;x++)this.h[x]+=f,f=this.h[x]>>>13,this.h[x]&=8191;for(this.h[0]+=f*5,f=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=f,f=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=f,a[0]=this.h[0]+5,f=a[0]>>>13,a[0]&=8191,x=1;x<10;x++)a[x]=this.h[x]+f,f=a[x]>>>13,a[x]&=8191;for(a[9]-=1<<13,_=(f^1)-1,x=0;x<10;x++)a[x]&=_;for(_=~_,x=0;x<10;x++)this.h[x]=this.h[x]&_|a[x];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,g=this.h[0]+this.pad[0],this.h[0]=g&65535,x=1;x<8;x++)g=(this.h[x]+this.pad[x]|0)+(g>>>16)|0,this.h[x]=g&65535;o[d+0]=this.h[0]>>>0&255,o[d+1]=this.h[0]>>>8&255,o[d+2]=this.h[1]>>>0&255,o[d+3]=this.h[1]>>>8&255,o[d+4]=this.h[2]>>>0&255,o[d+5]=this.h[2]>>>8&255,o[d+6]=this.h[3]>>>0&255,o[d+7]=this.h[3]>>>8&255,o[d+8]=this.h[4]>>>0&255,o[d+9]=this.h[4]>>>8&255,o[d+10]=this.h[5]>>>0&255,o[d+11]=this.h[5]>>>8&255,o[d+12]=this.h[6]>>>0&255,o[d+13]=this.h[6]>>>8&255,o[d+14]=this.h[7]>>>0&255,o[d+15]=this.h[7]>>>8&255},ot.prototype.update=function(o,d,a){var f,_;if(this.leftover){for(_=16-this.leftover,_>a&&(_=a),f=0;f<_;f++)this.buffer[this.leftover+f]=o[d+f];if(a-=_,d+=_,this.leftover+=_,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(a>=16&&(_=a-a%16,this.blocks(o,d,_),d+=_,a-=_),a){for(f=0;f<a;f++)this.buffer[this.leftover+f]=o[d+f];this.leftover+=a}};function Xe(o,d,a,f,_,g){var x=new ot(g);return x.update(a,f,_),x.finish(o,d),0}function ft(o,d,a,f,_,g){var x=new Uint8Array(16);return Xe(x,0,a,f,_,g),P(o,d,x,0)}function Ae(o,d,a,f,_){var g;if(a<32)return-1;for(De(o,0,d,0,a,f,_),Xe(o,16,o,32,a-32,o),g=0;g<16;g++)o[g]=0;return 0}function Je(o,d,a,f,_){var g,x=new Uint8Array(32);if(a<32||(ue(x,0,32,f,_),ft(d,16,d,32,a-32,x)!==0))return-1;for(De(o,0,d,0,a,f,_),g=0;g<32;g++)o[g]=0;return 0}function He(o,d){var a;for(a=0;a<16;a++)o[a]=d[a]|0}function ht(o){var d,a,f=1;for(d=0;d<16;d++)a=o[d]+f+65535,f=Math.floor(a/65536),o[d]=a-f*65536;o[0]+=f-1+37*(f-1)}function it(o,d,a){for(var f,_=~(a-1),g=0;g<16;g++)f=_&(o[g]^d[g]),o[g]^=f,d[g]^=f}function Oe(o,d){var a,f,_,g=n(),x=n();for(a=0;a<16;a++)x[a]=d[a];for(ht(x),ht(x),ht(x),f=0;f<2;f++){for(g[0]=x[0]-65517,a=1;a<15;a++)g[a]=x[a]-65535-(g[a-1]>>16&1),g[a-1]&=65535;g[15]=x[15]-32767-(g[14]>>16&1),_=g[15]>>16&1,g[14]&=65535,it(x,g,1-_)}for(a=0;a<16;a++)o[2*a]=x[a]&255,o[2*a+1]=x[a]>>8}function qe(o,d){var a=new Uint8Array(32),f=new Uint8Array(32);return Oe(a,o),Oe(f,d),k(a,0,f,0)}function gt(o){var d=new Uint8Array(32);return Oe(d,o),d[0]&1}function Nt(o,d){var a;for(a=0;a<16;a++)o[a]=d[2*a]+(d[2*a+1]<<8);o[15]&=32767}function We(o,d,a){for(var f=0;f<16;f++)o[f]=d[f]+a[f]}function et(o,d,a){for(var f=0;f<16;f++)o[f]=d[f]-a[f]}function de(o,d,a){var f,_,g=0,x=0,N=0,U=0,Q=0,Y=0,Ce=0,J=0,ie=0,fe=0,he=0,ae=0,se=0,le=0,oe=0,W=0,ee=0,H=0,Z=0,V=0,K=0,A=0,E=0,$=0,R=0,D=0,I=0,ne=0,_e=0,ve=0,pe=0,v=a[0],xe=a[1],Re=a[2],Ne=a[3],me=a[4],Te=a[5],ke=a[6],ze=a[7],Pe=a[8],Me=a[9],Ue=a[10],Le=a[11],Fe=a[12],Ge=a[13],Ve=a[14],Qe=a[15];f=d[0],g+=f*v,x+=f*xe,N+=f*Re,U+=f*Ne,Q+=f*me,Y+=f*Te,Ce+=f*ke,J+=f*ze,ie+=f*Pe,fe+=f*Me,he+=f*Ue,ae+=f*Le,se+=f*Fe,le+=f*Ge,oe+=f*Ve,W+=f*Qe,f=d[1],x+=f*v,N+=f*xe,U+=f*Re,Q+=f*Ne,Y+=f*me,Ce+=f*Te,J+=f*ke,ie+=f*ze,fe+=f*Pe,he+=f*Me,ae+=f*Ue,se+=f*Le,le+=f*Fe,oe+=f*Ge,W+=f*Ve,ee+=f*Qe,f=d[2],N+=f*v,U+=f*xe,Q+=f*Re,Y+=f*Ne,Ce+=f*me,J+=f*Te,ie+=f*ke,fe+=f*ze,he+=f*Pe,ae+=f*Me,se+=f*Ue,le+=f*Le,oe+=f*Fe,W+=f*Ge,ee+=f*Ve,H+=f*Qe,f=d[3],U+=f*v,Q+=f*xe,Y+=f*Re,Ce+=f*Ne,J+=f*me,ie+=f*Te,fe+=f*ke,he+=f*ze,ae+=f*Pe,se+=f*Me,le+=f*Ue,oe+=f*Le,W+=f*Fe,ee+=f*Ge,H+=f*Ve,Z+=f*Qe,f=d[4],Q+=f*v,Y+=f*xe,Ce+=f*Re,J+=f*Ne,ie+=f*me,fe+=f*Te,he+=f*ke,ae+=f*ze,se+=f*Pe,le+=f*Me,oe+=f*Ue,W+=f*Le,ee+=f*Fe,H+=f*Ge,Z+=f*Ve,V+=f*Qe,f=d[5],Y+=f*v,Ce+=f*xe,J+=f*Re,ie+=f*Ne,fe+=f*me,he+=f*Te,ae+=f*ke,se+=f*ze,le+=f*Pe,oe+=f*Me,W+=f*Ue,ee+=f*Le,H+=f*Fe,Z+=f*Ge,V+=f*Ve,K+=f*Qe,f=d[6],Ce+=f*v,J+=f*xe,ie+=f*Re,fe+=f*Ne,he+=f*me,ae+=f*Te,se+=f*ke,le+=f*ze,oe+=f*Pe,W+=f*Me,ee+=f*Ue,H+=f*Le,Z+=f*Fe,V+=f*Ge,K+=f*Ve,A+=f*Qe,f=d[7],J+=f*v,ie+=f*xe,fe+=f*Re,he+=f*Ne,ae+=f*me,se+=f*Te,le+=f*ke,oe+=f*ze,W+=f*Pe,ee+=f*Me,H+=f*Ue,Z+=f*Le,V+=f*Fe,K+=f*Ge,A+=f*Ve,E+=f*Qe,f=d[8],ie+=f*v,fe+=f*xe,he+=f*Re,ae+=f*Ne,se+=f*me,le+=f*Te,oe+=f*ke,W+=f*ze,ee+=f*Pe,H+=f*Me,Z+=f*Ue,V+=f*Le,K+=f*Fe,A+=f*Ge,E+=f*Ve,$+=f*Qe,f=d[9],fe+=f*v,he+=f*xe,ae+=f*Re,se+=f*Ne,le+=f*me,oe+=f*Te,W+=f*ke,ee+=f*ze,H+=f*Pe,Z+=f*Me,V+=f*Ue,K+=f*Le,A+=f*Fe,E+=f*Ge,$+=f*Ve,R+=f*Qe,f=d[10],he+=f*v,ae+=f*xe,se+=f*Re,le+=f*Ne,oe+=f*me,W+=f*Te,ee+=f*ke,H+=f*ze,Z+=f*Pe,V+=f*Me,K+=f*Ue,A+=f*Le,E+=f*Fe,$+=f*Ge,R+=f*Ve,D+=f*Qe,f=d[11],ae+=f*v,se+=f*xe,le+=f*Re,oe+=f*Ne,W+=f*me,ee+=f*Te,H+=f*ke,Z+=f*ze,V+=f*Pe,K+=f*Me,A+=f*Ue,E+=f*Le,$+=f*Fe,R+=f*Ge,D+=f*Ve,I+=f*Qe,f=d[12],se+=f*v,le+=f*xe,oe+=f*Re,W+=f*Ne,ee+=f*me,H+=f*Te,Z+=f*ke,V+=f*ze,K+=f*Pe,A+=f*Me,E+=f*Ue,$+=f*Le,R+=f*Fe,D+=f*Ge,I+=f*Ve,ne+=f*Qe,f=d[13],le+=f*v,oe+=f*xe,W+=f*Re,ee+=f*Ne,H+=f*me,Z+=f*Te,V+=f*ke,K+=f*ze,A+=f*Pe,E+=f*Me,$+=f*Ue,R+=f*Le,D+=f*Fe,I+=f*Ge,ne+=f*Ve,_e+=f*Qe,f=d[14],oe+=f*v,W+=f*xe,ee+=f*Re,H+=f*Ne,Z+=f*me,V+=f*Te,K+=f*ke,A+=f*ze,E+=f*Pe,$+=f*Me,R+=f*Ue,D+=f*Le,I+=f*Fe,ne+=f*Ge,_e+=f*Ve,ve+=f*Qe,f=d[15],W+=f*v,ee+=f*xe,H+=f*Re,Z+=f*Ne,V+=f*me,K+=f*Te,A+=f*ke,E+=f*ze,$+=f*Pe,R+=f*Me,D+=f*Ue,I+=f*Le,ne+=f*Fe,_e+=f*Ge,ve+=f*Ve,pe+=f*Qe,g+=38*ee,x+=38*H,N+=38*Z,U+=38*V,Q+=38*K,Y+=38*A,Ce+=38*E,J+=38*$,ie+=38*R,fe+=38*D,he+=38*I,ae+=38*ne,se+=38*_e,le+=38*ve,oe+=38*pe,_=1,f=g+_+65535,_=Math.floor(f/65536),g=f-_*65536,f=x+_+65535,_=Math.floor(f/65536),x=f-_*65536,f=N+_+65535,_=Math.floor(f/65536),N=f-_*65536,f=U+_+65535,_=Math.floor(f/65536),U=f-_*65536,f=Q+_+65535,_=Math.floor(f/65536),Q=f-_*65536,f=Y+_+65535,_=Math.floor(f/65536),Y=f-_*65536,f=Ce+_+65535,_=Math.floor(f/65536),Ce=f-_*65536,f=J+_+65535,_=Math.floor(f/65536),J=f-_*65536,f=ie+_+65535,_=Math.floor(f/65536),ie=f-_*65536,f=fe+_+65535,_=Math.floor(f/65536),fe=f-_*65536,f=he+_+65535,_=Math.floor(f/65536),he=f-_*65536,f=ae+_+65535,_=Math.floor(f/65536),ae=f-_*65536,f=se+_+65535,_=Math.floor(f/65536),se=f-_*65536,f=le+_+65535,_=Math.floor(f/65536),le=f-_*65536,f=oe+_+65535,_=Math.floor(f/65536),oe=f-_*65536,f=W+_+65535,_=Math.floor(f/65536),W=f-_*65536,g+=_-1+37*(_-1),_=1,f=g+_+65535,_=Math.floor(f/65536),g=f-_*65536,f=x+_+65535,_=Math.floor(f/65536),x=f-_*65536,f=N+_+65535,_=Math.floor(f/65536),N=f-_*65536,f=U+_+65535,_=Math.floor(f/65536),U=f-_*65536,f=Q+_+65535,_=Math.floor(f/65536),Q=f-_*65536,f=Y+_+65535,_=Math.floor(f/65536),Y=f-_*65536,f=Ce+_+65535,_=Math.floor(f/65536),Ce=f-_*65536,f=J+_+65535,_=Math.floor(f/65536),J=f-_*65536,f=ie+_+65535,_=Math.floor(f/65536),ie=f-_*65536,f=fe+_+65535,_=Math.floor(f/65536),fe=f-_*65536,f=he+_+65535,_=Math.floor(f/65536),he=f-_*65536,f=ae+_+65535,_=Math.floor(f/65536),ae=f-_*65536,f=se+_+65535,_=Math.floor(f/65536),se=f-_*65536,f=le+_+65535,_=Math.floor(f/65536),le=f-_*65536,f=oe+_+65535,_=Math.floor(f/65536),oe=f-_*65536,f=W+_+65535,_=Math.floor(f/65536),W=f-_*65536,g+=_-1+37*(_-1),o[0]=g,o[1]=x,o[2]=N,o[3]=U,o[4]=Q,o[5]=Y,o[6]=Ce,o[7]=J,o[8]=ie,o[9]=fe,o[10]=he,o[11]=ae,o[12]=se,o[13]=le,o[14]=oe,o[15]=W}function Ze(o,d){de(o,d,d)}function Dt(o,d){var a=n(),f;for(f=0;f<16;f++)a[f]=d[f];for(f=253;f>=0;f--)Ze(a,a),f!==2&&f!==4&&de(a,a,d);for(f=0;f<16;f++)o[f]=a[f]}function Xt(o,d){var a=n(),f;for(f=0;f<16;f++)a[f]=d[f];for(f=250;f>=0;f--)Ze(a,a),f!==1&&de(a,a,d);for(f=0;f<16;f++)o[f]=a[f]}function St(o,d,a){var f=new Uint8Array(32),_=new Float64Array(80),g,x,N=n(),U=n(),Q=n(),Y=n(),Ce=n(),J=n();for(x=0;x<31;x++)f[x]=d[x];for(f[31]=d[31]&127|64,f[0]&=248,Nt(_,a),x=0;x<16;x++)U[x]=_[x],Y[x]=N[x]=Q[x]=0;for(N[0]=Y[0]=1,x=254;x>=0;--x)g=f[x>>>3]>>>(x&7)&1,it(N,U,g),it(Q,Y,g),We(Ce,N,Q),et(N,N,Q),We(Q,U,Y),et(U,U,Y),Ze(Y,Ce),Ze(J,N),de(N,Q,N),de(Q,U,Ce),We(Ce,N,Q),et(N,N,Q),Ze(U,N),et(Q,Y,J),de(N,Q,u),We(N,N,Y),de(Q,Q,N),de(N,Y,J),de(Y,U,_),Ze(U,Ce),it(N,U,g),it(Q,Y,g);for(x=0;x<16;x++)_[x+16]=N[x],_[x+32]=Q[x],_[x+48]=U[x],_[x+64]=Y[x];var ie=_.subarray(32),fe=_.subarray(16);return Dt(ie,ie),de(fe,fe,ie),Oe(o,fe),0}function $t(o,d){return St(o,d,s)}function Ot(o,d){return r(d,32),$t(o,d)}function Mt(o,d,a){var f=new Uint8Array(32);return St(f,a,d),q(o,i,f,z)}var Ft=Ae,fn=Je;function _n(o,d,a,f,_,g){var x=new Uint8Array(32);return Mt(x,_,g),Ft(o,d,a,f,x)}function pn(o,d,a,f,_,g){var x=new Uint8Array(32);return Mt(x,_,g),fn(o,d,a,f,x)}var Ht=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function At(o,d,a,f){for(var _=new Int32Array(16),g=new Int32Array(16),x,N,U,Q,Y,Ce,J,ie,fe,he,ae,se,le,oe,W,ee,H,Z,V,K,A,E,$,R,D,I,ne=o[0],_e=o[1],ve=o[2],pe=o[3],v=o[4],xe=o[5],Re=o[6],Ne=o[7],me=d[0],Te=d[1],ke=d[2],ze=d[3],Pe=d[4],Me=d[5],Ue=d[6],Le=d[7],Fe=0;f>=128;){for(V=0;V<16;V++)K=8*V+Fe,_[V]=a[K+0]<<24|a[K+1]<<16|a[K+2]<<8|a[K+3],g[V]=a[K+4]<<24|a[K+5]<<16|a[K+6]<<8|a[K+7];for(V=0;V<80;V++)if(x=ne,N=_e,U=ve,Q=pe,Y=v,Ce=xe,J=Re,ie=Ne,fe=me,he=Te,ae=ke,se=ze,le=Pe,oe=Me,W=Ue,ee=Le,A=Ne,E=Le,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=(v>>>14|Pe<<32-14)^(v>>>18|Pe<<32-18)^(Pe>>>41-32|v<<32-(41-32)),E=(Pe>>>14|v<<32-14)^(Pe>>>18|v<<32-18)^(v>>>41-32|Pe<<32-(41-32)),$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,A=v&xe^~v&Re,E=Pe&Me^~Pe&Ue,$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,A=Ht[V*2],E=Ht[V*2+1],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,A=_[V%16],E=g[V%16],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,H=D&65535|I<<16,Z=$&65535|R<<16,A=H,E=Z,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=(ne>>>28|me<<32-28)^(me>>>34-32|ne<<32-(34-32))^(me>>>39-32|ne<<32-(39-32)),E=(me>>>28|ne<<32-28)^(ne>>>34-32|me<<32-(34-32))^(ne>>>39-32|me<<32-(39-32)),$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,A=ne&_e^ne&ve^_e&ve,E=me&Te^me&ke^Te&ke,$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,ie=D&65535|I<<16,ee=$&65535|R<<16,A=Q,E=se,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=H,E=Z,$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,Q=D&65535|I<<16,se=$&65535|R<<16,_e=x,ve=N,pe=U,v=Q,xe=Y,Re=Ce,Ne=J,ne=ie,Te=fe,ke=he,ze=ae,Pe=se,Me=le,Ue=oe,Le=W,me=ee,V%16===15)for(K=0;K<16;K++)A=_[K],E=g[K],$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=_[(K+9)%16],E=g[(K+9)%16],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,H=_[(K+1)%16],Z=g[(K+1)%16],A=(H>>>1|Z<<32-1)^(H>>>8|Z<<32-8)^H>>>7,E=(Z>>>1|H<<32-1)^(Z>>>8|H<<32-8)^(Z>>>7|H<<32-7),$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,H=_[(K+14)%16],Z=g[(K+14)%16],A=(H>>>19|Z<<32-19)^(Z>>>61-32|H<<32-(61-32))^H>>>6,E=(Z>>>19|H<<32-19)^(H>>>61-32|Z<<32-(61-32))^(Z>>>6|H<<32-6),$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,_[K]=D&65535|I<<16,g[K]=$&65535|R<<16;A=ne,E=me,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[0],E=d[0],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[0]=ne=D&65535|I<<16,d[0]=me=$&65535|R<<16,A=_e,E=Te,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[1],E=d[1],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[1]=_e=D&65535|I<<16,d[1]=Te=$&65535|R<<16,A=ve,E=ke,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[2],E=d[2],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[2]=ve=D&65535|I<<16,d[2]=ke=$&65535|R<<16,A=pe,E=ze,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[3],E=d[3],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[3]=pe=D&65535|I<<16,d[3]=ze=$&65535|R<<16,A=v,E=Pe,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[4],E=d[4],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[4]=v=D&65535|I<<16,d[4]=Pe=$&65535|R<<16,A=xe,E=Me,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[5],E=d[5],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[5]=xe=D&65535|I<<16,d[5]=Me=$&65535|R<<16,A=Re,E=Ue,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[6],E=d[6],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[6]=Re=D&65535|I<<16,d[6]=Ue=$&65535|R<<16,A=Ne,E=Le,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[7],E=d[7],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[7]=Ne=D&65535|I<<16,d[7]=Le=$&65535|R<<16,Fe+=128,f-=128}return f}function vt(o,d,a){var f=new Int32Array(8),_=new Int32Array(8),g=new Uint8Array(256),x,N=a;for(f[0]=1779033703,f[1]=3144134277,f[2]=1013904242,f[3]=2773480762,f[4]=1359893119,f[5]=2600822924,f[6]=528734635,f[7]=1541459225,_[0]=4089235720,_[1]=2227873595,_[2]=4271175723,_[3]=1595750129,_[4]=2917565137,_[5]=725511199,_[6]=4215389547,_[7]=327033209,At(f,_,d,a),a%=128,x=0;x<a;x++)g[x]=d[N-a+x];for(g[a]=128,a=256-128*(a<112?1:0),g[a-9]=0,w(g,a-8,N/536870912|0,N<<3),At(f,_,g,a),x=0;x<8;x++)w(o,8*x,f[x],_[x]);return 0}function Tt(o,d){var a=n(),f=n(),_=n(),g=n(),x=n(),N=n(),U=n(),Q=n(),Y=n();et(a,o[1],o[0]),et(Y,d[1],d[0]),de(a,a,Y),We(f,o[0],o[1]),We(Y,d[0],d[1]),de(f,f,Y),de(_,o[3],d[3]),de(_,_,p),de(g,o[2],d[2]),We(g,g,g),et(x,f,a),et(N,g,_),We(U,g,_),We(Q,f,a),de(o[0],x,N),de(o[1],Q,U),de(o[2],U,N),de(o[3],x,Q)}function Et(o,d,a){var f;for(f=0;f<4;f++)it(o[f],d[f],a)}function lt(o,d){var a=n(),f=n(),_=n();Dt(_,d[2]),de(a,d[0],_),de(f,d[1],_),Oe(o,f),o[31]^=gt(a)<<7}function ct(o,d,a){var f,_;for(He(o[0],l),He(o[1],c),He(o[2],c),He(o[3],l),_=255;_>=0;--_)f=a[_/8|0]>>(_&7)&1,Et(o,d,f),Tt(d,o),Tt(o,o),Et(o,d,f)}function rt(o,d){var a=[n(),n(),n(),n()];He(a[0],b),He(a[1],m),He(a[2],c),de(a[3],b,m),ct(o,a,d)}function Jt(o,d,a){var f=new Uint8Array(64),_=[n(),n(),n(),n()],g;for(a||r(d,32),vt(f,d,32),f[0]&=248,f[31]&=127,f[31]|=64,rt(_,f),lt(o,_),g=0;g<32;g++)d[g+32]=o[g];return 0}var Ut=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function te(o,d){var a,f,_,g;for(f=63;f>=32;--f){for(a=0,_=f-32,g=f-12;_<g;++_)d[_]+=a-16*d[f]*Ut[_-(f-32)],a=Math.floor((d[_]+128)/256),d[_]-=a*256;d[_]+=a,d[f]=0}for(a=0,_=0;_<32;_++)d[_]+=a-(d[31]>>4)*Ut[_],a=d[_]>>8,d[_]&=255;for(_=0;_<32;_++)d[_]-=a*Ut[_];for(f=0;f<32;f++)d[f+1]+=d[f]>>8,o[f]=d[f]&255}function $e(o){var d=new Float64Array(64),a;for(a=0;a<64;a++)d[a]=o[a];for(a=0;a<64;a++)o[a]=0;te(o,d)}function nn(o,d,a,f){var _=new Uint8Array(64),g=new Uint8Array(64),x=new Uint8Array(64),N,U,Q=new Float64Array(64),Y=[n(),n(),n(),n()];vt(_,f,32),_[0]&=248,_[31]&=127,_[31]|=64;var Ce=a+64;for(N=0;N<a;N++)o[64+N]=d[N];for(N=0;N<32;N++)o[32+N]=_[32+N];for(vt(x,o.subarray(32),a+32),$e(x),rt(Y,x),lt(o,Y),N=32;N<64;N++)o[N]=f[N];for(vt(g,o,a+64),$e(g),N=0;N<64;N++)Q[N]=0;for(N=0;N<32;N++)Q[N]=x[N];for(N=0;N<32;N++)for(U=0;U<32;U++)Q[N+U]+=g[N]*_[U];return te(o.subarray(32),Q),Ce}function bn(o,d){var a=n(),f=n(),_=n(),g=n(),x=n(),N=n(),U=n();return He(o[2],c),Nt(o[1],d),Ze(_,o[1]),de(g,_,h),et(_,_,o[2]),We(g,o[2],g),Ze(x,g),Ze(N,x),de(U,N,x),de(a,U,_),de(a,a,g),Xt(a,a),de(a,a,_),de(a,a,g),de(a,a,g),de(o[0],a,g),Ze(f,o[0]),de(f,f,g),qe(f,_)&&de(o[0],o[0],y),Ze(f,o[0]),de(f,f,g),qe(f,_)?-1:(gt(o[0])===d[31]>>7&&et(o[0],l,o[0]),de(o[3],o[0],o[1]),0)}function sn(o,d,a,f){var _,g=new Uint8Array(32),x=new Uint8Array(64),N=[n(),n(),n(),n()],U=[n(),n(),n(),n()];if(a<64||bn(U,f))return-1;for(_=0;_<a;_++)o[_]=d[_];for(_=0;_<32;_++)o[_+32]=f[_];if(vt(x,o,a),$e(x),ct(N,U,x),rt(U,d.subarray(32)),Tt(N,U),lt(g,N),a-=64,k(d,0,g,0)){for(_=0;_<a;_++)o[_]=0;return-1}for(_=0;_<a;_++)o[_]=d[_+64];return a}var on=32,en=24,Bt=32,Pt=16,zt=32,Ee=32,Ye=32,Lt=32,rn=32,vn=en,wr=Bt,Ar=Pt,xt=64,It=32,Kt=64,An=32,En=64;e.lowlevel={crypto_core_hsalsa20:q,crypto_stream_xor:De,crypto_stream:ue,crypto_stream_salsa20_xor:be,crypto_stream_salsa20:ye,crypto_onetimeauth:Xe,crypto_onetimeauth_verify:ft,crypto_verify_16:P,crypto_verify_32:k,crypto_secretbox:Ae,crypto_secretbox_open:Je,crypto_scalarmult:St,crypto_scalarmult_base:$t,crypto_box_beforenm:Mt,crypto_box_afternm:Ft,crypto_box:_n,crypto_box_open:pn,crypto_box_keypair:Ot,crypto_hash:vt,crypto_sign:nn,crypto_sign_keypair:Jt,crypto_sign_open:sn,crypto_secretbox_KEYBYTES:on,crypto_secretbox_NONCEBYTES:en,crypto_secretbox_ZEROBYTES:Bt,crypto_secretbox_BOXZEROBYTES:Pt,crypto_scalarmult_BYTES:zt,crypto_scalarmult_SCALARBYTES:Ee,crypto_box_PUBLICKEYBYTES:Ye,crypto_box_SECRETKEYBYTES:Lt,crypto_box_BEFORENMBYTES:rn,crypto_box_NONCEBYTES:vn,crypto_box_ZEROBYTES:wr,crypto_box_BOXZEROBYTES:Ar,crypto_sign_BYTES:xt,crypto_sign_PUBLICKEYBYTES:It,crypto_sign_SECRETKEYBYTES:Kt,crypto_sign_SEEDBYTES:An,crypto_hash_BYTES:En,gf:n,D:h,L:Ut,pack25519:Oe,unpack25519:Nt,M:de,A:We,S:Ze,Z:et,pow2523:Xt,add:Tt,set25519:He,modL:te,scalarmult:ct,scalarbase:rt};function Jn(o,d){if(o.length!==on)throw new Error("bad key size");if(d.length!==en)throw new Error("bad nonce size")}function Er(o,d){if(o.length!==Ye)throw new Error("bad public key size");if(d.length!==Lt)throw new Error("bad secret key size")}function st(){for(var o=0;o<arguments.length;o++)if(!(arguments[o]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Wn(o){for(var d=0;d<o.length;d++)o[d]=0}e.randomBytes=function(o){var d=new Uint8Array(o);return r(d,o),d},e.secretbox=function(o,d,a){st(o,d,a),Jn(a,d);for(var f=new Uint8Array(Bt+o.length),_=new Uint8Array(f.length),g=0;g<o.length;g++)f[g+Bt]=o[g];return Ae(_,f,f.length,d,a),_.subarray(Pt)},e.secretbox.open=function(o,d,a){st(o,d,a),Jn(a,d);for(var f=new Uint8Array(Pt+o.length),_=new Uint8Array(f.length),g=0;g<o.length;g++)f[g+Pt]=o[g];return f.length<32||Je(_,f,f.length,d,a)!==0?null:_.subarray(Bt)},e.secretbox.keyLength=on,e.secretbox.nonceLength=en,e.secretbox.overheadLength=Pt,e.scalarMult=function(o,d){if(st(o,d),o.length!==Ee)throw new Error("bad n size");if(d.length!==zt)throw new Error("bad p size");var a=new Uint8Array(zt);return St(a,o,d),a},e.scalarMult.base=function(o){if(st(o),o.length!==Ee)throw new Error("bad n size");var d=new Uint8Array(zt);return $t(d,o),d},e.scalarMult.scalarLength=Ee,e.scalarMult.groupElementLength=zt,e.box=function(o,d,a,f){var _=e.box.before(a,f);return e.secretbox(o,d,_)},e.box.before=function(o,d){st(o,d),Er(o,d);var a=new Uint8Array(rn);return Mt(a,o,d),a},e.box.after=e.secretbox,e.box.open=function(o,d,a,f){var _=e.box.before(a,f);return e.secretbox.open(o,d,_)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var o=new Uint8Array(Ye),d=new Uint8Array(Lt);return Ot(o,d),{publicKey:o,secretKey:d}},e.box.keyPair.fromSecretKey=function(o){if(st(o),o.length!==Lt)throw new Error("bad secret key size");var d=new Uint8Array(Ye);return $t(d,o),{publicKey:d,secretKey:new Uint8Array(o)}},e.box.publicKeyLength=Ye,e.box.secretKeyLength=Lt,e.box.sharedKeyLength=rn,e.box.nonceLength=vn,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(o,d){if(st(o,d),d.length!==Kt)throw new Error("bad secret key size");var a=new Uint8Array(xt+o.length);return nn(a,o,o.length,d),a},e.sign.open=function(o,d){if(st(o,d),d.length!==It)throw new Error("bad public key size");var a=new Uint8Array(o.length),f=sn(a,o,o.length,d);if(f<0)return null;for(var _=new Uint8Array(f),g=0;g<_.length;g++)_[g]=a[g];return _},e.sign.detached=function(o,d){for(var a=e.sign(o,d),f=new Uint8Array(xt),_=0;_<f.length;_++)f[_]=a[_];return f},e.sign.detached.verify=function(o,d,a){if(st(o,d,a),d.length!==xt)throw new Error("bad signature size");if(a.length!==It)throw new Error("bad public key size");var f=new Uint8Array(xt+o.length),_=new Uint8Array(xt+o.length),g;for(g=0;g<xt;g++)f[g]=d[g];for(g=0;g<o.length;g++)f[g+xt]=o[g];return sn(_,f,f.length,a)>=0},e.sign.keyPair=function(){var o=new Uint8Array(It),d=new Uint8Array(Kt);return Jt(o,d),{publicKey:o,secretKey:d}},e.sign.keyPair.fromSecretKey=function(o){if(st(o),o.length!==Kt)throw new Error("bad secret key size");for(var d=new Uint8Array(It),a=0;a<d.length;a++)d[a]=o[32+a];return{publicKey:d,secretKey:new Uint8Array(o)}},e.sign.keyPair.fromSeed=function(o){if(st(o),o.length!==An)throw new Error("bad seed size");for(var d=new Uint8Array(It),a=new Uint8Array(Kt),f=0;f<32;f++)a[f]=o[f];return Jt(d,a,!0),{publicKey:d,secretKey:a}},e.sign.publicKeyLength=It,e.sign.secretKeyLength=Kt,e.sign.seedLength=An,e.sign.signatureLength=xt,e.hash=function(o){st(o);var d=new Uint8Array(En);return vt(d,o,o.length),d},e.hash.hashLength=En,e.verify=function(o,d){return st(o,d),o.length===0||d.length===0||o.length!==d.length?!1:S(o,0,d,0,o.length)===0},e.setPRNG=function(o){r=o},function(){var o=typeof self<"u"?self.crypto||self.msCrypto:null;if(o&&o.getRandomValues){var d=65536;e.setPRNG(function(a,f){var _,g=new Uint8Array(f);for(_=0;_<f;_+=d)o.getRandomValues(g.subarray(_,_+Math.min(f-_,d)));for(_=0;_<f;_++)a[_]=g[_];Wn(g)})}else typeof ys<"u"&&(o=ql,o&&o.randomBytes&&e.setPRNG(function(a,f){var _,g=o.randomBytes(f);for(_=0;_<f;_++)a[_]=g[_];Wn(g)}))}()})(t.exports?t.exports:self.nacl=self.nacl||{})}),Fn=ms(function(t){(function(e,n){t.exports?t.exports=n():(e.nacl||(e.nacl={}),e.nacl.util=n())})(jl,function(){var e={};function n(r){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(r))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(r){if(typeof r!="string")throw new TypeError("expected string");var i,s=unescape(encodeURIComponent(r)),l=new Uint8Array(s.length);for(i=0;i<s.length;i++)l[i]=s.charCodeAt(i);return l},e.encodeUTF8=function(r){var i,s=[];for(i=0;i<r.length;i++)s.push(String.fromCharCode(r[i]));return decodeURIComponent(escape(s.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(r){return Buffer.from(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(Buffer.from(r,"base64"),0))}):(e.encodeBase64=function(r){return new Buffer(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(new Buffer(r,"base64"),0))}):(e.encodeBase64=function(r){var i,s=[],l=r.length;for(i=0;i<l;i++)s.push(String.fromCharCode(r[i]));return btoa(s.join(""))},e.decodeBase64=function(r){n(r);var i,s=atob(r),l=new Uint8Array(s.length);for(i=0;i<s.length;i++)l[i]=s.charCodeAt(i);return l}),e})});function Yl(t){return t!=null&&t.constructor==Object}function Fl(t,e){const n=new Uint8Array(t.length+1),r=new Uint8Array(1);return r[0]=e,n.set(r),n.set(t,r.length),n}function Hl(){}let Tr=class{constructor(e,n,r){this.prev=e,this.next=n,this.fn=r||Hl}run(e){this.fn(e),this.next&&this.next.run(e)}},Jl=class{constructor(e){this.head=new Tr,this.tail=new Tr(this.head),this.head.next=this.tail,this.linkConstructor=e,this.reg={}}insert(e){const n=new Tr(this.tail.prev,this.tail,e);return n.next.prev=n,n.prev.next=n,n}remove(e){e.prev.next=e.next,e.next.prev=e.prev}},Wl=0,ri=class{constructor(){this.__events_list={}}on(e,n){const r=this.__events_list[e]||(this.__events_list[e]=new Jl),i=n._eev||(n._eev=++Wl);r.reg[i]||(r.reg[i]=r.insert(n))}off(e,n){if(n){const r=this.__events_list[e];if(!r)return;const i=r.reg[n._eev];r.reg[n._eev]=void 0,r&&i&&r.remove(i)}}removeListener(...e){this.off(...e)}emit(e,n){const r=this.__events_list[e];r&&r.head.run(n)}};function Zl(t){return typeof t>"u"||t==null?[]:Array.isArray(t)?t:[t]}function ar(t){return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}function zr(t){const e=t.match(/.{1,2}(?=(.{2})+(?!.))|.{1,2}$/g);return new Uint8Array(e.map(n=>parseInt(n,16)))}function gs(t,e=8){const n=new Array(e).fill(0);for(let r=0;r<n.length;r++){const i=t&255;n[r]=i,t=(t-i)/256}return n}var Gl=Tn;/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 * @license MIT (© Joyent)
 */function Tn(t,e){var n={seen:[],stylize:Vl};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),xs(e)?n.showHidden=e:e&&ic(n,e),Un(n.showHidden)&&(n.showHidden=!1),Un(n.depth)&&(n.depth=2),Un(n.colors)&&(n.colors=!1),Un(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Ql),ur(n,t,n.depth)}Tn.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Tn.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Vl(t,e){return t}function xs(t){return typeof t=="boolean"}function Un(t){return t===void 0}function Ql(t,e){var n=Tn.styles[e];return n?"\x1B["+Tn.colors[n][0]+"m"+t+"\x1B["+Tn.colors[n][1]+"m":t}function kr(t){return typeof t=="function"}function ws(t){return typeof t=="string"}function Xl(t){return typeof t=="number"}function As(t){return t===null}function Es(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Cr(t){return yr(t)&&ii(t)==="[object RegExp]"}function yr(t){return typeof t=="object"&&t!==null}function Rr(t){return yr(t)&&(ii(t)==="[object Error]"||t instanceof Error)}function of(t){return yr(t)&&ii(t)==="[object Date]"}function ii(t){return Object.prototype.toString.call(t)}function ec(t){var e={};return t.forEach(function(n,r){e[n]=!0}),e}function tc(t,e,n,r,i){for(var s=[],l=0,c=e.length;l<c;++l)Es(e,String(l))?s.push(Kr(t,e,n,r,String(l),!0)):s.push("");return i.forEach(function(u){u.match(/^\d+$/)||s.push(Kr(t,e,n,r,u,!0))}),s}function Nr(t){return"["+Error.prototype.toString.call(t)+"]"}function ur(t,e,n){if(t.customInspect&&e&&kr(e.inspect)&&e.inspect!==Tn&&!(e.constructor&&e.constructor.prototype===e)){var r=e.inspect(n,t);return ws(r)||(r=ur(t,r,n)),r}var i=nc(t,e);if(i)return i;var s=Object.keys(e),l=ec(s);try{t.showHidden&&Object.getOwnPropertyNames&&(s=Object.getOwnPropertyNames(e))}catch{}if(Rr(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return Nr(e);if(s.length===0){if(kr(e)){var c=e.name?": "+e.name:"";return t.stylize("[Function"+c+"]","special")}if(Cr(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(of(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Rr(e))return Nr(e)}var u="",h=!1,p=["{","}"];if(Array.isArray(e)&&(h=!0,p=["[","]"]),kr(e)){var b=e.name?": "+e.name:"";u=" [Function"+b+"]"}if(Cr(e)&&(u=" "+RegExp.prototype.toString.call(e)),of(e)&&(u=" "+Date.prototype.toUTCString.call(e)),Rr(e)&&(u=" "+Nr(e)),s.length===0&&(!h||e.length==0))return p[0]+u+p[1];if(n<0)return Cr(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var m;return h?m=tc(t,e,n,l,s):m=s.map(function(y){return Kr(t,e,n,l,y,h)}),t.seen.pop(),rc(m,u,p)}function Kr(t,e,n,r,i,s){var l,c,u;u={value:void 0};try{u.value=e[i]}catch{}try{Object.getOwnPropertyDescriptor&&(u=Object.getOwnPropertyDescriptor(e,i)||u)}catch{}if(u.get?u.set?c=t.stylize("[Getter/Setter]","special"):c=t.stylize("[Getter]","special"):u.set&&(c=t.stylize("[Setter]","special")),Es(r,i)||(l="["+i+"]"),c||(t.seen.indexOf(u.value)<0?(As(n)?c=ur(t,u.value,null):c=ur(t,u.value,n-1),c.indexOf(`
`)>-1&&(s?c=c.split(`
`).map(function(h){return"  "+h}).join(`
`).substr(2):c=`
`+c.split(`
`).map(function(h){return"   "+h}).join(`
`))):c=t.stylize("[Circular]","special")),Un(l)){if(s&&i.match(/^\d+$/))return c;l=JSON.stringify(""+i),l.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(l=l.substr(1,l.length-2),l=t.stylize(l,"name")):(l=l.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),l=t.stylize(l,"string"))}return l+": "+c}function nc(t,e){if(Un(e))return t.stylize("undefined","undefined");if(ws(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(Xl(e))return t.stylize(""+e,"number");if(xs(e))return t.stylize(""+e,"boolean");if(As(e))return t.stylize("null","null")}function rc(t,e,n){var r=t.reduce(function(i,s){return s.indexOf(`
`)>=0,i+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function ic(t,e){if(!e||!yr(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}function ln(t,e,...n){try{e==console.log?e(`${new Date().toLocaleString()} → ${Gl(...n).replace(/^'/,"").replace(/'$/,"")}`):typeof e=="function"?e(...n):e&&e.logOutput(t,{source:"connectome"},...n)}catch(r){console.log(r)}}let fc=class{write(e,...n){ln(void 0,e,...n)}red(e,...n){ln("red",e,...n)}green(e,...n){ln("green",e,...n)}yellow(e,...n){ln("yellow",e,...n)}blue(e,...n){ln("blue",e,...n)}cyan(e,...n){ln("cyan",e,...n)}magenta(e,...n){ln("magenta",e,...n)}gray(e,...n){ln("gray",e,...n)}white(e,...n){ln("white",e,...n)}};var tt=new fc;Zt.util=Fn;function sc({data:t,connector:e}){const{log:n}=e;Yl(t)&&(t=JSON.stringify(t));const r=new Uint8Array(gs(2*e.sentCount,24));if(e.closed())tt.red(n,`⚠️ Warning: "${t}" was not sent because connector is not ready`);else if(e.sentCount>1){let i=0;typeof t=="string"&&(i=1);const s=i==1?Zt.util.decodeUTF8(t):t,l=Fl(s,i),c=Zt.secretbox(l,r,e.sharedSecret);e.verbose&&(tt.green(n,`Connector ${e.endpoint} → Sending encrypted message #${e.sentCount} ↴`),tt.gray(n,t)),e.connection.websocket.send(c)}else e.verbose&&(tt.green(n,`Connector ${e.endpoint} → Sending message #${e.sentCount} ↴`),tt.gray(n,t)),e.connection.websocket.send(t)}Zt.util=Fn;function oc(t){return Object.keys(t).includes("result")||Object.keys(t).includes("error")}function Ss({jsonData:t,encryptedData:e,rawMessage:n,wasEncrypted:r,connector:i}){const{log:s}=i;i.lastMessageAt=Date.now();const l=new Uint8Array(gs(2*i.receivedCount+1,24));if(i.verbose&&!r&&tt.magenta(s,`Connector ${i.endpoint} → Received message #${i.receivedCount} ↴`),t)t.jsonrpc?oc(t)?(i.verbose&&!r&&(tt.magenta(s,`Connector ${i.endpoint} received plain-text rpc result ↴`),tt.gray(s,t)),i.rpcClient.jsonrpcMsgReceive(n)):i.emit("json_rpc",n):i.emit("receive",{jsonData:t,rawMessage:n});else if(e){i.verbose=="extra"&&(tt.magenta(s,`Connector ${i.endpoint} received bytes ↴`),tt.gray(s,e),tt.magenta(s,`Connector ${i.endpoint} decrypting with shared secret ${i.sharedSecret}...`));const c=Zt.secretbox.open(e,l,i.sharedSecret),u=c[0],h=c.subarray(1);if(u==1){const p=Zt.util.encodeUTF8(h);i.verbose&&tt.write(s,`Received message: ${p}`);try{const b=JSON.parse(p);b.jsonrpc?Ss({jsonData:b,rawMessage:p,wasEncrypted:!0,connector:i}):b.state?i.emit("receive_state",b.state):b.diff?i.emit("receive_diff",b.diff):b.signal?i.emit(b.signal,b.data):b.stateField?i.emit("receive_state_field",b.stateField):i.emit("receive",{jsonData:b,rawMessage:p})}catch(b){throw tt.red(s,"Couldn't parse json message although the flag was for string ..."),tt.red(s,p),b}}else i.emit("receive_binary",h)}}Zt.util=Fn;function lc({connector:t,afterFirstStep:e=()=>{}}){const{clientPrivateKey:n,clientPublicKey:r,clientPublicKeyHex:i,protocol:s,tag:l,endpoint:c,verbose:u}=t;return new Promise((h,p)=>{t.remoteObject("Auth").call("exchangePubkeys",{pubkey:i}).then(b=>{const m=Zt.box.before(zr(b),n);e({sharedSecret:m,remotePubkeyHex:b}),u&&tt.write(t.log,`Connector ${c} established shared secret through diffie-hellman exchange.`),t.remoteObject("Auth").call("finalizeHandshake",{protocol:s}).then(y=>{if(y&&y.error)console.log(y.error);else{h();const w=l?` (${l})`:"";tt.cyan(t.log,`${c}${w} ✓ Connection [ ${s||'"no-name"'} ] ready`)}}).catch(p)}).catch(p)})}let cc=class extends ri{constructor(e){super(),this.state=e,this.subscriptions=[]}get(){return this.state}subscribe(e){return this.subscriptions.push(e),e(this.state),()=>{this.subscriptions=this.subscriptions.filter(n=>n!==e)}}announceStateChange(){this.subscriptions.forEach(e=>e(this.state))}},dr=class extends cc{set(e){this.state=e,this.announceStateChange()}},ac=class extends ri{constructor(e){super(),this.connector=e}send(...e){this.connector.send(...e)}};var Gt={PARSE_ERROR:-32700,INVALID_REQUEST:-32600,METHOD_NOT_FOUND:-32601,INVALID_PARAMS:-32602,REMOTE_INTERNAL_ERROR:-32603,TIMEOUT:-32701};let Os=class{constructor({transports:e}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transportsToRegister=e,this.methods={}}setMethodPrefix(e){this.methodPrefix=e}expose(e){this.methods=e}registerTransport(e){e.onData(this._processRequest.bind(this,e))}async _processRequest(e,n){const r=JSON.parse(n);let i;return Array.isArray(r)?i=await Promise.all(r.map(s=>this._callMethod(s,e))):i=await this._callMethod(r,e),JSON.stringify(i)}async _callMethod(e,n){if(!e.hasOwnProperty("method"))return;const{method:i,params:s=[],id:l}=e;let c=i;if(c.includes("::")){const[p,b]=c.split("::");if(c=b,this.methodPrefix&&p!=this.methodPrefix)return}const u=!this.methods[c]||typeof this.methods[c]!="function"||c==="constructor"||c.startsWith("_")||this.methods[c]===Object.prototype[c];let h={};if(u)h={jsonrpc:"2.0",id:l,error:{code:Gt.METHOD_NOT_FOUND,message:`Method [${c}] not found on remote target object`}};else{this.currentTransport=n;try{const p=await this.methods[c].apply(this.methods,s);if(!l)return;h={jsonrpc:"2.0",result:typeof p>"u"?null:p,id:l}}catch(p){console.log(`Exposed RPC method ${i} internal error:`),console.log(p),console.log("Sending this error as a result to calling client ..."),h={jsonrpc:"2.0",error:{code:Gt.REMOTE_INTERNAL_ERROR,message:`Method [${i}] internal error: ${p.stack}`},id:l}}}return h}run(){for(const e of this.transportsToRegister)this.registerTransport(e);this.transportsToRegister=[]}},Nn=class extends Error{constructor(e={}){if(super(),!e.code)throw new Error("Code required");if(!e.message)throw new Error("Message required");this.code=e.code,this.message=e.message}},uc=class extends Nn{constructor(e){super({code:Gt.METHOD_NOT_FOUND,message:e||"Method not found"})}},dc=class extends Nn{constructor(){super({code:Gt.INVALID_PARAMS,message:"Invalid params"})}},hc=class extends Nn{constructor(e){super({code:Gt.REMOTE_INTERNAL_ERROR,message:`Error originating at remote endpoint: ${e}`||"Remote Internal error"})}},_c=class extends Nn{constructor(){super({code:Gt.PARSE_ERROR,message:"Parse error"})}},pc=class extends Nn{constructor(){super({code:Gt.INVALID_REQUEST,message:"Invalid request"})}},Ts=class extends Nn{},bc=class extends Ts{constructor(e,n){super({code:Gt.TIMEOUT,message:`Request exceeded maximum execution time (${n}ms): ${e}`})}};var Dr={Base:Nn,MethodNotFound:uc,InvalidRequest:pc,InvalidParams:dc,RemoteInternalError:hc,ServerError:Ts,ParseError:_c,RequestTimeout:bc};let ks=class{constructor({transport:e,requestTimeout:n=2e4}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transport=e,this.requestTimeout=n,this.pendingRequest={},this.initialized=!1}setMethodPrefix(e){this.methodPrefix=e}async callMethod(e,n){this._init();const r=this.methodPrefix?`${this.methodPrefix}::${e}`:e,i=this._makeRequestObject({method:r,params:n});return this._sendRequest({object:i,id:i.id})}notify(e,n){this._init();const r=this._makeRequestObject({method:e,params:n,mode:"notify"});return this.transport.sendData(JSON.stringify(r)),!0}async runBatch(e){const n=this._generateId();let r=!0;const i=[];for(const[s,l,c]of e){const u=this._makeRequestObject({method:s,params:l,mode:c,batchId:n});u.id&&(r=!1),i.push(u)}return r?this.transport.sendData(JSON.stringify(i)):this._sendRequest({object:i,id:n})}_init(){this.initialized||(this.transport.onData(this._processResponse.bind(this)),this.initialized=!0)}_sendRequest({object:e,id:n}){const r=JSON.stringify(e);return new Promise((i,s)=>{this.pendingRequest[n]={resolve:i,reject:s,sentObject:e},setTimeout(()=>{this.pendingRequest[n]&&(delete this.pendingRequest[n],s(new Dr.RequestTimeout(r,this.requestTimeout)))},this.requestTimeout);try{this.transport.sendData(r)}catch(l){delete this.pendingRequest[n],s(l)}})}_processResponse(e){const n=JSON.parse(e);Array.isArray(n)?this._processBatchResponse(n):this._processSingleCallResponse(n)}_processSingleCallResponse(e){const n=e.hasOwnProperty("result")||!1,r=e.hasOwnProperty("error");if(!n&&!r)return;const i=this.pendingRequest[e.id];if(delete this.pendingRequest[e.id],!!i){if(n)i.resolve(e.result);else if(r){const s=this._makeErrorObject(e.error);i.reject(s)}}}_processBatchResponse(e){let n;const r={},i=[];for(const h of e)h.id?(n||(n=h.id.split("|")[0]),r[h.id]=h):h.error&&i.push(h.error);if(!this.pendingRequest[n])return;const{sentObject:s,resolve:l}=this.pendingRequest[n];delete this.pendingRequest[n];const c=[];let u=0;for(const h of s){if(!h.id){c.push(null);continue}const p=r[h.id];p?p.hasOwnProperty("result")||!1?c.push({success:!0,result:p.result}):c.push({success:!1,result:this._makeErrorObject(p.error)}):(c.push({success:!1,error:this._makeErrorObject(i[u])}),u++)}l(c)}_makeRequestObject({method:e,params:n,mode:r,batchId:i}){const s={jsonrpc:"2.0",method:e};return n&&n.length&&(s.params=n),r!=="notify"&&(s.id=i?`${i}|${this._generateId()}`:this._generateId()),s}_makeErrorObject(e){const n={[Gt.METHOD_NOT_FOUND]:()=>new Dr.MethodNotFound(e.message),[Gt.REMOTE_INTERNAL_ERROR]:()=>new Dr.RemoteInternalError(e.message)}[e.code];return n()}_generateId(){const e="bjectSymhasOwnProp-0123456789ABCDEFGHIJKLMNQRTUVWXYZ_dfgiklquvxz";let n=10,r="";for(;0<n--;)r+=e[Math.random()*64|0];return r}};function vc(t){const e=lf(t.callMethod.bind(t)),n=lf(t.notify.bind(t));return new Proxy(t,{get(r,i){if(i==="notify")return n;if(i==="callMethod")return e;if(i!=="then")return i==="setMethodPrefix"?(...s)=>t.setMethodPrefix(s):(...s)=>r.callMethod.call(r,i,s)}})}function lf(t){return new Proxy(t,{get(e,n){return(...r)=>e.call(null,n,r)},apply(e,n,r){return e.apply(null,r)}})}let mc=class extends ks{constructor(...e){return super(...e),vc(this)}},yc=class{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",e)}sendData(e){this.channel.send(e)}},Cs=class{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",async n=>{const r=await e(n);r&&this.channel.send(r)})}};var gc=Object.freeze({__proto__:null,MoleServer:Os,MoleClient:ks,MoleClientProxified:mc,ClientTransport:yc,ServerTransport:Cs});let xc=class extends Error{constructor(e,n){super(e),this.name=this.constructor.name,this.errorCode=n}errorCode(){return this.errorCode}};const{MoleClient:wc,ClientTransport:Ac}=gc;let Ec=class{constructor(e,n,r){this.moleChannel=new ac(e),this.methodPrefix=n,this.connectorOrServersideChannel=e,this.client=new wc({requestTimeout:r,transport:new Ac(this.moleChannel)})}jsonrpcMsgReceive(e){this.moleChannel.emit("json_rpc",e)}call(e,n){return this.connectorOrServersideChannel.closed()?new Promise((r,i)=>{i(new xc(`Method call [${this.methodPrefix}::${e}] on closed channel or connector ignored. Please add a check for closed channel in your code.`,"CLOSED_CHANNEL"))}):this.client.callMethod(`${this.methodPrefix}::${e}`,n)}};const Sc=1e4;let Oc=class{constructor(e,n){this.connectorOrServersideChannel=e,this.remoteObjects={},this.requestTimeout=n||Sc}remoteObject(e){return this.remoteObjects[e]||(this.remoteObjects[e]=new Ec(this.connectorOrServersideChannel,e,this.requestTimeout)),this.remoteObjects[e]}jsonrpcMsgReceive(e){for(const n of Object.values(this.remoteObjects))n.jsonrpcMsgReceive(e)}},Tc=class{constructor({serversideChannel:e,serverMethods:n,methodPrefix:r}){const i=[new Cs(e)];this.server=new Os({transports:i}),this.server.expose(n),this.server.setMethodPrefix(r),this.server.run()}};Zt.util=Fn;function kc(){const t=Zt.box.keyPair(),e=ar(t.publicKey),n=ar(t.secretKey);return{privateKey:t.secretKey,publicKey:t.publicKey,privateKeyHex:n,publicKeyHex:e}}Zt.util=Fn;function Cc(t){return t.publicKeyHex&&!t.publicKey&&(t.publicKey=zr(t.publicKeyHex)),t.privateKeyHex&&!t.privateKey&&(t.privateKey=zr(t.privateKeyHex)),t}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var Rc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nc=Object.prototype.hasOwnProperty;function qr(t,e){return Nc.call(t,e)}function Yr(t){if(Array.isArray(t)){for(var n=new Array(t.length),e=0;e<n.length;e++)n[e]=""+e;return n}if(Object.keys)return Object.keys(t);var n=[];for(var r in t)qr(t,r)&&n.push(r);return n}function qt(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function Fr(t){for(var e=0,n=t.length,r;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function Sn(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function Rs(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function Hr(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(Hr(t[e]))return!0}else if(typeof t=="object"){for(var r=Yr(t),i=r.length,e=0;e<i;e++)if(Hr(t[r[e]]))return!0}}return!1}function cf(t,e){var n=[t];for(var r in e){var i=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var Ns=function(t){Rc(e,t);function e(n,r,i,s,l){var c=this.constructor,u=t.call(this,cf(n,{name:r,index:i,operation:s,tree:l}))||this;return u.name=r,u.index=i,u.operation=s,u.tree=l,Object.setPrototypeOf(u,c.prototype),u.message=cf(n,{name:r,index:i,operation:s,tree:l}),u}return e}(Error),_t=Ns,Dc=qt,Ln={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=hr(n,this.path);r&&(r=qt(r));var i=kn(n,{op:"remove",path:this.from}).removed;return kn(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=hr(n,this.from);return kn(n,{op:"add",path:this.path,value:qt(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:Xn(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},$c={add:function(t,e,n){return Fr(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:Ln.move,copy:Ln.copy,test:Ln.test,_get:Ln._get};function hr(t,e){if(e=="")return t;var n={op:"_get",path:e};return kn(t,n),n.value}function kn(t,e,n,r,i,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):_r(e,0)),e.path===""){var l={newDocument:t};if(e.op==="add")return l.newDocument=e.value,l;if(e.op==="replace")return l.newDocument=e.value,l.removed=t,l;if(e.op==="move"||e.op==="copy")return l.newDocument=hr(t,e.from),e.op==="move"&&(l.removed=t),l;if(e.op==="test"){if(l.test=Xn(t,e.value),l.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l.newDocument=t,l}else{if(e.op==="remove")return l.removed=t,l.newDocument=null,l;if(e.op==="_get")return e.value=t,l;if(n)throw new _t("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return l}}else{r||(t=qt(t));var c=e.path||"",u=c.split("/"),h=t,p=1,b=u.length,m=void 0,y=void 0,w=void 0;for(typeof n=="function"?w=n:w=_r;;){if(y=u[p],i&&y=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&m===void 0&&(h[y]===void 0?m=u.slice(0,p).join("/"):p==b-1&&(m=e.path),m!==void 0&&w(e,0,t,m)),p++,Array.isArray(h)){if(y==="-")y=h.length;else{if(n&&!Fr(y))throw new _t("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);Fr(y)&&(y=~~y)}if(p>=b){if(n&&e.op==="add"&&y>h.length)throw new _t("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var l=$c[e.op].call(e,h,y,t);if(l.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}}else if(y&&y.indexOf("~")!=-1&&(y=Rs(y)),p>=b){var l=Ln[e.op].call(e,h,y,t);if(l.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}h=h[y]}}}function fi(t,e,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(e))throw new _t("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=qt(t));for(var s=new Array(e.length),l=0,c=e.length;l<c;l++)s[l]=kn(t,e[l],n,!0,i,l),t=s[l].newDocument;return s.newDocument=t,s}function Pc(t,e,n){var r=kn(t,e);if(r.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function _r(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new _t("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(Ln[t.op]){if(typeof t.path!="string")throw new _t("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new _t('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new _t("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new _t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&Hr(t.value))throw new _t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var i=t.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new _t("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new _t("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var l={op:"_get",path:t.from,value:void 0},c=Ds([l],n);if(c&&c.name==="OPERATION_PATH_UNRESOLVABLE")throw new _t("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new _t("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function Ds(t,e,n){try{if(!Array.isArray(t))throw new _t("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)fi(qt(e),qt(t),n||!0);else{n=n||_r;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof _t)return i;throw i}}function Xn(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),i,s,l;if(n&&r){if(s=t.length,s!=e.length)return!1;for(i=s;i--!==0;)if(!Xn(t[i],e[i]))return!1;return!0}if(n!=r)return!1;var c=Object.keys(t);if(s=c.length,s!==Object.keys(e).length)return!1;for(i=s;i--!==0;)if(!e.hasOwnProperty(c[i]))return!1;for(i=s;i--!==0;)if(l=c[i],!Xn(t[l],e[l]))return!1;return!0}return t!==t&&e!==e}var Ic=Object.freeze({__proto__:null,JsonPatchError:_t,deepClone:Dc,getValueByPointer:hr,applyOperation:kn,applyPatch:fi,applyReducer:Pc,validator:_r,validate:Ds,_areEquals:Xn});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var si=new WeakMap,Mc=function(){function t(e){this.observers=new Map,this.obj=e}return t}(),Uc=function(){function t(e,n){this.callback=e,this.observer=n}return t}();function Lc(t){return si.get(t)}function jc(t,e){return t.observers.get(e)}function Bc(t,e){t.observers.delete(e.callback)}function zc(t,e){e.unobserve()}function Kc(t,e){var n=[],r,i=Lc(t);if(!i)i=new Mc(t),si.set(t,i);else{var s=jc(i,e);r=s&&s.observer}if(r)return r;if(r={},i.value=qt(t),e){r.callback=e,r.next=null;var l=function(){Jr(r)},c=function(){clearTimeout(r.next),r.next=setTimeout(l)};typeof window<"u"&&(window.addEventListener("mouseup",c),window.addEventListener("keyup",c),window.addEventListener("mousedown",c),window.addEventListener("keydown",c),window.addEventListener("change",c))}return r.patches=n,r.object=t,r.unobserve=function(){Jr(r),clearTimeout(r.next),Bc(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",c),window.removeEventListener("keyup",c),window.removeEventListener("mousedown",c),window.removeEventListener("keydown",c),window.removeEventListener("change",c))},i.observers.set(e,new Uc(e,r)),r}function Jr(t,e){e===void 0&&(e=!1);var n=si.get(t.object);oi(n.value,t.object,t.patches,"",e),t.patches.length&&fi(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function oi(t,e,n,r,i){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=Yr(e),l=Yr(t),c=!1,u=l.length-1;u>=0;u--){var h=l[u],p=t[h];if(qr(e,h)&&!(e[h]===void 0&&p!==void 0&&Array.isArray(e)===!1)){var b=e[h];typeof p=="object"&&p!=null&&typeof b=="object"&&b!=null?oi(p,b,n,r+"/"+Sn(h),i):p!==b&&(i&&n.push({op:"test",path:r+"/"+Sn(h),value:qt(p)}),n.push({op:"replace",path:r+"/"+Sn(h),value:qt(b)}))}else Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+Sn(h),value:qt(p)}),n.push({op:"remove",path:r+"/"+Sn(h)}),c=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!c&&s.length==l.length))for(var u=0;u<s.length;u++){var h=s[u];!qr(t,h)&&e[h]!==void 0&&n.push({op:"add",path:r+"/"+Sn(h),value:qt(e[h])})}}}function qc(t,e,n){n===void 0&&(n=!1);var r=[];return oi(t,e,r,"",n),r}var Yc=Object.freeze({__proto__:null,unobserve:zc,observe:Kc,generate:Jr,compare:qc}),Fc=Object.assign({},Ic,Yc,{JsonPatchError:Ns,deepClone:qt,escapePathComponent:Sn,unescapePathComponent:Rs});const{applyPatch:Hc}=Fc;let Jc=class extends dr{constructor(e){super({}),this.connector=e,this.connector.on("receive_state",n=>{this.wireStateReceived=!0,this.set(n)}),this.connector.on("receive_diff",n=>{this.wireStateReceived&&(Hc(this.state,n),this.announceStateChange())})}field(e){return this.connector.connectionState.get(e)}},Wc=class extends dr{constructor(e){super({}),this.fields={},this.connector=e,this.connector.on("receive_state_field",({name:n,state:r})=>{this.get(n).set(r)})}get(e){return this.fields[e]||(this.fields[e]=new dr),this.fields[e]}};Zt.util=Fn;const Zc=700,Gc=6e4,Vc=1;let Qc=class extends ri{constructor({endpoint:e,protocol:n,keypair:r=kc(),rpcRequestTimeout:i,verbose:s=!1,tag:l,log:c=console.log,autoDecommission:u=!1,dummy:h}={}){super(),this.protocol=n,this.log=c;const{privateKey:p,publicKey:b}=Cc(r);this.clientPrivateKey=p,this.clientPublicKey=b,this.clientPublicKeyHex=ar(b),this.rpcClient=new Oc(this,i),this.endpoint=e,this.verbose=s,this.tag=l,this.autoDecommission=u,this.sentCount=0,this.receivedCount=0,this.successfulConnectsCount=0,h||(this.state=new Jc(this),this.connectionState=new Wc(this)),this.connected=new dr,this.delayedAdjustConnectionStatus(),s&&tt.green(this.log,`Connector ${this.endpoint} created`),this.decommissionCheckCounter=0,this.lastPongReceivedAt=Date.now(),this.on("pong",()=>{this.lastPongReceivedAt=Date.now()})}delayedAdjustConnectionStatus(){setTimeout(()=>{this.connected.get()==null&&this.connected.set(!1)},Zc)}send(e){sc({data:e,connector:this}),this.sentCount+=1}signal(e,n){this.connected.get()?this.send({signal:e,data:n}):tt.write(this.log,"Warning: trying to send signal over disconnected connector, this should be prevented by GUI")}userAction({action:e,scope:n,payload:r}){this.signal("__action",{action:e,scope:n,payload:r})}on(e,n){e=="ready"&&this.isReady()&&n(),super.on(e,n)}getSharedSecret(){return this.sharedSecret?ar(this.sharedSecret):void 0}wireReceive({jsonData:e,encryptedData:n,rawMessage:r}){Ss({jsonData:e,encryptedData:n,rawMessage:r,connector:this}),this.receivedCount+=1}field(e){return this.connectionState.get(e)}isReady(){return this.ready}closed(){return!this.transportConnected}connectStatus(e){if(e){this.sentCount=0,this.receivedCount=0,this.transportConnected=!0,this.successfulConnectsCount+=1,this.verbose&&tt.green(this.log,`✓ Connector ${this.endpoint} connected #${this.successfulConnectsCount}`);const n=this.connection.websocket.__id;lc({connector:this,afterFirstStep:({sharedSecret:i,remotePubkeyHex:s})=>{this.sharedSecret=i,this._remotePubkeyHex=s}}).then(()=>{this.connectedAt=Date.now(),this.connected.set(!0),this.ready=!0,this.emit("ready")}).catch(i=>{this.connection.websocket.__id==n&&this.connection.websocket.readyState==Vc&&i.code==Gt.TIMEOUT&&(tt.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] handshake error: "${i.message}"`),tt.write(this.log,`${this.endpoint} Connector dropping stale websocket after handshake error`),this.connection.terminate()),i.code!=Gt.TIMEOUT&&tt.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] on:ready error: "${i.stack}" — (will not try to reconnect, fix the error and reload this gui)`)})}else{let n;this.transportConnected&&(n=!0),this.transportConnected==null&&tt.write(this.log,`${this.endpoint} Connector was not able to connect at first try`),this.transportConnected=!1,this.ready=!1,this.sharedSecret=void 0,delete this.connectedAt,n&&(this.emit("disconnect"),e==null&&this.delayedAdjustConnectionStatus(),this.connected.set(e))}}checkForDecommission(){this.autoDecommission&&(this.decommissionCheckRequestedAt&&Date.now()-this.decommissionCheckRequestedAt>3e3&&(this.decommissionCheckCounter=0),this.decommissionCheckRequestedAt=Date.now(),this.decommissionCheckCounter+=1,this.decommissionCheckCounter>12&&Date.now()-this.lastPongReceivedAt>Gc&&(tt.write(this.log,`Decommissioning connector ${this.endpoint} (long inactive)`),this.decommission(),this.emit("decommission")))}decommission(){this.decommissioned=!0}remoteObject(e){return{call:(n,r=[])=>this.rpcClient.remoteObject(e).call(n,Zl(r))}}attachObject(e,n){new Tc({serversideChannel:this,serverMethods:n,methodPrefix:e})}clientPubkey(){return this.clientPublicKeyHex}remotePubkeyHex(){return this._remotePubkeyHex}remoteAddress(){return this.endpoint}};const af=typeof window<"u";function Xc({endpoint:t,host:e,port:n}){if(af&&t&&t.startsWith("/")&&(t=`${window.location.protocol.includes("s")?"wss":"ws"}://${window.location.host}${t}`),!t)if(af){e=e||window.location.hostname;const r=window.location.protocol.includes("s")?"wss":"ws";t=`${r}://${e}`,r=="wss"?t=`${r}://${e}/ws`:n?t=`${t}:${n}`:window.location.port&&(t=`${t}:${window.location.port}`)}else{if(!n)throw new Error(`Connectome determineEndpoint: No websocket port provided for ${e}`);t=`ws://${e||"localhost"}:${n}`}return t}const an=typeof window<"u",ea=0,ta=1,na=1e3,ra=3,ia=5;function fa({endpoint:t,host:e,port:n,protocol:r,keypair:i,remotePubkey:s,rpcRequestTimeout:l,autoDecommission:c,log:u,verbose:h,tag:p,dummy:b},{WebSocket:m}){t=Xc({endpoint:t,host:e,port:n});const y=new Qc({endpoint:t,protocol:r,rpcRequestTimeout:l,keypair:i,verbose:h,tag:p,log:u,autoDecommission:c,dummy:b}),w=()=>{oa({connector:y,endpoint:t},{WebSocket:m,reconnect:w,log:u,verbose:h})};y.connection={terminate(){this.websocket._removeAllCallbacks(),this.websocket.close(),y.connectStatus(!1),w()},endpoint:t,checkTicker:0};const S=()=>{y.decommissioned||(sa({connector:y,reconnect:w,log:u}),setTimeout(S,na))};return setTimeout(S,10),y}function sa({connector:t,reconnect:e,log:n}){const r=t.connection;if(ca(r)||t.decommissioned){t.decommissioned?(tt.yellow(n,`${t.endpoint} Connection decommisioned, closing websocket ${r.websocket.__id}, will not retry again `),$s(t)):(t.emit("inactive_connection"),tt.yellow(n,`${t.endpoint} ✖ Terminated inactive connection`)),r.terminate();return}Ps(r)?r.websocket.send("ping"):(t.connected==null&&(tt.write(n,`${t.endpoint} Setting connector status to FALSE because connector.connected is undefined`),t.connectStatus(!1)),e()),r.checkTicker+=1}function oa({connector:t,endpoint:e},{WebSocket:n,reconnect:r,log:i,verbose:s}){const l=t.connection;if(t.checkForDecommission(),t.decommissioned){$s(t);return}if(l.currentlyTryingWS&&l.currentlyTryingWS.readyState==ea){if(l.currentlyTryingWS._waitForConnectCounter<ia){l.currentlyTryingWS._waitForConnectCounter+=1;return}(s||an)&&tt.write(i,`${e} Reconnect timeout, creating new ws`),l.currentlyTryingWS._removeAllCallbacks(),l.currentlyTryingWS.close()}else(s||an)&&tt.write(i,`${e} Created new websocket`);const c=new n(e);c.__id=Math.random(),l.currentlyTryingWS=c,l.currentlyTryingWS._waitForConnectCounter=0,an&&(c.binaryType="arraybuffer"),an||c.on("error",()=>{});const u=()=>{t.decommissioned||((s||an)&&tt.write(i,`${e} Websocket open`),l.currentlyTryingWS=null,l.checkTicker=0,la({ws:c,connector:t,openCallback:u,reconnect:r},{log:i,verbose:s}),l.websocket=c,t.connectStatus(!0))};c._removeAllCallbacks=()=>{c.removeEventListener("open",u)},an?c.addEventListener("open",u):c.on("open",u)}function la({ws:t,connector:e,openCallback:n,reconnect:r},{log:i,verbose:s}){const l=e.connection,c=p=>{const b=`${e.endpoint} Websocket error`;console.log(b),console.log(p)},u=()=>{if(tt.write(i,`${e.endpoint} ✖ Connection closed`),e.decommissioned){e.connectStatus(!1);return}e.connectStatus(void 0),r()},h=p=>{if(e.decommissioned)return;l.checkTicker=0;const b=an?p.data:p;if(b=="pong"){e.emit("pong");return}let m;try{m=JSON.parse(b)}catch{}if(m)e.wireReceive({jsonData:m,rawMessage:b});else{const y=an?new Uint8Array(b):b;e.wireReceive({encryptedData:y})}};t._removeAllCallbacks=()=>{t.removeEventListener("error",c),t.removeEventListener("close",u),t.removeEventListener("message",h),t.removeEventListener("open",n)},an?(t.addEventListener("error",c),t.addEventListener("close",u),t.addEventListener("message",h)):(t.on("error",c),t.on("close",u),t.on("message",h))}function $s(t){const e=t.connection;e.currentlyTryingWS&&(e.currentlyTryingWS._removeAllCallbacks(),e.currentlyTryingWS.close(),e.currentlyTryingWS=null),e.ws&&(e.ws._removeAllCallbacks(),e.ws.close(),e.ws=null),t.connectStatus(!1)}function Ps(t){return t.websocket&&t.websocket.readyState==ta}function ca(t){return Ps(t)&&t.checkTicker>ra}function aa(t){return t.log=t.log||console.log,fa(t,{WebSocket})}function uf(t,e,n){const r=t.slice();return r[70]=e[n],r}function df(t,e,n){const r=t.slice();return r[70]=e[n],r}function ua(t){let e,n=(t[0].network||"")+"",r;return{c(){e=M("h3"),r=B(n),L(e,"class","svelte-xmpa81")},m(i,s){C(i,e,s),O(e,r)},p(i,s){s[0]&1&&n!==(n=(i[0].network||"")+"")&&Ie(r,n)},i:ge,o:ge,d(i){i&&T(e)}}}function da(t){let e,n,r,i,s;function l(h,p){return h[11]==0?_a:ha}let c=l(t),u=c(t);return{c(){e=M("h3"),n=B(`Vhod
      `),r=M("span"),i=B(`— odpiranje
        `),u.c(),L(r,"class","svelte-xmpa81"),L(e,"class","countdown svelte-xmpa81")},m(h,p){C(h,e,p),O(e,n),O(e,r),O(r,i),u.m(r,null)},p(h,p){c===(c=l(h))&&u?u.p(h,p):(u.d(1),u=c(h),u&&(u.c(),u.m(r,null)))},i(h){s||jt(()=>{s=hn(r,us,{}),s.start()})},o:ge,d(h){h&&T(e),u.d()}}}function ha(t){let e,n,r;return{c(){e=B("čez "),n=B(t[11]),r=B("s")},m(i,s){C(i,e,s),C(i,n,s),C(i,r,s)},p(i,s){s[0]&2048&&Ie(n,i[11])},d(i){i&&T(e),i&&T(n),i&&T(r)}}}function _a(t){let e;return{c(){e=B("ZDAJ")},m(n,r){C(n,e,r)},p:ge,d(n){n&&T(e)}}}function hf(t){let e,n,r,i,s,l,c,u,h,p,b,m,y,w;return{c(){e=M("div"),n=M("button"),r=B("ODPRI ZDAJ"),s=F(),l=M("button"),c=B("Zakasnitev +10s"),h=F(),p=M("button"),b=B("Prekliči"),L(n,"class","open svelte-xmpa81"),n.disabled=i=!t[12]||t[11]==0,L(l,"class","delayed_open svelte-xmpa81"),l.disabled=u=!t[12]||t[11]==0,L(p,"class","cancel svelte-xmpa81"),p.disabled=m=!t[12]||t[11]==0,L(e,"class","entry_door_options svelte-xmpa81")},m(S,P){C(S,e,P),O(e,n),O(n,r),O(e,s),O(e,l),O(l,c),O(e,h),O(e,p),O(p,b),y||(w=[Se(n,"click",t[36]),Se(l,"click",t[37]),Se(p,"click",t[38])],y=!0)},p(S,P){P[0]&6144&&i!==(i=!S[12]||S[11]==0)&&(n.disabled=i),P[0]&6144&&u!==(u=!S[12]||S[11]==0)&&(l.disabled=u),P[0]&6144&&m!==(m=!S[12]||S[11]==0)&&(p.disabled=m)},d(S){S&&T(e),y=!1,yt(w)}}}function pa(t){var Jt,Ut;let e,n,r,i,s,l,c,u,h,p,b,m,y,w,S,P=t[6]&&((Jt=t[1])==null?void 0:Jt.find(t[33])),k,G=t[5]&&((Ut=t[1])==null?void 0:Ut.find(t[31])),X,j,q,z,be,ye,ue,De,ot,Xe,ft,Ae,Je,He,ht,it,Oe,qe,gt,Nt,We,et,de,Ze,Dt,Xt,St,$t,Ot,Mt,Ft,fn,_n;function pn(te,$e){return te[3]?va:ma}let Ht=pn(t),At=Ht(t);function vt(te,$e){return te[4]?ya:ga}let Tt=vt(t),Et=Tt(t),lt=P&&pf(t),ct=G&&gf(t),rt=t[12]&&t[8]!=null&&Sf(t);return{c(){e=M("h3"),e.textContent="Ograja — parkirišče",n=F(),r=M("div"),i=M("button"),s=B("ODPRI"),c=F(),u=M("button"),h=B("OSEBNI PREHOD"),b=F(),At.c(),m=F(),y=M("h3"),y.textContent="Dnevna TV",w=F(),Et.c(),S=F(),lt&&lt.c(),k=F(),ct&&ct.c(),X=F(),j=M("h3"),j.textContent="Luč kabinet",q=F(),z=M("button"),be=B("PRIŽGI LUČ"),ue=F(),De=M("button"),ot=B("🛑 UGASNI"),ft=F(),Ae=M("button"),Je=B("⏱️"),ht=F(),rt&&rt.c(),it=F(),Oe=M("h3"),Oe.textContent="Alarm",qe=F(),gt=M("button"),Nt=B("VKLOPI"),et=F(),de=M("button"),Ze=B("IZKLOPI"),Xt=F(),St=M("h3"),St.textContent="Dodatne možnosti",$t=F(),Ot=M("button"),Mt=B("— ZAPRI VSE —"),L(e,"class","svelte-xmpa81"),i.disabled=l=!t[12]||t[10]||t[9],L(i,"class","svelte-xmpa81"),L(u,"class","personal_entry svelte-xmpa81"),u.disabled=p=!t[12]||t[10],ce(u,"personal_entry_in_progress",t[9]),L(r,"class","parking_door_options svelte-xmpa81"),L(y,"class","svelte-xmpa81"),L(j,"class","svelte-xmpa81"),z.disabled=ye=!t[12],L(z,"class","svelte-xmpa81"),L(De,"class","turn_off svelte-xmpa81"),De.disabled=Xe=!t[12],Ae.disabled=He=!t[12],L(Ae,"class","svelte-xmpa81"),L(Oe,"class","svelte-xmpa81"),gt.disabled=We=!t[12],L(gt,"class","svelte-xmpa81"),de.disabled=Dt=!t[12],L(de,"class","svelte-xmpa81"),L(St,"class","close_options svelte-xmpa81"),L(Ot,"class","close_options svelte-xmpa81"),Ot.disabled=Ft=!t[12]},m(te,$e){C(te,e,$e),C(te,n,$e),C(te,r,$e),O(r,i),O(i,s),O(r,c),O(r,u),O(u,h),O(r,b),At.m(r,null),C(te,m,$e),C(te,y,$e),C(te,w,$e),Et.m(te,$e),C(te,S,$e),lt&&lt.m(te,$e),C(te,k,$e),ct&&ct.m(te,$e),C(te,X,$e),C(te,j,$e),C(te,q,$e),C(te,z,$e),O(z,be),C(te,ue,$e),C(te,De,$e),O(De,ot),C(te,ft,$e),C(te,Ae,$e),O(Ae,Je),C(te,ht,$e),rt&&rt.m(te,$e),C(te,it,$e),C(te,Oe,$e),C(te,qe,$e),C(te,gt,$e),O(gt,Nt),C(te,et,$e),C(te,de,$e),O(de,Ze),C(te,Xt,$e),C(te,St,$e),C(te,$t,$e),C(te,Ot,$e),O(Ot,Mt),fn||(_n=[Se(i,"click",t[40]),Se(u,"click",t[41]),Se(z,"click",t[63]),Se(De,"click",t[64]),Se(Ae,"click",t[65]),Se(gt,"click",t[66]),Se(de,"click",t[67]),Se(Ot,"click",t[68])],fn=!0)},p(te,$e){var nn,bn;$e[0]&5632&&l!==(l=!te[12]||te[10]||te[9])&&(i.disabled=l),$e[0]&5120&&p!==(p=!te[12]||te[10])&&(u.disabled=p),$e[0]&512&&ce(u,"personal_entry_in_progress",te[9]),Ht===(Ht=pn(te))&&At?At.p(te,$e):(At.d(1),At=Ht(te),At&&(At.c(),At.m(r,null))),Tt===(Tt=vt(te))&&Et?Et.p(te,$e):(Et.d(1),Et=Tt(te),Et&&(Et.c(),Et.m(S.parentNode,S))),$e[0]&66&&(P=te[6]&&((nn=te[1])==null?void 0:nn.find(te[33]))),P?lt?lt.p(te,$e):(lt=pf(te),lt.c(),lt.m(k.parentNode,k)):lt&&(lt.d(1),lt=null),$e[0]&34&&(G=te[5]&&((bn=te[1])==null?void 0:bn.find(te[31]))),G?ct?ct.p(te,$e):(ct=gf(te),ct.c(),ct.m(X.parentNode,X)):ct&&(ct.d(1),ct=null),$e[0]&4096&&ye!==(ye=!te[12])&&(z.disabled=ye),$e[0]&4096&&Xe!==(Xe=!te[12])&&(De.disabled=Xe),$e[0]&4096&&He!==(He=!te[12])&&(Ae.disabled=He),te[12]&&te[8]!=null?rt?(rt.p(te,$e),$e[0]&4352&&re(rt,1)):(rt=Sf(te),rt.c(),re(rt,1),rt.m(it.parentNode,it)):rt&&(rt.d(1),rt=null),$e[0]&4096&&We!==(We=!te[12])&&(gt.disabled=We),$e[0]&4096&&Dt!==(Dt=!te[12])&&(de.disabled=Dt),$e[0]&4096&&Ft!==(Ft=!te[12])&&(Ot.disabled=Ft)},i(te){re(rt)},o:ge,d(te){te&&T(e),te&&T(n),te&&T(r),At.d(),te&&T(m),te&&T(y),te&&T(w),Et.d(te),te&&T(S),lt&&lt.d(te),te&&T(k),ct&&ct.d(te),te&&T(X),te&&T(j),te&&T(q),te&&T(z),te&&T(ue),te&&T(De),te&&T(ft),te&&T(Ae),te&&T(ht),rt&&rt.d(te),te&&T(it),te&&T(Oe),te&&T(qe),te&&T(gt),te&&T(et),te&&T(de),te&&T(Xt),te&&T(St),te&&T($t),te&&T(Ot),fn=!1,yt(_n)}}}function ba(t){let e,n,r,i,s=t[13]&&Of(t);return{c(){s&&s.c(),e=F(),n=M("button"),n.textContent="Več možnosti",L(n,"class","show_more_options svelte-xmpa81")},m(l,c){s&&s.m(l,c),C(l,e,c),C(l,n,c),r||(i=Se(n,"click",t[39]),r=!0)},p(l,c){l[13]?s?s.p(l,c):(s=Of(l),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null)},i:ge,o:ge,d(l){s&&s.d(l),l&&T(e),l&&T(n),r=!1,i()}}}function va(t){let e,n,r,i,s,l,c,u,h,p,b,m,y,w=t[10]&&_f();return{c(){e=M("h4"),e.textContent="— Odpri in ohrani —",n=F(),r=M("button"),i=B("ODPRI IN OHRANI"),l=F(),c=M("button"),u=B("ZAPRI OGRAJO"),p=F(),w&&w.c(),b=bt(),L(e,"class","suboption svelte-xmpa81"),L(r,"class","fence_keep_open svelte-xmpa81"),r.disabled=s=!t[12]||t[9],ce(r,"keep_open_in_progress",t[10]),L(c,"class","close_fence svelte-xmpa81"),c.disabled=h=!t[12]||t[10]||t[9]},m(S,P){C(S,e,P),C(S,n,P),C(S,r,P),O(r,i),C(S,l,P),C(S,c,P),O(c,u),C(S,p,P),w&&w.m(S,P),C(S,b,P),m||(y=[Se(r,"click",t[43]),Se(c,"click",t[44])],m=!0)},p(S,P){P[0]&4608&&s!==(s=!S[12]||S[9])&&(r.disabled=s),P[0]&1024&&ce(r,"keep_open_in_progress",S[10]),P[0]&5632&&h!==(h=!S[12]||S[10]||S[9])&&(c.disabled=h),S[10]?w||(w=_f(),w.c(),w.m(b.parentNode,b)):w&&(w.d(1),w=null)},d(S){S&&T(e),S&&T(n),S&&T(r),S&&T(l),S&&T(c),S&&T(p),w&&w.d(S),S&&T(b),m=!1,yt(y)}}}function ma(t){let e,n,r;return{c(){e=M("button"),e.textContent="Več",L(e,"class","show_more_options svelte-xmpa81")},m(i,s){C(i,e,s),n||(r=Se(e,"click",t[42]),n=!0)},p:ge,d(i){i&&T(e),n=!1,r()}}}function _f(t){let e;return{c(){e=M("h4"),e.textContent="[ ⚠️ v zadnji sekundi odpiranja ne sme biti prehoda, sicer vrata ne bodo ostala odprta ]",L(e,"class","suboption warn svelte-xmpa81")},m(n,r){C(n,e,r)},d(n){n&&T(e)}}}function ya(t){let e,n,r,i,s,l,c,u,h,p,b,m,y,w,S=(t[14]||"")+"",P,k,G,X,j,q,z,be,ye,ue,De,ot,Xe,ft,Ae,Je,He,ht,it;return{c(){e=M("button"),n=B("TV"),i=F(),s=M("button"),l=B("DMT"),u=F(),h=M("button"),p=B("🛑 UGASNI"),m=F(),y=M("h4"),y.textContent="— TV glasnost —",w=F(),P=B(S),k=F(),G=M("button"),X=B("VOL↑"),q=F(),z=M("button"),be=B("VOL ↓"),ue=F(),De=M("button"),ot=B("PRIVZETO"),ft=F(),Ae=M("button"),Je=B("🔇"),e.disabled=r=!t[12],L(e,"class","svelte-xmpa81"),s.disabled=c=!t[12],L(s,"class","svelte-xmpa81"),L(h,"class","turn_off svelte-xmpa81"),h.disabled=b=!t[12],L(y,"class","suboption volume svelte-xmpa81"),L(G,"class","volume svelte-xmpa81"),G.disabled=j=!t[12],L(z,"class","volume svelte-xmpa81"),z.disabled=ye=!t[12],L(De,"class","volume svelte-xmpa81"),De.disabled=Xe=!t[12],L(Ae,"class","volume svelte-xmpa81"),Ae.disabled=He=!t[12]},m(Oe,qe){C(Oe,e,qe),O(e,n),C(Oe,i,qe),C(Oe,s,qe),O(s,l),C(Oe,u,qe),C(Oe,h,qe),O(h,p),C(Oe,m,qe),C(Oe,y,qe),C(Oe,w,qe),C(Oe,P,qe),C(Oe,k,qe),C(Oe,G,qe),O(G,X),C(Oe,q,qe),C(Oe,z,qe),O(z,be),C(Oe,ue,qe),C(Oe,De,qe),O(De,ot),C(Oe,ft,qe),C(Oe,Ae,qe),O(Ae,Je),ht||(it=[Se(e,"click",t[46]),Se(s,"click",t[47]),Se(h,"click",t[48]),Se(G,"click",t[49]),Se(z,"click",t[50]),Se(De,"click",t[51]),Se(Ae,"click",t[52])],ht=!0)},p(Oe,qe){qe[0]&4096&&r!==(r=!Oe[12])&&(e.disabled=r),qe[0]&4096&&c!==(c=!Oe[12])&&(s.disabled=c),qe[0]&4096&&b!==(b=!Oe[12])&&(h.disabled=b),qe[0]&16384&&S!==(S=(Oe[14]||"")+"")&&Ie(P,S),qe[0]&4096&&j!==(j=!Oe[12])&&(G.disabled=j),qe[0]&4096&&ye!==(ye=!Oe[12])&&(z.disabled=ye),qe[0]&4096&&Xe!==(Xe=!Oe[12])&&(De.disabled=Xe),qe[0]&4096&&He!==(He=!Oe[12])&&(Ae.disabled=He)},d(Oe){Oe&&T(e),Oe&&T(i),Oe&&T(s),Oe&&T(u),Oe&&T(h),Oe&&T(m),Oe&&T(y),Oe&&T(w),Oe&&T(P),Oe&&T(k),Oe&&T(G),Oe&&T(q),Oe&&T(z),Oe&&T(ue),Oe&&T(De),Oe&&T(ft),Oe&&T(Ae),ht=!1,yt(it)}}}function ga(t){let e,n,r;return{c(){e=M("button"),e.textContent="Možnosti TV",L(e,"class","show_more_options svelte-xmpa81")},m(i,s){C(i,e,s),n||(r=Se(e,"click",t[45]),n=!0)},p:ge,d(i){i&&T(e),n=!1,r()}}}function pf(t){let e,n,r,i=t[17],s=[];for(let l=0;l<i.length;l+=1)s[l]=yf(df(t,i,l));return{c(){e=M("h3"),e.textContent="Izklop računalnikov",n=F();for(let l=0;l<s.length;l+=1)s[l].c();r=bt(),L(e,"class","svelte-xmpa81")},m(l,c){C(l,e,c),C(l,n,c);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(l,c);C(l,r,c)},p(l,c){if(c[0]&469897282){i=l[17];let u;for(u=0;u<i.length;u+=1){const h=df(l,i,u);s[u]?s[u].p(h,c):(s[u]=yf(h),s[u].c(),s[u].m(r.parentNode,r))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}},d(l){l&&T(e),l&&T(n),wn(s,l),l&&T(r)}}}function bf(t){var p,b;let e,n,r,i;function s(m,y){var w;return(w=m[6][m[70]])!=null&&w.counter?wa:xa}let l=s(t),c=l(t),u=((p=t[6][t[70]])==null?void 0:p.counter)&&vf(t),h=t[12]&&((b=t[6][t[70]])==null?void 0:b.counter)!=null&&mf(t);return{c(){e=M("div"),c.c(),n=F(),u&&u.c(),r=F(),h&&h.c(),i=F(),L(e,"class","sleep_device svelte-xmpa81")},m(m,y){C(m,e,y),c.m(e,null),O(e,n),u&&u.m(e,null),O(e,r),h&&h.m(e,null),O(e,i)},p(m,y){var w,S;l===(l=s(m))&&c?c.p(m,y):(c.d(1),c=l(m),c&&(c.c(),c.m(e,n))),(w=m[6][m[70]])!=null&&w.counter?u?u.p(m,y):(u=vf(m),u.c(),u.m(e,r)):u&&(u.d(1),u=null),m[12]&&((S=m[6][m[70]])==null?void 0:S.counter)!=null?h?h.p(m,y):(h=mf(m),h.c(),h.m(e,i)):h&&(h.d(1),h=null)},d(m){m&&T(e),c.d(),u&&u.d(),h&&h.d()}}}function xa(t){let e,n,r=t[70]+"",i,s,l,c;function u(){return t[53](t[70])}return{c(){e=M("button"),n=B("🛑💻 "),i=B(r),e.disabled=s=!t[12],L(e,"class","svelte-xmpa81")},m(h,p){C(h,e,p),O(e,n),O(e,i),l||(c=Se(e,"click",u),l=!0)},p(h,p){t=h,p[0]&4096&&s!==(s=!t[12])&&(e.disabled=s)},d(h){h&&T(e),l=!1,c()}}}function wa(t){let e,n=t[70]+"",r;return{c(){e=M("h3"),r=B(n),L(e,"class","sleep_device svelte-xmpa81")},m(i,s){C(i,e,s),O(e,r)},p:ge,d(i){i&&T(e)}}}function vf(t){let e,n,r,i,s,l,c,u,h,p,b,m,y;function w(){return t[54](t[70])}function S(){return t[55](t[70])}function P(){return t[56](t[70])}return{c(){e=M("button"),n=B("🛑 ZDAJ"),i=F(),s=M("button"),l=B("⏱ ZAKASNITEV"),u=F(),h=M("button"),p=B("Prekliči"),L(e,"class","turn_off svelte-xmpa81"),e.disabled=r=!t[12],L(s,"class","add_time svelte-xmpa81"),s.disabled=c=!t[12],L(h,"class","cancel svelte-xmpa81"),h.disabled=b=!t[12]},m(k,G){C(k,e,G),O(e,n),C(k,i,G),C(k,s,G),O(s,l),C(k,u,G),C(k,h,G),O(h,p),m||(y=[Se(e,"click",w),Se(s,"click",S),Se(h,"click",P)],m=!0)},p(k,G){t=k,G[0]&4096&&r!==(r=!t[12])&&(e.disabled=r),G[0]&4096&&c!==(c=!t[12])&&(s.disabled=c),G[0]&4096&&b!==(b=!t[12])&&(h.disabled=b)},d(k){k&&T(e),k&&T(i),k&&T(s),k&&T(u),k&&T(h),m=!1,yt(y)}}}function mf(t){let e,n,r=t[70]+"",i,s;function l(h,p){return h[6][h[70]].counter==0?Ea:Aa}let c=l(t),u=c(t);return{c(){e=M("h3"),n=M("span"),i=B(r),s=B(` izklop
                `),u.c(),L(n,"class","svelte-xmpa81"),L(e,"class","countdown_turn_off svelte-xmpa81"),ce(e,"warn",t[6][t[70]].counter<=15)},m(h,p){C(h,e,p),O(e,n),O(n,i),O(e,s),u.m(e,null)},p(h,p){c===(c=l(h))&&u?u.p(h,p):(u.d(1),u=c(h),u&&(u.c(),u.m(e,null))),p[0]&131136&&ce(e,"warn",h[6][h[70]].counter<=15)},d(h){h&&T(e),u.d()}}}function Aa(t){let e,n=t[6][t[70]].delayStr+"",r;return{c(){e=B("čez "),r=B(n)},m(i,s){C(i,e,s),C(i,r,s)},p(i,s){s[0]&64&&n!==(n=i[6][i[70]].delayStr+"")&&Ie(r,n)},d(i){i&&T(e),i&&T(r)}}}function Ea(t){let e;return{c(){e=B("ZDAJ")},m(n,r){C(n,e,r)},p:ge,d(n){n&&T(e)}}}function yf(t){var s;let e=(s=t[1])==null?void 0:s.find(r),n;function r(...l){return t[34](t[70],...l)}let i=e&&bf(t);return{c(){i&&i.c(),n=bt()},m(l,c){i&&i.m(l,c),C(l,n,c)},p(l,c){var u;t=l,c[0]&2&&(e=(u=t[1])==null?void 0:u.find(r)),e?i?i.p(t,c):(i=bf(t),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(l){i&&i.d(l),l&&T(n)}}}function gf(t){let e,n,r,i=t[18],s=[];for(let l=0;l<i.length;l+=1)s[l]=Ef(uf(t,i,l));return{c(){e=M("h3"),e.textContent="Spanje",n=F();for(let l=0;l<s.length;l+=1)s[l].c();r=bt(),L(e,"class","svelte-xmpa81")},m(l,c){C(l,e,c),C(l,n,c);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(l,c);C(l,r,c)},p(l,c){if(c[0]&470028322){i=l[18];let u;for(u=0;u<i.length;u+=1){const h=uf(l,i,u);s[u]?s[u].p(h,c):(s[u]=Ef(h),s[u].c(),s[u].m(r.parentNode,r))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}},d(l){l&&T(e),l&&T(n),wn(s,l),l&&T(r)}}}function xf(t){var p,b;let e,n,r,i;function s(m,y){var w;return(w=m[5][m[70]])!=null&&w.counter?Oa:Sa}let l=s(t),c=l(t),u=((p=t[5][t[70]])==null?void 0:p.counter)&&wf(t),h=t[12]&&((b=t[5][t[70]])==null?void 0:b.counter)!=null&&Af(t);return{c(){e=M("div"),c.c(),n=F(),u&&u.c(),r=F(),h&&h.c(),i=F(),L(e,"class","sleep_device svelte-xmpa81")},m(m,y){C(m,e,y),c.m(e,null),O(e,n),u&&u.m(e,null),O(e,r),h&&h.m(e,null),O(e,i)},p(m,y){var w,S;l===(l=s(m))&&c?c.p(m,y):(c.d(1),c=l(m),c&&(c.c(),c.m(e,n))),(w=m[5][m[70]])!=null&&w.counter?u?u.p(m,y):(u=wf(m),u.c(),u.m(e,r)):u&&(u.d(1),u=null),m[12]&&((S=m[5][m[70]])==null?void 0:S.counter)!=null?h?h.p(m,y):(h=Af(m),h.c(),h.m(e,i)):h&&(h.d(1),h=null)},d(m){m&&T(e),c.d(),u&&u.d(),h&&h.d()}}}function Sa(t){var m,y;let e,n=(y=(m=t[1])==null?void 0:m.find(p))!=null&&y.playing?"🔊":"🌚",r,i,s=t[70].replace("-room","")+"",l,c,u,h;function p(...w){return t[57](t[70],...w)}function b(){return t[58](t[70])}return{c(){e=M("button"),r=B(n),i=F(),l=B(s),e.disabled=c=!t[12],L(e,"class","svelte-xmpa81")},m(w,S){C(w,e,S),O(e,r),O(e,i),O(e,l),u||(h=Se(e,"click",b),u=!0)},p(w,S){var P,k;t=w,S[0]&2&&n!==(n=(k=(P=t[1])==null?void 0:P.find(p))!=null&&k.playing?"🔊":"🌚")&&Ie(r,n),S[0]&4096&&c!==(c=!t[12])&&(e.disabled=c)},d(w){w&&T(e),u=!1,h()}}}function Oa(t){let e,n=t[70].replace("-room","")+"",r;return{c(){e=M("h3"),r=B(n),L(e,"class","sleep_device svelte-xmpa81")},m(i,s){C(i,e,s),O(e,r)},p:ge,d(i){i&&T(e)}}}function wf(t){var j,q;let e,n=(q=(j=t[1])==null?void 0:j.find(P))!=null&&q.playing?"🔊":"🌚",r,i,s,l,c,u,h,p,b,m,y,w,S;function P(...z){return t[59](t[70],...z)}function k(){return t[60](t[70])}function G(){return t[61](t[70])}function X(){return t[62](t[70])}return{c(){e=M("button"),r=B(n),i=B(" ZDAJ"),l=F(),c=M("button"),u=B("⏱ ZAKASNITEV"),p=F(),b=M("button"),m=B("Prekliči"),L(e,"class","turn_off svelte-xmpa81"),e.disabled=s=!t[12],L(c,"class","add_time svelte-xmpa81"),c.disabled=h=!t[12],L(b,"class","cancel svelte-xmpa81"),b.disabled=y=!t[12]},m(z,be){C(z,e,be),O(e,r),O(e,i),C(z,l,be),C(z,c,be),O(c,u),C(z,p,be),C(z,b,be),O(b,m),w||(S=[Se(e,"click",k),Se(c,"click",G),Se(b,"click",X)],w=!0)},p(z,be){var ye,ue;t=z,be[0]&2&&n!==(n=(ue=(ye=t[1])==null?void 0:ye.find(P))!=null&&ue.playing?"🔊":"🌚")&&Ie(r,n),be[0]&4096&&s!==(s=!t[12])&&(e.disabled=s),be[0]&4096&&h!==(h=!t[12])&&(c.disabled=h),be[0]&4096&&y!==(y=!t[12])&&(b.disabled=y)},d(z){z&&T(e),z&&T(l),z&&T(c),z&&T(p),z&&T(b),w=!1,yt(S)}}}function Af(t){let e,n,r=t[70].replace("-room","")+"",i,s;function l(h,p){return h[5][h[70]].counter==0?ka:Ta}let c=l(t),u=c(t);return{c(){e=M("h3"),n=M("span"),i=B(r),s=B(` glasba
                `),u.c(),L(n,"class","svelte-xmpa81"),L(e,"class","countdown_turn_off svelte-xmpa81"),ce(e,"warn",t[5][t[70]].counter<=5)},m(h,p){C(h,e,p),O(e,n),O(n,i),O(e,s),u.m(e,null)},p(h,p){c===(c=l(h))&&u?u.p(h,p):(u.d(1),u=c(h),u&&(u.c(),u.m(e,null))),p[0]&262176&&ce(e,"warn",h[5][h[70]].counter<=5)},d(h){h&&T(e),u.d()}}}function Ta(t){let e,n=t[5][t[70]].delayStr+"",r;return{c(){e=B("čez "),r=B(n)},m(i,s){C(i,e,s),C(i,r,s)},p(i,s){s[0]&32&&n!==(n=i[5][i[70]].delayStr+"")&&Ie(r,n)},d(i){i&&T(e),i&&T(r)}}}function ka(t){let e;return{c(){e=B("ZDAJ")},m(n,r){C(n,e,r)},p:ge,d(n){n&&T(e)}}}function Ef(t){var s;let e=(s=t[1])==null?void 0:s.find(r),n;function r(...l){return t[32](t[70],...l)}let i=e&&xf(t);return{c(){i&&i.c(),n=bt()},m(l,c){i&&i.m(l,c),C(l,n,c)},p(l,c){var u;t=l,c[0]&2&&(e=(u=t[1])==null?void 0:u.find(r)),e?i?i.p(t,c):(i=xf(t),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(l){i&&i.d(l),l&&T(n)}}}function Sf(t){let e,n,r,i;function s(u,h){return u[8]==0?Ra:Ca}let l=s(t),c=l(t);return{c(){e=M("h3"),n=B(`Ugašanje
        `),r=M("span"),c.c(),L(r,"class","svelte-xmpa81"),L(e,"class","countdown svelte-xmpa81")},m(u,h){C(u,e,h),O(e,n),O(e,r),c.m(r,null)},p(u,h){l===(l=s(u))&&c?c.p(u,h):(c.d(1),c=l(u),c&&(c.c(),c.m(r,null)))},i(u){i||jt(()=>{i=hn(r,us,{}),i.start()})},o:ge,d(u){u&&T(e),c.d()}}}function Ca(t){let e,n;return{c(){e=B("čez "),n=B(t[7])},m(r,i){C(r,e,i),C(r,n,i)},p(r,i){i[0]&128&&Ie(n,r[7])},d(r){r&&T(e),r&&T(n)}}}function Ra(t){let e;return{c(){e=B("ZDAJ")},m(n,r){C(n,e,r)},p:ge,d(n){n&&T(e)}}}function Of(t){let e,n,r=(t[0].network||"")+"",i;return{c(){e=M("h3"),n=B("Več možnosti - "),i=B(r),L(e,"class","svelte-xmpa81")},m(s,l){C(s,e,l),O(e,n),O(e,i)},p(s,l){l[0]&1&&r!==(r=(s[0].network||"")+"")&&Ie(i,r)},d(s){s&&T(e)}}}function Na(t){let e,n,r,i,s,l,c,u,h;function p(k,G){return k[12]&&k[13]?da:ua}let b=p(t),m=b(t),y=t[13]&&hf(t);function w(k,G){return k[2]?pa:ba}let S=w(t),P=S(t);return{c(){e=M("div"),m.c(),n=F(),r=M("button"),i=B("ODPIRANJE VHODNIH VRAT"),l=F(),y&&y.c(),c=F(),P.c(),L(r,"class","open_door_show_options svelte-xmpa81"),r.disabled=s=!t[12],ce(r,"invisible",t[13]),L(e,"class","options svelte-xmpa81")},m(k,G){C(k,e,G),m.m(e,null),O(e,n),O(e,r),O(r,i),O(e,l),y&&y.m(e,null),O(e,c),P.m(e,null),u||(h=Se(r,"click",t[35]),u=!0)},p(k,G){b===(b=p(k))&&m?m.p(k,G):(m.d(1),m=b(k),m&&(m.c(),re(m,1),m.m(e,n))),G[0]&4096&&s!==(s=!k[12])&&(r.disabled=s),G[0]&8192&&ce(r,"invisible",k[13]),k[13]?y?y.p(k,G):(y=hf(k),y.c(),y.m(e,c)):y&&(y.d(1),y=null),S===(S=w(k))&&P?P.p(k,G):(P.d(1),P=S(k),P&&(P.c(),re(P,1),P.m(e,null)))},i(k){re(m),re(P)},o:ge,d(k){k&&T(e),m.d(),y&&y.d(),P.d(),u=!1,h()}}}const Da="192.168.0.20",$a=7780,Pa="david/home";function Ia(t,e,n){let r,i,s,l,c,u,h,p,b,m,y,{localDevice:w}=e,{nearbyDevices:S}=e;const P=aa({host:Da,port:$a,protocol:Pa}),{connected:k,state:G}=P;wt(t,k,Ee=>n(12,b=Ee)),wt(t,G,Ee=>n(30,p=Ee));const X=["kids","eclipse"],j=["david-room","ela-room"];w.deviceName=="turbine"&&X.push("turbine");const q=P.field("tvVolume");wt(t,q,Ee=>n(14,y=Ee));const z=Oo(G,Ee=>{var Ye;return((Ye=Ee.entryDoor)==null?void 0:Ye.counter)!=null});wt(t,z,Ee=>n(13,m=Ee));function be(Ee,Ye){P.userAction({action:Ee,payload:Ye,scope:"tv"})}function ye(Ee,Ye){P.userAction({action:Ee,payload:Ye,scope:"alarm"})}function ue(Ee,Ye){P.userAction({action:Ee,payload:Ye,scope:"entry-door"})}function De(Ee,Ye){P.userAction({action:Ee,payload:Ye,scope:"fence-door"})}function ot(Ee,Ye){P.userAction({action:Ee,payload:Ye,scope:"light-lab"})}function Xe(Ee,Ye){P.userAction({action:Ee,scope:"nearbyDevices",payload:{deviceName:Ye}})}function ft(Ee,Ye){P.userAction({action:Ee,scope:"nearbyDevices",payload:{deviceName:Ye,delay:!0}})}function Ae(Ee,Ye){P.userAction({action:Ee,scope:"nearbyDevices",payload:{deviceName:Ye,cancel:!0}})}let Je=w.deviceName=="turbine",He,ht;function it(){n(2,Je=!1),n(4,ht=!1),n(3,He=!1)}const Oe=({deviceName:Ee})=>j.includes(Ee),qe=(Ee,Ye)=>Ye.deviceName==Ee,gt=({deviceName:Ee})=>X.includes(Ee),Nt=(Ee,Ye)=>Ye.deviceName==Ee,We=()=>{ue("delayed-open")},et=()=>{ue("open")},de=()=>{ue("add-delay")},Ze=()=>{ue("cancel-opening")},Dt=()=>{n(2,Je=!0)},Xt=()=>{De("move")},St=()=>{De("personal-entry")},$t=()=>{n(3,He=!0)},Ot=()=>{De("keep-open")},Mt=()=>{De("close")},Ft=()=>{n(4,ht=!0),be("vol-report")},fn=()=>{be("hdmi1")},_n=()=>{be("hdmi2")},pn=()=>{be("off")},Ht=()=>{be("vol-up")},At=()=>{be("vol-down")},vt=()=>{be("vol-default")},Tt=()=>{be("mute")},Et=Ee=>{ft("sleep",Ee)},lt=Ee=>{Xe("sleep",Ee)},ct=Ee=>{ft("sleep",Ee)},rt=Ee=>{Ae("sleep",Ee)},Jt=(Ee,Ye)=>Ye.deviceName==Ee,Ut=Ee=>{ft("kid_sleep",Ee)},te=(Ee,Ye)=>Ye.deviceName==Ee,$e=Ee=>{Xe("kid_sleep",Ee)},nn=Ee=>{ft("kid_sleep",Ee)},bn=Ee=>{Ae("kid_sleep",Ee)},sn=()=>{ot("on")},on=()=>{ot("off")},en=()=>{ot("off-delay")},Bt=()=>{ye("enable")},Pt=()=>{ye("disable")},zt=()=>{it(),window.scrollTo({top:0,behavior:"smooth"})};return t.$$set=Ee=>{"localDevice"in Ee&&n(0,w=Ee.localDevice),"nearbyDevices"in Ee&&n(1,S=Ee.nearbyDevices)},t.$$.update=()=>{var Ee,Ye,Lt,rn,vn;t.$$.dirty[0]&1073741824&&n(11,r=(Ee=p.entryDoor)==null?void 0:Ee.counter),t.$$.dirty[0]&1073741824&&n(10,i=(Ye=p.parkingDoor)==null?void 0:Ye.keepOpenInProgress),t.$$.dirty[0]&1073741824&&n(9,s=(Lt=p.parkingDoor)==null?void 0:Lt.personalEntryInProgress),t.$$.dirty[0]&1073741824&&n(8,l=(rn=p.lights)==null?void 0:rn.labLightOffDelay),t.$$.dirty[0]&1073741824&&n(7,c=(vn=p.lights)==null?void 0:vn.labLightOffDelayStr),t.$$.dirty[0]&1073741824&&n(6,u=p.deviceSleepStarter),t.$$.dirty[0]&1073741824&&n(5,h=p.kidSleepStarter)},[w,S,Je,He,ht,h,u,c,l,s,i,r,b,m,y,k,G,X,j,q,z,be,ye,ue,De,ot,Xe,ft,Ae,it,p,Oe,qe,gt,Nt,We,et,de,Ze,Dt,Xt,St,$t,Ot,Mt,Ft,fn,_n,pn,Ht,At,vt,Tt,Et,lt,ct,rt,Jt,Ut,te,$e,nn,bn,sn,on,en,Bt,Pt,zt]}class Ma extends dt{constructor(e){super(),ut(this,e,Ia,Na,at,{localDevice:0,nearbyDevices:1},null,[-1,-1,-1])}}function Ua(t){let e,n=Tf(t[2])+"",r,i,s=t[1].replace("blinds","")+"",l,c,u,h;return{c(){e=M("button"),r=B(n),i=F(),l=B(s),e.disabled=c=!t[4],L(e,"class","svelte-1u4dkh7"),ce(e,"moving",t[3]&&t[3][mn(t[0],t[1],t[2])]&&t[3][mn(t[0],t[1],t[2])].blindsStatus=="moving"),ce(e,"present",t[3]&&t[3][mn(t[0],t[1],t[2])]&&t[3][mn(t[0],t[1],t[2])].present),ce(e,"disconnected",t[4]==!1)},m(p,b){C(p,e,b),O(e,r),O(e,i),O(e,l),u||(h=Se(e,"click",t[10]),u=!0)},p(p,[b]){b&4&&n!==(n=Tf(p[2])+"")&&Ie(r,n),b&2&&s!==(s=p[1].replace("blinds","")+"")&&Ie(l,s),b&16&&c!==(c=!p[4])&&(e.disabled=c),b&15&&ce(e,"moving",p[3]&&p[3][mn(p[0],p[1],p[2])]&&p[3][mn(p[0],p[1],p[2])].blindsStatus=="moving"),b&15&&ce(e,"present",p[3]&&p[3][mn(p[0],p[1],p[2])]&&p[3][mn(p[0],p[1],p[2])].present),b&16&&ce(e,"disconnected",p[4]==!1)},i:ge,o:ge,d(p){p&&T(e),u=!1,h()}}}function Tf(t){return t=="up"?"▲":"▼"}function mn(t,e,n){return`${t}-${e}-${n}`}function La(t,e,n){let r,i,s,{connector:l}=e,{placeId:c}=e,{blindsId:u}=e,{blindsDirection:h}=e;const{state:p,connected:b}=l;wt(t,p,S=>n(9,i=S)),wt(t,b,S=>n(4,s=S));function m(S,P){l.signal("action",{action:S,scope:"iot",payload:P})}function y(S,P,k){m("blinds",{placeId:S,blindsId:P,blindsDirection:k,blindsAction:"move"})}const w=()=>y(c,u,h);return t.$$set=S=>{"connector"in S&&n(8,l=S.connector),"placeId"in S&&n(0,c=S.placeId),"blindsId"in S&&n(1,u=S.blindsId),"blindsDirection"in S&&n(2,h=S.blindsDirection)},t.$$.update=()=>{t.$$.dirty&512&&n(3,r=i.blinds)},[c,u,h,r,s,p,b,y,l,i,w]}class mt extends dt{constructor(e){super(),ut(this,e,La,Ua,at,{connector:8,placeId:0,blindsId:1,blindsDirection:2})}}function ja(t){let e,n,r,i,s,l,c,u,h,p,b,m,y,w,S,P,k,G,X,j,q;return s=new mt({props:{placeId:"ap1",blindsId:"blinds4",blindsDirection:"up",connector:t[0]}}),c=new mt({props:{placeId:"ap1",blindsId:"blinds3",blindsDirection:"up",connector:t[0]}}),h=new mt({props:{placeId:"ap1",blindsId:"blinds2",blindsDirection:"up",connector:t[0]}}),b=new mt({props:{placeId:"ap1",blindsId:"blinds1",blindsDirection:"up",connector:t[0]}}),w=new mt({props:{placeId:"ap1",blindsId:"blinds4",blindsDirection:"down",connector:t[0]}}),P=new mt({props:{placeId:"ap1",blindsId:"blinds3",blindsDirection:"down",connector:t[0]}}),G=new mt({props:{placeId:"ap1",blindsId:"blinds2",blindsDirection:"down",connector:t[0]}}),j=new mt({props:{placeId:"ap1",blindsId:"blinds1",blindsDirection:"down",connector:t[0]}}),{c(){e=M("div"),n=M("h2"),n.textContent="Rolete",r=F(),i=M("div"),Ke(s.$$.fragment),l=F(),Ke(c.$$.fragment),u=B(`
        —
        `),Ke(h.$$.fragment),p=F(),Ke(b.$$.fragment),m=F(),y=M("div"),Ke(w.$$.fragment),S=F(),Ke(P.$$.fragment),k=B(`
        —
        `),Ke(G.$$.fragment),X=F(),Ke(j.$$.fragment),L(i,"class","iot section svelte-1kxggon"),L(y,"class","iot section svelte-1kxggon"),L(e,"class","blinds_ap1")},m(z,be){C(z,e,be),O(e,n),O(e,r),O(e,i),je(s,i,null),O(i,l),je(c,i,null),O(i,u),je(h,i,null),O(i,p),je(b,i,null),O(e,m),O(e,y),je(w,y,null),O(y,S),je(P,y,null),O(y,k),je(G,y,null),O(y,X),je(j,y,null),q=!0},p(z,be){const ye={};be&1&&(ye.connector=z[0]),s.$set(ye);const ue={};be&1&&(ue.connector=z[0]),c.$set(ue);const De={};be&1&&(De.connector=z[0]),h.$set(De);const ot={};be&1&&(ot.connector=z[0]),b.$set(ot);const Xe={};be&1&&(Xe.connector=z[0]),w.$set(Xe);const ft={};be&1&&(ft.connector=z[0]),P.$set(ft);const Ae={};be&1&&(Ae.connector=z[0]),G.$set(Ae);const Je={};be&1&&(Je.connector=z[0]),j.$set(Je)},i(z){q||(re(s.$$.fragment,z),re(c.$$.fragment,z),re(h.$$.fragment,z),re(b.$$.fragment,z),re(w.$$.fragment,z),re(P.$$.fragment,z),re(G.$$.fragment,z),re(j.$$.fragment,z),q=!0)},o(z){we(s.$$.fragment,z),we(c.$$.fragment,z),we(h.$$.fragment,z),we(b.$$.fragment,z),we(w.$$.fragment,z),we(P.$$.fragment,z),we(G.$$.fragment,z),we(j.$$.fragment,z),q=!1},d(z){z&&T(e),Be(s),Be(c),Be(h),Be(b),Be(w),Be(P),Be(G),Be(j)}}}function Ba(t){let e,n,r,i,s,l,c,u,h,p,b,m,y,w,S,P,k,G,X,j,q,z,be,ye,ue,De,ot,Xe,ft;return s=new mt({props:{placeId:"ap2",blindsId:"blinds6",blindsDirection:"up",connector:t[0]}}),c=new mt({props:{placeId:"ap2",blindsId:"blinds5",blindsDirection:"up",connector:t[0]}}),h=new mt({props:{placeId:"ap2",blindsId:"blinds4",blindsDirection:"up",connector:t[0]}}),b=new mt({props:{placeId:"ap2",blindsId:"blinds3",blindsDirection:"up",connector:t[0]}}),y=new mt({props:{placeId:"ap2",blindsId:"blinds2",blindsDirection:"up",connector:t[0]}}),S=new mt({props:{placeId:"ap2",blindsId:"blinds1",blindsDirection:"up",connector:t[0]}}),G=new mt({props:{placeId:"ap2",blindsId:"blinds6",blindsDirection:"down",connector:t[0]}}),j=new mt({props:{placeId:"ap2",blindsId:"blinds5",blindsDirection:"down",connector:t[0]}}),z=new mt({props:{placeId:"ap2",blindsId:"blinds4",blindsDirection:"down",connector:t[0]}}),ye=new mt({props:{placeId:"ap2",blindsId:"blinds3",blindsDirection:"down",connector:t[0]}}),De=new mt({props:{placeId:"ap2",blindsId:"blinds2",blindsDirection:"down",connector:t[0]}}),Xe=new mt({props:{placeId:"ap2",blindsId:"blinds1",blindsDirection:"down",connector:t[0]}}),{c(){e=M("div"),n=M("h2"),n.textContent="Rolete",r=F(),i=M("div"),Ke(s.$$.fragment),l=F(),Ke(c.$$.fragment),u=B(`
        —
        `),Ke(h.$$.fragment),p=F(),Ke(b.$$.fragment),m=B(`
        —
        `),Ke(y.$$.fragment),w=F(),Ke(S.$$.fragment),P=F(),k=M("div"),Ke(G.$$.fragment),X=F(),Ke(j.$$.fragment),q=B(`
        —
        `),Ke(z.$$.fragment),be=F(),Ke(ye.$$.fragment),ue=B(`
        —
        `),Ke(De.$$.fragment),ot=F(),Ke(Xe.$$.fragment),L(i,"class","iot section svelte-1kxggon"),L(k,"class","iot section svelte-1kxggon"),L(e,"class","blinds_ap2 svelte-1kxggon"),ce(e,"visible",Ka)},m(Ae,Je){C(Ae,e,Je),O(e,n),O(e,r),O(e,i),je(s,i,null),O(i,l),je(c,i,null),O(i,u),je(h,i,null),O(i,p),je(b,i,null),O(i,m),je(y,i,null),O(i,w),je(S,i,null),O(e,P),O(e,k),je(G,k,null),O(k,X),je(j,k,null),O(k,q),je(z,k,null),O(k,be),je(ye,k,null),O(k,ue),je(De,k,null),O(k,ot),je(Xe,k,null),ft=!0},p(Ae,Je){const He={};Je&1&&(He.connector=Ae[0]),s.$set(He);const ht={};Je&1&&(ht.connector=Ae[0]),c.$set(ht);const it={};Je&1&&(it.connector=Ae[0]),h.$set(it);const Oe={};Je&1&&(Oe.connector=Ae[0]),b.$set(Oe);const qe={};Je&1&&(qe.connector=Ae[0]),y.$set(qe);const gt={};Je&1&&(gt.connector=Ae[0]),S.$set(gt);const Nt={};Je&1&&(Nt.connector=Ae[0]),G.$set(Nt);const We={};Je&1&&(We.connector=Ae[0]),j.$set(We);const et={};Je&1&&(et.connector=Ae[0]),z.$set(et);const de={};Je&1&&(de.connector=Ae[0]),ye.$set(de);const Ze={};Je&1&&(Ze.connector=Ae[0]),De.$set(Ze);const Dt={};Je&1&&(Dt.connector=Ae[0]),Xe.$set(Dt)},i(Ae){ft||(re(s.$$.fragment,Ae),re(c.$$.fragment,Ae),re(h.$$.fragment,Ae),re(b.$$.fragment,Ae),re(y.$$.fragment,Ae),re(S.$$.fragment,Ae),re(G.$$.fragment,Ae),re(j.$$.fragment,Ae),re(z.$$.fragment,Ae),re(ye.$$.fragment,Ae),re(De.$$.fragment,Ae),re(Xe.$$.fragment,Ae),ft=!0)},o(Ae){we(s.$$.fragment,Ae),we(c.$$.fragment,Ae),we(h.$$.fragment,Ae),we(b.$$.fragment,Ae),we(y.$$.fragment,Ae),we(S.$$.fragment,Ae),we(G.$$.fragment,Ae),we(j.$$.fragment,Ae),we(z.$$.fragment,Ae),we(ye.$$.fragment,Ae),we(De.$$.fragment,Ae),we(Xe.$$.fragment,Ae),ft=!1},d(Ae){Ae&&T(e),Be(s),Be(c),Be(h),Be(b),Be(y),Be(S),Be(G),Be(j),Be(z),Be(ye),Be(De),Be(Xe)}}}function za(t){let e,n,r,i;const s=[Ba,ja],l=[];function c(u,h){return u[1].deviceName=="tv-ap2"?0:1}return n=c(t),r=l[n]=s[n](t),{c(){e=M("main"),r.c(),L(e,"class","svelte-1kxggon")},m(u,h){C(u,e,h),l[n].m(e,null),i=!0},p(u,[h]){let p=n;n=c(u),n===p?l[n].p(u,h):(kt(),we(l[p],1,1,()=>{l[p]=null}),Ct(),r=l[n],r?r.p(u,h):(r=l[n]=s[n](u),r.c()),re(r,1),r.m(e,null))},i(u){i||(re(r),i=!0)},o(u){we(r),i=!1},d(u){u&&T(e),l[n].d()}}}let Ka=!1;function qa(t,e,n){let r,i,{connector:s}=e;const{state:l,connected:c}=s;return wt(t,l,u=>n(3,i=u)),t.$$set=u=>{"connector"in u&&n(0,s=u.connector)},t.$$.update=()=>{t.$$.dirty&8&&n(1,r=i.device)},[s,r,l,i]}class Ya extends dt{constructor(e){super(),ut(this,e,qa,za,at,{connector:0})}}function kf(t,e,n){const r=t.slice();return r[3]=e[n],r}function Cf(t){let e,n=t[1].slice(0,4),r=[];for(let i=0;i<n.length;i+=1)r[i]=Nf(kf(t,n,i));return{c(){e=M("div");for(let i=0;i<r.length;i+=1)r[i].c();L(e,"class","notifications svelte-9jalg6")},m(i,s){C(i,e,s);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(i,s){if(s&2){n=i[1].slice(0,4);let l;for(l=0;l<n.length;l+=1){const c=kf(i,n,l);r[l]?r[l].p(c,s):(r[l]=Nf(c),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(i){i&&T(e),wn(r,i)}}}function Rf(t){let e,n=t[3].title+"",r;return{c(){e=M("div"),r=B(n),L(e,"class","title svelte-9jalg6")},m(i,s){C(i,e,s),O(e,r)},p(i,s){s&2&&n!==(n=i[3].title+"")&&Ie(r,n)},d(i){i&&T(e)}}}function Fa(t){let e,n=t[3].relativeTimeAdded+"",r;return{c(){e=M("div"),r=B(n),L(e,"class","time svelte-9jalg6")},m(i,s){C(i,e,s),O(e,r)},p(i,s){s&2&&n!==(n=i[3].relativeTimeAdded+"")&&Ie(r,n)},d(i){i&&T(e)}}}function Ha(t){let e,n=t[3].replaceTtl+"",r;return{c(){e=M("div"),r=B(n),L(e,"class","time svelte-9jalg6")},m(i,s){C(i,e,s),O(e,r)},p(i,s){s&2&&n!==(n=i[3].replaceTtl+"")&&Ie(r,n)},d(i){i&&T(e)}}}function Nf(t){let e,n,r=t[3].msg+"",i,s,l,c=t[3].title&&Rf(t);function u(b,m){if(b[3].replaceTtl)return Ha;if(!b[3].omitTtl)return Fa}let h=u(t),p=h&&h(t);return{c(){e=M("div"),c&&c.c(),n=F(),i=B(r),s=F(),p&&p.c(),l=F(),L(e,"class","notification svelte-9jalg6"),nr(e,"color",t[3].color),nr(e,"background-color",t[3].bgColor)},m(b,m){C(b,e,m),c&&c.m(e,null),O(e,n),O(e,i),O(e,s),p&&p.m(e,null),O(e,l)},p(b,m){b[3].title?c?c.p(b,m):(c=Rf(b),c.c(),c.m(e,n)):c&&(c.d(1),c=null),m&2&&r!==(r=b[3].msg+"")&&Ie(i,r),h===(h=u(b))&&p?p.p(b,m):(p&&p.d(1),p=h&&h(b),p&&(p.c(),p.m(e,l))),m&2&&nr(e,"color",b[3].color),m&2&&nr(e,"background-color",b[3].bgColor)},d(b){b&&T(e),c&&c.d(),p&&p.d()}}}function Ja(t){let e,n=t[1]&&t[1].length&&Cf(t);return{c(){n&&n.c(),e=bt()},m(r,i){n&&n.m(r,i),C(r,e,i)},p(r,[i]){r[1]&&r[1].length?n?n.p(r,i):(n=Cf(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ge,o:ge,d(r){n&&n.d(r),r&&T(e)}}}function Wa(t,e,n){let r,i,s=ge,l=()=>(s(),s=Rt(c,u=>n(2,i=u)),c);t.$$.on_destroy.push(()=>s());let{store:c}=e;return l(),t.$$set=u=>{"store"in u&&l(n(0,c=u.store))},t.$$.update=()=>{t.$$.dirty&4&&n(1,r=i.notifications.slice().reverse())},[c,r,i]}class Za extends dt{constructor(e){super(),ut(this,e,Wa,Ja,at,{store:0})}}const Wt=tn([]);Wt.LIMIT=300;Wt.log=(t,{dedup:e=!1}={})=>{Wt.update(n=>(e&&n.length>0&&n[n.length-1].entry==t&&n.pop(),n.push({entry:t,createdDate:new Date,createdAt:Date.now(),isRecent:!0,isVeryRecent:!0}),n.slice(-Wt.LIMIT)))};function Is(){const t=Date.now();Wt.update(e=>{for(const n of e)n.isRecent=t-n.createdAt<6e4,n.isVeryRecent=t-n.createdAt<5e3;return e}),setTimeout(Is,1e3)}Is();function Df(t,e,n){const r=t.slice();return r[11]=e[n].time,r[12]=e[n].entry,r[13]=e[n].isRecent,r[14]=e[n].isVeryRecent,r[15]=e[n].createdAt,r[17]=n,r}function $f(t){let e,n;return{c(){e=M("h2"),n=B(t[0]),L(e,"class","title svelte-jdzn25")},m(r,i){C(r,e,i),O(e,n)},p(r,i){i&1&&Ie(n,r[0])},d(r){r&&T(e)}}}function Ga(t){let e,n,r;return{c(){e=M("button"),e.textContent="Show Log",L(e,"class","svelte-jdzn25")},m(i,s){C(i,e,s),n||(r=Se(e,"click",t[8]),n=!0)},p:ge,i:ge,o:ge,d(i){i&&T(e),n=!1,r()}}}function Va(t){let e,n,r;const i=t[7].default,s=Gf(i,t,t[6],null);let l=t[2].map(If),c=[];for(let u=0;u<l.length;u+=1)c[u]=Pf(Df(t,l,u));return{c(){s&&s.c(),e=F();for(let u=0;u<c.length;u+=1)c[u].c();n=bt()},m(u,h){s&&s.m(u,h),C(u,e,h);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(u,h);C(u,n,h),r=!0},p(u,h){if(s&&s.p&&(!r||h&64)&&Xf(s,i,u,u[6],r?Qf(i,u[6],h,null):es(u[6]),null),h&4){l=u[2].map(If);let p;for(p=0;p<l.length;p+=1){const b=Df(u,l,p);c[p]?c[p].p(b,h):(c[p]=Pf(b),c[p].c(),c[p].m(n.parentNode,n))}for(;p<c.length;p+=1)c[p].d(1);c.length=l.length}},i(u){r||(re(s,u),r=!0)},o(u){we(s,u),r=!1},d(u){s&&s.d(u),u&&T(e),wn(c,u),u&&T(n)}}}function Qa(t){let e=t[11]+"",n;return{c(){n=B(e)},m(r,i){C(r,n,i)},p(r,i){i&4&&e!==(e=r[11]+"")&&Ie(n,e)},d(r){r&&T(n)}}}function Xa(t){let e;function n(s,l){return s[15]-s[2][s[17]+1].createdAt<1e4?tu:eu}let r=n(t),i=r(t);return{c(){i.c(),e=bt()},m(s,l){i.m(s,l),C(s,e,l)},p(s,l){r===(r=n(s))&&i?i.p(s,l):(i.d(1),i=r(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){i.d(s),s&&T(e)}}}function eu(t){let e=t[11]+"",n;return{c(){n=B(e)},m(r,i){C(r,n,i)},p(r,i){i&4&&e!==(e=r[11]+"")&&Ie(n,e)},d(r){r&&T(n)}}}function tu(t){let e,n,r=t[15]-t[2][t[17]+1].createdAt+"",i,s;return{c(){e=M("span"),n=B("+"),i=B(r),s=B("ms"),L(e,"class","diff svelte-jdzn25")},m(l,c){C(l,e,c),O(e,n),O(e,i),O(e,s)},p(l,c){c&4&&r!==(r=l[15]-l[2][l[17]+1].createdAt+"")&&Ie(i,r)},d(l){l&&T(e)}}}function Pf(t){let e,n,r,i=t[12]+"",s,l;function c(p,b){return p[17]<p[2].length-1?Xa:Qa}let u=c(t),h=u(t);return{c(){e=M("div"),n=M("span"),h.c(),r=F(),s=B(i),l=F(),L(n,"class","time svelte-jdzn25"),L(e,"class","log_entry svelte-jdzn25"),ce(e,"recent",t[13]),ce(e,"very_recent",t[14])},m(p,b){C(p,e,b),O(e,n),h.m(n,null),O(e,r),O(e,s),O(e,l)},p(p,b){u===(u=c(p))&&h?h.p(p,b):(h.d(1),h=u(p),h&&(h.c(),h.m(n,null))),b&4&&i!==(i=p[12]+"")&&Ie(s,i),b&4&&ce(e,"recent",p[13]),b&4&&ce(e,"very_recent",p[14])},d(p){p&&T(e),h.d()}}}function nu(t){let e,n,r,i,s,l=t[0]&&$f(t);const c=[Va,Ga],u=[];function h(p,b){return p[1]?0:1}return r=h(t),i=u[r]=c[r](t),{c(){e=M("div"),l&&l.c(),n=F(),i.c(),L(e,"class","logview svelte-jdzn25")},m(p,b){C(p,e,b),l&&l.m(e,null),O(e,n),u[r].m(e,null),s=!0},p(p,[b]){p[0]?l?l.p(p,b):(l=$f(p),l.c(),l.m(e,n)):l&&(l.d(1),l=null);let m=r;r=h(p),r===m?u[r].p(p,b):(kt(),we(u[m],1,1,()=>{u[m]=null}),Ct(),i=u[r],i?i.p(p,b):(i=u[r]=c[r](p),i.c()),re(i,1),i.m(e,null))},i(p){s||(re(i),s=!0)},o(p){we(i),s=!1},d(p){p&&T(e),l&&l.d(),u[r].d()}}}const If=t=>{const e=t.createdDate.toLocaleString().split(",")[1];return{...t,time:e}};function ru(t,e,n){let r,i;wt(t,Wt,w=>n(5,i=w));let{$$slots:s={},$$scope:l}=e,{showLogInitially:c=!0}=e,{title:u}=e,{limit:h=0}=e;h>Wt.LIMIT&&(console.log(`Warning: provided LogView line limit (${h}) is larger than logStore limit  (${Wt.LIMIT})`),console.log("Utilizing the lower value ..."),h=Wt.LIMIT);let p=c,b;function m(){const w=Date.now();b&&w-b>500&&Wt.log("——— Context switch / App wake ———",{dedup:!0}),b=w,setTimeout(m,300)}m();const y=()=>{n(1,p=!0)};return t.$$set=w=>{"showLogInitially"in w&&n(4,c=w.showLogInitially),"title"in w&&n(0,u=w.title),"limit"in w&&n(3,h=w.limit),"$$scope"in w&&n(6,l=w.$$scope)},t.$$.update=()=>{t.$$.dirty&40&&n(2,r=i.slice(-h).reverse())},[u,p,r,h,c,i,l,s,y]}class Ms extends dt{constructor(e){super(),ut(this,e,ru,nu,at,{showLogInitially:4,title:0,limit:3})}}function iu(t){let e,n,r,i,s;return{c(){e=M("div"),n=M("span"),n.textContent="DMT",r=F(),i=M("span"),s=B(t[0]),L(n,"class","dmt svelte-vrzjix"),L(i,"class","app svelte-vrzjix")},m(l,c){C(l,e,c),O(e,n),O(e,r),O(e,i),O(i,s)},p(l,[c]){c&1&&Ie(s,l[0])},i:ge,o:ge,d(l){l&&T(e)}}}function fu(t,e,n){let{dmtApp:r}=e;return t.$$set=i=>{"dmtApp"in i&&n(0,r=i.dmtApp)},[r]}class su extends dt{constructor(e){super(),ut(this,e,fu,iu,at,{dmtApp:0})}}function ou(t){let e,n,r,i,s,l,c=".".repeat(t[1])+"",u,h,p,b,m;n=new su({props:{dmtApp:t[0]}});const y=t[3].default,w=Gf(y,t,t[2],null);return{c(){e=M("div"),Ke(n.$$.fragment),r=F(),i=M("p"),s=B("Connecting "),l=M("span"),u=B(c),h=F(),w&&w.c(),L(l,"class","svelte-mtqbfw"),L(i,"class","svelte-mtqbfw"),L(e,"class","wrapper svelte-mtqbfw")},m(S,P){C(S,e,P),je(n,e,null),O(e,r),O(e,i),O(i,s),O(i,l),O(l,u),O(e,h),w&&w.m(e,null),m=!0},p(S,[P]){const k={};P&1&&(k.dmtApp=S[0]),n.$set(k),(!m||P&2)&&c!==(c=".".repeat(S[1])+"")&&Ie(u,c),w&&w.p&&(!m||P&4)&&Xf(w,y,S,S[2],m?Qf(y,S[2],P,null):es(S[2]),null)},i(S){m||(re(n.$$.fragment,S),re(w,S),jt(()=>{m&&(b&&b.end(1),p=hn(e,xn,{}),p.start())}),m=!0)},o(S){we(n.$$.fragment,S),we(w,S),p&&p.invalidate(),b=Ao(e,xn,{}),m=!1},d(S){S&&T(e),Be(n),w&&w.d(S),S&&b&&b.end()}}}const lu=5;function cu(t,e,n){let{$$slots:r={},$$scope:i}=e,{dmtApp:s}=e,l=1,c=!0;return mo(()=>{const u=setInterval(()=>{n(1,l=l+(c?1:-1)),l==lu&&(c=!1),l==1&&(c=!0)},500);return()=>clearInterval(u)}),t.$$set=u=>{"dmtApp"in u&&n(0,s=u.dmtApp),"$$scope"in u&&n(2,i=u.$$scope)},[s,l,i,r]}class au extends dt{constructor(e){super(),ut(this,e,cu,ou,at,{dmtApp:0})}}function Mf(t,e,n){const r=t.slice();return r[2]=e[n],r}function Uf(t){let e,n=t[1].errors.slice(0,3),r=[];for(let i=0;i<n.length;i+=1)r[i]=jf(Mf(t,n,i));return{c(){e=M("div");for(let i=0;i<r.length;i+=1)r[i].c();L(e,"class","errors svelte-1nzvkt5")},m(i,s){C(i,e,s);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(i,s){if(s&2){n=i[1].errors.slice(0,3);let l;for(l=0;l<n.length;l+=1){const c=Mf(i,n,l);r[l]?r[l].p(c,s):(r[l]=jf(c),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(i){i&&T(e),wn(r,i)}}}function Lf(t){let e=t[2].stacktrace+"",n;return{c(){n=B(e)},m(r,i){C(r,n,i)},p(r,i){i&2&&e!==(e=r[2].stacktrace+"")&&Ie(n,e)},d(r){r&&T(n)}}}function jf(t){let e,n,r,i,s,l=t[2].time+"",c,u,h,p=t[2].msg+"",b,m,y,w=t[2].stacktrace&&Lf(t);return{c(){e=M("div"),n=M("div"),r=M("span"),i=B("⚠️ Error at "),s=M("span"),c=B(l),u=F(),h=M("span"),b=B(p),m=F(),w&&w.c(),y=F(),L(s,"class","time svelte-1nzvkt5"),L(r,"class","title svelte-1nzvkt5"),L(h,"class","msg svelte-1nzvkt5"),L(n,"class","header svelte-1nzvkt5"),L(e,"class","error svelte-1nzvkt5"),ce(e,"cors_problem",t[2].corsProblem)},m(S,P){C(S,e,P),O(e,n),O(n,r),O(r,i),O(r,s),O(s,c),O(n,u),O(n,h),O(h,b),O(e,m),w&&w.m(e,null),O(e,y)},p(S,P){P&2&&l!==(l=S[2].time+"")&&Ie(c,l),P&2&&p!==(p=S[2].msg+"")&&Ie(b,p),S[2].stacktrace?w?w.p(S,P):(w=Lf(S),w.c(),w.m(e,y)):w&&(w.d(1),w=null),P&2&&ce(e,"cors_problem",S[2].corsProblem)},d(S){S&&T(e),w&&w.d()}}}function uu(t){var r;let e,n=((r=t[1])==null?void 0:r.errors.length)&&Uf(t);return{c(){n&&n.c(),e=bt()},m(i,s){n&&n.m(i,s),C(i,e,s)},p(i,[s]){var l;(l=i[1])!=null&&l.errors.length?n?n.p(i,s):(n=Uf(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:ge,o:ge,d(i){n&&n.d(i),i&&T(e)}}}function du(t,e,n){let r,i=ge,s=()=>(i(),i=Rt(l,c=>n(1,r=c)),l);t.$$.on_destroy.push(()=>i());let{errorStore:l}=e;return s(),t.$$set=c=>{"errorStore"in c&&s(n(0,l=c.errorStore))},[l,r]}class hu extends dt{constructor(e){super(),ut(this,e,du,uu,at,{errorStore:0})}}function _u({store:t,action:e,payload:n}){console.log(`Action: ${e}`),t.signal("action",{action:e,scope:"player",payload:n})}function pu(t){let e,n;return e=new au({props:{dmtApp:"Mobile",$$slots:{default:[vu]},$$scope:{ctx:t}}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p(r,i){const s={};i&131072&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function bu(t){let e,n,r,i,s,l,c,u,h=(t[2].deviceKey=="ed4f0a8f470b3024f25c60a54cf832584c2c16081f364fabebc77186ae11d626"||t[2].deviceName=="turbine")&&Bf(t),p=t[2].network=="zaboric"&&zf(t),b=t[2].deviceName!="tv-ap2"&&Kf(t);i=new Io({props:{connected:t[9],device:t[3],nearbyDevices:t[6],deviceName:t[8],activeDeviceKey:t[5],player:t[7]}});let m=t[2].deviceName!="tv-ap2"&&qf(t);return c=new Il({props:{connected:t[9],player:t[7],deviceName:t[8],store:t[0],fnAction:t[12]}}),{c(){h&&h.c(),e=F(),p&&p.c(),n=F(),b&&b.c(),r=F(),Ke(i.$$.fragment),s=F(),m&&m.c(),l=F(),Ke(c.$$.fragment)},m(y,w){h&&h.m(y,w),C(y,e,w),p&&p.m(y,w),C(y,n,w),b&&b.m(y,w),C(y,r,w),je(i,y,w),C(y,s,w),m&&m.m(y,w),C(y,l,w),je(c,y,w),u=!0},p(y,w){y[2].deviceKey=="ed4f0a8f470b3024f25c60a54cf832584c2c16081f364fabebc77186ae11d626"||y[2].deviceName=="turbine"?h?(h.p(y,w),w&4&&re(h,1)):(h=Bf(y),h.c(),re(h,1),h.m(e.parentNode,e)):h&&(kt(),we(h,1,1,()=>{h=null}),Ct()),y[2].network=="zaboric"?p?(p.p(y,w),w&4&&re(p,1)):(p=zf(y),p.c(),re(p,1),p.m(n.parentNode,n)):p&&(kt(),we(p,1,1,()=>{p=null}),Ct()),y[2].deviceName!="tv-ap2"?b?(b.p(y,w),w&4&&re(b,1)):(b=Kf(y),b.c(),re(b,1),b.m(r.parentNode,r)):b&&(kt(),we(b,1,1,()=>{b=null}),Ct());const S={};w&8&&(S.device=y[3]),w&64&&(S.nearbyDevices=y[6]),w&256&&(S.deviceName=y[8]),w&32&&(S.activeDeviceKey=y[5]),w&128&&(S.player=y[7]),i.$set(S),y[2].deviceName!="tv-ap2"?m?(m.p(y,w),w&4&&re(m,1)):(m=qf(y),m.c(),re(m,1),m.m(l.parentNode,l)):m&&(kt(),we(m,1,1,()=>{m=null}),Ct());const P={};w&128&&(P.player=y[7]),w&256&&(P.deviceName=y[8]),w&1&&(P.store=y[0]),c.$set(P)},i(y){u||(re(h),re(p),re(b),re(i.$$.fragment,y),re(m),re(c.$$.fragment,y),u=!0)},o(y){we(h),we(p),we(b),we(i.$$.fragment,y),we(m),we(c.$$.fragment,y),u=!1},d(y){h&&h.d(y),y&&T(e),p&&p.d(y),y&&T(n),b&&b.d(y),y&&T(r),Be(i,y),y&&T(s),m&&m.d(y),y&&T(l),Be(c,y)}}}function vu(t){let e,n;return e=new Ms({props:{showLogInitially:!0,limit:20}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p:ge,i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function Bf(t){let e,n;return e=new Ma({props:{connector:t[10],localDevice:t[2],nearbyDevices:t[6]}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p(r,i){const s={};i&4&&(s.localDevice=r[2]),i&64&&(s.nearbyDevices=r[6]),e.$set(s)},i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function zf(t){let e,n;return e=new Ya({props:{connector:t[10]}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p:ge,i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function Kf(t){let e,n;return e=new Za({props:{store:t[0]}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p(r,i){const s={};i&1&&(s.store=r[0]),e.$set(s)},i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function qf(t){let e,n;return e=new Ll({props:{nearbyDevices:t[6],activeDeviceKey:t[5],store:t[0],log:t[1]}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p(r,i){const s={};i&64&&(s.nearbyDevices=r[6]),i&32&&(s.activeDeviceKey=r[5]),i&1&&(s.store=r[0]),i&2&&(s.log=r[1]),e.$set(s)},i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function Yf(t){let e,n;return e=new Ms({props:{title:"Connectivity log",limit:200,showLogInitially:!1,$$slots:{default:[mu]},$$scope:{ctx:t}}}),{c(){Ke(e.$$.fragment)},m(r,i){je(e,r,i),n=!0},p(r,i){const s={};i&131088&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(re(e.$$.fragment,r),n=!0)},o(r){we(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function mu(t){let e,n,r,i,s,l,c;return{c(){e=M("p"),n=B("Gui active: "),r=M("span"),i=B(t[4]),s=B("s"),l=F(),c=M("span"),c.textContent="[ also indicates that this app is processing events ]",L(r,"class","svelte-gx051d"),L(c,"class","small svelte-gx051d"),L(e,"class","logview_counter svelte-gx051d")},m(u,h){C(u,e,h),O(e,n),O(e,r),O(r,i),O(r,s),O(e,l),O(e,c)},p(u,h){h&16&&Ie(i,u[4])},d(u){u&&T(e)}}}function yu(t){let e,n,r,i,s,l,c;n=new hu({props:{errorStore:hs}});const u=[bu,pu],h=[];function p(m,y){return m[2]?0:1}i=p(t),s=h[i]=u[i](t);let b=t[2]&&Yf(t);return{c(){e=M("main"),Ke(n.$$.fragment),r=F(),s.c(),l=F(),b&&b.c(),L(e,"class","svelte-gx051d")},m(m,y){C(m,e,y),je(n,e,null),O(e,r),h[i].m(e,null),O(e,l),b&&b.m(e,null),c=!0},p(m,[y]){let w=i;i=p(m),i===w?h[i].p(m,y):(kt(),we(h[w],1,1,()=>{h[w]=null}),Ct(),s=h[i],s?s.p(m,y):(s=h[i]=u[i](m),s.c()),re(s,1),s.m(e,l)),m[2]?b?(b.p(m,y),y&4&&re(b,1)):(b=Yf(m),b.c(),re(b,1),b.m(e,null)):b&&(kt(),we(b,1,1,()=>{b=null}),Ct())},i(m){c||(re(n.$$.fragment,m),re(s),re(b),c=!0)},o(m){we(n.$$.fragment,m),we(s),we(b),c=!1},d(m){m&&T(e),Be(n),h[i].d(),b&&b.d()}}}function gu(t,e,n){let r,i,s,l,c,u,h,p=ge,b=()=>(p(),p=Rt(y,q=>n(13,h=q)),y),m;t.$$.on_destroy.push(()=>p());let{store:y}=e;b();let{log:w}=e;const{connected:S,localConnector:P}=y,{state:k}=P;wt(t,k,q=>n(14,m=q));function G(q,z){bs(),_u({store:y,action:q,payload:z})}k.subscribe(q=>{var be;const z=(be=q==null?void 0:q.device)==null?void 0:be.network;_s.set(["zaboric","borovnjakova"].includes(z))});let X=0;function j(){n(4,X+=1),setTimeout(j,1e3)}return j(),t.$$set=q=>{"store"in q&&b(n(0,y=q.store)),"log"in q&&n(1,w=q.log)},t.$$.update=()=>{t.$$.dirty&8192&&n(3,r=h.device),t.$$.dirty&8192&&n(8,i=h.optimisticDeviceName),t.$$.dirty&16384&&n(2,s=m.device),t.$$.dirty&4&&(s==null||s.devMachine),t.$$.dirty&8192&&n(7,l=h.player||{}),t.$$.dirty&8192&&n(6,c=h.nearbyDevices?h.nearbyDevices.filter(q=>q.hasGui).sort(Co("deviceName")):[]),t.$$.dirty&8192&&n(5,u=h.activeDeviceKey)},[y,w,s,r,X,u,c,l,i,S,P,k,G,h,m]}class xu extends dt{constructor(e){super(),ut(this,e,gu,yu,at,{store:0,log:1})}}function wu(){}class $r{constructor(e,n,r){this.prev=e,this.next=n,this.fn=r||wu}run(e){this.fn(e),this.next&&this.next.run(e)}}class Au{constructor(e){this.head=new $r,this.tail=new $r(this.head),this.head.next=this.tail,this.linkConstructor=e,this.reg={}}insert(e){const n=new $r(this.tail.prev,this.tail,e);return n.next.prev=n,n.prev.next=n,n}remove(e){e.prev.next=e.next,e.next.prev=e.prev}}let Eu=0;class gr{constructor(){this.__events_list={}}on(e,n){const r=this.__events_list[e]||(this.__events_list[e]=new Au),i=n._eev||(n._eev=++Eu);r.reg[i]||(r.reg[i]=r.insert(n))}off(e,n){if(n){const r=this.__events_list[e];if(!r)return;const i=r.reg[n._eev];r.reg[n._eev]=void 0,r&&i&&r.remove(i)}}removeListener(...e){this.off(...e)}emit(e,n){const r=this.__events_list[e];r&&r.head.run(n)}}class Su extends gr{constructor(e){super(),this.state=e,this.subscriptions=[]}get(){return this.state}subscribe(e){return this.subscriptions.push(e),e(this.state),()=>{this.subscriptions=this.subscriptions.filter(n=>n!==e)}}announceStateChange(){this.subscriptions.forEach(e=>e(this.state))}}class qn extends Su{set(e){this.state=e,this.announceStateChange()}}class Ou extends qn{constructor(e={}){super(e)}set(e,{ignore:n=[]}={}){const r={};for(const i of n)r[i]=this.state[i];super.set({...e,...r})}setMerge(e){super.set({...this.state,...e})}clearState({except:e=[]}={}){for(const n of Object.keys(this.state))e.includes(n)||delete this.state[n]}}var Tu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Us(t,e,n){return n={path:e,exports:{},require:function(r,i){return Ls(r,i??n.path)}},t(n,n.exports),n.exports}function ku(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}),e}function Ls(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Cu={},Ru=Object.freeze({__proto__:null,default:Cu}),Nu=ku(Ru),Vt=Us(function(t){(function(e){var n=function(o){var d,a=new Float64Array(16);if(o)for(d=0;d<o.length;d++)a[d]=o[d];return a},r=function(){throw new Error("no PRNG")},i=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var l=n(),c=n([1]),u=n([56129,1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function w(o,d,a,f){o[d]=a>>24&255,o[d+1]=a>>16&255,o[d+2]=a>>8&255,o[d+3]=a&255,o[d+4]=f>>24&255,o[d+5]=f>>16&255,o[d+6]=f>>8&255,o[d+7]=f&255}function S(o,d,a,f,_){var g,x=0;for(g=0;g<_;g++)x|=o[d+g]^a[f+g];return(1&x-1>>>8)-1}function P(o,d,a,f){return S(o,d,a,f,16)}function k(o,d,a,f){return S(o,d,a,f,32)}function G(o,d,a,f){for(var _=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,N=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,U=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,Q=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,Y=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,Ce=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,J=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,ie=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,fe=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,he=a[16]&255|(a[17]&255)<<8|(a[18]&255)<<16|(a[19]&255)<<24,ae=a[20]&255|(a[21]&255)<<8|(a[22]&255)<<16|(a[23]&255)<<24,se=a[24]&255|(a[25]&255)<<8|(a[26]&255)<<16|(a[27]&255)<<24,le=a[28]&255|(a[29]&255)<<8|(a[30]&255)<<16|(a[31]&255)<<24,oe=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,W=_,ee=g,H=x,Z=N,V=U,K=Q,A=Y,E=Ce,$=J,R=ie,D=fe,I=he,ne=ae,_e=se,ve=le,pe=oe,v,xe=0;xe<20;xe+=2)v=W+ne|0,V^=v<<7|v>>>32-7,v=V+W|0,$^=v<<9|v>>>32-9,v=$+V|0,ne^=v<<13|v>>>32-13,v=ne+$|0,W^=v<<18|v>>>32-18,v=K+ee|0,R^=v<<7|v>>>32-7,v=R+K|0,_e^=v<<9|v>>>32-9,v=_e+R|0,ee^=v<<13|v>>>32-13,v=ee+_e|0,K^=v<<18|v>>>32-18,v=D+A|0,ve^=v<<7|v>>>32-7,v=ve+D|0,H^=v<<9|v>>>32-9,v=H+ve|0,A^=v<<13|v>>>32-13,v=A+H|0,D^=v<<18|v>>>32-18,v=pe+I|0,Z^=v<<7|v>>>32-7,v=Z+pe|0,E^=v<<9|v>>>32-9,v=E+Z|0,I^=v<<13|v>>>32-13,v=I+E|0,pe^=v<<18|v>>>32-18,v=W+Z|0,ee^=v<<7|v>>>32-7,v=ee+W|0,H^=v<<9|v>>>32-9,v=H+ee|0,Z^=v<<13|v>>>32-13,v=Z+H|0,W^=v<<18|v>>>32-18,v=K+V|0,A^=v<<7|v>>>32-7,v=A+K|0,E^=v<<9|v>>>32-9,v=E+A|0,V^=v<<13|v>>>32-13,v=V+E|0,K^=v<<18|v>>>32-18,v=D+R|0,I^=v<<7|v>>>32-7,v=I+D|0,$^=v<<9|v>>>32-9,v=$+I|0,R^=v<<13|v>>>32-13,v=R+$|0,D^=v<<18|v>>>32-18,v=pe+ve|0,ne^=v<<7|v>>>32-7,v=ne+pe|0,_e^=v<<9|v>>>32-9,v=_e+ne|0,ve^=v<<13|v>>>32-13,v=ve+_e|0,pe^=v<<18|v>>>32-18;W=W+_|0,ee=ee+g|0,H=H+x|0,Z=Z+N|0,V=V+U|0,K=K+Q|0,A=A+Y|0,E=E+Ce|0,$=$+J|0,R=R+ie|0,D=D+fe|0,I=I+he|0,ne=ne+ae|0,_e=_e+se|0,ve=ve+le|0,pe=pe+oe|0,o[0]=W>>>0&255,o[1]=W>>>8&255,o[2]=W>>>16&255,o[3]=W>>>24&255,o[4]=ee>>>0&255,o[5]=ee>>>8&255,o[6]=ee>>>16&255,o[7]=ee>>>24&255,o[8]=H>>>0&255,o[9]=H>>>8&255,o[10]=H>>>16&255,o[11]=H>>>24&255,o[12]=Z>>>0&255,o[13]=Z>>>8&255,o[14]=Z>>>16&255,o[15]=Z>>>24&255,o[16]=V>>>0&255,o[17]=V>>>8&255,o[18]=V>>>16&255,o[19]=V>>>24&255,o[20]=K>>>0&255,o[21]=K>>>8&255,o[22]=K>>>16&255,o[23]=K>>>24&255,o[24]=A>>>0&255,o[25]=A>>>8&255,o[26]=A>>>16&255,o[27]=A>>>24&255,o[28]=E>>>0&255,o[29]=E>>>8&255,o[30]=E>>>16&255,o[31]=E>>>24&255,o[32]=$>>>0&255,o[33]=$>>>8&255,o[34]=$>>>16&255,o[35]=$>>>24&255,o[36]=R>>>0&255,o[37]=R>>>8&255,o[38]=R>>>16&255,o[39]=R>>>24&255,o[40]=D>>>0&255,o[41]=D>>>8&255,o[42]=D>>>16&255,o[43]=D>>>24&255,o[44]=I>>>0&255,o[45]=I>>>8&255,o[46]=I>>>16&255,o[47]=I>>>24&255,o[48]=ne>>>0&255,o[49]=ne>>>8&255,o[50]=ne>>>16&255,o[51]=ne>>>24&255,o[52]=_e>>>0&255,o[53]=_e>>>8&255,o[54]=_e>>>16&255,o[55]=_e>>>24&255,o[56]=ve>>>0&255,o[57]=ve>>>8&255,o[58]=ve>>>16&255,o[59]=ve>>>24&255,o[60]=pe>>>0&255,o[61]=pe>>>8&255,o[62]=pe>>>16&255,o[63]=pe>>>24&255}function X(o,d,a,f){for(var _=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,N=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,U=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,Q=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,Y=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,Ce=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,J=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,ie=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,fe=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,he=a[16]&255|(a[17]&255)<<8|(a[18]&255)<<16|(a[19]&255)<<24,ae=a[20]&255|(a[21]&255)<<8|(a[22]&255)<<16|(a[23]&255)<<24,se=a[24]&255|(a[25]&255)<<8|(a[26]&255)<<16|(a[27]&255)<<24,le=a[28]&255|(a[29]&255)<<8|(a[30]&255)<<16|(a[31]&255)<<24,oe=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,W=_,ee=g,H=x,Z=N,V=U,K=Q,A=Y,E=Ce,$=J,R=ie,D=fe,I=he,ne=ae,_e=se,ve=le,pe=oe,v,xe=0;xe<20;xe+=2)v=W+ne|0,V^=v<<7|v>>>32-7,v=V+W|0,$^=v<<9|v>>>32-9,v=$+V|0,ne^=v<<13|v>>>32-13,v=ne+$|0,W^=v<<18|v>>>32-18,v=K+ee|0,R^=v<<7|v>>>32-7,v=R+K|0,_e^=v<<9|v>>>32-9,v=_e+R|0,ee^=v<<13|v>>>32-13,v=ee+_e|0,K^=v<<18|v>>>32-18,v=D+A|0,ve^=v<<7|v>>>32-7,v=ve+D|0,H^=v<<9|v>>>32-9,v=H+ve|0,A^=v<<13|v>>>32-13,v=A+H|0,D^=v<<18|v>>>32-18,v=pe+I|0,Z^=v<<7|v>>>32-7,v=Z+pe|0,E^=v<<9|v>>>32-9,v=E+Z|0,I^=v<<13|v>>>32-13,v=I+E|0,pe^=v<<18|v>>>32-18,v=W+Z|0,ee^=v<<7|v>>>32-7,v=ee+W|0,H^=v<<9|v>>>32-9,v=H+ee|0,Z^=v<<13|v>>>32-13,v=Z+H|0,W^=v<<18|v>>>32-18,v=K+V|0,A^=v<<7|v>>>32-7,v=A+K|0,E^=v<<9|v>>>32-9,v=E+A|0,V^=v<<13|v>>>32-13,v=V+E|0,K^=v<<18|v>>>32-18,v=D+R|0,I^=v<<7|v>>>32-7,v=I+D|0,$^=v<<9|v>>>32-9,v=$+I|0,R^=v<<13|v>>>32-13,v=R+$|0,D^=v<<18|v>>>32-18,v=pe+ve|0,ne^=v<<7|v>>>32-7,v=ne+pe|0,_e^=v<<9|v>>>32-9,v=_e+ne|0,ve^=v<<13|v>>>32-13,v=ve+_e|0,pe^=v<<18|v>>>32-18;o[0]=W>>>0&255,o[1]=W>>>8&255,o[2]=W>>>16&255,o[3]=W>>>24&255,o[4]=K>>>0&255,o[5]=K>>>8&255,o[6]=K>>>16&255,o[7]=K>>>24&255,o[8]=D>>>0&255,o[9]=D>>>8&255,o[10]=D>>>16&255,o[11]=D>>>24&255,o[12]=pe>>>0&255,o[13]=pe>>>8&255,o[14]=pe>>>16&255,o[15]=pe>>>24&255,o[16]=A>>>0&255,o[17]=A>>>8&255,o[18]=A>>>16&255,o[19]=A>>>24&255,o[20]=E>>>0&255,o[21]=E>>>8&255,o[22]=E>>>16&255,o[23]=E>>>24&255,o[24]=$>>>0&255,o[25]=$>>>8&255,o[26]=$>>>16&255,o[27]=$>>>24&255,o[28]=R>>>0&255,o[29]=R>>>8&255,o[30]=R>>>16&255,o[31]=R>>>24&255}function j(o,d,a,f){G(o,d,a,f)}function q(o,d,a,f){X(o,d,a,f)}var z=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function be(o,d,a,f,_,g,x){var N=new Uint8Array(16),U=new Uint8Array(64),Q,Y;for(Y=0;Y<16;Y++)N[Y]=0;for(Y=0;Y<8;Y++)N[Y]=g[Y];for(;_>=64;){for(j(U,N,x,z),Y=0;Y<64;Y++)o[d+Y]=a[f+Y]^U[Y];for(Q=1,Y=8;Y<16;Y++)Q=Q+(N[Y]&255)|0,N[Y]=Q&255,Q>>>=8;_-=64,d+=64,f+=64}if(_>0)for(j(U,N,x,z),Y=0;Y<_;Y++)o[d+Y]=a[f+Y]^U[Y];return 0}function ye(o,d,a,f,_){var g=new Uint8Array(16),x=new Uint8Array(64),N,U;for(U=0;U<16;U++)g[U]=0;for(U=0;U<8;U++)g[U]=f[U];for(;a>=64;){for(j(x,g,_,z),U=0;U<64;U++)o[d+U]=x[U];for(N=1,U=8;U<16;U++)N=N+(g[U]&255)|0,g[U]=N&255,N>>>=8;a-=64,d+=64}if(a>0)for(j(x,g,_,z),U=0;U<a;U++)o[d+U]=x[U];return 0}function ue(o,d,a,f,_){var g=new Uint8Array(32);q(g,f,_,z);for(var x=new Uint8Array(8),N=0;N<8;N++)x[N]=f[N+16];return ye(o,d,a,x,g)}function De(o,d,a,f,_,g,x){var N=new Uint8Array(32);q(N,g,x,z);for(var U=new Uint8Array(8),Q=0;Q<8;Q++)U[Q]=g[Q+16];return be(o,d,a,f,_,U,N)}var ot=function(o){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var d,a,f,_,g,x,N,U;d=o[0]&255|(o[1]&255)<<8,this.r[0]=d&8191,a=o[2]&255|(o[3]&255)<<8,this.r[1]=(d>>>13|a<<3)&8191,f=o[4]&255|(o[5]&255)<<8,this.r[2]=(a>>>10|f<<6)&7939,_=o[6]&255|(o[7]&255)<<8,this.r[3]=(f>>>7|_<<9)&8191,g=o[8]&255|(o[9]&255)<<8,this.r[4]=(_>>>4|g<<12)&255,this.r[5]=g>>>1&8190,x=o[10]&255|(o[11]&255)<<8,this.r[6]=(g>>>14|x<<2)&8191,N=o[12]&255|(o[13]&255)<<8,this.r[7]=(x>>>11|N<<5)&8065,U=o[14]&255|(o[15]&255)<<8,this.r[8]=(N>>>8|U<<8)&8191,this.r[9]=U>>>5&127,this.pad[0]=o[16]&255|(o[17]&255)<<8,this.pad[1]=o[18]&255|(o[19]&255)<<8,this.pad[2]=o[20]&255|(o[21]&255)<<8,this.pad[3]=o[22]&255|(o[23]&255)<<8,this.pad[4]=o[24]&255|(o[25]&255)<<8,this.pad[5]=o[26]&255|(o[27]&255)<<8,this.pad[6]=o[28]&255|(o[29]&255)<<8,this.pad[7]=o[30]&255|(o[31]&255)<<8};ot.prototype.blocks=function(o,d,a){for(var f=this.fin?0:2048,_,g,x,N,U,Q,Y,Ce,J,ie,fe,he,ae,se,le,oe,W,ee,H,Z=this.h[0],V=this.h[1],K=this.h[2],A=this.h[3],E=this.h[4],$=this.h[5],R=this.h[6],D=this.h[7],I=this.h[8],ne=this.h[9],_e=this.r[0],ve=this.r[1],pe=this.r[2],v=this.r[3],xe=this.r[4],Re=this.r[5],Ne=this.r[6],me=this.r[7],Te=this.r[8],ke=this.r[9];a>=16;)_=o[d+0]&255|(o[d+1]&255)<<8,Z+=_&8191,g=o[d+2]&255|(o[d+3]&255)<<8,V+=(_>>>13|g<<3)&8191,x=o[d+4]&255|(o[d+5]&255)<<8,K+=(g>>>10|x<<6)&8191,N=o[d+6]&255|(o[d+7]&255)<<8,A+=(x>>>7|N<<9)&8191,U=o[d+8]&255|(o[d+9]&255)<<8,E+=(N>>>4|U<<12)&8191,$+=U>>>1&8191,Q=o[d+10]&255|(o[d+11]&255)<<8,R+=(U>>>14|Q<<2)&8191,Y=o[d+12]&255|(o[d+13]&255)<<8,D+=(Q>>>11|Y<<5)&8191,Ce=o[d+14]&255|(o[d+15]&255)<<8,I+=(Y>>>8|Ce<<8)&8191,ne+=Ce>>>5|f,J=0,ie=J,ie+=Z*_e,ie+=V*(5*ke),ie+=K*(5*Te),ie+=A*(5*me),ie+=E*(5*Ne),J=ie>>>13,ie&=8191,ie+=$*(5*Re),ie+=R*(5*xe),ie+=D*(5*v),ie+=I*(5*pe),ie+=ne*(5*ve),J+=ie>>>13,ie&=8191,fe=J,fe+=Z*ve,fe+=V*_e,fe+=K*(5*ke),fe+=A*(5*Te),fe+=E*(5*me),J=fe>>>13,fe&=8191,fe+=$*(5*Ne),fe+=R*(5*Re),fe+=D*(5*xe),fe+=I*(5*v),fe+=ne*(5*pe),J+=fe>>>13,fe&=8191,he=J,he+=Z*pe,he+=V*ve,he+=K*_e,he+=A*(5*ke),he+=E*(5*Te),J=he>>>13,he&=8191,he+=$*(5*me),he+=R*(5*Ne),he+=D*(5*Re),he+=I*(5*xe),he+=ne*(5*v),J+=he>>>13,he&=8191,ae=J,ae+=Z*v,ae+=V*pe,ae+=K*ve,ae+=A*_e,ae+=E*(5*ke),J=ae>>>13,ae&=8191,ae+=$*(5*Te),ae+=R*(5*me),ae+=D*(5*Ne),ae+=I*(5*Re),ae+=ne*(5*xe),J+=ae>>>13,ae&=8191,se=J,se+=Z*xe,se+=V*v,se+=K*pe,se+=A*ve,se+=E*_e,J=se>>>13,se&=8191,se+=$*(5*ke),se+=R*(5*Te),se+=D*(5*me),se+=I*(5*Ne),se+=ne*(5*Re),J+=se>>>13,se&=8191,le=J,le+=Z*Re,le+=V*xe,le+=K*v,le+=A*pe,le+=E*ve,J=le>>>13,le&=8191,le+=$*_e,le+=R*(5*ke),le+=D*(5*Te),le+=I*(5*me),le+=ne*(5*Ne),J+=le>>>13,le&=8191,oe=J,oe+=Z*Ne,oe+=V*Re,oe+=K*xe,oe+=A*v,oe+=E*pe,J=oe>>>13,oe&=8191,oe+=$*ve,oe+=R*_e,oe+=D*(5*ke),oe+=I*(5*Te),oe+=ne*(5*me),J+=oe>>>13,oe&=8191,W=J,W+=Z*me,W+=V*Ne,W+=K*Re,W+=A*xe,W+=E*v,J=W>>>13,W&=8191,W+=$*pe,W+=R*ve,W+=D*_e,W+=I*(5*ke),W+=ne*(5*Te),J+=W>>>13,W&=8191,ee=J,ee+=Z*Te,ee+=V*me,ee+=K*Ne,ee+=A*Re,ee+=E*xe,J=ee>>>13,ee&=8191,ee+=$*v,ee+=R*pe,ee+=D*ve,ee+=I*_e,ee+=ne*(5*ke),J+=ee>>>13,ee&=8191,H=J,H+=Z*ke,H+=V*Te,H+=K*me,H+=A*Ne,H+=E*Re,J=H>>>13,H&=8191,H+=$*xe,H+=R*v,H+=D*pe,H+=I*ve,H+=ne*_e,J+=H>>>13,H&=8191,J=(J<<2)+J|0,J=J+ie|0,ie=J&8191,J=J>>>13,fe+=J,Z=ie,V=fe,K=he,A=ae,E=se,$=le,R=oe,D=W,I=ee,ne=H,d+=16,a-=16;this.h[0]=Z,this.h[1]=V,this.h[2]=K,this.h[3]=A,this.h[4]=E,this.h[5]=$,this.h[6]=R,this.h[7]=D,this.h[8]=I,this.h[9]=ne},ot.prototype.finish=function(o,d){var a=new Uint16Array(10),f,_,g,x;if(this.leftover){for(x=this.leftover,this.buffer[x++]=1;x<16;x++)this.buffer[x]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(f=this.h[1]>>>13,this.h[1]&=8191,x=2;x<10;x++)this.h[x]+=f,f=this.h[x]>>>13,this.h[x]&=8191;for(this.h[0]+=f*5,f=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=f,f=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=f,a[0]=this.h[0]+5,f=a[0]>>>13,a[0]&=8191,x=1;x<10;x++)a[x]=this.h[x]+f,f=a[x]>>>13,a[x]&=8191;for(a[9]-=1<<13,_=(f^1)-1,x=0;x<10;x++)a[x]&=_;for(_=~_,x=0;x<10;x++)this.h[x]=this.h[x]&_|a[x];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,g=this.h[0]+this.pad[0],this.h[0]=g&65535,x=1;x<8;x++)g=(this.h[x]+this.pad[x]|0)+(g>>>16)|0,this.h[x]=g&65535;o[d+0]=this.h[0]>>>0&255,o[d+1]=this.h[0]>>>8&255,o[d+2]=this.h[1]>>>0&255,o[d+3]=this.h[1]>>>8&255,o[d+4]=this.h[2]>>>0&255,o[d+5]=this.h[2]>>>8&255,o[d+6]=this.h[3]>>>0&255,o[d+7]=this.h[3]>>>8&255,o[d+8]=this.h[4]>>>0&255,o[d+9]=this.h[4]>>>8&255,o[d+10]=this.h[5]>>>0&255,o[d+11]=this.h[5]>>>8&255,o[d+12]=this.h[6]>>>0&255,o[d+13]=this.h[6]>>>8&255,o[d+14]=this.h[7]>>>0&255,o[d+15]=this.h[7]>>>8&255},ot.prototype.update=function(o,d,a){var f,_;if(this.leftover){for(_=16-this.leftover,_>a&&(_=a),f=0;f<_;f++)this.buffer[this.leftover+f]=o[d+f];if(a-=_,d+=_,this.leftover+=_,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(a>=16&&(_=a-a%16,this.blocks(o,d,_),d+=_,a-=_),a){for(f=0;f<a;f++)this.buffer[this.leftover+f]=o[d+f];this.leftover+=a}};function Xe(o,d,a,f,_,g){var x=new ot(g);return x.update(a,f,_),x.finish(o,d),0}function ft(o,d,a,f,_,g){var x=new Uint8Array(16);return Xe(x,0,a,f,_,g),P(o,d,x,0)}function Ae(o,d,a,f,_){var g;if(a<32)return-1;for(De(o,0,d,0,a,f,_),Xe(o,16,o,32,a-32,o),g=0;g<16;g++)o[g]=0;return 0}function Je(o,d,a,f,_){var g,x=new Uint8Array(32);if(a<32||(ue(x,0,32,f,_),ft(d,16,d,32,a-32,x)!==0))return-1;for(De(o,0,d,0,a,f,_),g=0;g<32;g++)o[g]=0;return 0}function He(o,d){var a;for(a=0;a<16;a++)o[a]=d[a]|0}function ht(o){var d,a,f=1;for(d=0;d<16;d++)a=o[d]+f+65535,f=Math.floor(a/65536),o[d]=a-f*65536;o[0]+=f-1+37*(f-1)}function it(o,d,a){for(var f,_=~(a-1),g=0;g<16;g++)f=_&(o[g]^d[g]),o[g]^=f,d[g]^=f}function Oe(o,d){var a,f,_,g=n(),x=n();for(a=0;a<16;a++)x[a]=d[a];for(ht(x),ht(x),ht(x),f=0;f<2;f++){for(g[0]=x[0]-65517,a=1;a<15;a++)g[a]=x[a]-65535-(g[a-1]>>16&1),g[a-1]&=65535;g[15]=x[15]-32767-(g[14]>>16&1),_=g[15]>>16&1,g[14]&=65535,it(x,g,1-_)}for(a=0;a<16;a++)o[2*a]=x[a]&255,o[2*a+1]=x[a]>>8}function qe(o,d){var a=new Uint8Array(32),f=new Uint8Array(32);return Oe(a,o),Oe(f,d),k(a,0,f,0)}function gt(o){var d=new Uint8Array(32);return Oe(d,o),d[0]&1}function Nt(o,d){var a;for(a=0;a<16;a++)o[a]=d[2*a]+(d[2*a+1]<<8);o[15]&=32767}function We(o,d,a){for(var f=0;f<16;f++)o[f]=d[f]+a[f]}function et(o,d,a){for(var f=0;f<16;f++)o[f]=d[f]-a[f]}function de(o,d,a){var f,_,g=0,x=0,N=0,U=0,Q=0,Y=0,Ce=0,J=0,ie=0,fe=0,he=0,ae=0,se=0,le=0,oe=0,W=0,ee=0,H=0,Z=0,V=0,K=0,A=0,E=0,$=0,R=0,D=0,I=0,ne=0,_e=0,ve=0,pe=0,v=a[0],xe=a[1],Re=a[2],Ne=a[3],me=a[4],Te=a[5],ke=a[6],ze=a[7],Pe=a[8],Me=a[9],Ue=a[10],Le=a[11],Fe=a[12],Ge=a[13],Ve=a[14],Qe=a[15];f=d[0],g+=f*v,x+=f*xe,N+=f*Re,U+=f*Ne,Q+=f*me,Y+=f*Te,Ce+=f*ke,J+=f*ze,ie+=f*Pe,fe+=f*Me,he+=f*Ue,ae+=f*Le,se+=f*Fe,le+=f*Ge,oe+=f*Ve,W+=f*Qe,f=d[1],x+=f*v,N+=f*xe,U+=f*Re,Q+=f*Ne,Y+=f*me,Ce+=f*Te,J+=f*ke,ie+=f*ze,fe+=f*Pe,he+=f*Me,ae+=f*Ue,se+=f*Le,le+=f*Fe,oe+=f*Ge,W+=f*Ve,ee+=f*Qe,f=d[2],N+=f*v,U+=f*xe,Q+=f*Re,Y+=f*Ne,Ce+=f*me,J+=f*Te,ie+=f*ke,fe+=f*ze,he+=f*Pe,ae+=f*Me,se+=f*Ue,le+=f*Le,oe+=f*Fe,W+=f*Ge,ee+=f*Ve,H+=f*Qe,f=d[3],U+=f*v,Q+=f*xe,Y+=f*Re,Ce+=f*Ne,J+=f*me,ie+=f*Te,fe+=f*ke,he+=f*ze,ae+=f*Pe,se+=f*Me,le+=f*Ue,oe+=f*Le,W+=f*Fe,ee+=f*Ge,H+=f*Ve,Z+=f*Qe,f=d[4],Q+=f*v,Y+=f*xe,Ce+=f*Re,J+=f*Ne,ie+=f*me,fe+=f*Te,he+=f*ke,ae+=f*ze,se+=f*Pe,le+=f*Me,oe+=f*Ue,W+=f*Le,ee+=f*Fe,H+=f*Ge,Z+=f*Ve,V+=f*Qe,f=d[5],Y+=f*v,Ce+=f*xe,J+=f*Re,ie+=f*Ne,fe+=f*me,he+=f*Te,ae+=f*ke,se+=f*ze,le+=f*Pe,oe+=f*Me,W+=f*Ue,ee+=f*Le,H+=f*Fe,Z+=f*Ge,V+=f*Ve,K+=f*Qe,f=d[6],Ce+=f*v,J+=f*xe,ie+=f*Re,fe+=f*Ne,he+=f*me,ae+=f*Te,se+=f*ke,le+=f*ze,oe+=f*Pe,W+=f*Me,ee+=f*Ue,H+=f*Le,Z+=f*Fe,V+=f*Ge,K+=f*Ve,A+=f*Qe,f=d[7],J+=f*v,ie+=f*xe,fe+=f*Re,he+=f*Ne,ae+=f*me,se+=f*Te,le+=f*ke,oe+=f*ze,W+=f*Pe,ee+=f*Me,H+=f*Ue,Z+=f*Le,V+=f*Fe,K+=f*Ge,A+=f*Ve,E+=f*Qe,f=d[8],ie+=f*v,fe+=f*xe,he+=f*Re,ae+=f*Ne,se+=f*me,le+=f*Te,oe+=f*ke,W+=f*ze,ee+=f*Pe,H+=f*Me,Z+=f*Ue,V+=f*Le,K+=f*Fe,A+=f*Ge,E+=f*Ve,$+=f*Qe,f=d[9],fe+=f*v,he+=f*xe,ae+=f*Re,se+=f*Ne,le+=f*me,oe+=f*Te,W+=f*ke,ee+=f*ze,H+=f*Pe,Z+=f*Me,V+=f*Ue,K+=f*Le,A+=f*Fe,E+=f*Ge,$+=f*Ve,R+=f*Qe,f=d[10],he+=f*v,ae+=f*xe,se+=f*Re,le+=f*Ne,oe+=f*me,W+=f*Te,ee+=f*ke,H+=f*ze,Z+=f*Pe,V+=f*Me,K+=f*Ue,A+=f*Le,E+=f*Fe,$+=f*Ge,R+=f*Ve,D+=f*Qe,f=d[11],ae+=f*v,se+=f*xe,le+=f*Re,oe+=f*Ne,W+=f*me,ee+=f*Te,H+=f*ke,Z+=f*ze,V+=f*Pe,K+=f*Me,A+=f*Ue,E+=f*Le,$+=f*Fe,R+=f*Ge,D+=f*Ve,I+=f*Qe,f=d[12],se+=f*v,le+=f*xe,oe+=f*Re,W+=f*Ne,ee+=f*me,H+=f*Te,Z+=f*ke,V+=f*ze,K+=f*Pe,A+=f*Me,E+=f*Ue,$+=f*Le,R+=f*Fe,D+=f*Ge,I+=f*Ve,ne+=f*Qe,f=d[13],le+=f*v,oe+=f*xe,W+=f*Re,ee+=f*Ne,H+=f*me,Z+=f*Te,V+=f*ke,K+=f*ze,A+=f*Pe,E+=f*Me,$+=f*Ue,R+=f*Le,D+=f*Fe,I+=f*Ge,ne+=f*Ve,_e+=f*Qe,f=d[14],oe+=f*v,W+=f*xe,ee+=f*Re,H+=f*Ne,Z+=f*me,V+=f*Te,K+=f*ke,A+=f*ze,E+=f*Pe,$+=f*Me,R+=f*Ue,D+=f*Le,I+=f*Fe,ne+=f*Ge,_e+=f*Ve,ve+=f*Qe,f=d[15],W+=f*v,ee+=f*xe,H+=f*Re,Z+=f*Ne,V+=f*me,K+=f*Te,A+=f*ke,E+=f*ze,$+=f*Pe,R+=f*Me,D+=f*Ue,I+=f*Le,ne+=f*Fe,_e+=f*Ge,ve+=f*Ve,pe+=f*Qe,g+=38*ee,x+=38*H,N+=38*Z,U+=38*V,Q+=38*K,Y+=38*A,Ce+=38*E,J+=38*$,ie+=38*R,fe+=38*D,he+=38*I,ae+=38*ne,se+=38*_e,le+=38*ve,oe+=38*pe,_=1,f=g+_+65535,_=Math.floor(f/65536),g=f-_*65536,f=x+_+65535,_=Math.floor(f/65536),x=f-_*65536,f=N+_+65535,_=Math.floor(f/65536),N=f-_*65536,f=U+_+65535,_=Math.floor(f/65536),U=f-_*65536,f=Q+_+65535,_=Math.floor(f/65536),Q=f-_*65536,f=Y+_+65535,_=Math.floor(f/65536),Y=f-_*65536,f=Ce+_+65535,_=Math.floor(f/65536),Ce=f-_*65536,f=J+_+65535,_=Math.floor(f/65536),J=f-_*65536,f=ie+_+65535,_=Math.floor(f/65536),ie=f-_*65536,f=fe+_+65535,_=Math.floor(f/65536),fe=f-_*65536,f=he+_+65535,_=Math.floor(f/65536),he=f-_*65536,f=ae+_+65535,_=Math.floor(f/65536),ae=f-_*65536,f=se+_+65535,_=Math.floor(f/65536),se=f-_*65536,f=le+_+65535,_=Math.floor(f/65536),le=f-_*65536,f=oe+_+65535,_=Math.floor(f/65536),oe=f-_*65536,f=W+_+65535,_=Math.floor(f/65536),W=f-_*65536,g+=_-1+37*(_-1),_=1,f=g+_+65535,_=Math.floor(f/65536),g=f-_*65536,f=x+_+65535,_=Math.floor(f/65536),x=f-_*65536,f=N+_+65535,_=Math.floor(f/65536),N=f-_*65536,f=U+_+65535,_=Math.floor(f/65536),U=f-_*65536,f=Q+_+65535,_=Math.floor(f/65536),Q=f-_*65536,f=Y+_+65535,_=Math.floor(f/65536),Y=f-_*65536,f=Ce+_+65535,_=Math.floor(f/65536),Ce=f-_*65536,f=J+_+65535,_=Math.floor(f/65536),J=f-_*65536,f=ie+_+65535,_=Math.floor(f/65536),ie=f-_*65536,f=fe+_+65535,_=Math.floor(f/65536),fe=f-_*65536,f=he+_+65535,_=Math.floor(f/65536),he=f-_*65536,f=ae+_+65535,_=Math.floor(f/65536),ae=f-_*65536,f=se+_+65535,_=Math.floor(f/65536),se=f-_*65536,f=le+_+65535,_=Math.floor(f/65536),le=f-_*65536,f=oe+_+65535,_=Math.floor(f/65536),oe=f-_*65536,f=W+_+65535,_=Math.floor(f/65536),W=f-_*65536,g+=_-1+37*(_-1),o[0]=g,o[1]=x,o[2]=N,o[3]=U,o[4]=Q,o[5]=Y,o[6]=Ce,o[7]=J,o[8]=ie,o[9]=fe,o[10]=he,o[11]=ae,o[12]=se,o[13]=le,o[14]=oe,o[15]=W}function Ze(o,d){de(o,d,d)}function Dt(o,d){var a=n(),f;for(f=0;f<16;f++)a[f]=d[f];for(f=253;f>=0;f--)Ze(a,a),f!==2&&f!==4&&de(a,a,d);for(f=0;f<16;f++)o[f]=a[f]}function Xt(o,d){var a=n(),f;for(f=0;f<16;f++)a[f]=d[f];for(f=250;f>=0;f--)Ze(a,a),f!==1&&de(a,a,d);for(f=0;f<16;f++)o[f]=a[f]}function St(o,d,a){var f=new Uint8Array(32),_=new Float64Array(80),g,x,N=n(),U=n(),Q=n(),Y=n(),Ce=n(),J=n();for(x=0;x<31;x++)f[x]=d[x];for(f[31]=d[31]&127|64,f[0]&=248,Nt(_,a),x=0;x<16;x++)U[x]=_[x],Y[x]=N[x]=Q[x]=0;for(N[0]=Y[0]=1,x=254;x>=0;--x)g=f[x>>>3]>>>(x&7)&1,it(N,U,g),it(Q,Y,g),We(Ce,N,Q),et(N,N,Q),We(Q,U,Y),et(U,U,Y),Ze(Y,Ce),Ze(J,N),de(N,Q,N),de(Q,U,Ce),We(Ce,N,Q),et(N,N,Q),Ze(U,N),et(Q,Y,J),de(N,Q,u),We(N,N,Y),de(Q,Q,N),de(N,Y,J),de(Y,U,_),Ze(U,Ce),it(N,U,g),it(Q,Y,g);for(x=0;x<16;x++)_[x+16]=N[x],_[x+32]=Q[x],_[x+48]=U[x],_[x+64]=Y[x];var ie=_.subarray(32),fe=_.subarray(16);return Dt(ie,ie),de(fe,fe,ie),Oe(o,fe),0}function $t(o,d){return St(o,d,s)}function Ot(o,d){return r(d,32),$t(o,d)}function Mt(o,d,a){var f=new Uint8Array(32);return St(f,a,d),q(o,i,f,z)}var Ft=Ae,fn=Je;function _n(o,d,a,f,_,g){var x=new Uint8Array(32);return Mt(x,_,g),Ft(o,d,a,f,x)}function pn(o,d,a,f,_,g){var x=new Uint8Array(32);return Mt(x,_,g),fn(o,d,a,f,x)}var Ht=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function At(o,d,a,f){for(var _=new Int32Array(16),g=new Int32Array(16),x,N,U,Q,Y,Ce,J,ie,fe,he,ae,se,le,oe,W,ee,H,Z,V,K,A,E,$,R,D,I,ne=o[0],_e=o[1],ve=o[2],pe=o[3],v=o[4],xe=o[5],Re=o[6],Ne=o[7],me=d[0],Te=d[1],ke=d[2],ze=d[3],Pe=d[4],Me=d[5],Ue=d[6],Le=d[7],Fe=0;f>=128;){for(V=0;V<16;V++)K=8*V+Fe,_[V]=a[K+0]<<24|a[K+1]<<16|a[K+2]<<8|a[K+3],g[V]=a[K+4]<<24|a[K+5]<<16|a[K+6]<<8|a[K+7];for(V=0;V<80;V++)if(x=ne,N=_e,U=ve,Q=pe,Y=v,Ce=xe,J=Re,ie=Ne,fe=me,he=Te,ae=ke,se=ze,le=Pe,oe=Me,W=Ue,ee=Le,A=Ne,E=Le,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=(v>>>14|Pe<<32-14)^(v>>>18|Pe<<32-18)^(Pe>>>41-32|v<<32-(41-32)),E=(Pe>>>14|v<<32-14)^(Pe>>>18|v<<32-18)^(v>>>41-32|Pe<<32-(41-32)),$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,A=v&xe^~v&Re,E=Pe&Me^~Pe&Ue,$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,A=Ht[V*2],E=Ht[V*2+1],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,A=_[V%16],E=g[V%16],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,H=D&65535|I<<16,Z=$&65535|R<<16,A=H,E=Z,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=(ne>>>28|me<<32-28)^(me>>>34-32|ne<<32-(34-32))^(me>>>39-32|ne<<32-(39-32)),E=(me>>>28|ne<<32-28)^(ne>>>34-32|me<<32-(34-32))^(ne>>>39-32|me<<32-(39-32)),$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,A=ne&_e^ne&ve^_e&ve,E=me&Te^me&ke^Te&ke,$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,ie=D&65535|I<<16,ee=$&65535|R<<16,A=Q,E=se,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=H,E=Z,$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,Q=D&65535|I<<16,se=$&65535|R<<16,_e=x,ve=N,pe=U,v=Q,xe=Y,Re=Ce,Ne=J,ne=ie,Te=fe,ke=he,ze=ae,Pe=se,Me=le,Ue=oe,Le=W,me=ee,V%16===15)for(K=0;K<16;K++)A=_[K],E=g[K],$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=_[(K+9)%16],E=g[(K+9)%16],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,H=_[(K+1)%16],Z=g[(K+1)%16],A=(H>>>1|Z<<32-1)^(H>>>8|Z<<32-8)^H>>>7,E=(Z>>>1|H<<32-1)^(Z>>>8|H<<32-8)^(Z>>>7|H<<32-7),$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,H=_[(K+14)%16],Z=g[(K+14)%16],A=(H>>>19|Z<<32-19)^(Z>>>61-32|H<<32-(61-32))^H>>>6,E=(Z>>>19|H<<32-19)^(H>>>61-32|Z<<32-(61-32))^(Z>>>6|H<<32-6),$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,_[K]=D&65535|I<<16,g[K]=$&65535|R<<16;A=ne,E=me,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[0],E=d[0],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[0]=ne=D&65535|I<<16,d[0]=me=$&65535|R<<16,A=_e,E=Te,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[1],E=d[1],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[1]=_e=D&65535|I<<16,d[1]=Te=$&65535|R<<16,A=ve,E=ke,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[2],E=d[2],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[2]=ve=D&65535|I<<16,d[2]=ke=$&65535|R<<16,A=pe,E=ze,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[3],E=d[3],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[3]=pe=D&65535|I<<16,d[3]=ze=$&65535|R<<16,A=v,E=Pe,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[4],E=d[4],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[4]=v=D&65535|I<<16,d[4]=Pe=$&65535|R<<16,A=xe,E=Me,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[5],E=d[5],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[5]=xe=D&65535|I<<16,d[5]=Me=$&65535|R<<16,A=Re,E=Ue,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[6],E=d[6],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[6]=Re=D&65535|I<<16,d[6]=Ue=$&65535|R<<16,A=Ne,E=Le,$=E&65535,R=E>>>16,D=A&65535,I=A>>>16,A=o[7],E=d[7],$+=E&65535,R+=E>>>16,D+=A&65535,I+=A>>>16,R+=$>>>16,D+=R>>>16,I+=D>>>16,o[7]=Ne=D&65535|I<<16,d[7]=Le=$&65535|R<<16,Fe+=128,f-=128}return f}function vt(o,d,a){var f=new Int32Array(8),_=new Int32Array(8),g=new Uint8Array(256),x,N=a;for(f[0]=1779033703,f[1]=3144134277,f[2]=1013904242,f[3]=2773480762,f[4]=1359893119,f[5]=2600822924,f[6]=528734635,f[7]=1541459225,_[0]=4089235720,_[1]=2227873595,_[2]=4271175723,_[3]=1595750129,_[4]=2917565137,_[5]=725511199,_[6]=4215389547,_[7]=327033209,At(f,_,d,a),a%=128,x=0;x<a;x++)g[x]=d[N-a+x];for(g[a]=128,a=256-128*(a<112?1:0),g[a-9]=0,w(g,a-8,N/536870912|0,N<<3),At(f,_,g,a),x=0;x<8;x++)w(o,8*x,f[x],_[x]);return 0}function Tt(o,d){var a=n(),f=n(),_=n(),g=n(),x=n(),N=n(),U=n(),Q=n(),Y=n();et(a,o[1],o[0]),et(Y,d[1],d[0]),de(a,a,Y),We(f,o[0],o[1]),We(Y,d[0],d[1]),de(f,f,Y),de(_,o[3],d[3]),de(_,_,p),de(g,o[2],d[2]),We(g,g,g),et(x,f,a),et(N,g,_),We(U,g,_),We(Q,f,a),de(o[0],x,N),de(o[1],Q,U),de(o[2],U,N),de(o[3],x,Q)}function Et(o,d,a){var f;for(f=0;f<4;f++)it(o[f],d[f],a)}function lt(o,d){var a=n(),f=n(),_=n();Dt(_,d[2]),de(a,d[0],_),de(f,d[1],_),Oe(o,f),o[31]^=gt(a)<<7}function ct(o,d,a){var f,_;for(He(o[0],l),He(o[1],c),He(o[2],c),He(o[3],l),_=255;_>=0;--_)f=a[_/8|0]>>(_&7)&1,Et(o,d,f),Tt(d,o),Tt(o,o),Et(o,d,f)}function rt(o,d){var a=[n(),n(),n(),n()];He(a[0],b),He(a[1],m),He(a[2],c),de(a[3],b,m),ct(o,a,d)}function Jt(o,d,a){var f=new Uint8Array(64),_=[n(),n(),n(),n()],g;for(a||r(d,32),vt(f,d,32),f[0]&=248,f[31]&=127,f[31]|=64,rt(_,f),lt(o,_),g=0;g<32;g++)d[g+32]=o[g];return 0}var Ut=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function te(o,d){var a,f,_,g;for(f=63;f>=32;--f){for(a=0,_=f-32,g=f-12;_<g;++_)d[_]+=a-16*d[f]*Ut[_-(f-32)],a=Math.floor((d[_]+128)/256),d[_]-=a*256;d[_]+=a,d[f]=0}for(a=0,_=0;_<32;_++)d[_]+=a-(d[31]>>4)*Ut[_],a=d[_]>>8,d[_]&=255;for(_=0;_<32;_++)d[_]-=a*Ut[_];for(f=0;f<32;f++)d[f+1]+=d[f]>>8,o[f]=d[f]&255}function $e(o){var d=new Float64Array(64),a;for(a=0;a<64;a++)d[a]=o[a];for(a=0;a<64;a++)o[a]=0;te(o,d)}function nn(o,d,a,f){var _=new Uint8Array(64),g=new Uint8Array(64),x=new Uint8Array(64),N,U,Q=new Float64Array(64),Y=[n(),n(),n(),n()];vt(_,f,32),_[0]&=248,_[31]&=127,_[31]|=64;var Ce=a+64;for(N=0;N<a;N++)o[64+N]=d[N];for(N=0;N<32;N++)o[32+N]=_[32+N];for(vt(x,o.subarray(32),a+32),$e(x),rt(Y,x),lt(o,Y),N=32;N<64;N++)o[N]=f[N];for(vt(g,o,a+64),$e(g),N=0;N<64;N++)Q[N]=0;for(N=0;N<32;N++)Q[N]=x[N];for(N=0;N<32;N++)for(U=0;U<32;U++)Q[N+U]+=g[N]*_[U];return te(o.subarray(32),Q),Ce}function bn(o,d){var a=n(),f=n(),_=n(),g=n(),x=n(),N=n(),U=n();return He(o[2],c),Nt(o[1],d),Ze(_,o[1]),de(g,_,h),et(_,_,o[2]),We(g,o[2],g),Ze(x,g),Ze(N,x),de(U,N,x),de(a,U,_),de(a,a,g),Xt(a,a),de(a,a,_),de(a,a,g),de(a,a,g),de(o[0],a,g),Ze(f,o[0]),de(f,f,g),qe(f,_)&&de(o[0],o[0],y),Ze(f,o[0]),de(f,f,g),qe(f,_)?-1:(gt(o[0])===d[31]>>7&&et(o[0],l,o[0]),de(o[3],o[0],o[1]),0)}function sn(o,d,a,f){var _,g=new Uint8Array(32),x=new Uint8Array(64),N=[n(),n(),n(),n()],U=[n(),n(),n(),n()];if(a<64||bn(U,f))return-1;for(_=0;_<a;_++)o[_]=d[_];for(_=0;_<32;_++)o[_+32]=f[_];if(vt(x,o,a),$e(x),ct(N,U,x),rt(U,d.subarray(32)),Tt(N,U),lt(g,N),a-=64,k(d,0,g,0)){for(_=0;_<a;_++)o[_]=0;return-1}for(_=0;_<a;_++)o[_]=d[_+64];return a}var on=32,en=24,Bt=32,Pt=16,zt=32,Ee=32,Ye=32,Lt=32,rn=32,vn=en,wr=Bt,Ar=Pt,xt=64,It=32,Kt=64,An=32,En=64;e.lowlevel={crypto_core_hsalsa20:q,crypto_stream_xor:De,crypto_stream:ue,crypto_stream_salsa20_xor:be,crypto_stream_salsa20:ye,crypto_onetimeauth:Xe,crypto_onetimeauth_verify:ft,crypto_verify_16:P,crypto_verify_32:k,crypto_secretbox:Ae,crypto_secretbox_open:Je,crypto_scalarmult:St,crypto_scalarmult_base:$t,crypto_box_beforenm:Mt,crypto_box_afternm:Ft,crypto_box:_n,crypto_box_open:pn,crypto_box_keypair:Ot,crypto_hash:vt,crypto_sign:nn,crypto_sign_keypair:Jt,crypto_sign_open:sn,crypto_secretbox_KEYBYTES:on,crypto_secretbox_NONCEBYTES:en,crypto_secretbox_ZEROBYTES:Bt,crypto_secretbox_BOXZEROBYTES:Pt,crypto_scalarmult_BYTES:zt,crypto_scalarmult_SCALARBYTES:Ee,crypto_box_PUBLICKEYBYTES:Ye,crypto_box_SECRETKEYBYTES:Lt,crypto_box_BEFORENMBYTES:rn,crypto_box_NONCEBYTES:vn,crypto_box_ZEROBYTES:wr,crypto_box_BOXZEROBYTES:Ar,crypto_sign_BYTES:xt,crypto_sign_PUBLICKEYBYTES:It,crypto_sign_SECRETKEYBYTES:Kt,crypto_sign_SEEDBYTES:An,crypto_hash_BYTES:En,gf:n,D:h,L:Ut,pack25519:Oe,unpack25519:Nt,M:de,A:We,S:Ze,Z:et,pow2523:Xt,add:Tt,set25519:He,modL:te,scalarmult:ct,scalarbase:rt};function Jn(o,d){if(o.length!==on)throw new Error("bad key size");if(d.length!==en)throw new Error("bad nonce size")}function Er(o,d){if(o.length!==Ye)throw new Error("bad public key size");if(d.length!==Lt)throw new Error("bad secret key size")}function st(){for(var o=0;o<arguments.length;o++)if(!(arguments[o]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Wn(o){for(var d=0;d<o.length;d++)o[d]=0}e.randomBytes=function(o){var d=new Uint8Array(o);return r(d,o),d},e.secretbox=function(o,d,a){st(o,d,a),Jn(a,d);for(var f=new Uint8Array(Bt+o.length),_=new Uint8Array(f.length),g=0;g<o.length;g++)f[g+Bt]=o[g];return Ae(_,f,f.length,d,a),_.subarray(Pt)},e.secretbox.open=function(o,d,a){st(o,d,a),Jn(a,d);for(var f=new Uint8Array(Pt+o.length),_=new Uint8Array(f.length),g=0;g<o.length;g++)f[g+Pt]=o[g];return f.length<32||Je(_,f,f.length,d,a)!==0?null:_.subarray(Bt)},e.secretbox.keyLength=on,e.secretbox.nonceLength=en,e.secretbox.overheadLength=Pt,e.scalarMult=function(o,d){if(st(o,d),o.length!==Ee)throw new Error("bad n size");if(d.length!==zt)throw new Error("bad p size");var a=new Uint8Array(zt);return St(a,o,d),a},e.scalarMult.base=function(o){if(st(o),o.length!==Ee)throw new Error("bad n size");var d=new Uint8Array(zt);return $t(d,o),d},e.scalarMult.scalarLength=Ee,e.scalarMult.groupElementLength=zt,e.box=function(o,d,a,f){var _=e.box.before(a,f);return e.secretbox(o,d,_)},e.box.before=function(o,d){st(o,d),Er(o,d);var a=new Uint8Array(rn);return Mt(a,o,d),a},e.box.after=e.secretbox,e.box.open=function(o,d,a,f){var _=e.box.before(a,f);return e.secretbox.open(o,d,_)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var o=new Uint8Array(Ye),d=new Uint8Array(Lt);return Ot(o,d),{publicKey:o,secretKey:d}},e.box.keyPair.fromSecretKey=function(o){if(st(o),o.length!==Lt)throw new Error("bad secret key size");var d=new Uint8Array(Ye);return $t(d,o),{publicKey:d,secretKey:new Uint8Array(o)}},e.box.publicKeyLength=Ye,e.box.secretKeyLength=Lt,e.box.sharedKeyLength=rn,e.box.nonceLength=vn,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(o,d){if(st(o,d),d.length!==Kt)throw new Error("bad secret key size");var a=new Uint8Array(xt+o.length);return nn(a,o,o.length,d),a},e.sign.open=function(o,d){if(st(o,d),d.length!==It)throw new Error("bad public key size");var a=new Uint8Array(o.length),f=sn(a,o,o.length,d);if(f<0)return null;for(var _=new Uint8Array(f),g=0;g<_.length;g++)_[g]=a[g];return _},e.sign.detached=function(o,d){for(var a=e.sign(o,d),f=new Uint8Array(xt),_=0;_<f.length;_++)f[_]=a[_];return f},e.sign.detached.verify=function(o,d,a){if(st(o,d,a),d.length!==xt)throw new Error("bad signature size");if(a.length!==It)throw new Error("bad public key size");var f=new Uint8Array(xt+o.length),_=new Uint8Array(xt+o.length),g;for(g=0;g<xt;g++)f[g]=d[g];for(g=0;g<o.length;g++)f[g+xt]=o[g];return sn(_,f,f.length,a)>=0},e.sign.keyPair=function(){var o=new Uint8Array(It),d=new Uint8Array(Kt);return Jt(o,d),{publicKey:o,secretKey:d}},e.sign.keyPair.fromSecretKey=function(o){if(st(o),o.length!==Kt)throw new Error("bad secret key size");for(var d=new Uint8Array(It),a=0;a<d.length;a++)d[a]=o[32+a];return{publicKey:d,secretKey:new Uint8Array(o)}},e.sign.keyPair.fromSeed=function(o){if(st(o),o.length!==An)throw new Error("bad seed size");for(var d=new Uint8Array(It),a=new Uint8Array(Kt),f=0;f<32;f++)a[f]=o[f];return Jt(d,a,!0),{publicKey:d,secretKey:a}},e.sign.publicKeyLength=It,e.sign.secretKeyLength=Kt,e.sign.seedLength=An,e.sign.signatureLength=xt,e.hash=function(o){st(o);var d=new Uint8Array(En);return vt(d,o,o.length),d},e.hash.hashLength=En,e.verify=function(o,d){return st(o,d),o.length===0||d.length===0||o.length!==d.length?!1:S(o,0,d,0,o.length)===0},e.setPRNG=function(o){r=o},function(){var o=typeof self<"u"?self.crypto||self.msCrypto:null;if(o&&o.getRandomValues){var d=65536;e.setPRNG(function(a,f){var _,g=new Uint8Array(f);for(_=0;_<f;_+=d)o.getRandomValues(g.subarray(_,_+Math.min(f-_,d)));for(_=0;_<f;_++)a[_]=g[_];Wn(g)})}else typeof Ls<"u"&&(o=Nu,o&&o.randomBytes&&e.setPRNG(function(a,f){var _,g=o.randomBytes(f);for(_=0;_<f;_++)a[_]=g[_];Wn(g)}))}()})(t.exports?t.exports:self.nacl=self.nacl||{})}),Hn=Us(function(t){(function(e,n){t.exports?t.exports=n():(e.nacl||(e.nacl={}),e.nacl.util=n())})(Tu,function(){var e={};function n(r){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(r))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(r){if(typeof r!="string")throw new TypeError("expected string");var i,s=unescape(encodeURIComponent(r)),l=new Uint8Array(s.length);for(i=0;i<s.length;i++)l[i]=s.charCodeAt(i);return l},e.encodeUTF8=function(r){var i,s=[];for(i=0;i<r.length;i++)s.push(String.fromCharCode(r[i]));return decodeURIComponent(escape(s.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(r){return Buffer.from(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(Buffer.from(r,"base64"),0))}):(e.encodeBase64=function(r){return new Buffer(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(new Buffer(r,"base64"),0))}):(e.encodeBase64=function(r){var i,s=[],l=r.length;for(i=0;i<l;i++)s.push(String.fromCharCode(r[i]));return btoa(s.join(""))},e.decodeBase64=function(r){n(r);var i,s=atob(r),l=new Uint8Array(s.length);for(i=0;i<s.length;i++)l[i]=s.charCodeAt(i);return l}),e})});function Du(t){return typeof t>"u"||t==null?[]:Array.isArray(t)?t:[t]}function pr(t){return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}function Wr(t){const e=t.match(/.{1,2}(?=(.{2})+(?!.))|.{1,2}$/g);return new Uint8Array(e.map(n=>parseInt(n,16)))}function js(t,e=8){const n=new Array(e).fill(0);for(let r=0;r<n.length;r++){const i=t&255;n[r]=i,t=(t-i)/256}return n}Vt.util=Hn;function Bs(){const t=Vt.box.keyPair(),e=pr(t.publicKey),n=pr(t.secretKey);return{privateKey:t.secretKey,publicKey:t.publicKey,privateKeyHex:n,publicKeyHex:e}}Vt.util=Hn;function zs(t){return t.publicKeyHex&&!t.publicKey&&(t.publicKey=Wr(t.publicKeyHex)),t.privateKeyHex&&!t.privateKey&&(t.privateKey=Wr(t.privateKeyHex)),t}function $u(t){return t!=null&&t.constructor==Object}function Pu(t,e){const n=new Uint8Array(t.length+1),r=new Uint8Array(1);return r[0]=e,n.set(r),n.set(t,r.length),n}var Iu=Cn;/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 * @license MIT (© Joyent)
 */function Cn(t,e){var n={seen:[],stylize:Mu};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),Ks(e)?n.showHidden=e:e&&qu(n,e),jn(n.showHidden)&&(n.showHidden=!1),jn(n.depth)&&(n.depth=2),jn(n.colors)&&(n.colors=!1),jn(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Uu),br(n,t,n.depth)}Cn.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Cn.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Mu(t,e){return t}function Ks(t){return typeof t=="boolean"}function jn(t){return t===void 0}function Uu(t,e){var n=Cn.styles[e];return n?"\x1B["+Cn.colors[n][0]+"m"+t+"\x1B["+Cn.colors[n][1]+"m":t}function Pr(t){return typeof t=="function"}function qs(t){return typeof t=="string"}function Lu(t){return typeof t=="number"}function Ys(t){return t===null}function Fs(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ir(t){return xr(t)&&li(t)==="[object RegExp]"}function xr(t){return typeof t=="object"&&t!==null}function Mr(t){return xr(t)&&(li(t)==="[object Error]"||t instanceof Error)}function Ff(t){return xr(t)&&li(t)==="[object Date]"}function li(t){return Object.prototype.toString.call(t)}function ju(t){var e={};return t.forEach(function(n,r){e[n]=!0}),e}function Bu(t,e,n,r,i){for(var s=[],l=0,c=e.length;l<c;++l)Fs(e,String(l))?s.push(Zr(t,e,n,r,String(l),!0)):s.push("");return i.forEach(function(u){u.match(/^\d+$/)||s.push(Zr(t,e,n,r,u,!0))}),s}function Ur(t){return"["+Error.prototype.toString.call(t)+"]"}function br(t,e,n){if(t.customInspect&&e&&Pr(e.inspect)&&e.inspect!==Cn&&!(e.constructor&&e.constructor.prototype===e)){var r=e.inspect(n,t);return qs(r)||(r=br(t,r,n)),r}var i=zu(t,e);if(i)return i;var s=Object.keys(e),l=ju(s);try{t.showHidden&&Object.getOwnPropertyNames&&(s=Object.getOwnPropertyNames(e))}catch{}if(Mr(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return Ur(e);if(s.length===0){if(Pr(e)){var c=e.name?": "+e.name:"";return t.stylize("[Function"+c+"]","special")}if(Ir(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(Ff(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Mr(e))return Ur(e)}var u="",h=!1,p=["{","}"];if(Array.isArray(e)&&(h=!0,p=["[","]"]),Pr(e)){var b=e.name?": "+e.name:"";u=" [Function"+b+"]"}if(Ir(e)&&(u=" "+RegExp.prototype.toString.call(e)),Ff(e)&&(u=" "+Date.prototype.toUTCString.call(e)),Mr(e)&&(u=" "+Ur(e)),s.length===0&&(!h||e.length==0))return p[0]+u+p[1];if(n<0)return Ir(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var m;return h?m=Bu(t,e,n,l,s):m=s.map(function(y){return Zr(t,e,n,l,y,h)}),t.seen.pop(),Ku(m,u,p)}function Zr(t,e,n,r,i,s){var l,c,u;u={value:void 0};try{u.value=e[i]}catch{}try{Object.getOwnPropertyDescriptor&&(u=Object.getOwnPropertyDescriptor(e,i)||u)}catch{}if(u.get?u.set?c=t.stylize("[Getter/Setter]","special"):c=t.stylize("[Getter]","special"):u.set&&(c=t.stylize("[Setter]","special")),Fs(r,i)||(l="["+i+"]"),c||(t.seen.indexOf(u.value)<0?(Ys(n)?c=br(t,u.value,null):c=br(t,u.value,n-1),c.indexOf(`
`)>-1&&(s?c=c.split(`
`).map(function(h){return"  "+h}).join(`
`).substr(2):c=`
`+c.split(`
`).map(function(h){return"   "+h}).join(`
`))):c=t.stylize("[Circular]","special")),jn(l)){if(s&&i.match(/^\d+$/))return c;l=JSON.stringify(""+i),l.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(l=l.substr(1,l.length-2),l=t.stylize(l,"name")):(l=l.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),l=t.stylize(l,"string"))}return l+": "+c}function zu(t,e){if(jn(e))return t.stylize("undefined","undefined");if(qs(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(Lu(e))return t.stylize(""+e,"number");if(Ks(e))return t.stylize(""+e,"boolean");if(Ys(e))return t.stylize("null","null")}function Ku(t,e,n){var r=t.reduce(function(i,s){return s.indexOf(`
`)>=0,i+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function qu(t,e){if(!e||!xr(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}function cn(t,e,...n){try{e==console.log?e(`${new Date().toLocaleString()} → ${Iu(...n).replace(/^'/,"").replace(/'$/,"")}`):typeof e=="function"?e(...n):e&&e.logOutput(t,{source:"connectome"},...n)}catch(r){console.log(r)}}class Yu{write(e,...n){cn(void 0,e,...n)}red(e,...n){cn("red",e,...n)}green(e,...n){cn("green",e,...n)}yellow(e,...n){cn("yellow",e,...n)}blue(e,...n){cn("blue",e,...n)}cyan(e,...n){cn("cyan",e,...n)}magenta(e,...n){cn("magenta",e,...n)}gray(e,...n){cn("gray",e,...n)}white(e,...n){cn("white",e,...n)}}var nt=new Yu;Vt.util=Hn;function Fu({data:t,connector:e}){const{log:n}=e;$u(t)&&(t=JSON.stringify(t));const r=new Uint8Array(js(2*e.sentCount,24));if(e.closed())nt.red(n,`⚠️ Warning: "${t}" was not sent because connector is not ready`);else if(e.sentCount>1){let i=0;typeof t=="string"&&(i=1);const s=i==1?Vt.util.decodeUTF8(t):t,l=Pu(s,i),c=Vt.secretbox(l,r,e.sharedSecret);e.verbose&&(nt.green(n,`Connector ${e.endpoint} → Sending encrypted message #${e.sentCount} ↴`),nt.gray(n,t)),e.connection.websocket.send(c)}else e.verbose&&(nt.green(n,`Connector ${e.endpoint} → Sending message #${e.sentCount} ↴`),nt.gray(n,t)),e.connection.websocket.send(t)}Vt.util=Hn;function Hu(t){return Object.keys(t).includes("result")||Object.keys(t).includes("error")}function Hs({jsonData:t,encryptedData:e,rawMessage:n,wasEncrypted:r,connector:i}){const{log:s}=i;i.lastMessageAt=Date.now();const l=new Uint8Array(js(2*i.receivedCount+1,24));if(i.verbose&&!r&&nt.magenta(s,`Connector ${i.endpoint} → Received message #${i.receivedCount} ↴`),t)t.jsonrpc?Hu(t)?(i.verbose&&!r&&(nt.magenta(s,`Connector ${i.endpoint} received plain-text rpc result ↴`),nt.gray(s,t)),i.rpcClient.jsonrpcMsgReceive(n)):i.emit("json_rpc",n):i.emit("receive",{jsonData:t,rawMessage:n});else if(e){i.verbose=="extra"&&(nt.magenta(s,`Connector ${i.endpoint} received bytes ↴`),nt.gray(s,e),nt.magenta(s,`Connector ${i.endpoint} decrypting with shared secret ${i.sharedSecret}...`));const c=Vt.secretbox.open(e,l,i.sharedSecret),u=c[0],h=c.subarray(1);if(u==1){const p=Vt.util.encodeUTF8(h);i.verbose&&nt.write(s,`Received message: ${p}`);try{const b=JSON.parse(p);b.jsonrpc?Hs({jsonData:b,rawMessage:p,wasEncrypted:!0,connector:i}):b.state?i.emit("receive_state",b.state):b.diff?i.emit("receive_diff",b.diff):b.signal?i.emit(b.signal,b.data):b.stateField?i.emit("receive_state_field",b.stateField):i.emit("receive",{jsonData:b,rawMessage:p})}catch(b){throw nt.red(s,"Couldn't parse json message although the flag was for string ..."),nt.red(s,p),b}}else i.emit("receive_binary",h)}}Vt.util=Hn;function Ju({connector:t,afterFirstStep:e=()=>{}}){const{clientPrivateKey:n,clientPublicKey:r,clientPublicKeyHex:i,protocol:s,tag:l,endpoint:c,verbose:u}=t;return new Promise((h,p)=>{t.remoteObject("Auth").call("exchangePubkeys",{pubkey:i}).then(b=>{const m=Vt.box.before(Wr(b),n);e({sharedSecret:m,remotePubkeyHex:b}),u&&nt.write(t.log,`Connector ${c} established shared secret through diffie-hellman exchange.`),t.remoteObject("Auth").call("finalizeHandshake",{protocol:s}).then(y=>{if(y&&y.error)console.log(y.error);else{h();const w=l?` (${l})`:"";nt.cyan(t.log,`${c}${w} ✓ Connection [ ${s||'"no-name"'} ] ready`)}}).catch(p)}).catch(p)})}class Wu extends gr{constructor(e){super(),this.connector=e}send(...e){this.connector.send(...e)}}var Qt={PARSE_ERROR:-32700,INVALID_REQUEST:-32600,METHOD_NOT_FOUND:-32601,INVALID_PARAMS:-32602,REMOTE_INTERNAL_ERROR:-32603,TIMEOUT:-32701};class Js{constructor({transports:e}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transportsToRegister=e,this.methods={}}setMethodPrefix(e){this.methodPrefix=e}expose(e){this.methods=e}registerTransport(e){e.onData(this._processRequest.bind(this,e))}async _processRequest(e,n){const r=JSON.parse(n);let i;return Array.isArray(r)?i=await Promise.all(r.map(s=>this._callMethod(s,e))):i=await this._callMethod(r,e),JSON.stringify(i)}async _callMethod(e,n){if(!e.hasOwnProperty("method"))return;const{method:i,params:s=[],id:l}=e;let c=i;if(c.includes("::")){const[p,b]=c.split("::");if(c=b,this.methodPrefix&&p!=this.methodPrefix)return}const u=!this.methods[c]||typeof this.methods[c]!="function"||c==="constructor"||c.startsWith("_")||this.methods[c]===Object.prototype[c];let h={};if(u)h={jsonrpc:"2.0",id:l,error:{code:Qt.METHOD_NOT_FOUND,message:`Method [${c}] not found on remote target object`}};else{this.currentTransport=n;try{const p=await this.methods[c].apply(this.methods,s);if(!l)return;h={jsonrpc:"2.0",result:typeof p>"u"?null:p,id:l}}catch(p){console.log(`Exposed RPC method ${i} internal error:`),console.log(p),console.log("Sending this error as a result to calling client ..."),h={jsonrpc:"2.0",error:{code:Qt.REMOTE_INTERNAL_ERROR,message:`Method [${i}] internal error: ${p.stack}`},id:l}}}return h}run(){for(const e of this.transportsToRegister)this.registerTransport(e);this.transportsToRegister=[]}}class Dn extends Error{constructor(e={}){if(super(),!e.code)throw new Error("Code required");if(!e.message)throw new Error("Message required");this.code=e.code,this.message=e.message}}class Zu extends Dn{constructor(e){super({code:Qt.METHOD_NOT_FOUND,message:e||"Method not found"})}}class Gu extends Dn{constructor(){super({code:Qt.INVALID_PARAMS,message:"Invalid params"})}}class Vu extends Dn{constructor(e){super({code:Qt.REMOTE_INTERNAL_ERROR,message:`Error originating at remote endpoint: ${e}`||"Remote Internal error"})}}class Qu extends Dn{constructor(){super({code:Qt.PARSE_ERROR,message:"Parse error"})}}class Xu extends Dn{constructor(){super({code:Qt.INVALID_REQUEST,message:"Invalid request"})}}class Ws extends Dn{}class e0 extends Ws{constructor(e,n){super({code:Qt.TIMEOUT,message:`Request exceeded maximum execution time (${n}ms): ${e}`})}}var Lr={Base:Dn,MethodNotFound:Zu,InvalidRequest:Xu,InvalidParams:Gu,RemoteInternalError:Vu,ServerError:Ws,ParseError:Qu,RequestTimeout:e0};class Zs{constructor({transport:e,requestTimeout:n=2e4}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transport=e,this.requestTimeout=n,this.pendingRequest={},this.initialized=!1}setMethodPrefix(e){this.methodPrefix=e}async callMethod(e,n){this._init();const r=this.methodPrefix?`${this.methodPrefix}::${e}`:e,i=this._makeRequestObject({method:r,params:n});return this._sendRequest({object:i,id:i.id})}notify(e,n){this._init();const r=this._makeRequestObject({method:e,params:n,mode:"notify"});return this.transport.sendData(JSON.stringify(r)),!0}async runBatch(e){const n=this._generateId();let r=!0;const i=[];for(const[s,l,c]of e){const u=this._makeRequestObject({method:s,params:l,mode:c,batchId:n});u.id&&(r=!1),i.push(u)}return r?this.transport.sendData(JSON.stringify(i)):this._sendRequest({object:i,id:n})}_init(){this.initialized||(this.transport.onData(this._processResponse.bind(this)),this.initialized=!0)}_sendRequest({object:e,id:n}){const r=JSON.stringify(e);return new Promise((i,s)=>{this.pendingRequest[n]={resolve:i,reject:s,sentObject:e},setTimeout(()=>{this.pendingRequest[n]&&(delete this.pendingRequest[n],s(new Lr.RequestTimeout(r,this.requestTimeout)))},this.requestTimeout);try{this.transport.sendData(r)}catch(l){delete this.pendingRequest[n],s(l)}})}_processResponse(e){const n=JSON.parse(e);Array.isArray(n)?this._processBatchResponse(n):this._processSingleCallResponse(n)}_processSingleCallResponse(e){const n=e.hasOwnProperty("result")||!1,r=e.hasOwnProperty("error");if(!n&&!r)return;const i=this.pendingRequest[e.id];if(delete this.pendingRequest[e.id],!!i){if(n)i.resolve(e.result);else if(r){const s=this._makeErrorObject(e.error);i.reject(s)}}}_processBatchResponse(e){let n;const r={},i=[];for(const h of e)h.id?(n||(n=h.id.split("|")[0]),r[h.id]=h):h.error&&i.push(h.error);if(!this.pendingRequest[n])return;const{sentObject:s,resolve:l}=this.pendingRequest[n];delete this.pendingRequest[n];const c=[];let u=0;for(const h of s){if(!h.id){c.push(null);continue}const p=r[h.id];p?p.hasOwnProperty("result")||!1?c.push({success:!0,result:p.result}):c.push({success:!1,result:this._makeErrorObject(p.error)}):(c.push({success:!1,error:this._makeErrorObject(i[u])}),u++)}l(c)}_makeRequestObject({method:e,params:n,mode:r,batchId:i}){const s={jsonrpc:"2.0",method:e};return n&&n.length&&(s.params=n),r!=="notify"&&(s.id=i?`${i}|${this._generateId()}`:this._generateId()),s}_makeErrorObject(e){const n={[Qt.METHOD_NOT_FOUND]:()=>new Lr.MethodNotFound(e.message),[Qt.REMOTE_INTERNAL_ERROR]:()=>new Lr.RemoteInternalError(e.message)}[e.code];return n()}_generateId(){const e="bjectSymhasOwnProp-0123456789ABCDEFGHIJKLMNQRTUVWXYZ_dfgiklquvxz";let n=10,r="";for(;0<n--;)r+=e[Math.random()*64|0];return r}}function t0(t){const e=Hf(t.callMethod.bind(t)),n=Hf(t.notify.bind(t));return new Proxy(t,{get(r,i){if(i==="notify")return n;if(i==="callMethod")return e;if(i!=="then")return i==="setMethodPrefix"?(...s)=>t.setMethodPrefix(s):(...s)=>r.callMethod.call(r,i,s)}})}function Hf(t){return new Proxy(t,{get(e,n){return(...r)=>e.call(null,n,r)},apply(e,n,r){return e.apply(null,r)}})}class n0 extends Zs{constructor(...e){return super(...e),t0(this)}}class r0{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",e)}sendData(e){this.channel.send(e)}}class Gs{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",async n=>{const r=await e(n);r&&this.channel.send(r)})}}var i0=Object.freeze({__proto__:null,MoleServer:Js,MoleClient:Zs,MoleClientProxified:n0,ClientTransport:r0,ServerTransport:Gs});class f0 extends Error{constructor(e,n){super(e),this.name=this.constructor.name,this.errorCode=n}errorCode(){return this.errorCode}}const{MoleClient:s0,ClientTransport:o0}=i0;class l0{constructor(e,n,r){this.moleChannel=new Wu(e),this.methodPrefix=n,this.connectorOrServersideChannel=e,this.client=new s0({requestTimeout:r,transport:new o0(this.moleChannel)})}jsonrpcMsgReceive(e){this.moleChannel.emit("json_rpc",e)}call(e,n){return this.connectorOrServersideChannel.closed()?new Promise((r,i)=>{i(new f0(`Method call [${this.methodPrefix}::${e}] on closed channel or connector ignored. Please add a check for closed channel in your code.`,"CLOSED_CHANNEL"))}):this.client.callMethod(`${this.methodPrefix}::${e}`,n)}}const c0=1e4;class a0{constructor(e,n){this.connectorOrServersideChannel=e,this.remoteObjects={},this.requestTimeout=n||c0}remoteObject(e){return this.remoteObjects[e]||(this.remoteObjects[e]=new l0(this.connectorOrServersideChannel,e,this.requestTimeout)),this.remoteObjects[e]}jsonrpcMsgReceive(e){for(const n of Object.values(this.remoteObjects))n.jsonrpcMsgReceive(e)}}class u0{constructor({serversideChannel:e,serverMethods:n,methodPrefix:r}){const i=[new Gs(e)];this.server=new Js({transports:i}),this.server.expose(n),this.server.setMethodPrefix(r),this.server.run()}}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var d0=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),h0=Object.prototype.hasOwnProperty;function Gr(t,e){return h0.call(t,e)}function Vr(t){if(Array.isArray(t)){for(var n=new Array(t.length),e=0;e<n.length;e++)n[e]=""+e;return n}if(Object.keys)return Object.keys(t);var n=[];for(var r in t)Gr(t,r)&&n.push(r);return n}function Yt(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function Qr(t){for(var e=0,n=t.length,r;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function On(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function Vs(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function Xr(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(Xr(t[e]))return!0}else if(typeof t=="object"){for(var r=Vr(t),i=r.length,e=0;e<i;e++)if(Xr(t[r[e]]))return!0}}return!1}function Jf(t,e){var n=[t];for(var r in e){var i=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var Qs=function(t){d0(e,t);function e(n,r,i,s,l){var c=this.constructor,u=t.call(this,Jf(n,{name:r,index:i,operation:s,tree:l}))||this;return u.name=r,u.index=i,u.operation=s,u.tree=l,Object.setPrototypeOf(u,c.prototype),u.message=Jf(n,{name:r,index:i,operation:s,tree:l}),u}return e}(Error),pt=Qs,_0=Yt,Bn={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=vr(n,this.path);r&&(r=Yt(r));var i=Rn(n,{op:"remove",path:this.from}).removed;return Rn(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=vr(n,this.from);return Rn(n,{op:"add",path:this.path,value:Yt(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:er(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},p0={add:function(t,e,n){return Qr(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:Bn.move,copy:Bn.copy,test:Bn.test,_get:Bn._get};function vr(t,e){if(e=="")return t;var n={op:"_get",path:e};return Rn(t,n),n.value}function Rn(t,e,n,r,i,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):mr(e,0)),e.path===""){var l={newDocument:t};if(e.op==="add")return l.newDocument=e.value,l;if(e.op==="replace")return l.newDocument=e.value,l.removed=t,l;if(e.op==="move"||e.op==="copy")return l.newDocument=vr(t,e.from),e.op==="move"&&(l.removed=t),l;if(e.op==="test"){if(l.test=er(t,e.value),l.test===!1)throw new pt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l.newDocument=t,l}else{if(e.op==="remove")return l.removed=t,l.newDocument=null,l;if(e.op==="_get")return e.value=t,l;if(n)throw new pt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return l}}else{r||(t=Yt(t));var c=e.path||"",u=c.split("/"),h=t,p=1,b=u.length,m=void 0,y=void 0,w=void 0;for(typeof n=="function"?w=n:w=mr;;){if(y=u[p],i&&y=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&m===void 0&&(h[y]===void 0?m=u.slice(0,p).join("/"):p==b-1&&(m=e.path),m!==void 0&&w(e,0,t,m)),p++,Array.isArray(h)){if(y==="-")y=h.length;else{if(n&&!Qr(y))throw new pt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);Qr(y)&&(y=~~y)}if(p>=b){if(n&&e.op==="add"&&y>h.length)throw new pt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var l=p0[e.op].call(e,h,y,t);if(l.test===!1)throw new pt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}}else if(y&&y.indexOf("~")!=-1&&(y=Vs(y)),p>=b){var l=Bn[e.op].call(e,h,y,t);if(l.test===!1)throw new pt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}h=h[y]}}}function ci(t,e,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(e))throw new pt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=Yt(t));for(var s=new Array(e.length),l=0,c=e.length;l<c;l++)s[l]=Rn(t,e[l],n,!0,i,l),t=s[l].newDocument;return s.newDocument=t,s}function b0(t,e,n){var r=Rn(t,e);if(r.test===!1)throw new pt("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function mr(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new pt("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(Bn[t.op]){if(typeof t.path!="string")throw new pt("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new pt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new pt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new pt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&Xr(t.value))throw new pt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var i=t.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new pt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new pt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var l={op:"_get",path:t.from,value:void 0},c=Xs([l],n);if(c&&c.name==="OPERATION_PATH_UNRESOLVABLE")throw new pt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new pt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function Xs(t,e,n){try{if(!Array.isArray(t))throw new pt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)ci(Yt(e),Yt(t),n||!0);else{n=n||mr;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof pt)return i;throw i}}function er(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),i,s,l;if(n&&r){if(s=t.length,s!=e.length)return!1;for(i=s;i--!==0;)if(!er(t[i],e[i]))return!1;return!0}if(n!=r)return!1;var c=Object.keys(t);if(s=c.length,s!==Object.keys(e).length)return!1;for(i=s;i--!==0;)if(!e.hasOwnProperty(c[i]))return!1;for(i=s;i--!==0;)if(l=c[i],!er(t[l],e[l]))return!1;return!0}return t!==t&&e!==e}var v0=Object.freeze({__proto__:null,JsonPatchError:pt,deepClone:_0,getValueByPointer:vr,applyOperation:Rn,applyPatch:ci,applyReducer:b0,validator:mr,validate:Xs,_areEquals:er});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var ai=new WeakMap,m0=function(){function t(e){this.observers=new Map,this.obj=e}return t}(),y0=function(){function t(e,n){this.callback=e,this.observer=n}return t}();function g0(t){return ai.get(t)}function x0(t,e){return t.observers.get(e)}function w0(t,e){t.observers.delete(e.callback)}function A0(t,e){e.unobserve()}function E0(t,e){var n=[],r,i=g0(t);if(!i)i=new m0(t),ai.set(t,i);else{var s=x0(i,e);r=s&&s.observer}if(r)return r;if(r={},i.value=Yt(t),e){r.callback=e,r.next=null;var l=function(){ei(r)},c=function(){clearTimeout(r.next),r.next=setTimeout(l)};typeof window<"u"&&(window.addEventListener("mouseup",c),window.addEventListener("keyup",c),window.addEventListener("mousedown",c),window.addEventListener("keydown",c),window.addEventListener("change",c))}return r.patches=n,r.object=t,r.unobserve=function(){ei(r),clearTimeout(r.next),w0(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",c),window.removeEventListener("keyup",c),window.removeEventListener("mousedown",c),window.removeEventListener("keydown",c),window.removeEventListener("change",c))},i.observers.set(e,new y0(e,r)),r}function ei(t,e){e===void 0&&(e=!1);var n=ai.get(t.object);ui(n.value,t.object,t.patches,"",e),t.patches.length&&ci(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function ui(t,e,n,r,i){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=Vr(e),l=Vr(t),c=!1,u=l.length-1;u>=0;u--){var h=l[u],p=t[h];if(Gr(e,h)&&!(e[h]===void 0&&p!==void 0&&Array.isArray(e)===!1)){var b=e[h];typeof p=="object"&&p!=null&&typeof b=="object"&&b!=null?ui(p,b,n,r+"/"+On(h),i):p!==b&&(i&&n.push({op:"test",path:r+"/"+On(h),value:Yt(p)}),n.push({op:"replace",path:r+"/"+On(h),value:Yt(b)}))}else Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+On(h),value:Yt(p)}),n.push({op:"remove",path:r+"/"+On(h)}),c=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!c&&s.length==l.length))for(var u=0;u<s.length;u++){var h=s[u];!Gr(t,h)&&e[h]!==void 0&&n.push({op:"add",path:r+"/"+On(h),value:Yt(e[h])})}}}function S0(t,e,n){n===void 0&&(n=!1);var r=[];return ui(t,e,r,"",n),r}var O0=Object.freeze({__proto__:null,unobserve:A0,observe:E0,generate:ei,compare:S0}),T0=Object.assign({},v0,O0,{JsonPatchError:Qs,deepClone:Yt,escapePathComponent:On,unescapePathComponent:Vs});const{applyPatch:k0}=T0;class C0 extends qn{constructor(e){super({}),this.connector=e,this.connector.on("receive_state",n=>{this.wireStateReceived=!0,this.set(n)}),this.connector.on("receive_diff",n=>{this.wireStateReceived&&(k0(this.state,n),this.announceStateChange())})}field(e){return this.connector.connectionState.get(e)}}class R0 extends qn{constructor(e){super({}),this.fields={},this.connector=e,this.connector.on("receive_state_field",({name:n,state:r})=>{this.get(n).set(r)})}get(e){return this.fields[e]||(this.fields[e]=new qn),this.fields[e]}}Vt.util=Hn;const N0=700,D0=6e4,$0=1;class P0 extends gr{constructor({endpoint:e,protocol:n,keypair:r=Bs(),rpcRequestTimeout:i,verbose:s=!1,tag:l,log:c=console.log,autoDecommission:u=!1,dummy:h}={}){super(),this.protocol=n,this.log=c;const{privateKey:p,publicKey:b}=zs(r);this.clientPrivateKey=p,this.clientPublicKey=b,this.clientPublicKeyHex=pr(b),this.rpcClient=new a0(this,i),this.endpoint=e,this.verbose=s,this.tag=l,this.autoDecommission=u,this.sentCount=0,this.receivedCount=0,this.successfulConnectsCount=0,h||(this.state=new C0(this),this.connectionState=new R0(this)),this.connected=new qn,this.delayedAdjustConnectionStatus(),s&&nt.green(this.log,`Connector ${this.endpoint} created`),this.decommissionCheckCounter=0,this.lastPongReceivedAt=Date.now(),this.on("pong",()=>{this.lastPongReceivedAt=Date.now()})}delayedAdjustConnectionStatus(){setTimeout(()=>{this.connected.get()==null&&this.connected.set(!1)},N0)}send(e){Fu({data:e,connector:this}),this.sentCount+=1}signal(e,n){this.connected.get()?this.send({signal:e,data:n}):nt.write(this.log,"Warning: trying to send signal over disconnected connector, this should be prevented by GUI")}userAction({action:e,scope:n,payload:r}){this.signal("__action",{action:e,scope:n,payload:r})}on(e,n){e=="ready"&&this.isReady()&&n(),super.on(e,n)}getSharedSecret(){return this.sharedSecret?pr(this.sharedSecret):void 0}wireReceive({jsonData:e,encryptedData:n,rawMessage:r}){Hs({jsonData:e,encryptedData:n,rawMessage:r,connector:this}),this.receivedCount+=1}field(e){return this.connectionState.get(e)}isReady(){return this.ready}closed(){return!this.transportConnected}connectStatus(e){if(e){this.sentCount=0,this.receivedCount=0,this.transportConnected=!0,this.successfulConnectsCount+=1,this.verbose&&nt.green(this.log,`✓ Connector ${this.endpoint} connected #${this.successfulConnectsCount}`);const n=this.connection.websocket.__id;Ju({connector:this,afterFirstStep:({sharedSecret:i,remotePubkeyHex:s})=>{this.sharedSecret=i,this._remotePubkeyHex=s}}).then(()=>{this.connectedAt=Date.now(),this.connected.set(!0),this.ready=!0,this.emit("ready")}).catch(i=>{this.connection.websocket.__id==n&&this.connection.websocket.readyState==$0&&i.code==Qt.TIMEOUT&&(nt.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] handshake error: "${i.message}"`),nt.write(this.log,`${this.endpoint} Connector dropping stale websocket after handshake error`),this.connection.terminate()),i.code!=Qt.TIMEOUT&&nt.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] on:ready error: "${i.stack}" — (will not try to reconnect, fix the error and reload this gui)`)})}else{let n;this.transportConnected&&(n=!0),this.transportConnected==null&&nt.write(this.log,`${this.endpoint} Connector was not able to connect at first try`),this.transportConnected=!1,this.ready=!1,this.sharedSecret=void 0,delete this.connectedAt,n&&(this.emit("disconnect"),e==null&&this.delayedAdjustConnectionStatus(),this.connected.set(e))}}checkForDecommission(){this.autoDecommission&&(this.decommissionCheckRequestedAt&&Date.now()-this.decommissionCheckRequestedAt>3e3&&(this.decommissionCheckCounter=0),this.decommissionCheckRequestedAt=Date.now(),this.decommissionCheckCounter+=1,this.decommissionCheckCounter>12&&Date.now()-this.lastPongReceivedAt>D0&&(nt.write(this.log,`Decommissioning connector ${this.endpoint} (long inactive)`),this.decommission(),this.emit("decommission")))}decommission(){this.decommissioned=!0}remoteObject(e){return{call:(n,r=[])=>this.rpcClient.remoteObject(e).call(n,Du(r))}}attachObject(e,n){new u0({serversideChannel:this,serverMethods:n,methodPrefix:e})}clientPubkey(){return this.clientPublicKeyHex}remotePubkeyHex(){return this._remotePubkeyHex}remoteAddress(){return this.endpoint}}const Wf=typeof window<"u";function I0({endpoint:t,host:e,port:n}){if(Wf&&t&&t.startsWith("/")&&(t=`${window.location.protocol.includes("s")?"wss":"ws"}://${window.location.host}${t}`),!t)if(Wf){e=e||window.location.hostname;const r=window.location.protocol.includes("s")?"wss":"ws";t=`${r}://${e}`,r=="wss"?t=`${r}://${e}/ws`:n?t=`${t}:${n}`:window.location.port&&(t=`${t}:${window.location.port}`)}else{if(!n)throw new Error(`Connectome determineEndpoint: No websocket port provided for ${e}`);t=`ws://${e||"localhost"}:${n}`}return t}const un=typeof window<"u",M0=0,U0=1,L0=1e3,j0=3,B0=5;function z0({endpoint:t,host:e,port:n,protocol:r,keypair:i,remotePubkey:s,rpcRequestTimeout:l,autoDecommission:c,log:u,verbose:h,tag:p,dummy:b},{WebSocket:m}){t=I0({endpoint:t,host:e,port:n});const y=new P0({endpoint:t,protocol:r,rpcRequestTimeout:l,keypair:i,verbose:h,tag:p,log:u,autoDecommission:c,dummy:b}),w=()=>{q0({connector:y,endpoint:t},{WebSocket:m,reconnect:w,log:u,verbose:h})};y.connection={terminate(){this.websocket._removeAllCallbacks(),this.websocket.close(),y.connectStatus(!1),w()},endpoint:t,checkTicker:0};const S=()=>{y.decommissioned||(K0({connector:y,reconnect:w,log:u}),setTimeout(S,L0))};return setTimeout(S,10),y}function K0({connector:t,reconnect:e,log:n}){const r=t.connection;if(F0(r)||t.decommissioned){t.decommissioned?(nt.yellow(n,`${t.endpoint} Connection decommisioned, closing websocket ${r.websocket.__id}, will not retry again `),eo(t)):(t.emit("inactive_connection"),nt.yellow(n,`${t.endpoint} ✖ Terminated inactive connection`)),r.terminate();return}to(r)?r.websocket.send("ping"):(t.connected==null&&(nt.write(n,`${t.endpoint} Setting connector status to FALSE because connector.connected is undefined`),t.connectStatus(!1)),e()),r.checkTicker+=1}function q0({connector:t,endpoint:e},{WebSocket:n,reconnect:r,log:i,verbose:s}){const l=t.connection;if(t.checkForDecommission(),t.decommissioned){eo(t);return}if(l.currentlyTryingWS&&l.currentlyTryingWS.readyState==M0){if(l.currentlyTryingWS._waitForConnectCounter<B0){l.currentlyTryingWS._waitForConnectCounter+=1;return}(s||un)&&nt.write(i,`${e} Reconnect timeout, creating new ws`),l.currentlyTryingWS._removeAllCallbacks(),l.currentlyTryingWS.close()}else(s||un)&&nt.write(i,`${e} Created new websocket`);const c=new n(e);c.__id=Math.random(),l.currentlyTryingWS=c,l.currentlyTryingWS._waitForConnectCounter=0,un&&(c.binaryType="arraybuffer"),un||c.on("error",()=>{});const u=()=>{t.decommissioned||((s||un)&&nt.write(i,`${e} Websocket open`),l.currentlyTryingWS=null,l.checkTicker=0,Y0({ws:c,connector:t,openCallback:u,reconnect:r},{log:i,verbose:s}),l.websocket=c,t.connectStatus(!0))};c._removeAllCallbacks=()=>{c.removeEventListener("open",u)},un?c.addEventListener("open",u):c.on("open",u)}function Y0({ws:t,connector:e,openCallback:n,reconnect:r},{log:i,verbose:s}){const l=e.connection,c=p=>{const b=`${e.endpoint} Websocket error`;console.log(b),console.log(p)},u=()=>{if(nt.write(i,`${e.endpoint} ✖ Connection closed`),e.decommissioned){e.connectStatus(!1);return}e.connectStatus(void 0),r()},h=p=>{if(e.decommissioned)return;l.checkTicker=0;const b=un?p.data:p;if(b=="pong"){e.emit("pong");return}let m;try{m=JSON.parse(b)}catch{}if(m)e.wireReceive({jsonData:m,rawMessage:b});else{const y=un?new Uint8Array(b):b;e.wireReceive({encryptedData:y})}};t._removeAllCallbacks=()=>{t.removeEventListener("error",c),t.removeEventListener("close",u),t.removeEventListener("message",h),t.removeEventListener("open",n)},un?(t.addEventListener("error",c),t.addEventListener("close",u),t.addEventListener("message",h)):(t.on("error",c),t.on("close",u),t.on("message",h))}function eo(t){const e=t.connection;e.currentlyTryingWS&&(e.currentlyTryingWS._removeAllCallbacks(),e.currentlyTryingWS.close(),e.currentlyTryingWS=null),e.ws&&(e.ws._removeAllCallbacks(),e.ws.close(),e.ws=null),t.connectStatus(!1)}function to(t){return t.websocket&&t.websocket.readyState==U0}function F0(t){return to(t)&&t.checkTicker>j0}function H0(t){return t.log=t.log||console.log,z0(t,{WebSocket})}class J0{constructor({mcs:e,foreground:n,connectToDeviceKey:r}){this.mcs=e,this.foreground=n,this.connectToDeviceKey=r}createConnector({host:e,autoDecommission:n=!1}){const{port:r,protocol:i,rpcRequestTimeout:s,log:l,verbose:c,keypair:u}=this.mcs;return H0({host:e,port:r,protocol:i,keypair:u,rpcRequestTimeout:s,autoDecommission:n,log:l,verbose:c})}getDeviceKey(e){var n;return(n=e==null?void 0:e.device)==null?void 0:n.deviceKey}connectThisDevice({host:e}){const n=this.createConnector({host:e});let r=!1;return n.state.subscribe(i=>{var l;i.nearbyDevices||(i.nearbyDevices=[]),i.notifications||(i.notifications=[]);const s=this.getDeviceKey(i);if(s){r||(n.on("pong",()=>{this.mcs.emit("pong",{deviceKey:s})}),r=!0),this.thisDeviceAlreadySetup||(this.mcs.set({activeDeviceKey:s}),this.initNewConnector({deviceKey:s,connector:n}));const c=this.connectToDeviceKey&&this.connectToDeviceKey!=s;if(!c&&this.mcs.activeDeviceKey()==s){const u=(l=i.device)==null?void 0:l.deviceName;this.foreground.set(i,{optimisticDeviceName:u})}this.foreground.setSpecial(i),this.thisDeviceAlreadySetup||(c&&(this.mcs.switch({deviceKey:this.connectToDeviceKey}),delete this.connectToDeviceKey),this.thisDeviceAlreadySetup=!0)}}),n}connectOtherDevice({host:e,deviceKey:n}){if(!this.mcs.connectors[n]){const r=this.createConnector({host:e,autoDecommission:!0});r.on("decommission",()=>{delete this.mcs.connectors[n],r.__removeListeners&&r.__removeListeners()});const i=()=>{this.mcs.emit("pong",{deviceKey:n})};r.on("pong",i),this.initNewConnector({deviceKey:n,connector:r});const s=r.state.subscribe(l=>{if(this.mcs.activeDeviceKey()==n){const c=l.device?l.device.deviceName:null;this.foreground.set(l,{optimisticDeviceName:c})}});r.__removeListeners=()=>{r.off("pong",i),s()}}return this.mcs.connectors[n]}initNewConnector({deviceKey:e,connector:n}){this.mcs.connectors[e]=n,this.setConnectedStore({deviceKey:e,connector:n})}setConnectedStore({deviceKey:e,connector:n}){n.connected.subscribe(r=>{this.mcs.activeDeviceKey()==e&&this.mcs.connected.set(r)})}}function no(t,e=0,n={}){const r=["day","h","min","s"],i=[24,60,60,1e3];if(e==r.length)return n.ms=t,n;e==0&&(n.totalSeconds=t/1e3);const s=i.slice(e).reduce((l,c)=>l*c,1);return n[r[e]]=Math.floor(t/s),no(t%s,e+1,n)}function W0(t){const e=["day","h","min","s"];let n="";for(const r of e)t[r]>0&&(r!="s"||r=="s"&&t.totalSeconds<60)&&(n=`${n} ${t[r]} ${r}`);return n.trim()}function ro(t){if(t){const e=Date.now(),n=3e3;return t.filter(r=>e<r.expireAt).map(r=>({...r,relativeTimeAdded:e-r.addedAt<n?"now":`${W0(no(e-r.addedAt))} ago`}))}return[]}class Z0{constructor({mcs:e,thisDeviceStateKeys:n}){this.mcs=e,this.thisDeviceStateKeys=n}specialStoreKeys(){return this.thisDeviceStateKeys.concat(["activeDeviceKey","optimisticDeviceName"])}clear(){this.mcs.clearState({except:this.specialStoreKeys()})}set(e,{optimisticDeviceName:n=void 0}={}){this.clear();const r={};for(const i of Object.keys(e))this.specialStoreKeys().includes(i)||(r[i]=e[i]);n&&(r.optimisticDeviceName=n),this.mcs.setMerge(r)}setSpecial(e){const n={};for(const r of this.thisDeviceStateKeys)r=="notifications"?n[r]=ro(e[r]):n[r]=e[r];this.mcs.setMerge(n)}}class G0 extends gr{constructor({mcs:e,connectDevice:n,foreground:r}){super(),this.mcs=e,this.connectDevice=n,this.foreground=r}switchState({deviceKey:e,deviceName:n}){this.mcs.setMerge({activeDeviceKey:e});const{state:r,connected:i}=this.mcs.connectors[e];this.foreground.set(r.get(),{optimisticDeviceName:n}),this.mcs.connected.set(i.get())}switch({host:e,deviceKey:n,deviceName:r}){if(this.mcs.connectors[n])this.switchState({deviceKey:n,deviceName:r});else if(e)this.foreground.clear(),this.mcs.setMerge({activeDeviceKey:n,optimisticDeviceName:r}),this.connectDevice.connectOtherDevice({host:e,deviceKey:n});else{const i=this.mcs.localConnector.state.get(),{nearbyDevices:s}=i,l=s.find(c=>c.deviceKey==n&&!c.thisDevice);if(l){const{deviceKey:c,deviceName:u,ip:h}=l;this.switch({host:h,deviceKey:c,deviceName:u})}else this.emit("connect_to_device_key_failed"),this.switchState(i.device)}}}const V0=500;class Q0 extends Ou{constructor({host:e,port:n,protocol:r,keypair:i=Bs(),connectToDeviceKey:s,rpcRequestTimeout:l=3e3,log:c,verbose:u}){super();const h=["time","environment","nearbyDevices","nearbySensors","notifications"],{publicKey:p,privateKey:b}=zs(i);this.publicKey=p,this.privateKey=b,this.keypair=i,this.port=n,this.protocol=r,this.log=c,this.rpcRequestTimeout=l,this.verbose=u,this.connectors={},this.connected=new qn;const m=new Z0({mcs:this,thisDeviceStateKeys:h}),y=new J0({mcs:this,foreground:m,connectToDeviceKey:s});this.connectDevice=y,this.switchDevice=new G0({mcs:this,connectDevice:y,foreground:m}),this.switchDevice.on("connect_to_device_key_failed",()=>{this.emit("connect_to_device_key_failed")}),this.localConnector=y.connectThisDevice({host:e}),this._notificationsExpireAndCalculateRelativeTime()}_notificationsExpireAndCalculateRelativeTime(){const{notifications:e}=this.get();this.setMerge({notifications:ro(e)}),setTimeout(()=>{this._notificationsExpireAndCalculateRelativeTime()},V0)}signal(e,n){this.activeConnector()?this.activeConnector().signal(e,n):console.log(`MCS: Error emitting remote signal ${e} / ${n}. Debug info: activeDeviceKey=${this.activeDeviceKey()}`)}signalLocalDevice(e,n){this.localConnector.signal(e,n)}remoteObject(e){if(this.activeConnector())return this.activeConnector().remoteObject(e);console.log(`Error obtaining remote object ${e}. Debug info: activeDeviceKey=${this.activeDeviceKey()}`)}preconnect({host:e,deviceKey:n,thisDevice:r}){return r?this.localConnector:this.connectDevice.connectOtherDevice({host:e,deviceKey:n})}switch({host:e,deviceKey:n,deviceName:r}){this.switchDevice.switch({host:e,deviceKey:n,deviceName:r})}activeConnector(){if(this.activeDeviceKey())return this.connectors[this.activeDeviceKey()]}activeDeviceKey(){return this.get().activeDeviceKey}}const X0=7780,e1="dmt/gui",io=localStorage.getItem("current_device_key");console.log(`connectToDeviceKey: ${io}`);const fo=new Q0({port:X0,protocol:e1,connectToDeviceKey:io,log:Wt.log});fo.on("connect_to_device_key_failed",()=>{console.log("connect_to_device_key_failed FAILED"),localStorage.removeItem("current_device_key")});window.onerror=ko(hs);new xu({target:document.body,props:{store:fo,log:Wt.log}});
