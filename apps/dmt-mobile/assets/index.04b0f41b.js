const Xs=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))r(f);new MutationObserver(f=>{for(const s of f)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(f){const s={};return f.integrity&&(s.integrity=f.integrity),f.referrerpolicy&&(s.referrerPolicy=f.referrerpolicy),f.crossorigin==="use-credentials"?s.credentials="include":f.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(f){if(f.ep)return;f.ep=!0;const s=n(f);fetch(f.href,s)}};Xs();function xe(){}const ti=t=>t;function eo(t,e){for(const n in e)t[n]=e[n];return t}function zf(t){return t()}function di(){return Object.create(null)}function gt(t){t.forEach(zf)}function Qn(t){return typeof t=="function"}function at(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let Xn;function hi(t,e){return Xn||(Xn=document.createElement("a")),Xn.href=e,t===Xn.href}function to(t){return Object.keys(t).length===0}function Tt(t,...e){if(t==null)return xe;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function no(t){let e;return Tt(t,n=>e=n)(),e}function yt(t,e,n){t.$$.on_destroy.push(Tt(e,n))}function qf(t,e,n,r){if(t){const f=Yf(t,e,n,r);return t[0](f)}}function Yf(t,e,n,r){return t[1]&&r?eo(n.ctx.slice(),t[1](r(e))):n.ctx}function Ff(t,e,n,r){if(t[2]&&r){const f=t[2](r(n));if(e.dirty===void 0)return f;if(typeof f=="object"){const s=[],l=Math.max(e.dirty.length,f.length);for(let c=0;c<l;c+=1)s[c]=e.dirty[c]|f[c];return s}return e.dirty|f}return e.dirty}function Hf(t,e,n,r,f,s){if(f){const l=Yf(e,n,r,s);t.p(l,f)}}function Jf(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}const Wf=typeof window<"u";let Zf=Wf?()=>window.performance.now():()=>Date.now(),ni=Wf?t=>requestAnimationFrame(t):xe;const Ln=new Set;function Gf(t){Ln.forEach(e=>{e.c(t)||(Ln.delete(e),e.f())}),Ln.size!==0&&ni(Gf)}function Vf(t){let e;return Ln.size===0&&ni(Gf),{promise:new Promise(n=>{Ln.add(e={c:t,f:n})}),abort(){Ln.delete(e)}}}function O(t,e){t.appendChild(e)}function Qf(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function ro(t){const e=U("style");return io(Qf(t),e),e.sheet}function io(t,e){O(t.head||t,e)}function D(t,e,n){t.insertBefore(e,n||null)}function N(t){t.parentNode.removeChild(t)}function Cn(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function U(t){return document.createElement(t)}function K(t){return document.createTextNode(t)}function J(){return K(" ")}function xt(){return K("")}function Re(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function Xf(t){return function(e){return e.preventDefault(),t.call(this,e)}}function _i(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function L(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function fo(t){return Array.from(t.childNodes)}function Pe(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function pi(t,e){t.value=e==null?"":e}function er(t,e,n,r){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function ce(t,e,n){t.classList[n?"add":"remove"](e)}function so(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const f=document.createEvent("CustomEvent");return f.initCustomEvent(t,n,r,e),f}const ir=new Map;let fr=0;function oo(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function lo(t,e){const n={stylesheet:ro(e),rules:{}};return ir.set(t,n),n}function es(t,e,n,r,f,s,l,c=0){const d=16.666/r;let h=`{
`;for(let I=0;I<=1;I+=d){const T=e+(n-e)*s(I);h+=I*100+`%{${l(T,1-T)}}
`}const p=h+`100% {${l(n,1-n)}}
}`,b=`__svelte_${oo(p)}_${c}`,m=Qf(t),{stylesheet:y,rules:S}=ir.get(m)||lo(m,t);S[b]||(S[b]=!0,y.insertRule(`@keyframes ${b} ${p}`,y.cssRules.length));const E=t.style.animation||"";return t.style.animation=`${E?`${E}, `:""}${b} ${r}ms linear ${f}ms 1 both`,fr+=1,b}function jr(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),f=n.length-r.length;f&&(t.style.animation=r.join(", "),fr-=f,fr||co())}function co(){ni(()=>{fr||(ir.forEach(t=>{const{stylesheet:e}=t;let n=e.cssRules.length;for(;n--;)e.deleteRule(n);t.rules={}}),ir.clear())})}let Zn;function Wn(t){Zn=t}function ao(){if(!Zn)throw new Error("Function called outside component initialization");return Zn}function uo(t){ao().$$.on_mount.push(t)}const Hn=[],bi=[],nr=[],vi=[],ho=Promise.resolve();let Br=!1;function _o(){Br||(Br=!0,ho.then(ts))}function Dt(t){nr.push(t)}const Sr=new Set;let tr=0;function ts(){const t=Zn;do{for(;tr<Hn.length;){const e=Hn[tr];tr++,Wn(e),po(e.$$)}for(Wn(null),Hn.length=0,tr=0;bi.length;)bi.pop()();for(let e=0;e<nr.length;e+=1){const n=nr[e];Sr.has(n)||(Sr.add(n),n())}nr.length=0}while(Hn.length);for(;vi.length;)vi.pop()();Br=!1,Sr.clear(),Wn(t)}function po(t){if(t.fragment!==null){t.update(),gt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Dt)}}let Fn;function ns(){return Fn||(Fn=Promise.resolve(),Fn.then(()=>{Fn=null})),Fn}function sr(t,e,n){t.dispatchEvent(so(`${e?"intro":"outro"}${n}`))}const rr=new Set;let bn;function St(){bn={r:0,c:[],p:bn}}function Ot(){bn.r||gt(bn.c),bn=bn.p}function ne(t,e){t&&t.i&&(rr.delete(t),t.i(e))}function ge(t,e,n,r){if(t&&t.o){if(rr.has(t))return;rr.add(t),bn.c.push(()=>{rr.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const rs={duration:0};function un(t,e,n){let r=e(t,n),f=!1,s,l,c=0;function d(){s&&jr(t,s)}function h(){const{delay:b=0,duration:m=300,easing:y=ti,tick:S=xe,css:E}=r||rs;E&&(s=es(t,0,1,m,b,y,E,c++)),S(0,1);const I=Zf()+b,T=I+m;l&&l.abort(),f=!0,Dt(()=>sr(t,!0,"start")),l=Vf(F=>{if(f){if(F>=T)return S(1,0),sr(t,!0,"end"),d(),f=!1;if(F>=I){const oe=y((F-I)/m);S(oe,1-oe)}}return f})}let p=!1;return{start(){p||(p=!0,jr(t),Qn(r)?(r=r(),ns().then(h)):h())},invalidate(){p=!1},end(){f&&(d(),f=!1)}}}function bo(t,e,n){let r=e(t,n),f=!0,s;const l=bn;l.r+=1;function c(){const{delay:d=0,duration:h=300,easing:p=ti,tick:b=xe,css:m}=r||rs;m&&(s=es(t,1,0,h,d,p,m));const y=Zf()+d,S=y+h;Dt(()=>sr(t,!1,"start")),Vf(E=>{if(f){if(E>=S)return b(0,1),sr(t,!1,"end"),--l.r||gt(l.c),!1;if(E>=y){const I=p((E-y)/h);b(1-I,I)}}return f})}return Qn(r)?ns().then(()=>{r=r(),c()}):c(),{end(d){d&&r.tick&&r.tick(1,0),f&&(s&&jr(t,s),f=!1)}}}function ze(t){t&&t.c()}function je(t,e,n,r){const{fragment:f,on_mount:s,on_destroy:l,after_update:c}=t.$$;f&&f.m(e,n),r||Dt(()=>{const d=s.map(zf).filter(Qn);l?l.push(...d):gt(d),t.$$.on_mount=[]}),c.forEach(Dt)}function Be(t,e){const n=t.$$;n.fragment!==null&&(gt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function vo(t,e){t.$$.dirty[0]===-1&&(Hn.push(t),_o(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ut(t,e,n,r,f,s,l,c=[-1]){const d=Zn;Wn(t);const h=t.$$={fragment:null,ctx:null,props:s,update:xe,not_equal:f,bound:di(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(d?d.$$.context:[])),callbacks:di(),dirty:c,skip_bound:!1,root:e.target||d.$$.root};l&&l(h.root);let p=!1;if(h.ctx=n?n(t,e.props||{},(b,m,...y)=>{const S=y.length?y[0]:m;return h.ctx&&f(h.ctx[b],h.ctx[b]=S)&&(!h.skip_bound&&h.bound[b]&&h.bound[b](S),p&&vo(t,b)),m}):[],h.update(),p=!0,gt(h.before_update),h.fragment=r?r(h.ctx):!1,e.target){if(e.hydrate){const b=fo(e.target);h.fragment&&h.fragment.l(b),b.forEach(N)}else h.fragment&&h.fragment.c();e.intro&&ne(t.$$.fragment),je(t,e.target,e.anchor,e.customElement),ts()}Wn(d)}class dt{$destroy(){Be(this,1),this.$destroy=xe}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const f=r.indexOf(n);f!==-1&&r.splice(f,1)}}$set(e){this.$$set&&!to(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Dn=[];function mo(t,e){return{subscribe:Qt(t,e).subscribe}}function Qt(t,e=xe){let n;const r=new Set;function f(c){if(at(t,c)&&(t=c,n)){const d=!Dn.length;for(const h of r)h[1](),Dn.push(h,t);if(d){for(let h=0;h<Dn.length;h+=2)Dn[h][0](Dn[h+1]);Dn.length=0}}}function s(c){f(c(t))}function l(c,d=xe){const h=[c,d];return r.add(h),r.size===1&&(n=e(f)||xe),c(t),()=>{r.delete(h),r.size===0&&(n(),n=null)}}return{set:f,update:s,subscribe:l}}function yo(t,e,n){const r=!Array.isArray(t),f=r?[t]:t,s=e.length<2;return mo(n,l=>{let c=!1;const d=[];let h=0,p=xe;const b=()=>{if(h)return;p();const y=e(r?d[0]:d,l);s?l(y):p=Qn(y)?y:xe},m=f.map((y,S)=>Tt(y,E=>{d[S]=E,h&=~(1<<S),c&&b()},()=>{h|=1<<S}));return c=!0,b(),function(){gt(m),p()}})}function go(t){const e=t-1;return e*e*e+1}function is(t,{delay:e=0,duration:n=400,easing:r=ti}={}){const f=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:s=>`opacity: ${s*f}`}}function vn(t,{delay:e=0,duration:n=400,easing:r=go,x:f=0,y:s=0,opacity:l=0}={}){const c=getComputedStyle(t),d=+c.opacity,h=c.transform==="none"?"":c.transform,p=d*(1-l);return{delay:e,duration:n,easing:r,css:(b,m)=>`
			transform: ${h} translate(${(1-b)*f}px, ${(1-b)*s}px);
			opacity: ${d-p*m}`}}function xo(t){function e(r,...f){const s=r.subscribe(...f);return s.unsubscribe?()=>s.unsubscribe():s}function n(r){let f;return e(r,s=>f=s)(),f}return(r,f,s,l,c)=>{const{errors:d}=n(t),h=new Date,p=`${h.getHours()}:${`0${h.getMinutes()}`.slice(-2)}`;c&&c.stack?d.push({msg:r,stacktrace:c.stack,time:p}):d.push({msg:`"${r}" (No more info because of CORS, fix: 1) check for the same error on device where gui runs on :80... 2) if more possible errors from this source, then rethrow - see example in dmt-connect/browser/connect around JSON.parse(msg))`,corsProblem:!0,time:p}),t.set({errors:d})}}function wo(t,e="asc"){return function(r,f){if(!r.hasOwnProperty(t)||!f.hasOwnProperty(t))return 0;const s=typeof r[t]=="string"?r[t].toUpperCase():r[t],l=typeof f[t]=="string"?f[t].toUpperCase():f[t];let c=0;return s>l?c=1:s<l&&(c=-1),e==="desc"?c*-1:c}}function Ao(t,e){localStorage.getItem(e)=="true"&&t.set(!0),localStorage.getItem(e)=="false"&&t.set(!1),t.subscribe(n=>{localStorage.setItem(e,n.toString())})}function mi(t){console.log(`${new Date().toLocaleString()} \u2192 ${t}`)}mi.write=mi;const fs=Qt(!0);Ao(fs,"show_all_nearby_devices");const ss=Qt({errors:[]}),os=Qt(!1);function or(t,{defaultSymbol:e="",showTimeLimitIndicator:n=!1}={}){return!t||!t.currentMedia||t.paused?e:n&&t.timeLimit>0?"\u23F1\uFE0F":t.currentMedia.mediaType=="video"?"\u25B6":"\u266B"}function Eo(t){let e;return{c(){e=K("disconnected")},m(n,r){D(n,e,r)},p:xe,d(n){n&&N(e)}}}function So(t){let e,n=or(t[2])+"",r,f,s,l,c,d=t[4]==!1&&yi();return{c(){e=U("span"),r=K(n),f=J(),s=U("h2"),l=K(t[1]),c=J(),d&&d.c(),L(e,"class","play_symbol svelte-5h63c7"),L(s,"class","svelte-5h63c7"),ce(s,"disconnected",t[4]==!1)},m(h,p){D(h,e,p),O(e,r),D(h,f,p),D(h,s,p),O(s,l),O(s,c),d&&d.m(s,null)},p(h,p){p&4&&n!==(n=or(h[2])+"")&&Pe(r,n),p&2&&Pe(l,h[1]),h[4]==!1?d||(d=yi(),d.c(),d.m(s,null)):d&&(d.d(1),d=null),p&16&&ce(s,"disconnected",h[4]==!1)},d(h){h&&N(e),h&&N(f),h&&N(s),d&&d.d()}}}function yi(t){let e;return{c(){e=U("span"),L(e,"class","disconnected svelte-5h63c7")},m(n,r){D(n,e,r)},d(n){n&&N(e)}}}function gi(t){let e,n,r,f=t[3].ip+"",s;return{c(){e=U("div"),n=U("span"),n.textContent="IP Address",r=J(),s=K(f),L(n,"class","svelte-5h63c7"),L(e,"class","device_stat svelte-5h63c7")},m(l,c){D(l,e,c),O(e,n),O(e,r),O(e,s)},p(l,c){c&8&&f!==(f=l[3].ip+"")&&Pe(s,f)},d(l){l&&N(e)}}}function xi(t){let e,n,r,f=t[3].cpuUsage+"",s,l;return{c(){var c,d,h;e=U("div"),n=U("span"),n.textContent="CPU Usage",r=J(),s=K(f),l=K("%"),L(n,"class","svelte-5h63c7"),L(e,"class","device_stat cpu_usage svelte-5h63c7"),ce(e,"warn1",((c=t[3])==null?void 0:c.cpuUsage)>=50),ce(e,"warn2",((d=t[3])==null?void 0:d.cpuUsage)>=70),ce(e,"warn3",((h=t[3])==null?void 0:h.cpuUsage)>=80)},m(c,d){D(c,e,d),O(e,n),O(e,r),O(e,s),O(e,l)},p(c,d){var h,p,b;d&8&&f!==(f=c[3].cpuUsage+"")&&Pe(s,f),d&8&&ce(e,"warn1",((h=c[3])==null?void 0:h.cpuUsage)>=50),d&8&&ce(e,"warn2",((p=c[3])==null?void 0:p.cpuUsage)>=70),d&8&&ce(e,"warn3",((b=c[3])==null?void 0:b.cpuUsage)>=80)},d(c){c&&N(e)}}}function wi(t){let e,n,r,f=t[3].cpuTemp+"",s,l;return{c(){e=U("div"),n=U("span"),n.textContent="CPU Temperature",r=J(),s=K(f),l=K("\xB0C"),L(n,"class","svelte-5h63c7"),L(e,"class","device_stat svelte-5h63c7")},m(c,d){D(c,e,d),O(e,n),O(e,r),O(e,s),O(e,l)},p(c,d){d&8&&f!==(f=c[3].cpuTemp+"")&&Pe(s,f)},d(c){c&&N(e)}}}function Ai(t){var l,c;let e,n,r,f=(((l=t[3])==null?void 0:l.wifiAP)||((c=t[3])==null?void 0:c.apssid))+"",s;return{c(){e=U("div"),n=U("span"),n.textContent="Wifi",r=J(),s=K(f),L(n,"class","svelte-5h63c7"),L(e,"class","wifi_ap svelte-5h63c7")},m(d,h){D(d,e,h),O(e,n),O(e,r),O(e,s)},p(d,h){var p,b;h&8&&f!==(f=(((p=d[3])==null?void 0:p.wifiAP)||((b=d[3])==null?void 0:b.apssid))+"")&&Pe(s,f)},d(d){d&&N(e)}}}function Oo(t){var E,I,T,F,oe;let e,n,r,f,s,l,c;function d(j,q){if(j[1])return So;if(j[4]!=null)return Eo}let h=d(t),p=h&&h(t),b=((E=t[3])==null?void 0:E.ip)&&gi(t),m=((I=t[3])==null?void 0:I.cpuUsage)&&xi(t),y=((T=t[3])==null?void 0:T.cpuTemp)&&wi(t),S=(((F=t[3])==null?void 0:F.wifiAP)||((oe=t[3])==null?void 0:oe.apssid))&&Ai(t);return{c(){e=U("div"),p&&p.c(),r=J(),b&&b.c(),f=J(),m&&m.c(),s=J(),y&&y.c(),l=J(),S&&S.c(),c=xt(),L(e,"class","device_title svelte-5h63c7")},m(j,q){D(j,e,q),p&&p.m(e,null),D(j,r,q),b&&b.m(j,q),D(j,f,q),m&&m.m(j,q),D(j,s,q),y&&y.m(j,q),D(j,l,q),S&&S.m(j,q),D(j,c,q)},p(j,[q]){var W,Oe,pe,ye,$e;h===(h=d(j))&&p?p.p(j,q):(p&&p.d(1),p=h&&h(j),p&&(p.c(),p.m(e,null))),(W=j[3])!=null&&W.ip?b?b.p(j,q):(b=gi(j),b.c(),b.m(f.parentNode,f)):b&&(b.d(1),b=null),(Oe=j[3])!=null&&Oe.cpuUsage?m?m.p(j,q):(m=xi(j),m.c(),m.m(s.parentNode,s)):m&&(m.d(1),m=null),(pe=j[3])!=null&&pe.cpuTemp?y?y.p(j,q):(y=wi(j),y.c(),y.m(l.parentNode,l)):y&&(y.d(1),y=null),((ye=j[3])==null?void 0:ye.wifiAP)||(($e=j[3])==null?void 0:$e.apssid)?S?S.p(j,q):(S=Ai(j),S.c(),S.m(c.parentNode,c)):S&&(S.d(1),S=null)},i(j){n||Dt(()=>{n=un(e,vn,{}),n.start()})},o:xe,d(j){j&&N(e),p&&p.d(),j&&N(r),b&&b.d(j),j&&N(f),m&&m.d(j),j&&N(s),y&&y.d(j),j&&N(l),S&&S.d(j),j&&N(c)}}}function To(t,e,n){let r,f,s=xe,l=()=>(s(),s=Tt(c,y=>n(4,f=y)),c);t.$$.on_destroy.push(()=>s());let{connected:c}=e;l();let{nearbyDevices:d}=e,{deviceName:h}=e,{device:p}=e,{activeDeviceKey:b}=e,{player:m}=e;return t.$$set=y=>{"connected"in y&&l(n(0,c=y.connected)),"nearbyDevices"in y&&n(5,d=y.nearbyDevices),"deviceName"in y&&n(1,h=y.deviceName),"device"in y&&n(6,p=y.device),"activeDeviceKey"in y&&n(7,b=y.activeDeviceKey),"player"in y&&n(2,m=y.player)},t.$$.update=()=>{t.$$.dirty&160&&n(3,r=d.find(y=>y.deviceKey==b))},[c,h,m,r,f,d,p,b]}class Co extends dt{constructor(e){super(),ut(this,e,To,Oo,at,{connected:0,nearbyDevices:5,deviceName:1,device:6,activeDeviceKey:7,player:2})}}function Or(t,e=2){return Array(Math.max(e-String(t).length+1,0)).join(0)+t}function $n(t){t=Math.round(t);const e=Math.floor(t/3600),n=t%3600,r=Math.floor(n/60);return t=n%60,e?`${e}h ${Or(r)}min ${Or(t)}s`:`${r}:${Or(t)}`}function ko(t){let e=$n(t[0].currentMedia.duration)+"",n;return{c(){n=K(e)},m(r,f){D(r,n,f)},p(r,f){f&1&&e!==(e=$n(r[0].currentMedia.duration)+"")&&Pe(n,e)},d(r){r&&N(n)}}}function Ro(t){let e=$n(Math.floor(t[0].timeposition))+"",n,r,f=$n(t[0].currentMedia.duration)+"",s,l,c,d=Math.round(t[0].percentposition)+"",h,p;return{c(){n=K(e),r=K(" / "),s=K(f),l=K(" \u2014 "),c=U("span"),h=K(d),p=K("%"),L(c,"class","svelte-b6jwnj")},m(b,m){D(b,n,m),D(b,r,m),D(b,s,m),D(b,l,m),D(b,c,m),O(c,h),O(c,p)},p(b,m){m&1&&e!==(e=$n(Math.floor(b[0].timeposition))+"")&&Pe(n,e),m&1&&f!==(f=$n(b[0].currentMedia.duration)+"")&&Pe(s,f),m&1&&d!==(d=Math.round(b[0].percentposition)+"")&&Pe(h,d)},d(b){b&&N(n),b&&N(r),b&&N(s),b&&N(l),b&&N(c)}}}function No(t){let e;return{c(){e=K("(radio)")},m(n,r){D(n,e,r)},p:xe,d(n){n&&N(e)}}}function Do(t){let e;function n(s,l){if(s[0].isStream)return No;if(s[0].timeposition)return Ro;if(s[0].duration)return ko}let r=n(t),f=r&&r(t);return{c(){e=U("section"),f&&f.c(),L(e,"class","progress svelte-b6jwnj"),ce(e,"faded",t[0].paused)},m(s,l){D(s,e,l),f&&f.m(e,null)},p(s,[l]){r===(r=n(s))&&f?f.p(s,l):(f&&f.d(1),f=r&&r(s),f&&(f.c(),f.m(e,null))),l&1&&ce(e,"faded",s[0].paused)},i:xe,o:xe,d(s){s&&N(e),f&&f.d()}}}function $o(t,e,n){let{player:r}=e;return t.$$set=f=>{"player"in f&&n(0,r=f.player)},[r]}class Po extends dt{constructor(e){super(),ut(this,e,$o,Do,at,{player:0})}}function Ei(t){let e,n,r,f;function s(d,h){if(d[2]&&d[6])return Mo;if(d[6])return Io}let l=s(t),c=l&&l(t);return r=new Po({props:{player:t[0]}}),{c(){e=U("div"),c&&c.c(),n=J(),ze(r.$$.fragment),L(e,"class","wrapper svelte-120eh85")},m(d,h){D(d,e,h),c&&c.m(e,null),O(e,n),je(r,e,null),f=!0},p(d,h){l===(l=s(d))&&c?c.p(d,h):(c&&c.d(1),c=l&&l(d),c&&(c.c(),ne(c,1),c.m(e,n)));const p={};h&1&&(p.player=d[0]),r.$set(p)},i(d){f||(ne(c),ne(r.$$.fragment,d),f=!0)},o(d){ge(r.$$.fragment,d),f=!1},d(d){d&&N(e),c&&c.d(),Be(r)}}}function Io(t){let e,n;return{c(){e=U("section"),e.textContent="[ No media loaded ]",L(e,"class","no_media svelte-120eh85")},m(r,f){D(r,e,f)},p:xe,i(r){n||Dt(()=>{n=un(e,vn,{}),n.start()})},o:xe,d(r){r&&N(e)}}}function Mo(t){let e,n,r=or(t[0],{showTimeLimitIndicator:!0})+"",f,s,l,c,d,h,p=t[3]&&Si(t);return{c(){var b;e=U("section"),n=U("span"),f=K(r),s=J(),l=K(t[2]),c=J(),d=U("div"),p&&p.c(),L(n,"class","play_symbol svelte-120eh85"),L(d,"class","file_path svelte-120eh85"),L(e,"class","current_media svelte-120eh85"),ce(e,"playing",!t[0].paused),ce(e,"within_limit",!t[0].isStream&&t[0].limit),ce(e,"last_in_limit",!t[0].isStream&&t[0].limit==1),ce(e,"error",t[5]==t[3]&&((b=t[4])==null?void 0:b.error))},m(b,m){D(b,e,m),O(e,n),O(n,f),O(e,s),O(e,l),O(e,c),O(e,d),p&&p.m(d,null)},p(b,m){var y;m&1&&r!==(r=or(b[0],{showTimeLimitIndicator:!0})+"")&&Pe(f,r),m&4&&Pe(l,b[2]),b[3]?p?p.p(b,m):(p=Si(b),p.c(),p.m(d,null)):p&&(p.d(1),p=null),m&1&&ce(e,"playing",!b[0].paused),m&1&&ce(e,"within_limit",!b[0].isStream&&b[0].limit),m&1&&ce(e,"last_in_limit",!b[0].isStream&&b[0].limit==1),m&56&&ce(e,"error",b[5]==b[3]&&((y=b[4])==null?void 0:y.error))},i(b){h||Dt(()=>{h=un(e,vn,{}),h.start()})},o:xe,d(b){b&&N(e),p&&p.d()}}}function Si(t){let e=Oi(t[3])+"",n;return{c(){n=K(e)},m(r,f){D(r,n,f)},p(r,f){f&8&&e!==(e=Oi(r[3])+"")&&Pe(n,e)},d(r){r&&N(n)}}}function Uo(t){let e,n,r=t[0]&&Ei(t);return{c(){r&&r.c(),e=xt()},m(f,s){r&&r.m(f,s),D(f,e,s),n=!0},p(f,[s]){f[0]?r?(r.p(f,s),s&1&&ne(r,1)):(r=Ei(f),r.c(),ne(r,1),r.m(e.parentNode,e)):r&&(St(),ge(r,1,1,()=>{r=null}),Ot())},i(f){n||(ne(r),n=!0)},o(f){ge(r),n=!1},d(f){r&&r.d(f),f&&N(e)}}}function Oi(t){return t.replace("/root/DMTMountedMedia","")}function Lo(t,e,n){let r,f=xe,s=()=>(f(),f=Tt(c,y=>n(6,r=y)),c);t.$$.on_destroy.push(()=>f());let{player:l}=e,{connected:c}=e;s();let{store:d}=e,{songTitle:h}=e,{songPath:p}=e,{playlistCurrentMedia:b}=e,{playlistSongPath:m}=e;return t.$$set=y=>{"player"in y&&n(0,l=y.player),"connected"in y&&s(n(1,c=y.connected)),"store"in y&&n(7,d=y.store),"songTitle"in y&&n(2,h=y.songTitle),"songPath"in y&&n(3,p=y.songPath),"playlistCurrentMedia"in y&&n(4,b=y.playlistCurrentMedia),"playlistSongPath"in y&&n(5,m=y.playlistSongPath)},[l,c,h,p,b,m,r,d]}class jo extends dt{constructor(e){super(),ut(this,e,Lo,Uo,at,{player:0,connected:1,store:7,songTitle:2,songPath:3,playlistCurrentMedia:4,playlistSongPath:5})}}function Ti(t){let e;function n(s,l){return s[1].paused?Ko:Bo}let r=n(t),f=r(t);return{c(){f.c(),e=xt()},m(s,l){f.m(s,l),D(s,e,l)},p(s,l){r===(r=n(s))&&f?f.p(s,l):(f.d(1),f=r(s),f&&(f.c(),f.m(e.parentNode,e)))},d(s){f.d(s),s&&N(e)}}}function Bo(t){let e,n,r,f=(t[2]||"")+"",s,l,c,d;return{c(){e=U("button"),n=K("\u25CF Pause "),r=U("span"),s=K(f),L(r,"class","svelte-p9vgzg"),L(e,"class","pause svelte-p9vgzg"),e.disabled=l=!t[5]},m(h,p){D(h,e,p),O(e,n),O(e,r),O(r,s),c||(d=Re(e,"click",t[8]),c=!0)},p(h,p){p&4&&f!==(f=(h[2]||"")+"")&&Pe(s,f),p&32&&l!==(l=!h[5])&&(e.disabled=l)},d(h){h&&N(e),c=!1,d()}}}function Ko(t){let e,n,r,f=(t[2]||"")+"",s,l,c,d;return{c(){e=U("button"),n=K("\u25B6 Play "),r=U("span"),s=K(f),L(r,"class","svelte-p9vgzg"),L(e,"class","play svelte-p9vgzg"),e.disabled=l=!t[5]},m(h,p){D(h,e,p),O(e,n),O(e,r),O(r,s),c||(d=Re(e,"click",t[7]),c=!0)},p(h,p){p&4&&f!==(f=(h[2]||"")+"")&&Pe(s,f),p&32&&l!==(l=!h[5])&&(e.disabled=l)},d(h){h&&N(e),c=!1,d()}}}function Ci(t){let e,n=t[1].volume+"",r;return{c(){e=U("div"),r=K(n),L(e,"class","volume_level svelte-p9vgzg"),ce(e,"faded",t[1].paused)},m(f,s){D(f,e,s),O(e,r)},p(f,s){s&2&&n!==(n=f[1].volume+"")&&Pe(r,n),s&2&&ce(e,"faded",f[1].paused)},d(f){f&&N(e)}}}function ki(t){let e,n,r=t[1].isStream?"Close radio":"Stop",f,s,l,c;return{c(){e=U("button"),n=K("\u25A0 "),f=K(r),L(e,"class","stop svelte-p9vgzg"),e.disabled=s=!t[5],ce(e,"radio",t[1].isStream)},m(d,h){D(d,e,h),O(e,n),O(e,f),l||(c=Re(e,"click",t[11]),l=!0)},p(d,h){h&2&&r!==(r=d[1].isStream?"Close radio":"Stop")&&Pe(f,r),h&32&&s!==(s=!d[5])&&(e.disabled=s),h&2&&ce(e,"radio",d[1].isStream)},d(d){d&&N(e),l=!1,c()}}}function Ri(t){let e,n,r,f,s,l,c,d,h,p,b=(t[1].repeatCount||"")+"",m,y,S,E;return{c(){e=U("button"),n=K("Shuffle"),f=J(),s=U("button"),l=K("Similar"),d=J(),h=U("button"),p=K("Repeat "),m=K(b),L(e,"class","shuffle svelte-p9vgzg"),e.disabled=r=!t[5],L(s,"class","similar svelte-p9vgzg"),s.disabled=c=!t[5],L(h,"class","repeat svelte-p9vgzg"),h.disabled=y=!t[5],ce(h,"repeat_set",t[1].repeatCount>0)},m(I,T){D(I,e,T),O(e,n),D(I,f,T),D(I,s,T),O(s,l),D(I,d,T),D(I,h,T),O(h,p),O(h,m),S||(E=[Re(e,"click",t[12]),Re(s,"click",t[13]),Re(h,"click",t[14])],S=!0)},p(I,T){T&32&&r!==(r=!I[5])&&(e.disabled=r),T&32&&c!==(c=!I[5])&&(s.disabled=c),T&2&&b!==(b=(I[1].repeatCount||"")+"")&&Pe(m,b),T&32&&y!==(y=!I[5])&&(h.disabled=y),T&2&&ce(h,"repeat_set",I[1].repeatCount>0)},d(I){I&&N(e),I&&N(f),I&&N(s),I&&N(d),I&&N(h),S=!1,gt(E)}}}function Ni(t){let e,n,r,f,s,l,c,d,h;return{c(){e=U("button"),n=K("\xAB 20s"),f=J(),s=U("button"),l=K("20s \xBB"),L(e,"class","backward svelte-p9vgzg"),e.disabled=r=!t[5],L(s,"class","forward svelte-p9vgzg"),s.disabled=c=!t[5]},m(p,b){D(p,e,b),O(e,n),D(p,f,b),D(p,s,b),O(s,l),d||(h=[Re(e,"click",t[15]),Re(s,"click",t[16])],d=!0)},p(p,b){b&32&&r!==(r=!p[5])&&(e.disabled=r),b&32&&c!==(c=!p[5])&&(s.disabled=c)},d(p){p&&N(e),p&&N(f),p&&N(s),d=!1,gt(h)}}}function Di(t){let e;function n(s,l){return s[1].isStream?qo:zo}let r=n(t),f=r(t);return{c(){f.c(),e=xt()},m(s,l){f.m(s,l),D(s,e,l)},p(s,l){r===(r=n(s))&&f?f.p(s,l):(f.d(1),f=r(s),f&&(f.c(),f.m(e.parentNode,e)))},d(s){f.d(s),s&&N(e)}}}function zo(t){let e,n,r,f,s,l,c=(t[1].limit>0||t[1].timeLimit>0)&&$i(t),d=t[1].limit>0&&Pi(t);function h(m,y){return m[1].timeLimit>0?Fo:Yo}let p=h(t),b=p(t);return{c(){c&&c.c(),e=J(),d&&d.c(),n=J(),r=U("button"),b.c(),L(r,"class","limit svelte-p9vgzg"),r.disabled=f=!t[5],ce(r,"limit_set",t[1].limit>0),ce(r,"time_limit_set",t[1].timeLimit>0)},m(m,y){c&&c.m(m,y),D(m,e,y),d&&d.m(m,y),D(m,n,y),D(m,r,y),b.m(r,null),s||(l=Re(r,"click",t[6]),s=!0)},p(m,y){m[1].limit>0||m[1].timeLimit>0?c?c.p(m,y):(c=$i(m),c.c(),c.m(e.parentNode,e)):c&&(c.d(1),c=null),m[1].limit>0?d?d.p(m,y):(d=Pi(m),d.c(),d.m(n.parentNode,n)):d&&(d.d(1),d=null),p===(p=h(m))&&b?b.p(m,y):(b.d(1),b=p(m),b&&(b.c(),b.m(r,null))),y&32&&f!==(f=!m[5])&&(r.disabled=f),y&2&&ce(r,"limit_set",m[1].limit>0),y&2&&ce(r,"time_limit_set",m[1].timeLimit>0)},d(m){c&&c.d(m),m&&N(e),d&&d.d(m),m&&N(n),m&&N(r),b.d(),s=!1,l()}}}function qo(t){let e,n,r,f,s,l=t[1].timeLimit>0&&Ii(t);function c(p,b){return p[1].timeLimit>0?Jo:Ho}let d=c(t),h=d(t);return{c(){l&&l.c(),e=J(),n=U("button"),h.c(),L(n,"class","limit svelte-p9vgzg"),n.disabled=r=!t[5],ce(n,"time_limit_set",t[1].timeLimit>0)},m(p,b){l&&l.m(p,b),D(p,e,b),D(p,n,b),h.m(n,null),f||(s=Re(n,"click",t[6]),f=!0)},p(p,b){p[1].timeLimit>0?l?l.p(p,b):(l=Ii(p),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),d===(d=c(p))&&h?h.p(p,b):(h.d(1),h=d(p),h&&(h.c(),h.m(n,null))),b&32&&r!==(r=!p[5])&&(n.disabled=r),b&2&&ce(n,"time_limit_set",p[1].timeLimit>0)},d(p){l&&l.d(p),p&&N(e),p&&N(n),h.d(),f=!1,s()}}}function $i(t){let e,n,r,f,s;return{c(){e=U("button"),n=K("\u{1F5D1}\uFE0F Cancel"),L(e,"class","remove_limit svelte-p9vgzg"),e.disabled=r=!t[5],ce(e,"remove_time_limit",t[1].timeLimit>0)},m(l,c){D(l,e,c),O(e,n),f||(s=Re(e,"click",t[18]),f=!0)},p(l,c){c&32&&r!==(r=!l[5])&&(e.disabled=r),c&2&&ce(e,"remove_time_limit",l[1].timeLimit>0)},d(l){l&&N(e),f=!1,s()}}}function Pi(t){let e,n,r,f,s;return{c(){e=U("button"),n=K("\u23F1\uFE0F Limit"),L(e,"class","set_time_limit svelte-p9vgzg"),e.disabled=r=!t[5]},m(l,c){D(l,e,c),O(e,n),f||(s=Re(e,"click",t[19]),f=!0)},p(l,c){c&32&&r!==(r=!l[5])&&(e.disabled=r)},d(l){l&&N(e),f=!1,s()}}}function Yo(t){let e,n=(t[1].limit||"")+"",r;return{c(){e=K("Limit "),r=K(n)},m(f,s){D(f,e,s),D(f,r,s)},p(f,s){s&2&&n!==(n=(f[1].limit||"")+"")&&Pe(r,n)},d(f){f&&N(e),f&&N(r)}}}function Fo(t){let e,n,r=lr(t[1])+"",f;return{c(){e=U("span"),n=K("\u23F1\uFE0F "),f=K(r)},m(s,l){D(s,e,l),O(e,n),O(e,f)},p(s,l){l&2&&r!==(r=lr(s[1])+"")&&Pe(f,r)},d(s){s&&N(e)}}}function Ii(t){let e,n,r,f,s;return{c(){e=U("button"),n=K("\u{1F5D1}\uFE0F Cancel"),L(e,"class","remove_limit svelte-p9vgzg"),e.disabled=r=!t[5],ce(e,"remove_time_limit",t[1].timeLimit>0)},m(l,c){D(l,e,c),O(e,n),f||(s=Re(e,"click",t[17]),f=!0)},p(l,c){c&32&&r!==(r=!l[5])&&(e.disabled=r),c&2&&ce(e,"remove_time_limit",l[1].timeLimit>0)},d(l){l&&N(e),f=!1,s()}}}function Ho(t){let e;return{c(){e=U("span"),e.textContent="\u23F1\uFE0F Limit"},m(n,r){D(n,e,r)},p:xe,d(n){n&&N(e)}}}function Jo(t){let e,n,r=lr(t[1])+"",f;return{c(){e=U("span"),n=K("\u23F1\uFE0F "),f=K(r)},m(s,l){D(s,e,l),O(e,n),O(e,f)},p(s,l){l&2&&r!==(r=lr(s[1])+"")&&Pe(f,r)},d(s){s&&N(e)}}}function Wo(t){let e,n,r,f,s,l,c,d,h,p,b,m,y,S,E,I,T,F,oe=t[3]&&Ti(t),j=t[5]&&t[1].volume!=null&&Ci(t),q=t[3]&&ki(t),W=!t[1].isStream&&t[3]&&Ri(t),Oe=!t[1].isStream&&t[3]&&Ni(t),pe=t[3]&&Di(t);return{c(){e=U("section"),oe&&oe.c(),n=J(),r=U("button"),f=K("Vol \u2193"),l=J(),c=U("button"),d=K("Vol \u2191"),p=J(),j&&j.c(),b=J(),m=U("section"),q&&q.c(),y=J(),W&&W.c(),S=J(),E=U("section"),Oe&&Oe.c(),I=J(),pe&&pe.c(),L(r,"class","volume svelte-p9vgzg"),r.disabled=s=!t[5],L(c,"class","volume svelte-p9vgzg"),c.disabled=h=!t[5],L(e,"class","main svelte-p9vgzg"),L(m,"class","svelte-p9vgzg"),L(E,"class","svelte-p9vgzg")},m(ye,$e){D(ye,e,$e),oe&&oe.m(e,null),O(e,n),O(e,r),O(r,f),O(e,l),O(e,c),O(c,d),O(e,p),j&&j.m(e,null),D(ye,b,$e),D(ye,m,$e),q&&q.m(m,null),O(m,y),W&&W.m(m,null),D(ye,S,$e),D(ye,E,$e),Oe&&Oe.m(E,null),O(E,I),pe&&pe.m(E,null),T||(F=[Re(r,"click",t[9]),Re(c,"click",t[10])],T=!0)},p(ye,[$e]){ye[3]?oe?oe.p(ye,$e):(oe=Ti(ye),oe.c(),oe.m(e,n)):oe&&(oe.d(1),oe=null),$e&32&&s!==(s=!ye[5])&&(r.disabled=s),$e&32&&h!==(h=!ye[5])&&(c.disabled=h),ye[5]&&ye[1].volume!=null?j?j.p(ye,$e):(j=Ci(ye),j.c(),j.m(e,null)):j&&(j.d(1),j=null),ye[3]?q?q.p(ye,$e):(q=ki(ye),q.c(),q.m(m,y)):q&&(q.d(1),q=null),!ye[1].isStream&&ye[3]?W?W.p(ye,$e):(W=Ri(ye),W.c(),W.m(m,null)):W&&(W.d(1),W=null),!ye[1].isStream&&ye[3]?Oe?Oe.p(ye,$e):(Oe=Ni(ye),Oe.c(),Oe.m(E,I)):Oe&&(Oe.d(1),Oe=null),ye[3]?pe?pe.p(ye,$e):(pe=Di(ye),pe.c(),pe.m(E,null)):pe&&(pe.d(1),pe=null)},i:xe,o:xe,d(ye){ye&&N(e),oe&&oe.d(),j&&j.d(),ye&&N(b),ye&&N(m),q&&q.d(),W&&W.d(),ye&&N(S),ye&&N(E),Oe&&Oe.d(),pe&&pe.d(),T=!1,gt(F)}}}function lr(t){return t.timeLimit>2?`${Math.round(t.timeLimit)} min`:`${Math.round(t.timeLimit*60)} s`}function Zo(t,e,n){let r,f=xe,s=()=>(f(),f=Tt(l,ye=>n(5,r=ye)),l);t.$$.on_destroy.push(()=>f());let{connected:l}=e;s();let{player:c}=e,{deviceName:d}=e,{songTitle:h}=e,{fnAction:p}=e;function b(){c.isStream||c.timeLimit>0?p("time_limit"):p("limit")}const m=()=>p("play"),y=()=>p("pause"),S=()=>p("volume_down"),E=()=>p("volume_up"),I=()=>p("stop"),T=()=>p("shuffle"),F=()=>p("similar"),oe=()=>p("repeat"),j=()=>p("backward"),q=()=>p("forward"),W=()=>p("remove_time_limit"),Oe=()=>p("remove_limit"),pe=()=>p("time_limit");return t.$$set=ye=>{"connected"in ye&&s(n(0,l=ye.connected)),"player"in ye&&n(1,c=ye.player),"deviceName"in ye&&n(2,d=ye.deviceName),"songTitle"in ye&&n(3,h=ye.songTitle),"fnAction"in ye&&n(4,p=ye.fnAction)},[l,c,d,h,p,r,b,m,y,S,E,I,T,F,oe,j,q,W,Oe,pe]}class Go extends dt{constructor(e){super(),ut(this,e,Zo,Wo,at,{connected:0,player:1,deviceName:2,songTitle:3,fnAction:4})}}const cr=Qt(),an=Qt();function ls(){cr.set(""),an.set(null)}const Jn=Qt();function cs(){Jn.set(null)}const Vo=""+new URL("close.28a6104f.png",import.meta.url).href,Qo=""+new URL("magnifying_glass.a4a7aab7.svg",import.meta.url).href;function Mi(t){let e,n,r,f,s,l;return{c(){e=U("button"),n=K("\u25BC SET NEXT"),e.disabled=r=!t[2],L(e,"class","svelte-11smw5j")},m(c,d){D(c,e,d),O(e,n),s||(l=Re(e,"click",Xf(t[5])),s=!0)},p(c,d){d&4&&r!==(r=!c[2])&&(e.disabled=r)},i(c){f||Dt(()=>{f=un(e,vn,{}),f.start()})},o:xe,d(c){c&&N(e),s=!1,l()}}}function Xo(t){var I,T;let e,n,r,f,s,l,c,d,h,p,b,m=((I=t[1])==null?void 0:I.trim())&&((T=t[3])==null?void 0:T.length),y,S,E=m&&Mi(t);return{c(){var F;e=U("form"),n=U("div"),r=U("input"),s=J(),l=U("img"),d=J(),h=U("img"),b=J(),E&&E.c(),L(r,"id","search"),L(r,"placeholder","Playlist Search"),L(r,"type","text"),r.disabled=f=!t[2],L(r,"class","svelte-11smw5j"),L(l,"class","magnifying_glass svelte-11smw5j"),hi(l.src,c=Qo)||L(l,"src",c),L(h,"class","clear_search svelte-11smw5j"),hi(h.src,p=Vo)||L(h,"src",p),ce(h,"invisible",!((F=t[1])!=null&&F.trim())),L(n,"class","input_wrapper svelte-11smw5j"),L(e,"class","svelte-11smw5j")},m(F,oe){D(F,e,oe),O(e,n),O(n,r),pi(r,t[1]),O(n,s),O(n,l),O(n,d),O(n,h),O(e,b),E&&E.m(e,null),y||(S=[Re(r,"input",t[8]),Re(r,"keyup",t[4]),Re(h,"click",ls)],y=!0)},p(F,[oe]){var j,q,W;oe&4&&f!==(f=!F[2])&&(r.disabled=f),oe&2&&r.value!==F[1]&&pi(r,F[1]),oe&2&&ce(h,"invisible",!((j=F[1])!=null&&j.trim())),oe&10&&(m=((q=F[1])==null?void 0:q.trim())&&((W=F[3])==null?void 0:W.length)),m?E?(E.p(F,oe),oe&10&&ne(E,1)):(E=Mi(F),E.c(),ne(E,1),E.m(e,null)):E&&(E.d(1),E=null)},i(F){ne(E)},o:xe,d(F){F&&N(e),E&&E.d(),y=!1,gt(S)}}}function el(t,e,n){let r,f,s=xe,l=()=>(s(),s=Tt(d,T=>n(2,f=T)),d),c;yt(t,cr,T=>n(1,r=T)),yt(t,an,T=>n(3,c=T)),t.$$.on_destroy.push(()=>s());let{connected:d}=e;l();let{store:h}=e,{fnAction:p}=e,b;function m(T){h.remoteObject("player").call("playlistSearch",{query:r}).then(F=>{F?T==b&&an.set(F):an.set(null)}).catch(console.log)}let y;function S(){cs(),clearTimeout(y),r!=null&&r.trim()?(b=Math.random(),y=setTimeout(()=>{m(b)},300)):(b=null,an.set(null))}function E(){h.remoteObject("player").call("bump",{query:r}).then(()=>{an.set(null)}).catch(console.log)}function I(){r=this.value,cr.set(r)}return t.$$set=T=>{"connected"in T&&l(n(0,d=T.connected)),"store"in T&&n(6,h=T.store),"fnAction"in T&&n(7,p=T.fnAction)},[d,r,f,c,S,E,h,p,I]}class tl extends dt{constructor(e){super(),ut(this,e,el,Xo,at,{connected:0,store:6,fnAction:7})}}function nl(t){let e,n,r,f,s,l;return{c(){e=U("div"),n=U("button"),n.textContent="Play",r=J(),f=U("button"),f.textContent="Bump",L(n,"class","svelte-27xey9"),L(f,"class","svelte-27xey9"),L(e,"class","controls svelte-27xey9")},m(c,d){D(c,e,d),O(e,n),O(e,r),O(e,f),s||(l=[Re(n,"click",_i(t[4])),Re(f,"click",_i(t[5]))],s=!0)},p:xe,i:xe,o:xe,d(c){c&&N(e),s=!1,gt(l)}}}function rl(t,e,n){let{fnAction:r}=e,{entry:f}=e;function s(h){window.scrollTo({top:0,behavior:"smooth"}),ls(),r("next",{songId:h})}function l(h){r("bump",{args:h})}const c=()=>{s(f.id)},d=()=>{l(f.id)};return t.$$set=h=>{"fnAction"in h&&n(3,r=h.fnAction),"entry"in h&&n(0,f=h.entry)},[f,s,l,r,c,d]}class il extends dt{constructor(e){super(),ut(this,e,rl,nl,at,{fnAction:3,entry:0})}}function Ui(t){let e,n,r=t[0].metadata.duration+"",f,s;return{c(){e=U("span"),n=K("["),f=K(r),s=K("]"),L(e,"class","duration svelte-3i54h5")},m(l,c){D(l,e,c),O(e,n),O(e,f),O(e,s)},p(l,c){c&1&&r!==(r=l[0].metadata.duration+"")&&Pe(f,r)},d(l){l&&N(e)}}}function fl(t){var F,oe;let e,n,r,f=t[0].title+"",s,l,c,d=Li(t[0].path)+"",h,p,b,m,y,S,E,I,T=((oe=(F=t[0])==null?void 0:F.metadata)==null?void 0:oe.duration)&&Ui(t);return m=new il({props:{entry:t[0],fnAction:t[1]}}),{c(){e=U("div"),n=U("div"),T&&T.c(),r=J(),s=K(f),l=J(),c=U("div"),h=K(d),p=J(),b=U("div"),ze(m.$$.fragment),L(c,"class","file_path svelte-3i54h5"),L(b,"class","controls svelte-3i54h5"),L(n,"class","entry svelte-3i54h5"),ce(n,"selected",t[0].id==t[3]),ce(n,"just_bumped",!t[2]&&t[0].justBumped),ce(n,"within_limit",!t[2]&&t[0].withinLimit),ce(n,"is_search_result",t[2]),ce(n,"error",t[0].error),L(e,"class","entry_wrapper svelte-3i54h5")},m(j,q){D(j,e,q),O(e,n),T&&T.m(n,null),O(n,r),O(n,s),O(n,l),O(n,c),O(c,h),O(n,p),O(n,b),je(m,b,null),S=!0,E||(I=Re(n,"click",t[5]),E=!0)},p(j,[q]){var Oe,pe;(pe=(Oe=j[0])==null?void 0:Oe.metadata)!=null&&pe.duration?T?T.p(j,q):(T=Ui(j),T.c(),T.m(n,r)):T&&(T.d(1),T=null),(!S||q&1)&&f!==(f=j[0].title+"")&&Pe(s,f),(!S||q&1)&&d!==(d=Li(j[0].path)+"")&&Pe(h,d);const W={};q&1&&(W.entry=j[0]),q&2&&(W.fnAction=j[1]),m.$set(W),q&9&&ce(n,"selected",j[0].id==j[3]),q&5&&ce(n,"just_bumped",!j[2]&&j[0].justBumped),q&5&&ce(n,"within_limit",!j[2]&&j[0].withinLimit),q&4&&ce(n,"is_search_result",j[2]),q&1&&ce(n,"error",j[0].error)},i(j){S||(ne(m.$$.fragment,j),y||Dt(()=>{y=un(n,vn,{}),y.start()}),S=!0)},o(j){ge(m.$$.fragment,j),S=!1},d(j){j&&N(e),T&&T.d(),Be(m),E=!1,I()}}}function Li(t){return t.replace("/root/DMTMountedMedia","")}function sl(t,e,n){let r;yt(t,Jn,h=>n(3,r=h));let{entry:f}=e,{fnAction:s}=e,{isSearchResult:l}=e;function c(h){h==no(Jn)?Jn.set(null):Jn.set(h)}const d=()=>{c(f.id)};return t.$$set=h=>{"entry"in h&&n(0,f=h.entry),"fnAction"in h&&n(1,s=h.fnAction),"isSearchResult"in h&&n(2,l=h.isSearchResult)},[f,s,l,r,c,d]}class as extends dt{constructor(e){super(),ut(this,e,sl,fl,at,{entry:0,fnAction:1,isSearchResult:2})}}function ji(t,e,n){const r=t.slice();return r[7]=e[n],r}function Bi(t){let e,n,r,f;const s=[ll,ol],l=[];function c(d,h){return d[2].length?0:1}return e=c(t),n=l[e]=s[e](t),{c(){n.c(),r=xt()},m(d,h){l[e].m(d,h),D(d,r,h),f=!0},p(d,h){let p=e;e=c(d),e===p?l[e].p(d,h):(St(),ge(l[p],1,1,()=>{l[p]=null}),Ot(),n=l[e],n?n.p(d,h):(n=l[e]=s[e](d),n.c()),ne(n,1),n.m(r.parentNode,r))},i(d){f||(ne(n),f=!0)},o(d){ge(n),f=!1},d(d){l[e].d(d),d&&N(r)}}}function ol(t){let e,n;return{c(){e=U("h3"),e.textContent="[ No matches ]",L(e,"class","no_matches svelte-11vb31n")},m(r,f){D(r,e,f)},p:xe,i(r){n||Dt(()=>{n=un(e,vn,{}),n.start()})},o:xe,d(r){r&&N(e)}}}function ll(t){let e,n,r,f,s,l,c;function d(E,I){return E[2].length>pn?al:cl}let h=d(t),p=h(t),b=t[2].slice(0,pn),m=[];for(let E=0;E<b.length;E+=1)m[E]=Ki(ji(t,b,E));const y=E=>ge(m[E],1,1,()=>{m[E]=null});let S=t[2].length>pn&&zi(t);return{c(){e=U("h3"),p.c(),n=J();for(let E=0;E<m.length;E+=1)m[E].c();r=J(),f=U("div"),S&&S.c(),s=J(),l=U("span"),l.textContent="\u{1F4A1} Use comma (,) to separate multiple additive search terms.",L(e,"class","svelte-11vb31n"),L(l,"class","deemph svelte-11vb31n"),L(f,"class","result_count svelte-11vb31n")},m(E,I){D(E,e,I),p.m(e,null),D(E,n,I);for(let T=0;T<m.length;T+=1)m[T].m(E,I);D(E,r,I),D(E,f,I),S&&S.m(f,null),O(f,s),O(f,l),c=!0},p(E,I){if(h===(h=d(E))&&p?p.p(E,I):(p.d(1),p=h(E),p&&(p.c(),p.m(e,null))),I&6){b=E[2].slice(0,pn);let T;for(T=0;T<b.length;T+=1){const F=ji(E,b,T);m[T]?(m[T].p(F,I),ne(m[T],1)):(m[T]=Ki(F),m[T].c(),ne(m[T],1),m[T].m(r.parentNode,r))}for(St(),T=b.length;T<m.length;T+=1)y(T);Ot()}E[2].length>pn?S?S.p(E,I):(S=zi(E),S.c(),S.m(f,s)):S&&(S.d(1),S=null)},i(E){if(!c){for(let I=0;I<b.length;I+=1)ne(m[I]);c=!0}},o(E){m=m.filter(Boolean);for(let I=0;I<m.length;I+=1)ge(m[I]);c=!1},d(E){E&&N(e),p.d(),E&&N(n),Cn(m,E),E&&N(r),E&&N(f),S&&S.d()}}}function cl(t){let e=t[2].length+"",n,r,f=t[2].length==1?"match":"matches",s;return{c(){n=K(e),r=J(),s=K(f)},m(l,c){D(l,n,c),D(l,r,c),D(l,s,c)},p(l,c){c&4&&e!==(e=l[2].length+"")&&Pe(n,e),c&4&&f!==(f=l[2].length==1?"match":"matches")&&Pe(s,f)},d(l){l&&N(n),l&&N(r),l&&N(s)}}}function al(t){let e,n,r;return{c(){e=K("First "),n=K(pn),r=K(" matches")},m(f,s){D(f,e,s),D(f,n,s),D(f,r,s)},p:xe,d(f){f&&N(e),f&&N(n),f&&N(r)}}}function Ki(t){let e,n;return e=new as({props:{entry:t[7],fnAction:t[1],isSearchResult:"true"}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p(r,f){const s={};f&4&&(s.entry=r[7]),f&2&&(s.fnAction=r[1]),e.$set(s)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function zi(t){let e,n,r=t[2].length-pn+"",f,s;return{c(){e=U("div"),n=K("\u2026 there are "),f=K(r),s=K(" more matches")},m(l,c){D(l,e,c),O(e,n),O(e,f),O(e,s)},p(l,c){c&4&&r!==(r=l[2].length-pn+"")&&Pe(f,r)},d(l){l&&N(e)}}}function ul(t){let e,n,r=t[2]&&Bi(t);return{c(){r&&r.c(),e=xt()},m(f,s){r&&r.m(f,s),D(f,e,s),n=!0},p(f,[s]){f[2]?r?(r.p(f,s),s&4&&ne(r,1)):(r=Bi(f),r.c(),ne(r,1),r.m(e.parentNode,e)):r&&(St(),ge(r,1,1,()=>{r=null}),Ot())},i(f){n||(ne(r),n=!0)},o(f){ge(r),n=!1},d(f){r&&r.d(f),f&&N(e)}}}const pn=20;function dl(t,e,n){let r,f=xe,s=()=>(f(),f=Tt(c,p=>n(4,r=p)),c),l;yt(t,an,p=>n(2,l=p)),t.$$.on_destroy.push(()=>f());let{store:c}=e;s();let{connected:d}=e,{fnAction:h}=e;return t.$$set=p=>{"store"in p&&s(n(0,c=p.store)),"connected"in p&&n(3,d=p.connected),"fnAction"in p&&n(1,h=p.fnAction)},t.$$.update=()=>{t.$$.dirty&16&&r.playlist,t.$$.dirty&16&&r.playlistMetadata},[c,h,l,d,r]}class hl extends dt{constructor(e){super(),ut(this,e,dl,ul,at,{store:0,connected:3,fnAction:1})}}function qi(t){let e,n=t[1]=="tv"&&Yi(t);return{c(){n&&n.c(),e=xt()},m(r,f){n&&n.m(r,f),D(r,e,f)},p(r,f){r[1]=="tv"?n?n.p(r,f):(n=Yi(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(r){n&&n.d(r),r&&N(e)}}}function Yi(t){let e,n,r,f,s,l,c,d,h,p,b,m,y,S,E,I;return{c(){e=U("div"),n=U("button"),n.textContent="Celove\u010Derne risanke",r=J(),f=U("button"),f.textContent="Booba",s=J(),l=U("button"),l.textContent="Rusty Rivets",c=J(),d=U("button"),d.textContent="Jellystone",h=J(),p=U("button"),p.textContent="Pajek Lukas",b=J(),m=U("button"),m.textContent="Medvedek Paddington",y=J(),S=U("button"),S.textContent="Wolfoo",L(n,"class","svelte-84hcn8"),L(f,"class","svelte-84hcn8"),L(l,"class","svelte-84hcn8"),L(d,"class","svelte-84hcn8"),L(p,"class","svelte-84hcn8"),L(m,"class","svelte-84hcn8"),L(S,"class","svelte-84hcn8"),L(e,"class","sublist svelte-84hcn8")},m(T,F){D(T,e,F),O(e,n),O(e,r),O(e,f),O(e,s),O(e,l),O(e,c),O(e,d),O(e,h),O(e,p),O(e,b),O(e,m),O(e,y),O(e,S),E||(I=[Re(n,"click",t[6]),Re(f,"click",t[7]),Re(l,"click",t[8]),Re(d,"click",t[9]),Re(p,"click",t[10]),Re(m,"click",t[11]),Re(S,"click",t[12])],E=!0)},p:xe,d(T){T&&N(e),E=!1,gt(I)}}}function _l(t){let e,n=t[2]&&t[3]&&qi(t);return{c(){n&&n.c(),e=xt()},m(r,f){n&&n.m(r,f),D(r,e,f)},p(r,[f]){r[2]&&r[3]?n?n.p(r,f):(n=qi(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:xe,o:xe,d(r){n&&n.d(r),r&&N(e)}}}function pl(t,e,n){let r,f,s=xe,l=()=>(s(),s=Tt(d,F=>n(3,f=F)),d);yt(t,os,F=>n(2,r=F)),t.$$.on_destroy.push(()=>s());function c(F){h("sublist",{tag:F})}let{connected:d}=e;l();let{fnAction:h}=e,{deviceName:p}=e;const b=()=>{c("cartoons-slo/")},m=()=>{c("Booba")},y=()=>{c("Rusty Rivets")},S=()=>{c("Jellystone")},E=()=>{c("Lucas the spider")},I=()=>{c("Adventure Paddington")},T=()=>{c("Wolfoo")};return t.$$set=F=>{"connected"in F&&l(n(0,d=F.connected)),"fnAction"in F&&n(5,h=F.fnAction),"deviceName"in F&&n(1,p=F.deviceName)},[d,p,r,f,c,h,b,m,y,S,E,I,T]}class bl extends dt{constructor(e){super(),ut(this,e,pl,_l,at,{connected:0,fnAction:5,deviceName:1})}}function Fi(t,e,n){const r=t.slice();return r[10]=e[n],r}function Hi(t){let e,n,r,f,s,l,c=t[4].playlistLength+"",d,h,p,b,m,y,S,E,I,T=t[7]&&Ji(t);m=new bl({props:{connected:t[1],deviceName:t[3],fnAction:t[2]}});let F=t[5].filter(Gi).slice(0,1.5*Zi),oe=[];for(let q=0;q<F.length;q+=1)oe[q]=Wi(Fi(t,F,q));const j=q=>ge(oe[q],1,1,()=>{oe[q]=null});return{c(){e=U("h3"),n=K("Playlist @ "),r=K(t[3]),f=J(),s=U("span"),l=K("("),d=K(c),h=K(")"),p=J(),T&&T.c(),b=J(),ze(m.$$.fragment),y=J();for(let q=0;q<oe.length;q+=1)oe[q].c();S=J(),E=U("div"),E.textContent="...",L(s,"class","svelte-146wfrf"),L(e,"class","svelte-146wfrf")},m(q,W){D(q,e,W),O(e,n),O(e,r),O(e,f),O(e,s),O(s,l),O(s,d),O(s,h),O(e,p),T&&T.m(e,null),D(q,b,W),je(m,q,W),D(q,y,W);for(let Oe=0;Oe<oe.length;Oe+=1)oe[Oe].m(q,W);D(q,S,W),D(q,E,W),I=!0},p(q,W){(!I||W&8)&&Pe(r,q[3]),(!I||W&16)&&c!==(c=q[4].playlistLength+"")&&Pe(d,c),q[7]?T?T.p(q,W):(T=Ji(q),T.c(),T.m(e,null)):T&&(T.d(1),T=null);const Oe={};if(W&2&&(Oe.connected=q[1]),W&8&&(Oe.deviceName=q[3]),W&4&&(Oe.fnAction=q[2]),m.$set(Oe),W&36){F=q[5].filter(Gi).slice(0,1.5*Zi);let pe;for(pe=0;pe<F.length;pe+=1){const ye=Fi(q,F,pe);oe[pe]?(oe[pe].p(ye,W),ne(oe[pe],1)):(oe[pe]=Wi(ye),oe[pe].c(),ne(oe[pe],1),oe[pe].m(S.parentNode,S))}for(St(),pe=F.length;pe<oe.length;pe+=1)j(pe);Ot()}},i(q){if(!I){ne(m.$$.fragment,q);for(let W=0;W<F.length;W+=1)ne(oe[W]);I=!0}},o(q){ge(m.$$.fragment,q),oe=oe.filter(Boolean);for(let W=0;W<oe.length;W+=1)ge(oe[W]);I=!1},d(q){q&&N(e),T&&T.d(),q&&N(b),Be(m,q),q&&N(y),Cn(oe,q),q&&N(S),q&&N(E)}}}function Ji(t){let e,n,r,f,s,l;return{c(){e=K("| "),n=U("a"),r=K("\u25B6 Next"),L(n,"href","#"),L(n,"class","next svelte-146wfrf"),L(n,"disabled",f=!t[7])},m(c,d){D(c,e,d),D(c,n,d),O(n,r),s||(l=Re(n,"click",Xf(t[8])),s=!0)},p(c,d){d&128&&f!==(f=!c[7])&&L(n,"disabled",f)},d(c){c&&N(e),c&&N(n),s=!1,l()}}}function Wi(t){let e,n;return e=new as({props:{entry:t[10],fnAction:t[2]}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p(r,f){const s={};f&32&&(s.entry=r[10]),f&4&&(s.fnAction=r[2]),e.$set(s)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function vl(t){var f;let e,n,r=!t[6]&&((f=t[5])==null?void 0:f.length)&&Hi(t);return{c(){r&&r.c(),e=xt()},m(s,l){r&&r.m(s,l),D(s,e,l),n=!0},p(s,[l]){var c;!s[6]&&((c=s[5])==null?void 0:c.length)?r?(r.p(s,l),l&96&&ne(r,1)):(r=Hi(s),r.c(),ne(r,1),r.m(e.parentNode,e)):r&&(St(),ge(r,1,1,()=>{r=null}),Ot())},i(s){n||(ne(r),n=!0)},o(s){ge(r),n=!1},d(s){r&&r.d(s),s&&N(e)}}}const Zi=20,Gi=({current:t,past:e})=>!t&&!e;function ml(t,e,n){let r,f,s,l=xe,c=()=>(l(),l=Tt(m,T=>n(9,s=T)),m),d,h,p=xe,b=()=>(p(),p=Tt(y,T=>n(7,h=T)),y);yt(t,an,T=>n(6,d=T)),t.$$.on_destroy.push(()=>l()),t.$$.on_destroy.push(()=>p());let{store:m}=e;c();let{connected:y}=e;b();let{fnAction:S}=e,{deviceName:E}=e;function I(){window.scrollTo({top:0,behavior:"smooth"}),S("next")}return t.$$set=T=>{"store"in T&&c(n(0,m=T.store)),"connected"in T&&b(n(1,y=T.connected)),"fnAction"in T&&n(2,S=T.fnAction),"deviceName"in T&&n(3,E=T.deviceName)},t.$$.update=()=>{t.$$.dirty&512&&n(5,r=s.playlist),t.$$.dirty&512&&n(4,f=s.playlistMetadata)},[m,y,S,E,f,r,d,h,I,s]}class yl extends dt{constructor(e){super(),ut(this,e,ml,vl,at,{store:0,connected:1,fnAction:2,deviceName:3})}}function gl(t){let e,n,r,f,s,l,c;return n=new tl({props:{connected:t[1],store:t[0],fnAction:t[2]}}),f=new hl({props:{connected:t[1],store:t[0],fnAction:t[2]}}),l=new yl({props:{connected:t[1],store:t[0],fnAction:t[2],deviceName:t[3]}}),{c(){e=U("div"),ze(n.$$.fragment),r=J(),ze(f.$$.fragment),s=J(),ze(l.$$.fragment),L(e,"class","searchable_playlist svelte-1op3n77")},m(d,h){D(d,e,h),je(n,e,null),O(e,r),je(f,e,null),O(e,s),je(l,e,null),c=!0},p(d,[h]){const p={};h&2&&(p.connected=d[1]),h&1&&(p.store=d[0]),h&4&&(p.fnAction=d[2]),n.$set(p);const b={};h&2&&(b.connected=d[1]),h&1&&(b.store=d[0]),h&4&&(b.fnAction=d[2]),f.$set(b);const m={};h&2&&(m.connected=d[1]),h&1&&(m.store=d[0]),h&4&&(m.fnAction=d[2]),h&8&&(m.deviceName=d[3]),l.$set(m)},i(d){c||(ne(n.$$.fragment,d),ne(f.$$.fragment,d),ne(l.$$.fragment,d),c=!0)},o(d){ge(n.$$.fragment,d),ge(f.$$.fragment,d),ge(l.$$.fragment,d),c=!1},d(d){d&&N(e),Be(n),Be(f),Be(l)}}}function xl(t,e,n){let{store:r}=e,{connected:f}=e,{fnAction:s}=e,{deviceName:l}=e;return t.$$set=c=>{"store"in c&&n(0,r=c.store),"connected"in c&&n(1,f=c.connected),"fnAction"in c&&n(2,s=c.fnAction),"deviceName"in c&&n(3,l=c.deviceName)},[r,f,s,l]}class wl extends dt{constructor(e){super(),ut(this,e,xl,gl,at,{store:0,connected:1,fnAction:2,deviceName:3})}}function Vi(t){let e,n,r,f,s,l,c,d,h,p,b,m,y,S;return{c(){e=U("h3"),n=K("Play internet radio @ "),r=K(t[2]),f=J(),s=U("div"),l=U("button"),l.textContent="Rock",c=J(),d=U("button"),d.textContent="Jazz",h=J(),p=U("button"),p.textContent="Psytrance",b=J(),m=U("button"),m.textContent="Goatrance",L(l,"class","svelte-tpf42f"),L(d,"class","svelte-tpf42f"),L(p,"class","svelte-tpf42f"),L(m,"class","svelte-tpf42f"),L(s,"class","radios svelte-tpf42f")},m(E,I){D(E,e,I),O(e,n),O(e,r),D(E,f,I),D(E,s,I),O(s,l),O(s,c),O(s,d),O(s,h),O(s,p),O(s,b),O(s,m),y||(S=[Re(l,"click",t[4]),Re(d,"click",t[5]),Re(p,"click",t[6]),Re(m,"click",t[7])],y=!0)},p(E,I){I&4&&Pe(r,E[2])},d(E){E&&N(e),E&&N(f),E&&N(s),y=!1,gt(S)}}}function Al(t){let e,n=t[3]&&Vi(t);return{c(){n&&n.c(),e=xt()},m(r,f){n&&n.m(r,f),D(r,e,f)},p(r,[f]){r[3]?n?n.p(r,f):(n=Vi(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:xe,o:xe,d(r){n&&n.d(r),r&&N(e)}}}function El(t,e,n){let r,f=xe,s=()=>(f(),f=Tt(l,y=>n(3,r=y)),l);t.$$.on_destroy.push(()=>f());let{connected:l}=e;s();let{fnAction:c}=e,{deviceName:d}=e;const h=()=>{c("play_radio",{radioId:"rock"})},p=()=>{c("play_radio",{radioId:"jazz"})},b=()=>{c("play_radio",{radioId:"progressive-trance"})},m=()=>{c("play_radio",{radioId:"goa-trance"})};return t.$$set=y=>{"connected"in y&&s(n(0,l=y.connected)),"fnAction"in y&&n(1,c=y.fnAction),"deviceName"in y&&n(2,d=y.deviceName)},[l,c,d,r,h,p,b,m]}class Sl extends dt{constructor(e){super(),ut(this,e,El,Al,at,{connected:0,fnAction:1,deviceName:2})}}function Qi(t){let e,n;return e=new Sl({props:{connected:t[0],fnAction:t[4],deviceName:t[1]}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p(r,f){const s={};f&1&&(s.connected=r[0]),f&16&&(s.fnAction=r[4]),f&2&&(s.deviceName=r[1]),e.$set(s)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function Xi(t){let e,n;return e=new wl({props:{connected:t[0],store:t[3],fnAction:t[4],deviceName:t[1]}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p(r,f){const s={};f&1&&(s.connected=r[0]),f&8&&(s.store=r[3]),f&16&&(s.fnAction=r[4]),f&2&&(s.deviceName=r[1]),e.$set(s)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function Ol(t){var p;let e,n,r,f,s,l,c;e=new jo({props:{connected:t[0],store:t[3],player:t[2],songTitle:t[9],songPath:t[8],playlistCurrentMedia:t[6],playlistSongPath:t[5],fnAction:t[4]}}),r=new Go({props:{connected:t[0],player:t[2],fnAction:t[4],songTitle:t[9],deviceName:t[1]}});let d=t[1]!="tv-ap2"&&Qi(t),h=!t[2].isStream&&((p=t[7])==null?void 0:p.length)&&Xi(t);return{c(){ze(e.$$.fragment),n=J(),ze(r.$$.fragment),f=J(),d&&d.c(),s=J(),h&&h.c(),l=xt()},m(b,m){je(e,b,m),D(b,n,m),je(r,b,m),D(b,f,m),d&&d.m(b,m),D(b,s,m),h&&h.m(b,m),D(b,l,m),c=!0},p(b,[m]){var E;const y={};m&1&&(y.connected=b[0]),m&8&&(y.store=b[3]),m&4&&(y.player=b[2]),m&512&&(y.songTitle=b[9]),m&256&&(y.songPath=b[8]),m&64&&(y.playlistCurrentMedia=b[6]),m&32&&(y.playlistSongPath=b[5]),m&16&&(y.fnAction=b[4]),e.$set(y);const S={};m&1&&(S.connected=b[0]),m&4&&(S.player=b[2]),m&16&&(S.fnAction=b[4]),m&512&&(S.songTitle=b[9]),m&2&&(S.deviceName=b[1]),r.$set(S),b[1]!="tv-ap2"?d?(d.p(b,m),m&2&&ne(d,1)):(d=Qi(b),d.c(),ne(d,1),d.m(s.parentNode,s)):d&&(St(),ge(d,1,1,()=>{d=null}),Ot()),!b[2].isStream&&((E=b[7])==null?void 0:E.length)?h?(h.p(b,m),m&132&&ne(h,1)):(h=Xi(b),h.c(),ne(h,1),h.m(l.parentNode,l)):h&&(St(),ge(h,1,1,()=>{h=null}),Ot())},i(b){c||(ne(e.$$.fragment,b),ne(r.$$.fragment,b),ne(d),ne(h),c=!0)},o(b){ge(e.$$.fragment,b),ge(r.$$.fragment,b),ge(d),ge(h),c=!1},d(b){Be(e,b),b&&N(n),Be(r,b),b&&N(f),d&&d.d(b),b&&N(s),h&&h.d(b),b&&N(l)}}}function Tl(t,e,n){let r,f,s,l,c,d,h,p,b,m,y=xe,S=()=>(y(),y=Tt(F,j=>n(14,m=j)),F);t.$$.on_destroy.push(()=>y());let{connected:E}=e,{deviceName:I}=e,{player:T}=e,{store:F}=e;S();let{fnAction:oe}=e;return t.$$set=j=>{"connected"in j&&n(0,E=j.connected),"deviceName"in j&&n(1,I=j.deviceName),"player"in j&&n(2,T=j.player),"store"in j&&S(n(3,F=j.store)),"fnAction"in j&&n(4,oe=j.fnAction)},t.$$.update=()=>{t.$$.dirty&4&&n(13,r=T.currentMedia||{}),t.$$.dirty&8192&&n(12,f=r.artist&&r.song?`${r.artist} - ${r.song}`:r.song),t.$$.dirty&8192&&n(10,s=r.songPath),t.$$.dirty&16384&&n(7,l=m.playlist),t.$$.dirty&128&&n(6,c=(l||[]).find(({current:j})=>j)),t.$$.dirty&64&&n(11,d=c==null?void 0:c.title),t.$$.dirty&64&&n(5,h=c==null?void 0:c.path),t.$$.dirty&6144&&n(9,p=f||d),t.$$.dirty&1056&&n(8,b=s||h)},[E,I,T,F,oe,h,c,l,b,p,s,d,f,r,m]}class Cl extends dt{constructor(e){super(),ut(this,e,Tl,Ol,at,{connected:0,deviceName:1,player:2,store:3,fnAction:4})}}function ef(t,e,n){const r=t.slice();return r[15]=e[n],r}function tf(t){let e,n=t[3],r=[];for(let f=0;f<n.length;f+=1)r[f]=ff(ef(t,n,f));return{c(){e=U("div");for(let f=0;f<r.length;f+=1)r[f].c();L(e,"class","nearby_devices svelte-f8wsgm")},m(f,s){D(f,e,s);for(let l=0;l<r.length;l+=1)r[l].m(e,null)},p(f,s){if(s&251){n=f[3];let l;for(l=0;l<n.length;l+=1){const c=ef(f,n,l);r[l]?r[l].p(c,s):(r[l]=ff(c),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(f){f&&N(e),Cn(r,f)}}}function nf(t){let e;return{c(){e=U("span"),e.textContent="!",L(e,"class","error svelte-f8wsgm")},m(n,r){D(n,e,r)},d(n){n&&N(e)}}}function rf(t){let e,n=t[15].mediaType=="music"?"\u266B":"\u25B6",r;return{c(){e=U("span"),r=K(n),L(e,"class","play_symbol svelte-f8wsgm")},m(f,s){D(f,e,s),O(e,r)},p(f,s){s&8&&n!==(n=f[15].mediaType=="music"?"\u266B":"\u25B6")&&Pe(r,n)},d(f){f&&N(e)}}}function ff(t){let e,n,r,f=t[15].deviceName+"",s,l,c,d,h=t[15].hasErrors&&nf(),p=t[15].playing&&rf(t);return{c(){e=U("button"),h&&h.c(),n=J(),p&&p.c(),r=J(),s=K(f),l=J(),L(e,"class","svelte-f8wsgm"),ce(e,"active",t[15].deviceKey==t[0]),ce(e,"local_device",t[15].thisDevice),ce(e,"playing",t[15].playing),ce(e,"late_pong1",t[4]-t[5][t[15].deviceKey]>2e3),ce(e,"late_pong2",t[4]-t[5][t[15].deviceKey]>2500),ce(e,"late_pong3",t[4]-t[5][t[15].deviceKey]>3500),ce(e,"connected",t[6][t[15].deviceKey]),ce(e,"disconnected",t[6][t[15].deviceKey]==!1),ce(e,"cpu_usage_warn1",t[15].cpuUsage>50),ce(e,"cpu_usage_warn2",t[15].cpuUsage>70),ce(e,"cpu_usage_warn3",t[15].cpuUsage>80)},m(b,m){D(b,e,m),h&&h.m(e,null),O(e,n),p&&p.m(e,null),O(e,r),O(e,s),O(e,l),c||(d=Re(e,"click",function(){Qn(t[7]({store:t[1],device:t[15]}))&&t[7]({store:t[1],device:t[15]}).apply(this,arguments)}),c=!0)},p(b,m){t=b,t[15].hasErrors?h||(h=nf(),h.c(),h.m(e,n)):h&&(h.d(1),h=null),t[15].playing?p?p.p(t,m):(p=rf(t),p.c(),p.m(e,r)):p&&(p.d(1),p=null),m&8&&f!==(f=t[15].deviceName+"")&&Pe(s,f),m&9&&ce(e,"active",t[15].deviceKey==t[0]),m&8&&ce(e,"local_device",t[15].thisDevice),m&8&&ce(e,"playing",t[15].playing),m&56&&ce(e,"late_pong1",t[4]-t[5][t[15].deviceKey]>2e3),m&56&&ce(e,"late_pong2",t[4]-t[5][t[15].deviceKey]>2500),m&56&&ce(e,"late_pong3",t[4]-t[5][t[15].deviceKey]>3500),m&72&&ce(e,"connected",t[6][t[15].deviceKey]),m&72&&ce(e,"disconnected",t[6][t[15].deviceKey]==!1),m&8&&ce(e,"cpu_usage_warn1",t[15].cpuUsage>50),m&8&&ce(e,"cpu_usage_warn2",t[15].cpuUsage>70),m&8&&ce(e,"cpu_usage_warn3",t[15].cpuUsage>80)},d(b){b&&N(e),h&&h.d(),p&&p.d(),c=!1,d()}}}function kl(t){let e,n=t[3].length&&tf(t);return{c(){n&&n.c(),e=xt()},m(r,f){n&&n.m(r,f),D(r,e,f)},p(r,[f]){r[3].length?n?n.p(r,f):(n=tf(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:xe,o:xe,d(r){n&&n.d(r),r&&N(e)}}}function Rl(t,e,n){let r,f,s,l,c;yt(t,fs,T=>n(12,f=T));let{nearbyDevices:d}=e,{activeDeviceKey:h}=e,{store:p}=e,{log:b}=e;function m({store:T,device:F}){cr.set(null),an.set(null),localStorage.setItem("current_device_key",F.deviceKey),T.switch(F)}const y=Qt({});yt(t,y,T=>n(5,l=T)),p.on("pong",({deviceKey:T})=>{y.update(F=>(F[T]=Date.now(),F))});const S=Qt({});yt(t,S,T=>n(6,c=T)),S.alreadyDone={};const E=Qt(Date.now());yt(t,E,T=>n(4,s=T));function I(){E.set(Date.now()),setTimeout(I,300)}return I(),t.$$set=T=>{"nearbyDevices"in T&&n(10,d=T.nearbyDevices),"activeDeviceKey"in T&&n(0,h=T.activeDeviceKey),"store"in T&&n(1,p=T.store),"log"in T&&n(11,b=T.log)},t.$$.update=()=>{t.$$.dirty&7175&&n(3,r=d.filter(({deviceName:T,playing:F,deviceKey:oe,thisDevice:j,ip:q,isRPi:W})=>(oe==h||F||f)&&(W||j)).map(T=>{const{ip:F,deviceKey:oe,deviceName:j,thisDevice:q,playing:W}=T;return S.alreadyDone[oe]||(n(2,S.alreadyDone[oe]=!0,S),setTimeout(()=>{b(`${F} Preconnecting ${j}`);const pe=p.preconnect({host:F,deviceKey:oe,thisDevice:q});pe.__prevSubUnsubscribe?pe.__prevSubUnsubscribe():pe.on("decommission",()=>{b(`dmt-mobile: Decommissioned connector ${j} @ ${F}`),n(2,S.alreadyDone[oe]=!1,S),pe.__prevSubUnsubscribe&&pe.__prevSubUnsubscribe()}),pe.__prevSubUnsubscribe=pe.connected.subscribe(ye=>{S.update($e=>($e[oe]=ye,$e))})},0)),T}))},[h,p,S,r,s,l,c,m,y,E,d,b,f]}class Nl extends dt{constructor(e){super(),ut(this,e,Rl,kl,at,{nearbyDevices:10,activeDeviceKey:0,store:1,log:11})}}var Dl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function us(t,e,n){return n={path:e,exports:{},require:function(r,f){return ds(r,f==null?n.path:f)}},t(n,n.exports),n.exports}function $l(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}),e}function ds(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Pl={},Il=Object.freeze({__proto__:null,default:Pl}),Ml=$l(Il),zt=us(function(t){(function(e){var n=function(o){var u,a=new Float64Array(16);if(o)for(u=0;u<o.length;u++)a[u]=o[u];return a},r=function(){throw new Error("no PRNG")},f=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var l=n(),c=n([1]),d=n([56129,1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function S(o,u,a,i){o[u]=a>>24&255,o[u+1]=a>>16&255,o[u+2]=a>>8&255,o[u+3]=a&255,o[u+4]=i>>24&255,o[u+5]=i>>16&255,o[u+6]=i>>8&255,o[u+7]=i&255}function E(o,u,a,i,_){var g,x=0;for(g=0;g<_;g++)x|=o[u+g]^a[i+g];return(1&x-1>>>8)-1}function I(o,u,a,i){return E(o,u,a,i,16)}function T(o,u,a,i){return E(o,u,a,i,32)}function F(o,u,a,i){for(var _=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,k=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,M=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,Q=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,z=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,Te=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,H=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,re=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,ie=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,ue=a[16]&255|(a[17]&255)<<8|(a[18]&255)<<16|(a[19]&255)<<24,ae=a[20]&255|(a[21]&255)<<8|(a[22]&255)<<16|(a[23]&255)<<24,fe=a[24]&255|(a[25]&255)<<8|(a[26]&255)<<16|(a[27]&255)<<24,le=a[28]&255|(a[29]&255)<<8|(a[30]&255)<<16|(a[31]&255)<<24,se=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24,Z=_,X=g,Y=x,G=k,V=M,B=Q,w=z,A=Te,$=H,C=re,R=ie,P=ue,ee=ae,de=fe,_e=le,he=se,v,me=0;me<20;me+=2)v=Z+ee|0,V^=v<<7|v>>>32-7,v=V+Z|0,$^=v<<9|v>>>32-9,v=$+V|0,ee^=v<<13|v>>>32-13,v=ee+$|0,Z^=v<<18|v>>>32-18,v=B+X|0,C^=v<<7|v>>>32-7,v=C+B|0,de^=v<<9|v>>>32-9,v=de+C|0,X^=v<<13|v>>>32-13,v=X+de|0,B^=v<<18|v>>>32-18,v=R+w|0,_e^=v<<7|v>>>32-7,v=_e+R|0,Y^=v<<9|v>>>32-9,v=Y+_e|0,w^=v<<13|v>>>32-13,v=w+Y|0,R^=v<<18|v>>>32-18,v=he+P|0,G^=v<<7|v>>>32-7,v=G+he|0,A^=v<<9|v>>>32-9,v=A+G|0,P^=v<<13|v>>>32-13,v=P+A|0,he^=v<<18|v>>>32-18,v=Z+G|0,X^=v<<7|v>>>32-7,v=X+Z|0,Y^=v<<9|v>>>32-9,v=Y+X|0,G^=v<<13|v>>>32-13,v=G+Y|0,Z^=v<<18|v>>>32-18,v=B+V|0,w^=v<<7|v>>>32-7,v=w+B|0,A^=v<<9|v>>>32-9,v=A+w|0,V^=v<<13|v>>>32-13,v=V+A|0,B^=v<<18|v>>>32-18,v=R+C|0,P^=v<<7|v>>>32-7,v=P+R|0,$^=v<<9|v>>>32-9,v=$+P|0,C^=v<<13|v>>>32-13,v=C+$|0,R^=v<<18|v>>>32-18,v=he+_e|0,ee^=v<<7|v>>>32-7,v=ee+he|0,de^=v<<9|v>>>32-9,v=de+ee|0,_e^=v<<13|v>>>32-13,v=_e+de|0,he^=v<<18|v>>>32-18;Z=Z+_|0,X=X+g|0,Y=Y+x|0,G=G+k|0,V=V+M|0,B=B+Q|0,w=w+z|0,A=A+Te|0,$=$+H|0,C=C+re|0,R=R+ie|0,P=P+ue|0,ee=ee+ae|0,de=de+fe|0,_e=_e+le|0,he=he+se|0,o[0]=Z>>>0&255,o[1]=Z>>>8&255,o[2]=Z>>>16&255,o[3]=Z>>>24&255,o[4]=X>>>0&255,o[5]=X>>>8&255,o[6]=X>>>16&255,o[7]=X>>>24&255,o[8]=Y>>>0&255,o[9]=Y>>>8&255,o[10]=Y>>>16&255,o[11]=Y>>>24&255,o[12]=G>>>0&255,o[13]=G>>>8&255,o[14]=G>>>16&255,o[15]=G>>>24&255,o[16]=V>>>0&255,o[17]=V>>>8&255,o[18]=V>>>16&255,o[19]=V>>>24&255,o[20]=B>>>0&255,o[21]=B>>>8&255,o[22]=B>>>16&255,o[23]=B>>>24&255,o[24]=w>>>0&255,o[25]=w>>>8&255,o[26]=w>>>16&255,o[27]=w>>>24&255,o[28]=A>>>0&255,o[29]=A>>>8&255,o[30]=A>>>16&255,o[31]=A>>>24&255,o[32]=$>>>0&255,o[33]=$>>>8&255,o[34]=$>>>16&255,o[35]=$>>>24&255,o[36]=C>>>0&255,o[37]=C>>>8&255,o[38]=C>>>16&255,o[39]=C>>>24&255,o[40]=R>>>0&255,o[41]=R>>>8&255,o[42]=R>>>16&255,o[43]=R>>>24&255,o[44]=P>>>0&255,o[45]=P>>>8&255,o[46]=P>>>16&255,o[47]=P>>>24&255,o[48]=ee>>>0&255,o[49]=ee>>>8&255,o[50]=ee>>>16&255,o[51]=ee>>>24&255,o[52]=de>>>0&255,o[53]=de>>>8&255,o[54]=de>>>16&255,o[55]=de>>>24&255,o[56]=_e>>>0&255,o[57]=_e>>>8&255,o[58]=_e>>>16&255,o[59]=_e>>>24&255,o[60]=he>>>0&255,o[61]=he>>>8&255,o[62]=he>>>16&255,o[63]=he>>>24&255}function oe(o,u,a,i){for(var _=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,k=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,M=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,Q=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,z=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,Te=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,H=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,re=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,ie=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,ue=a[16]&255|(a[17]&255)<<8|(a[18]&255)<<16|(a[19]&255)<<24,ae=a[20]&255|(a[21]&255)<<8|(a[22]&255)<<16|(a[23]&255)<<24,fe=a[24]&255|(a[25]&255)<<8|(a[26]&255)<<16|(a[27]&255)<<24,le=a[28]&255|(a[29]&255)<<8|(a[30]&255)<<16|(a[31]&255)<<24,se=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24,Z=_,X=g,Y=x,G=k,V=M,B=Q,w=z,A=Te,$=H,C=re,R=ie,P=ue,ee=ae,de=fe,_e=le,he=se,v,me=0;me<20;me+=2)v=Z+ee|0,V^=v<<7|v>>>32-7,v=V+Z|0,$^=v<<9|v>>>32-9,v=$+V|0,ee^=v<<13|v>>>32-13,v=ee+$|0,Z^=v<<18|v>>>32-18,v=B+X|0,C^=v<<7|v>>>32-7,v=C+B|0,de^=v<<9|v>>>32-9,v=de+C|0,X^=v<<13|v>>>32-13,v=X+de|0,B^=v<<18|v>>>32-18,v=R+w|0,_e^=v<<7|v>>>32-7,v=_e+R|0,Y^=v<<9|v>>>32-9,v=Y+_e|0,w^=v<<13|v>>>32-13,v=w+Y|0,R^=v<<18|v>>>32-18,v=he+P|0,G^=v<<7|v>>>32-7,v=G+he|0,A^=v<<9|v>>>32-9,v=A+G|0,P^=v<<13|v>>>32-13,v=P+A|0,he^=v<<18|v>>>32-18,v=Z+G|0,X^=v<<7|v>>>32-7,v=X+Z|0,Y^=v<<9|v>>>32-9,v=Y+X|0,G^=v<<13|v>>>32-13,v=G+Y|0,Z^=v<<18|v>>>32-18,v=B+V|0,w^=v<<7|v>>>32-7,v=w+B|0,A^=v<<9|v>>>32-9,v=A+w|0,V^=v<<13|v>>>32-13,v=V+A|0,B^=v<<18|v>>>32-18,v=R+C|0,P^=v<<7|v>>>32-7,v=P+R|0,$^=v<<9|v>>>32-9,v=$+P|0,C^=v<<13|v>>>32-13,v=C+$|0,R^=v<<18|v>>>32-18,v=he+_e|0,ee^=v<<7|v>>>32-7,v=ee+he|0,de^=v<<9|v>>>32-9,v=de+ee|0,_e^=v<<13|v>>>32-13,v=_e+de|0,he^=v<<18|v>>>32-18;o[0]=Z>>>0&255,o[1]=Z>>>8&255,o[2]=Z>>>16&255,o[3]=Z>>>24&255,o[4]=B>>>0&255,o[5]=B>>>8&255,o[6]=B>>>16&255,o[7]=B>>>24&255,o[8]=R>>>0&255,o[9]=R>>>8&255,o[10]=R>>>16&255,o[11]=R>>>24&255,o[12]=he>>>0&255,o[13]=he>>>8&255,o[14]=he>>>16&255,o[15]=he>>>24&255,o[16]=w>>>0&255,o[17]=w>>>8&255,o[18]=w>>>16&255,o[19]=w>>>24&255,o[20]=A>>>0&255,o[21]=A>>>8&255,o[22]=A>>>16&255,o[23]=A>>>24&255,o[24]=$>>>0&255,o[25]=$>>>8&255,o[26]=$>>>16&255,o[27]=$>>>24&255,o[28]=C>>>0&255,o[29]=C>>>8&255,o[30]=C>>>16&255,o[31]=C>>>24&255}function j(o,u,a,i){F(o,u,a,i)}function q(o,u,a,i){oe(o,u,a,i)}var W=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function Oe(o,u,a,i,_,g,x){var k=new Uint8Array(16),M=new Uint8Array(64),Q,z;for(z=0;z<16;z++)k[z]=0;for(z=0;z<8;z++)k[z]=g[z];for(;_>=64;){for(j(M,k,x,W),z=0;z<64;z++)o[u+z]=a[i+z]^M[z];for(Q=1,z=8;z<16;z++)Q=Q+(k[z]&255)|0,k[z]=Q&255,Q>>>=8;_-=64,u+=64,i+=64}if(_>0)for(j(M,k,x,W),z=0;z<_;z++)o[u+z]=a[i+z]^M[z];return 0}function pe(o,u,a,i,_){var g=new Uint8Array(16),x=new Uint8Array(64),k,M;for(M=0;M<16;M++)g[M]=0;for(M=0;M<8;M++)g[M]=i[M];for(;a>=64;){for(j(x,g,_,W),M=0;M<64;M++)o[u+M]=x[M];for(k=1,M=8;M<16;M++)k=k+(g[M]&255)|0,g[M]=k&255,k>>>=8;a-=64,u+=64}if(a>0)for(j(x,g,_,W),M=0;M<a;M++)o[u+M]=x[M];return 0}function ye(o,u,a,i,_){var g=new Uint8Array(32);q(g,i,_,W);for(var x=new Uint8Array(8),k=0;k<8;k++)x[k]=i[k+16];return pe(o,u,a,x,g)}function $e(o,u,a,i,_,g,x){var k=new Uint8Array(32);q(k,g,x,W);for(var M=new Uint8Array(8),Q=0;Q<8;Q++)M[Q]=g[Q+16];return Oe(o,u,a,i,_,M,k)}var ft=function(o){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var u,a,i,_,g,x,k,M;u=o[0]&255|(o[1]&255)<<8,this.r[0]=u&8191,a=o[2]&255|(o[3]&255)<<8,this.r[1]=(u>>>13|a<<3)&8191,i=o[4]&255|(o[5]&255)<<8,this.r[2]=(a>>>10|i<<6)&7939,_=o[6]&255|(o[7]&255)<<8,this.r[3]=(i>>>7|_<<9)&8191,g=o[8]&255|(o[9]&255)<<8,this.r[4]=(_>>>4|g<<12)&255,this.r[5]=g>>>1&8190,x=o[10]&255|(o[11]&255)<<8,this.r[6]=(g>>>14|x<<2)&8191,k=o[12]&255|(o[13]&255)<<8,this.r[7]=(x>>>11|k<<5)&8065,M=o[14]&255|(o[15]&255)<<8,this.r[8]=(k>>>8|M<<8)&8191,this.r[9]=M>>>5&127,this.pad[0]=o[16]&255|(o[17]&255)<<8,this.pad[1]=o[18]&255|(o[19]&255)<<8,this.pad[2]=o[20]&255|(o[21]&255)<<8,this.pad[3]=o[22]&255|(o[23]&255)<<8,this.pad[4]=o[24]&255|(o[25]&255)<<8,this.pad[5]=o[26]&255|(o[27]&255)<<8,this.pad[6]=o[28]&255|(o[29]&255)<<8,this.pad[7]=o[30]&255|(o[31]&255)<<8};ft.prototype.blocks=function(o,u,a){for(var i=this.fin?0:2048,_,g,x,k,M,Q,z,Te,H,re,ie,ue,ae,fe,le,se,Z,X,Y,G=this.h[0],V=this.h[1],B=this.h[2],w=this.h[3],A=this.h[4],$=this.h[5],C=this.h[6],R=this.h[7],P=this.h[8],ee=this.h[9],de=this.r[0],_e=this.r[1],he=this.r[2],v=this.r[3],me=this.r[4],Ce=this.r[5],ke=this.r[6],ve=this.r[7],Ee=this.r[8],Se=this.r[9];a>=16;)_=o[u+0]&255|(o[u+1]&255)<<8,G+=_&8191,g=o[u+2]&255|(o[u+3]&255)<<8,V+=(_>>>13|g<<3)&8191,x=o[u+4]&255|(o[u+5]&255)<<8,B+=(g>>>10|x<<6)&8191,k=o[u+6]&255|(o[u+7]&255)<<8,w+=(x>>>7|k<<9)&8191,M=o[u+8]&255|(o[u+9]&255)<<8,A+=(k>>>4|M<<12)&8191,$+=M>>>1&8191,Q=o[u+10]&255|(o[u+11]&255)<<8,C+=(M>>>14|Q<<2)&8191,z=o[u+12]&255|(o[u+13]&255)<<8,R+=(Q>>>11|z<<5)&8191,Te=o[u+14]&255|(o[u+15]&255)<<8,P+=(z>>>8|Te<<8)&8191,ee+=Te>>>5|i,H=0,re=H,re+=G*de,re+=V*(5*Se),re+=B*(5*Ee),re+=w*(5*ve),re+=A*(5*ke),H=re>>>13,re&=8191,re+=$*(5*Ce),re+=C*(5*me),re+=R*(5*v),re+=P*(5*he),re+=ee*(5*_e),H+=re>>>13,re&=8191,ie=H,ie+=G*_e,ie+=V*de,ie+=B*(5*Se),ie+=w*(5*Ee),ie+=A*(5*ve),H=ie>>>13,ie&=8191,ie+=$*(5*ke),ie+=C*(5*Ce),ie+=R*(5*me),ie+=P*(5*v),ie+=ee*(5*he),H+=ie>>>13,ie&=8191,ue=H,ue+=G*he,ue+=V*_e,ue+=B*de,ue+=w*(5*Se),ue+=A*(5*Ee),H=ue>>>13,ue&=8191,ue+=$*(5*ve),ue+=C*(5*ke),ue+=R*(5*Ce),ue+=P*(5*me),ue+=ee*(5*v),H+=ue>>>13,ue&=8191,ae=H,ae+=G*v,ae+=V*he,ae+=B*_e,ae+=w*de,ae+=A*(5*Se),H=ae>>>13,ae&=8191,ae+=$*(5*Ee),ae+=C*(5*ve),ae+=R*(5*ke),ae+=P*(5*Ce),ae+=ee*(5*me),H+=ae>>>13,ae&=8191,fe=H,fe+=G*me,fe+=V*v,fe+=B*he,fe+=w*_e,fe+=A*de,H=fe>>>13,fe&=8191,fe+=$*(5*Se),fe+=C*(5*Ee),fe+=R*(5*ve),fe+=P*(5*ke),fe+=ee*(5*Ce),H+=fe>>>13,fe&=8191,le=H,le+=G*Ce,le+=V*me,le+=B*v,le+=w*he,le+=A*_e,H=le>>>13,le&=8191,le+=$*de,le+=C*(5*Se),le+=R*(5*Ee),le+=P*(5*ve),le+=ee*(5*ke),H+=le>>>13,le&=8191,se=H,se+=G*ke,se+=V*Ce,se+=B*me,se+=w*v,se+=A*he,H=se>>>13,se&=8191,se+=$*_e,se+=C*de,se+=R*(5*Se),se+=P*(5*Ee),se+=ee*(5*ve),H+=se>>>13,se&=8191,Z=H,Z+=G*ve,Z+=V*ke,Z+=B*Ce,Z+=w*me,Z+=A*v,H=Z>>>13,Z&=8191,Z+=$*he,Z+=C*_e,Z+=R*de,Z+=P*(5*Se),Z+=ee*(5*Ee),H+=Z>>>13,Z&=8191,X=H,X+=G*Ee,X+=V*ve,X+=B*ke,X+=w*Ce,X+=A*me,H=X>>>13,X&=8191,X+=$*v,X+=C*he,X+=R*_e,X+=P*de,X+=ee*(5*Se),H+=X>>>13,X&=8191,Y=H,Y+=G*Se,Y+=V*Ee,Y+=B*ve,Y+=w*ke,Y+=A*Ce,H=Y>>>13,Y&=8191,Y+=$*me,Y+=C*v,Y+=R*he,Y+=P*_e,Y+=ee*de,H+=Y>>>13,Y&=8191,H=(H<<2)+H|0,H=H+re|0,re=H&8191,H=H>>>13,ie+=H,G=re,V=ie,B=ue,w=ae,A=fe,$=le,C=se,R=Z,P=X,ee=Y,u+=16,a-=16;this.h[0]=G,this.h[1]=V,this.h[2]=B,this.h[3]=w,this.h[4]=A,this.h[5]=$,this.h[6]=C,this.h[7]=R,this.h[8]=P,this.h[9]=ee},ft.prototype.finish=function(o,u){var a=new Uint16Array(10),i,_,g,x;if(this.leftover){for(x=this.leftover,this.buffer[x++]=1;x<16;x++)this.buffer[x]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(i=this.h[1]>>>13,this.h[1]&=8191,x=2;x<10;x++)this.h[x]+=i,i=this.h[x]>>>13,this.h[x]&=8191;for(this.h[0]+=i*5,i=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=i,i=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=i,a[0]=this.h[0]+5,i=a[0]>>>13,a[0]&=8191,x=1;x<10;x++)a[x]=this.h[x]+i,i=a[x]>>>13,a[x]&=8191;for(a[9]-=1<<13,_=(i^1)-1,x=0;x<10;x++)a[x]&=_;for(_=~_,x=0;x<10;x++)this.h[x]=this.h[x]&_|a[x];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,g=this.h[0]+this.pad[0],this.h[0]=g&65535,x=1;x<8;x++)g=(this.h[x]+this.pad[x]|0)+(g>>>16)|0,this.h[x]=g&65535;o[u+0]=this.h[0]>>>0&255,o[u+1]=this.h[0]>>>8&255,o[u+2]=this.h[1]>>>0&255,o[u+3]=this.h[1]>>>8&255,o[u+4]=this.h[2]>>>0&255,o[u+5]=this.h[2]>>>8&255,o[u+6]=this.h[3]>>>0&255,o[u+7]=this.h[3]>>>8&255,o[u+8]=this.h[4]>>>0&255,o[u+9]=this.h[4]>>>8&255,o[u+10]=this.h[5]>>>0&255,o[u+11]=this.h[5]>>>8&255,o[u+12]=this.h[6]>>>0&255,o[u+13]=this.h[6]>>>8&255,o[u+14]=this.h[7]>>>0&255,o[u+15]=this.h[7]>>>8&255},ft.prototype.update=function(o,u,a){var i,_;if(this.leftover){for(_=16-this.leftover,_>a&&(_=a),i=0;i<_;i++)this.buffer[this.leftover+i]=o[u+i];if(a-=_,u+=_,this.leftover+=_,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(a>=16&&(_=a-a%16,this.blocks(o,u,_),u+=_,a-=_),a){for(i=0;i<a;i++)this.buffer[this.leftover+i]=o[u+i];this.leftover+=a}};function Je(o,u,a,i,_,g){var x=new ft(g);return x.update(a,i,_),x.finish(o,u),0}function ct(o,u,a,i,_,g){var x=new Uint8Array(16);return Je(x,0,a,i,_,g),I(o,u,x,0)}function Ae(o,u,a,i,_){var g;if(a<32)return-1;for($e(o,0,u,0,a,i,_),Je(o,16,o,32,a-32,o),g=0;g<16;g++)o[g]=0;return 0}function We(o,u,a,i,_){var g,x=new Uint8Array(32);if(a<32||(ye(x,0,32,i,_),ct(u,16,u,32,a-32,x)!==0))return-1;for($e(o,0,u,0,a,i,_),g=0;g<32;g++)o[g]=0;return 0}function Fe(o,u){var a;for(a=0;a<16;a++)o[a]=u[a]|0}function ht(o){var u,a,i=1;for(u=0;u<16;u++)a=o[u]+i+65535,i=Math.floor(a/65536),o[u]=a-i*65536;o[0]+=i-1+37*(i-1)}function st(o,u,a){for(var i,_=~(a-1),g=0;g<16;g++)i=_&(o[g]^u[g]),o[g]^=i,u[g]^=i}function we(o,u){var a,i,_,g=n(),x=n();for(a=0;a<16;a++)x[a]=u[a];for(ht(x),ht(x),ht(x),i=0;i<2;i++){for(g[0]=x[0]-65517,a=1;a<15;a++)g[a]=x[a]-65535-(g[a-1]>>16&1),g[a-1]&=65535;g[15]=x[15]-32767-(g[14]>>16&1),_=g[15]>>16&1,g[14]&=65535,st(x,g,1-_)}for(a=0;a<16;a++)o[2*a]=x[a]&255,o[2*a+1]=x[a]>>8}function qe(o,u){var a=new Uint8Array(32),i=new Uint8Array(32);return we(a,o),we(i,u),T(a,0,i,0)}function Ct(o){var u=new Uint8Array(32);return we(u,o),u[0]&1}function wt(o,u){var a;for(a=0;a<16;a++)o[a]=u[2*a]+(u[2*a+1]<<8);o[15]&=32767}function He(o,u,a){for(var i=0;i<16;i++)o[i]=u[i]+a[i]}function Xe(o,u,a){for(var i=0;i<16;i++)o[i]=u[i]-a[i]}function be(o,u,a){var i,_,g=0,x=0,k=0,M=0,Q=0,z=0,Te=0,H=0,re=0,ie=0,ue=0,ae=0,fe=0,le=0,se=0,Z=0,X=0,Y=0,G=0,V=0,B=0,w=0,A=0,$=0,C=0,R=0,P=0,ee=0,de=0,_e=0,he=0,v=a[0],me=a[1],Ce=a[2],ke=a[3],ve=a[4],Ee=a[5],Se=a[6],Ke=a[7],De=a[8],Me=a[9],Ue=a[10],Le=a[11],Ye=a[12],Ge=a[13],Ve=a[14],Qe=a[15];i=u[0],g+=i*v,x+=i*me,k+=i*Ce,M+=i*ke,Q+=i*ve,z+=i*Ee,Te+=i*Se,H+=i*Ke,re+=i*De,ie+=i*Me,ue+=i*Ue,ae+=i*Le,fe+=i*Ye,le+=i*Ge,se+=i*Ve,Z+=i*Qe,i=u[1],x+=i*v,k+=i*me,M+=i*Ce,Q+=i*ke,z+=i*ve,Te+=i*Ee,H+=i*Se,re+=i*Ke,ie+=i*De,ue+=i*Me,ae+=i*Ue,fe+=i*Le,le+=i*Ye,se+=i*Ge,Z+=i*Ve,X+=i*Qe,i=u[2],k+=i*v,M+=i*me,Q+=i*Ce,z+=i*ke,Te+=i*ve,H+=i*Ee,re+=i*Se,ie+=i*Ke,ue+=i*De,ae+=i*Me,fe+=i*Ue,le+=i*Le,se+=i*Ye,Z+=i*Ge,X+=i*Ve,Y+=i*Qe,i=u[3],M+=i*v,Q+=i*me,z+=i*Ce,Te+=i*ke,H+=i*ve,re+=i*Ee,ie+=i*Se,ue+=i*Ke,ae+=i*De,fe+=i*Me,le+=i*Ue,se+=i*Le,Z+=i*Ye,X+=i*Ge,Y+=i*Ve,G+=i*Qe,i=u[4],Q+=i*v,z+=i*me,Te+=i*Ce,H+=i*ke,re+=i*ve,ie+=i*Ee,ue+=i*Se,ae+=i*Ke,fe+=i*De,le+=i*Me,se+=i*Ue,Z+=i*Le,X+=i*Ye,Y+=i*Ge,G+=i*Ve,V+=i*Qe,i=u[5],z+=i*v,Te+=i*me,H+=i*Ce,re+=i*ke,ie+=i*ve,ue+=i*Ee,ae+=i*Se,fe+=i*Ke,le+=i*De,se+=i*Me,Z+=i*Ue,X+=i*Le,Y+=i*Ye,G+=i*Ge,V+=i*Ve,B+=i*Qe,i=u[6],Te+=i*v,H+=i*me,re+=i*Ce,ie+=i*ke,ue+=i*ve,ae+=i*Ee,fe+=i*Se,le+=i*Ke,se+=i*De,Z+=i*Me,X+=i*Ue,Y+=i*Le,G+=i*Ye,V+=i*Ge,B+=i*Ve,w+=i*Qe,i=u[7],H+=i*v,re+=i*me,ie+=i*Ce,ue+=i*ke,ae+=i*ve,fe+=i*Ee,le+=i*Se,se+=i*Ke,Z+=i*De,X+=i*Me,Y+=i*Ue,G+=i*Le,V+=i*Ye,B+=i*Ge,w+=i*Ve,A+=i*Qe,i=u[8],re+=i*v,ie+=i*me,ue+=i*Ce,ae+=i*ke,fe+=i*ve,le+=i*Ee,se+=i*Se,Z+=i*Ke,X+=i*De,Y+=i*Me,G+=i*Ue,V+=i*Le,B+=i*Ye,w+=i*Ge,A+=i*Ve,$+=i*Qe,i=u[9],ie+=i*v,ue+=i*me,ae+=i*Ce,fe+=i*ke,le+=i*ve,se+=i*Ee,Z+=i*Se,X+=i*Ke,Y+=i*De,G+=i*Me,V+=i*Ue,B+=i*Le,w+=i*Ye,A+=i*Ge,$+=i*Ve,C+=i*Qe,i=u[10],ue+=i*v,ae+=i*me,fe+=i*Ce,le+=i*ke,se+=i*ve,Z+=i*Ee,X+=i*Se,Y+=i*Ke,G+=i*De,V+=i*Me,B+=i*Ue,w+=i*Le,A+=i*Ye,$+=i*Ge,C+=i*Ve,R+=i*Qe,i=u[11],ae+=i*v,fe+=i*me,le+=i*Ce,se+=i*ke,Z+=i*ve,X+=i*Ee,Y+=i*Se,G+=i*Ke,V+=i*De,B+=i*Me,w+=i*Ue,A+=i*Le,$+=i*Ye,C+=i*Ge,R+=i*Ve,P+=i*Qe,i=u[12],fe+=i*v,le+=i*me,se+=i*Ce,Z+=i*ke,X+=i*ve,Y+=i*Ee,G+=i*Se,V+=i*Ke,B+=i*De,w+=i*Me,A+=i*Ue,$+=i*Le,C+=i*Ye,R+=i*Ge,P+=i*Ve,ee+=i*Qe,i=u[13],le+=i*v,se+=i*me,Z+=i*Ce,X+=i*ke,Y+=i*ve,G+=i*Ee,V+=i*Se,B+=i*Ke,w+=i*De,A+=i*Me,$+=i*Ue,C+=i*Le,R+=i*Ye,P+=i*Ge,ee+=i*Ve,de+=i*Qe,i=u[14],se+=i*v,Z+=i*me,X+=i*Ce,Y+=i*ke,G+=i*ve,V+=i*Ee,B+=i*Se,w+=i*Ke,A+=i*De,$+=i*Me,C+=i*Ue,R+=i*Le,P+=i*Ye,ee+=i*Ge,de+=i*Ve,_e+=i*Qe,i=u[15],Z+=i*v,X+=i*me,Y+=i*Ce,G+=i*ke,V+=i*ve,B+=i*Ee,w+=i*Se,A+=i*Ke,$+=i*De,C+=i*Me,R+=i*Ue,P+=i*Le,ee+=i*Ye,de+=i*Ge,_e+=i*Ve,he+=i*Qe,g+=38*X,x+=38*Y,k+=38*G,M+=38*V,Q+=38*B,z+=38*w,Te+=38*A,H+=38*$,re+=38*C,ie+=38*R,ue+=38*P,ae+=38*ee,fe+=38*de,le+=38*_e,se+=38*he,_=1,i=g+_+65535,_=Math.floor(i/65536),g=i-_*65536,i=x+_+65535,_=Math.floor(i/65536),x=i-_*65536,i=k+_+65535,_=Math.floor(i/65536),k=i-_*65536,i=M+_+65535,_=Math.floor(i/65536),M=i-_*65536,i=Q+_+65535,_=Math.floor(i/65536),Q=i-_*65536,i=z+_+65535,_=Math.floor(i/65536),z=i-_*65536,i=Te+_+65535,_=Math.floor(i/65536),Te=i-_*65536,i=H+_+65535,_=Math.floor(i/65536),H=i-_*65536,i=re+_+65535,_=Math.floor(i/65536),re=i-_*65536,i=ie+_+65535,_=Math.floor(i/65536),ie=i-_*65536,i=ue+_+65535,_=Math.floor(i/65536),ue=i-_*65536,i=ae+_+65535,_=Math.floor(i/65536),ae=i-_*65536,i=fe+_+65535,_=Math.floor(i/65536),fe=i-_*65536,i=le+_+65535,_=Math.floor(i/65536),le=i-_*65536,i=se+_+65535,_=Math.floor(i/65536),se=i-_*65536,i=Z+_+65535,_=Math.floor(i/65536),Z=i-_*65536,g+=_-1+37*(_-1),_=1,i=g+_+65535,_=Math.floor(i/65536),g=i-_*65536,i=x+_+65535,_=Math.floor(i/65536),x=i-_*65536,i=k+_+65535,_=Math.floor(i/65536),k=i-_*65536,i=M+_+65535,_=Math.floor(i/65536),M=i-_*65536,i=Q+_+65535,_=Math.floor(i/65536),Q=i-_*65536,i=z+_+65535,_=Math.floor(i/65536),z=i-_*65536,i=Te+_+65535,_=Math.floor(i/65536),Te=i-_*65536,i=H+_+65535,_=Math.floor(i/65536),H=i-_*65536,i=re+_+65535,_=Math.floor(i/65536),re=i-_*65536,i=ie+_+65535,_=Math.floor(i/65536),ie=i-_*65536,i=ue+_+65535,_=Math.floor(i/65536),ue=i-_*65536,i=ae+_+65535,_=Math.floor(i/65536),ae=i-_*65536,i=fe+_+65535,_=Math.floor(i/65536),fe=i-_*65536,i=le+_+65535,_=Math.floor(i/65536),le=i-_*65536,i=se+_+65535,_=Math.floor(i/65536),se=i-_*65536,i=Z+_+65535,_=Math.floor(i/65536),Z=i-_*65536,g+=_-1+37*(_-1),o[0]=g,o[1]=x,o[2]=k,o[3]=M,o[4]=Q,o[5]=z,o[6]=Te,o[7]=H,o[8]=re,o[9]=ie,o[10]=ue,o[11]=ae,o[12]=fe,o[13]=le,o[14]=se,o[15]=Z}function Ze(o,u){be(o,u,u)}function At(o,u){var a=n(),i;for(i=0;i<16;i++)a[i]=u[i];for(i=253;i>=0;i--)Ze(a,a),i!==2&&i!==4&&be(a,a,u);for(i=0;i<16;i++)o[i]=a[i]}function Ht(o,u){var a=n(),i;for(i=0;i<16;i++)a[i]=u[i];for(i=250;i>=0;i--)Ze(a,a),i!==1&&be(a,a,u);for(i=0;i<16;i++)o[i]=a[i]}function bt(o,u,a){var i=new Uint8Array(32),_=new Float64Array(80),g,x,k=n(),M=n(),Q=n(),z=n(),Te=n(),H=n();for(x=0;x<31;x++)i[x]=u[x];for(i[31]=u[31]&127|64,i[0]&=248,wt(_,a),x=0;x<16;x++)M[x]=_[x],z[x]=k[x]=Q[x]=0;for(k[0]=z[0]=1,x=254;x>=0;--x)g=i[x>>>3]>>>(x&7)&1,st(k,M,g),st(Q,z,g),He(Te,k,Q),Xe(k,k,Q),He(Q,M,z),Xe(M,M,z),Ze(z,Te),Ze(H,k),be(k,Q,k),be(Q,M,Te),He(Te,k,Q),Xe(k,k,Q),Ze(M,k),Xe(Q,z,H),be(k,Q,d),He(k,k,z),be(Q,Q,k),be(k,z,H),be(z,M,_),Ze(M,Te),st(k,M,g),st(Q,z,g);for(x=0;x<16;x++)_[x+16]=k[x],_[x+32]=Q[x],_[x+48]=M[x],_[x+64]=z[x];var re=_.subarray(32),ie=_.subarray(16);return At(re,re),be(ie,ie,re),we(o,ie),0}function Nt(o,u){return bt(o,u,s)}function Ut(o,u){return r(u,32),Nt(o,u)}function kt(o,u,a){var i=new Uint8Array(32);return bt(i,a,u),q(o,f,i,W)}var Xt=Ae,dn=We;function en(o,u,a,i,_,g){var x=new Uint8Array(32);return kt(x,_,g),Xt(o,u,a,i,x)}function Et(o,u,a,i,_,g){var x=new Uint8Array(32);return kt(x,_,g),dn(o,u,a,i,x)}var tn=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Lt(o,u,a,i){for(var _=new Int32Array(16),g=new Int32Array(16),x,k,M,Q,z,Te,H,re,ie,ue,ae,fe,le,se,Z,X,Y,G,V,B,w,A,$,C,R,P,ee=o[0],de=o[1],_e=o[2],he=o[3],v=o[4],me=o[5],Ce=o[6],ke=o[7],ve=u[0],Ee=u[1],Se=u[2],Ke=u[3],De=u[4],Me=u[5],Ue=u[6],Le=u[7],Ye=0;i>=128;){for(V=0;V<16;V++)B=8*V+Ye,_[V]=a[B+0]<<24|a[B+1]<<16|a[B+2]<<8|a[B+3],g[V]=a[B+4]<<24|a[B+5]<<16|a[B+6]<<8|a[B+7];for(V=0;V<80;V++)if(x=ee,k=de,M=_e,Q=he,z=v,Te=me,H=Ce,re=ke,ie=ve,ue=Ee,ae=Se,fe=Ke,le=De,se=Me,Z=Ue,X=Le,w=ke,A=Le,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=(v>>>14|De<<32-14)^(v>>>18|De<<32-18)^(De>>>41-32|v<<32-(41-32)),A=(De>>>14|v<<32-14)^(De>>>18|v<<32-18)^(v>>>41-32|De<<32-(41-32)),$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,w=v&me^~v&Ce,A=De&Me^~De&Ue,$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,w=tn[V*2],A=tn[V*2+1],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,w=_[V%16],A=g[V%16],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,Y=R&65535|P<<16,G=$&65535|C<<16,w=Y,A=G,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=(ee>>>28|ve<<32-28)^(ve>>>34-32|ee<<32-(34-32))^(ve>>>39-32|ee<<32-(39-32)),A=(ve>>>28|ee<<32-28)^(ee>>>34-32|ve<<32-(34-32))^(ee>>>39-32|ve<<32-(39-32)),$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,w=ee&de^ee&_e^de&_e,A=ve&Ee^ve&Se^Ee&Se,$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,re=R&65535|P<<16,X=$&65535|C<<16,w=Q,A=fe,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=Y,A=G,$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,Q=R&65535|P<<16,fe=$&65535|C<<16,de=x,_e=k,he=M,v=Q,me=z,Ce=Te,ke=H,ee=re,Ee=ie,Se=ue,Ke=ae,De=fe,Me=le,Ue=se,Le=Z,ve=X,V%16===15)for(B=0;B<16;B++)w=_[B],A=g[B],$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=_[(B+9)%16],A=g[(B+9)%16],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,Y=_[(B+1)%16],G=g[(B+1)%16],w=(Y>>>1|G<<32-1)^(Y>>>8|G<<32-8)^Y>>>7,A=(G>>>1|Y<<32-1)^(G>>>8|Y<<32-8)^(G>>>7|Y<<32-7),$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,Y=_[(B+14)%16],G=g[(B+14)%16],w=(Y>>>19|G<<32-19)^(G>>>61-32|Y<<32-(61-32))^Y>>>6,A=(G>>>19|Y<<32-19)^(Y>>>61-32|G<<32-(61-32))^(G>>>6|Y<<32-6),$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,_[B]=R&65535|P<<16,g[B]=$&65535|C<<16;w=ee,A=ve,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[0],A=u[0],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[0]=ee=R&65535|P<<16,u[0]=ve=$&65535|C<<16,w=de,A=Ee,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[1],A=u[1],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[1]=de=R&65535|P<<16,u[1]=Ee=$&65535|C<<16,w=_e,A=Se,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[2],A=u[2],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[2]=_e=R&65535|P<<16,u[2]=Se=$&65535|C<<16,w=he,A=Ke,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[3],A=u[3],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[3]=he=R&65535|P<<16,u[3]=Ke=$&65535|C<<16,w=v,A=De,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[4],A=u[4],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[4]=v=R&65535|P<<16,u[4]=De=$&65535|C<<16,w=me,A=Me,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[5],A=u[5],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[5]=me=R&65535|P<<16,u[5]=Me=$&65535|C<<16,w=Ce,A=Ue,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[6],A=u[6],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[6]=Ce=R&65535|P<<16,u[6]=Ue=$&65535|C<<16,w=ke,A=Le,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[7],A=u[7],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[7]=ke=R&65535|P<<16,u[7]=Le=$&65535|C<<16,Ye+=128,i-=128}return i}function nt(o,u,a){var i=new Int32Array(8),_=new Int32Array(8),g=new Uint8Array(256),x,k=a;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,_[0]=4089235720,_[1]=2227873595,_[2]=4271175723,_[3]=1595750129,_[4]=2917565137,_[5]=725511199,_[6]=4215389547,_[7]=327033209,Lt(i,_,u,a),a%=128,x=0;x<a;x++)g[x]=u[k-a+x];for(g[a]=128,a=256-128*(a<112?1:0),g[a-9]=0,S(g,a-8,k/536870912|0,k<<3),Lt(i,_,g,a),x=0;x<8;x++)S(o,8*x,i[x],_[x]);return 0}function it(o,u){var a=n(),i=n(),_=n(),g=n(),x=n(),k=n(),M=n(),Q=n(),z=n();Xe(a,o[1],o[0]),Xe(z,u[1],u[0]),be(a,a,z),He(i,o[0],o[1]),He(z,u[0],u[1]),be(i,i,z),be(_,o[3],u[3]),be(_,_,p),be(g,o[2],u[2]),He(g,g,g),Xe(x,i,a),Xe(k,g,_),He(M,g,_),He(Q,i,a),be(o[0],x,k),be(o[1],Q,M),be(o[2],M,k),be(o[3],x,Q)}function ot(o,u,a){var i;for(i=0;i<4;i++)st(o[i],u[i],a)}function jt(o,u){var a=n(),i=n(),_=n();At(_,u[2]),be(a,u[0],_),be(i,u[1],_),we(o,i),o[31]^=Ct(a)<<7}function te(o,u,a){var i,_;for(Fe(o[0],l),Fe(o[1],c),Fe(o[2],c),Fe(o[3],l),_=255;_>=0;--_)i=a[_/8|0]>>(_&7)&1,ot(o,u,i),it(u,o),it(o,o),ot(o,u,i)}function Ne(o,u){var a=[n(),n(),n(),n()];Fe(a[0],b),Fe(a[1],m),Fe(a[2],c),be(a[3],b,m),te(o,a,u)}function Bt(o,u,a){var i=new Uint8Array(64),_=[n(),n(),n(),n()],g;for(a||r(u,32),nt(i,u,32),i[0]&=248,i[31]&=127,i[31]|=64,Ne(_,i),jt(o,_),g=0;g<32;g++)u[g+32]=o[g];return 0}var Jt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Ie(o,u){var a,i,_,g;for(i=63;i>=32;--i){for(a=0,_=i-32,g=i-12;_<g;++_)u[_]+=a-16*u[i]*Jt[_-(i-32)],a=Math.floor((u[_]+128)/256),u[_]-=a*256;u[_]+=a,u[i]=0}for(a=0,_=0;_<32;_++)u[_]+=a-(u[31]>>4)*Jt[_],a=u[_]>>8,u[_]&=255;for(_=0;_<32;_++)u[_]-=a*Jt[_];for(i=0;i<32;i++)u[i+1]+=u[i]>>8,o[i]=u[i]&255}function lt(o){var u=new Float64Array(64),a;for(a=0;a<64;a++)u[a]=o[a];for(a=0;a<64;a++)o[a]=0;Ie(o,u)}function hn(o,u,a,i){var _=new Uint8Array(64),g=new Uint8Array(64),x=new Uint8Array(64),k,M,Q=new Float64Array(64),z=[n(),n(),n(),n()];nt(_,i,32),_[0]&=248,_[31]&=127,_[31]|=64;var Te=a+64;for(k=0;k<a;k++)o[64+k]=u[k];for(k=0;k<32;k++)o[32+k]=_[32+k];for(nt(x,o.subarray(32),a+32),lt(x),Ne(z,x),jt(o,z),k=32;k<64;k++)o[k]=i[k];for(nt(g,o,a+64),lt(g),k=0;k<64;k++)Q[k]=0;for(k=0;k<32;k++)Q[k]=x[k];for(k=0;k<32;k++)for(M=0;M<32;M++)Q[k+M]+=g[k]*_[M];return Ie(o.subarray(32),Q),Te}function Nn(o,u){var a=n(),i=n(),_=n(),g=n(),x=n(),k=n(),M=n();return Fe(o[2],c),wt(o[1],u),Ze(_,o[1]),be(g,_,h),Xe(_,_,o[2]),He(g,o[2],g),Ze(x,g),Ze(k,x),be(M,k,x),be(a,M,_),be(a,a,g),Ht(a,a),be(a,a,_),be(a,a,g),be(a,a,g),be(o[0],a,g),Ze(i,o[0]),be(i,i,g),qe(i,_)&&be(o[0],o[0],y),Ze(i,o[0]),be(i,i,g),qe(i,_)?-1:(Ct(o[0])===u[31]>>7&&Xe(o[0],l,o[0]),be(o[3],o[0],o[1]),0)}function nn(o,u,a,i){var _,g=new Uint8Array(32),x=new Uint8Array(64),k=[n(),n(),n(),n()],M=[n(),n(),n(),n()];if(a<64||Nn(M,i))return-1;for(_=0;_<a;_++)o[_]=u[_];for(_=0;_<32;_++)o[_+32]=i[_];if(nt(x,o,a),lt(x),te(k,M,x),Ne(M,u.subarray(32)),it(k,M),jt(g,k),a-=64,T(u,0,g,0)){for(_=0;_<a;_++)o[_]=0;return-1}for(_=0;_<a;_++)o[_]=u[_+64];return a}var mn=32,rn=24,Wt=32,$t=16,Zt=32,fn=32,Gt=32,Vt=32,yn=32,zn=rn,wr=Wt,Ar=$t,mt=64,Rt=32,Pt=64,gn=32,xn=64;e.lowlevel={crypto_core_hsalsa20:q,crypto_stream_xor:$e,crypto_stream:ye,crypto_stream_salsa20_xor:Oe,crypto_stream_salsa20:pe,crypto_onetimeauth:Je,crypto_onetimeauth_verify:ct,crypto_verify_16:I,crypto_verify_32:T,crypto_secretbox:Ae,crypto_secretbox_open:We,crypto_scalarmult:bt,crypto_scalarmult_base:Nt,crypto_box_beforenm:kt,crypto_box_afternm:Xt,crypto_box:en,crypto_box_open:Et,crypto_box_keypair:Ut,crypto_hash:nt,crypto_sign:hn,crypto_sign_keypair:Bt,crypto_sign_open:nn,crypto_secretbox_KEYBYTES:mn,crypto_secretbox_NONCEBYTES:rn,crypto_secretbox_ZEROBYTES:Wt,crypto_secretbox_BOXZEROBYTES:$t,crypto_scalarmult_BYTES:Zt,crypto_scalarmult_SCALARBYTES:fn,crypto_box_PUBLICKEYBYTES:Gt,crypto_box_SECRETKEYBYTES:Vt,crypto_box_BEFORENMBYTES:yn,crypto_box_NONCEBYTES:zn,crypto_box_ZEROBYTES:wr,crypto_box_BOXZEROBYTES:Ar,crypto_sign_BYTES:mt,crypto_sign_PUBLICKEYBYTES:Rt,crypto_sign_SECRETKEYBYTES:Pt,crypto_sign_SEEDBYTES:gn,crypto_hash_BYTES:xn,gf:n,D:h,L:Jt,pack25519:we,unpack25519:wt,M:be,A:He,S:Ze,Z:Xe,pow2523:Ht,add:it,set25519:Fe,modL:Ie,scalarmult:te,scalarbase:Ne};function qn(o,u){if(o.length!==mn)throw new Error("bad key size");if(u.length!==rn)throw new Error("bad nonce size")}function Er(o,u){if(o.length!==Gt)throw new Error("bad public key size");if(u.length!==Vt)throw new Error("bad secret key size")}function rt(){for(var o=0;o<arguments.length;o++)if(!(arguments[o]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Yn(o){for(var u=0;u<o.length;u++)o[u]=0}e.randomBytes=function(o){var u=new Uint8Array(o);return r(u,o),u},e.secretbox=function(o,u,a){rt(o,u,a),qn(a,u);for(var i=new Uint8Array(Wt+o.length),_=new Uint8Array(i.length),g=0;g<o.length;g++)i[g+Wt]=o[g];return Ae(_,i,i.length,u,a),_.subarray($t)},e.secretbox.open=function(o,u,a){rt(o,u,a),qn(a,u);for(var i=new Uint8Array($t+o.length),_=new Uint8Array(i.length),g=0;g<o.length;g++)i[g+$t]=o[g];return i.length<32||We(_,i,i.length,u,a)!==0?null:_.subarray(Wt)},e.secretbox.keyLength=mn,e.secretbox.nonceLength=rn,e.secretbox.overheadLength=$t,e.scalarMult=function(o,u){if(rt(o,u),o.length!==fn)throw new Error("bad n size");if(u.length!==Zt)throw new Error("bad p size");var a=new Uint8Array(Zt);return bt(a,o,u),a},e.scalarMult.base=function(o){if(rt(o),o.length!==fn)throw new Error("bad n size");var u=new Uint8Array(Zt);return Nt(u,o),u},e.scalarMult.scalarLength=fn,e.scalarMult.groupElementLength=Zt,e.box=function(o,u,a,i){var _=e.box.before(a,i);return e.secretbox(o,u,_)},e.box.before=function(o,u){rt(o,u),Er(o,u);var a=new Uint8Array(yn);return kt(a,o,u),a},e.box.after=e.secretbox,e.box.open=function(o,u,a,i){var _=e.box.before(a,i);return e.secretbox.open(o,u,_)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var o=new Uint8Array(Gt),u=new Uint8Array(Vt);return Ut(o,u),{publicKey:o,secretKey:u}},e.box.keyPair.fromSecretKey=function(o){if(rt(o),o.length!==Vt)throw new Error("bad secret key size");var u=new Uint8Array(Gt);return Nt(u,o),{publicKey:u,secretKey:new Uint8Array(o)}},e.box.publicKeyLength=Gt,e.box.secretKeyLength=Vt,e.box.sharedKeyLength=yn,e.box.nonceLength=zn,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(o,u){if(rt(o,u),u.length!==Pt)throw new Error("bad secret key size");var a=new Uint8Array(mt+o.length);return hn(a,o,o.length,u),a},e.sign.open=function(o,u){if(rt(o,u),u.length!==Rt)throw new Error("bad public key size");var a=new Uint8Array(o.length),i=nn(a,o,o.length,u);if(i<0)return null;for(var _=new Uint8Array(i),g=0;g<_.length;g++)_[g]=a[g];return _},e.sign.detached=function(o,u){for(var a=e.sign(o,u),i=new Uint8Array(mt),_=0;_<i.length;_++)i[_]=a[_];return i},e.sign.detached.verify=function(o,u,a){if(rt(o,u,a),u.length!==mt)throw new Error("bad signature size");if(a.length!==Rt)throw new Error("bad public key size");var i=new Uint8Array(mt+o.length),_=new Uint8Array(mt+o.length),g;for(g=0;g<mt;g++)i[g]=u[g];for(g=0;g<o.length;g++)i[g+mt]=o[g];return nn(_,i,i.length,a)>=0},e.sign.keyPair=function(){var o=new Uint8Array(Rt),u=new Uint8Array(Pt);return Bt(o,u),{publicKey:o,secretKey:u}},e.sign.keyPair.fromSecretKey=function(o){if(rt(o),o.length!==Pt)throw new Error("bad secret key size");for(var u=new Uint8Array(Rt),a=0;a<u.length;a++)u[a]=o[32+a];return{publicKey:u,secretKey:new Uint8Array(o)}},e.sign.keyPair.fromSeed=function(o){if(rt(o),o.length!==gn)throw new Error("bad seed size");for(var u=new Uint8Array(Rt),a=new Uint8Array(Pt),i=0;i<32;i++)a[i]=o[i];return Bt(u,a,!0),{publicKey:u,secretKey:a}},e.sign.publicKeyLength=Rt,e.sign.secretKeyLength=Pt,e.sign.seedLength=gn,e.sign.signatureLength=mt,e.hash=function(o){rt(o);var u=new Uint8Array(xn);return nt(u,o,o.length),u},e.hash.hashLength=xn,e.verify=function(o,u){return rt(o,u),o.length===0||u.length===0||o.length!==u.length?!1:E(o,0,u,0,o.length)===0},e.setPRNG=function(o){r=o},function(){var o=typeof self<"u"?self.crypto||self.msCrypto:null;if(o&&o.getRandomValues){var u=65536;e.setPRNG(function(a,i){var _,g=new Uint8Array(i);for(_=0;_<i;_+=u)o.getRandomValues(g.subarray(_,_+Math.min(i-_,u)));for(_=0;_<i;_++)a[_]=g[_];Yn(g)})}else typeof ds<"u"&&(o=Ml,o&&o.randomBytes&&e.setPRNG(function(a,i){var _,g=o.randomBytes(i);for(_=0;_<i;_++)a[_]=g[_];Yn(g)}))}()})(t.exports?t.exports:self.nacl=self.nacl||{})}),Bn=us(function(t){(function(e,n){t.exports?t.exports=n():(e.nacl||(e.nacl={}),e.nacl.util=n())})(Dl,function(){var e={};function n(r){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(r))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(r){if(typeof r!="string")throw new TypeError("expected string");var f,s=unescape(encodeURIComponent(r)),l=new Uint8Array(s.length);for(f=0;f<s.length;f++)l[f]=s.charCodeAt(f);return l},e.encodeUTF8=function(r){var f,s=[];for(f=0;f<r.length;f++)s.push(String.fromCharCode(r[f]));return decodeURIComponent(escape(s.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(r){return Buffer.from(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(Buffer.from(r,"base64"),0))}):(e.encodeBase64=function(r){return new Buffer(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(new Buffer(r,"base64"),0))}):(e.encodeBase64=function(r){var f,s=[],l=r.length;for(f=0;f<l;f++)s.push(String.fromCharCode(r[f]));return btoa(s.join(""))},e.decodeBase64=function(r){n(r);var f,s=atob(r),l=new Uint8Array(s.length);for(f=0;f<s.length;f++)l[f]=s.charCodeAt(f);return l}),e})});function Ul(t){return t!=null&&t.constructor==Object}function Ll(t,e){const n=new Uint8Array(t.length+1),r=new Uint8Array(1);return r[0]=e,n.set(r),n.set(t,r.length),n}function jl(){}class Tr{constructor(e,n,r){this.prev=e,this.next=n,this.fn=r||jl}run(e){this.fn(e),this.next&&this.next.run(e)}}class Bl{constructor(e){this.head=new Tr,this.tail=new Tr(this.head),this.head.next=this.tail,this.linkConstructor=e,this.reg={}}insert(e){const n=new Tr(this.tail.prev,this.tail,e);return n.next.prev=n,n.prev.next=n,n}remove(e){e.prev.next=e.next,e.next.prev=e.prev}}let Kl=0;class ri{constructor(){this.__events_list={}}on(e,n){const r=this.__events_list[e]||(this.__events_list[e]=new Bl),f=n._eev||(n._eev=++Kl);r.reg[f]||(r.reg[f]=r.insert(n))}off(e,n){if(n){const r=this.__events_list[e];if(!r)return;const f=r.reg[n._eev];r.reg[n._eev]=void 0,r&&f&&r.remove(f)}}removeListener(...e){this.off(...e)}emit(e,n){const r=this.__events_list[e];r&&r.head.run(n)}}function zl(t){return typeof t>"u"||t==null?[]:Array.isArray(t)?t:[t]}function ar(t){return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}function Kr(t){const e=t.match(/.{1,2}(?=(.{2})+(?!.))|.{1,2}$/g);return new Uint8Array(e.map(n=>parseInt(n,16)))}function hs(t,e=8){const n=new Array(e).fill(0);for(let r=0;r<n.length;r++){const f=t&255;n[r]=f,t=(t-f)/256}return n}var ql=En;/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 * @license MIT (© Joyent)
 */function En(t,e){var n={seen:[],stylize:Yl};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),_s(e)?n.showHidden=e:e&&Vl(n,e),Pn(n.showHidden)&&(n.showHidden=!1),Pn(n.depth)&&(n.depth=2),Pn(n.colors)&&(n.colors=!1),Pn(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Fl),ur(n,t,n.depth)}En.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};En.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Yl(t,e){return t}function _s(t){return typeof t=="boolean"}function Pn(t){return t===void 0}function Fl(t,e){var n=En.styles[e];return n?"\x1B["+En.colors[n][0]+"m"+t+"\x1B["+En.colors[n][1]+"m":t}function Cr(t){return typeof t=="function"}function ps(t){return typeof t=="string"}function Hl(t){return typeof t=="number"}function bs(t){return t===null}function vs(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function kr(t){return yr(t)&&ii(t)==="[object RegExp]"}function yr(t){return typeof t=="object"&&t!==null}function Rr(t){return yr(t)&&(ii(t)==="[object Error]"||t instanceof Error)}function sf(t){return yr(t)&&ii(t)==="[object Date]"}function ii(t){return Object.prototype.toString.call(t)}function Jl(t){var e={};return t.forEach(function(n,r){e[n]=!0}),e}function Wl(t,e,n,r,f){for(var s=[],l=0,c=e.length;l<c;++l)vs(e,String(l))?s.push(zr(t,e,n,r,String(l),!0)):s.push("");return f.forEach(function(d){d.match(/^\d+$/)||s.push(zr(t,e,n,r,d,!0))}),s}function Nr(t){return"["+Error.prototype.toString.call(t)+"]"}function ur(t,e,n){if(t.customInspect&&e&&Cr(e.inspect)&&e.inspect!==En&&!(e.constructor&&e.constructor.prototype===e)){var r=e.inspect(n,t);return ps(r)||(r=ur(t,r,n)),r}var f=Zl(t,e);if(f)return f;var s=Object.keys(e),l=Jl(s);try{t.showHidden&&Object.getOwnPropertyNames&&(s=Object.getOwnPropertyNames(e))}catch{}if(Rr(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return Nr(e);if(s.length===0){if(Cr(e)){var c=e.name?": "+e.name:"";return t.stylize("[Function"+c+"]","special")}if(kr(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(sf(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Rr(e))return Nr(e)}var d="",h=!1,p=["{","}"];if(Array.isArray(e)&&(h=!0,p=["[","]"]),Cr(e)){var b=e.name?": "+e.name:"";d=" [Function"+b+"]"}if(kr(e)&&(d=" "+RegExp.prototype.toString.call(e)),sf(e)&&(d=" "+Date.prototype.toUTCString.call(e)),Rr(e)&&(d=" "+Nr(e)),s.length===0&&(!h||e.length==0))return p[0]+d+p[1];if(n<0)return kr(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var m;return h?m=Wl(t,e,n,l,s):m=s.map(function(y){return zr(t,e,n,l,y,h)}),t.seen.pop(),Gl(m,d,p)}function zr(t,e,n,r,f,s){var l,c,d;d={value:void 0};try{d.value=e[f]}catch{}try{Object.getOwnPropertyDescriptor&&(d=Object.getOwnPropertyDescriptor(e,f)||d)}catch{}if(d.get?d.set?c=t.stylize("[Getter/Setter]","special"):c=t.stylize("[Getter]","special"):d.set&&(c=t.stylize("[Setter]","special")),vs(r,f)||(l="["+f+"]"),c||(t.seen.indexOf(d.value)<0?(bs(n)?c=ur(t,d.value,null):c=ur(t,d.value,n-1),c.indexOf(`
`)>-1&&(s?c=c.split(`
`).map(function(h){return"  "+h}).join(`
`).substr(2):c=`
`+c.split(`
`).map(function(h){return"   "+h}).join(`
`))):c=t.stylize("[Circular]","special")),Pn(l)){if(s&&f.match(/^\d+$/))return c;l=JSON.stringify(""+f),l.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(l=l.substr(1,l.length-2),l=t.stylize(l,"name")):(l=l.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),l=t.stylize(l,"string"))}return l+": "+c}function Zl(t,e){if(Pn(e))return t.stylize("undefined","undefined");if(ps(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(Hl(e))return t.stylize(""+e,"number");if(_s(e))return t.stylize(""+e,"boolean");if(bs(e))return t.stylize("null","null")}function Gl(t,e,n){var r=t.reduce(function(f,s){return s.indexOf(`
`)>=0,f+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function Vl(t,e){if(!e||!yr(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}function sn(t,e,...n){try{e==console.log?e(`${new Date().toLocaleString()} \u2192 ${ql(...n).replace(/^'/,"").replace(/'$/,"")}`):typeof e=="function"?e(...n):e&&e.logOutput(t,{source:"connectome"},...n)}catch(r){console.log(r)}}class Ql{write(e,...n){sn(void 0,e,...n)}red(e,...n){sn("red",e,...n)}green(e,...n){sn("green",e,...n)}yellow(e,...n){sn("yellow",e,...n)}blue(e,...n){sn("blue",e,...n)}cyan(e,...n){sn("cyan",e,...n)}magenta(e,...n){sn("magenta",e,...n)}gray(e,...n){sn("gray",e,...n)}white(e,...n){sn("white",e,...n)}}var et=new Ql;zt.util=Bn;function Xl({data:t,connector:e}){const{log:n}=e;Ul(t)&&(t=JSON.stringify(t));const r=new Uint8Array(hs(2*e.sentCount,24));if(e.closed())et.red(n,`\u26A0\uFE0F Warning: "${t}" was not sent because connector is not ready`);else if(e.sentCount>1){let f=0;typeof t=="string"&&(f=1);const s=f==1?zt.util.decodeUTF8(t):t,l=Ll(s,f),c=zt.secretbox(l,r,e.sharedSecret);e.verbose&&(et.green(n,`Connector ${e.endpoint} \u2192 Sending encrypted message #${e.sentCount} \u21B4`),et.gray(n,t)),e.connection.websocket.send(c)}else e.verbose&&(et.green(n,`Connector ${e.endpoint} \u2192 Sending message #${e.sentCount} \u21B4`),et.gray(n,t)),e.connection.websocket.send(t)}zt.util=Bn;function ec(t){return Object.keys(t).includes("result")||Object.keys(t).includes("error")}function ms({jsonData:t,encryptedData:e,rawMessage:n,wasEncrypted:r,connector:f}){const{log:s}=f;f.lastMessageAt=Date.now();const l=new Uint8Array(hs(2*f.receivedCount+1,24));if(f.verbose&&!r&&et.magenta(s,`Connector ${f.endpoint} \u2192 Received message #${f.receivedCount} \u21B4`),t)t.jsonrpc?ec(t)?(f.verbose&&!r&&(et.magenta(s,`Connector ${f.endpoint} received plain-text rpc result \u21B4`),et.gray(s,t)),f.rpcClient.jsonrpcMsgReceive(n)):f.emit("json_rpc",n):f.emit("receive",{jsonData:t,rawMessage:n});else if(e){f.verbose=="extra"&&(et.magenta(s,`Connector ${f.endpoint} received bytes \u21B4`),et.gray(s,e),et.magenta(s,`Connector ${f.endpoint} decrypting with shared secret ${f.sharedSecret}...`));const c=zt.secretbox.open(e,l,f.sharedSecret),d=c[0],h=c.subarray(1);if(d==1){const p=zt.util.encodeUTF8(h);f.verbose&&et.write(s,`Received message: ${p}`);try{const b=JSON.parse(p);b.jsonrpc?ms({jsonData:b,rawMessage:p,wasEncrypted:!0,connector:f}):b.state?f.emit("receive_state",b.state):b.diff?f.emit("receive_diff",b.diff):b.signal?f.emit(b.signal,b.data):b.stateField?f.emit("receive_state_field",b.stateField):f.emit("receive",{jsonData:b,rawMessage:p})}catch(b){throw et.red(s,"Couldn't parse json message although the flag was for string ..."),et.red(s,p),b}}else f.emit("receive_binary",h)}}zt.util=Bn;function tc({connector:t,afterFirstStep:e=()=>{}}){const{clientPrivateKey:n,clientPublicKey:r,clientPublicKeyHex:f,protocol:s,tag:l,endpoint:c,verbose:d}=t;return new Promise((h,p)=>{t.remoteObject("Auth").call("exchangePubkeys",{pubkey:f}).then(b=>{const m=zt.box.before(Kr(b),n);e({sharedSecret:m,remotePubkeyHex:b}),d&&et.write(t.log,`Connector ${c} established shared secret through diffie-hellman exchange.`),t.remoteObject("Auth").call("finalizeHandshake",{protocol:s}).then(y=>{if(y&&y.error)console.log(y.error);else{h();const S=l?` (${l})`:"";et.cyan(t.log,`${c}${S} \u2713 Connection [ ${s||'"no-name"'} ] ready`)}}).catch(p)}).catch(p)})}class nc extends ri{constructor(e){super(),this.state=e,this.subscriptions=[]}get(){return this.state}subscribe(e){return this.subscriptions.push(e),e(this.state),()=>{this.subscriptions=this.subscriptions.filter(n=>n!==e)}}announceStateChange(){this.subscriptions.forEach(e=>e(this.state))}}class dr extends nc{set(e){this.state=e,this.announceStateChange()}}class rc extends ri{constructor(e){super(),this.connector=e}send(...e){this.connector.send(...e)}}var qt={PARSE_ERROR:-32700,INVALID_REQUEST:-32600,METHOD_NOT_FOUND:-32601,INVALID_PARAMS:-32602,REMOTE_INTERNAL_ERROR:-32603,TIMEOUT:-32701};class ys{constructor({transports:e}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transportsToRegister=e,this.methods={}}setMethodPrefix(e){this.methodPrefix=e}expose(e){this.methods=e}registerTransport(e){e.onData(this._processRequest.bind(this,e))}async _processRequest(e,n){const r=JSON.parse(n);let f;return Array.isArray(r)?f=await Promise.all(r.map(s=>this._callMethod(s,e))):f=await this._callMethod(r,e),JSON.stringify(f)}async _callMethod(e,n){if(!e.hasOwnProperty("method"))return;const{method:f,params:s=[],id:l}=e;let c=f;if(c.includes("::")){const[p,b]=c.split("::");if(c=b,this.methodPrefix&&p!=this.methodPrefix)return}const d=!this.methods[c]||typeof this.methods[c]!="function"||c==="constructor"||c.startsWith("_")||this.methods[c]===Object.prototype[c];let h={};if(d)h={jsonrpc:"2.0",id:l,error:{code:qt.METHOD_NOT_FOUND,message:`Method [${c}] not found on remote target object`}};else{this.currentTransport=n;try{const p=await this.methods[c].apply(this.methods,s);if(!l)return;h={jsonrpc:"2.0",result:typeof p>"u"?null:p,id:l}}catch(p){console.log(`Exposed RPC method ${f} internal error:`),console.log(p),console.log("Sending this error as a result to calling client ..."),h={jsonrpc:"2.0",error:{code:qt.REMOTE_INTERNAL_ERROR,message:`Method [${f}] internal error: ${p.stack}`},id:l}}}return h}run(){for(const e of this.transportsToRegister)this.registerTransport(e);this.transportsToRegister=[]}}class kn extends Error{constructor(e={}){if(super(),!e.code)throw new Error("Code required");if(!e.message)throw new Error("Message required");this.code=e.code,this.message=e.message}}class ic extends kn{constructor(e){super({code:qt.METHOD_NOT_FOUND,message:e||"Method not found"})}}class fc extends kn{constructor(){super({code:qt.INVALID_PARAMS,message:"Invalid params"})}}class sc extends kn{constructor(e){super({code:qt.REMOTE_INTERNAL_ERROR,message:`Error originating at remote endpoint: ${e}`||"Remote Internal error"})}}class oc extends kn{constructor(){super({code:qt.PARSE_ERROR,message:"Parse error"})}}class lc extends kn{constructor(){super({code:qt.INVALID_REQUEST,message:"Invalid request"})}}class gs extends kn{}class cc extends gs{constructor(e,n){super({code:qt.TIMEOUT,message:`Request exceeded maximum execution time (${n}ms): ${e}`})}}var Dr={Base:kn,MethodNotFound:ic,InvalidRequest:lc,InvalidParams:fc,RemoteInternalError:sc,ServerError:gs,ParseError:oc,RequestTimeout:cc};class xs{constructor({transport:e,requestTimeout:n=2e4}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transport=e,this.requestTimeout=n,this.pendingRequest={},this.initialized=!1}setMethodPrefix(e){this.methodPrefix=e}async callMethod(e,n){this._init();const r=this.methodPrefix?`${this.methodPrefix}::${e}`:e,f=this._makeRequestObject({method:r,params:n});return this._sendRequest({object:f,id:f.id})}notify(e,n){this._init();const r=this._makeRequestObject({method:e,params:n,mode:"notify"});return this.transport.sendData(JSON.stringify(r)),!0}async runBatch(e){const n=this._generateId();let r=!0;const f=[];for(const[s,l,c]of e){const d=this._makeRequestObject({method:s,params:l,mode:c,batchId:n});d.id&&(r=!1),f.push(d)}return r?this.transport.sendData(JSON.stringify(f)):this._sendRequest({object:f,id:n})}_init(){this.initialized||(this.transport.onData(this._processResponse.bind(this)),this.initialized=!0)}_sendRequest({object:e,id:n}){const r=JSON.stringify(e);return new Promise((f,s)=>{this.pendingRequest[n]={resolve:f,reject:s,sentObject:e},setTimeout(()=>{this.pendingRequest[n]&&(delete this.pendingRequest[n],s(new Dr.RequestTimeout(r,this.requestTimeout)))},this.requestTimeout);try{this.transport.sendData(r)}catch(l){delete this.pendingRequest[n],s(l)}})}_processResponse(e){const n=JSON.parse(e);Array.isArray(n)?this._processBatchResponse(n):this._processSingleCallResponse(n)}_processSingleCallResponse(e){const n=e.hasOwnProperty("result")||!1,r=e.hasOwnProperty("error");if(!n&&!r)return;const f=this.pendingRequest[e.id];if(delete this.pendingRequest[e.id],!!f){if(n)f.resolve(e.result);else if(r){const s=this._makeErrorObject(e.error);f.reject(s)}}}_processBatchResponse(e){let n;const r={},f=[];for(const h of e)h.id?(n||(n=h.id.split("|")[0]),r[h.id]=h):h.error&&f.push(h.error);if(!this.pendingRequest[n])return;const{sentObject:s,resolve:l}=this.pendingRequest[n];delete this.pendingRequest[n];const c=[];let d=0;for(const h of s){if(!h.id){c.push(null);continue}const p=r[h.id];p?p.hasOwnProperty("result")||!1?c.push({success:!0,result:p.result}):c.push({success:!1,result:this._makeErrorObject(p.error)}):(c.push({success:!1,error:this._makeErrorObject(f[d])}),d++)}l(c)}_makeRequestObject({method:e,params:n,mode:r,batchId:f}){const s={jsonrpc:"2.0",method:e};return n&&n.length&&(s.params=n),r!=="notify"&&(s.id=f?`${f}|${this._generateId()}`:this._generateId()),s}_makeErrorObject(e){const n={[qt.METHOD_NOT_FOUND]:()=>new Dr.MethodNotFound(e.message),[qt.REMOTE_INTERNAL_ERROR]:()=>new Dr.RemoteInternalError(e.message)}[e.code];return n()}_generateId(){const e="bjectSymhasOwnProp-0123456789ABCDEFGHIJKLMNQRTUVWXYZ_dfgiklquvxz";let n=10,r="";for(;0<n--;)r+=e[Math.random()*64|0];return r}}function ac(t){const e=of(t.callMethod.bind(t)),n=of(t.notify.bind(t));return new Proxy(t,{get(r,f){if(f==="notify")return n;if(f==="callMethod")return e;if(f!=="then")return f==="setMethodPrefix"?(...s)=>t.setMethodPrefix(s):(...s)=>r.callMethod.call(r,f,s)}})}function of(t){return new Proxy(t,{get(e,n){return(...r)=>e.call(null,n,r)},apply(e,n,r){return e.apply(null,r)}})}class uc extends xs{constructor(...e){return super(...e),ac(this)}}class dc{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",e)}sendData(e){this.channel.send(e)}}class ws{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",async n=>{const r=await e(n);!r||this.channel.send(r)})}}var hc=Object.freeze({__proto__:null,MoleServer:ys,MoleClient:xs,MoleClientProxified:uc,ClientTransport:dc,ServerTransport:ws});class _c extends Error{constructor(e,n){super(e),this.name=this.constructor.name,this.errorCode=n}errorCode(){return this.errorCode}}const{MoleClient:pc,ClientTransport:bc}=hc;class vc{constructor(e,n,r){this.moleChannel=new rc(e),this.methodPrefix=n,this.connectorOrServersideChannel=e,this.client=new pc({requestTimeout:r,transport:new bc(this.moleChannel)})}jsonrpcMsgReceive(e){this.moleChannel.emit("json_rpc",e)}call(e,n){return this.connectorOrServersideChannel.closed()?new Promise((r,f)=>{f(new _c(`Method call [${this.methodPrefix}::${e}] on closed channel or connector ignored. Please add a check for closed channel in your code.`,"CLOSED_CHANNEL"))}):this.client.callMethod(`${this.methodPrefix}::${e}`,n)}}const mc=1e4;class yc{constructor(e,n){this.connectorOrServersideChannel=e,this.remoteObjects={},this.requestTimeout=n||mc}remoteObject(e){return this.remoteObjects[e]||(this.remoteObjects[e]=new vc(this.connectorOrServersideChannel,e,this.requestTimeout)),this.remoteObjects[e]}jsonrpcMsgReceive(e){for(const n of Object.values(this.remoteObjects))n.jsonrpcMsgReceive(e)}}class gc{constructor({serversideChannel:e,serverMethods:n,methodPrefix:r}){const f=[new ws(e)];this.server=new ys({transports:f}),this.server.expose(n),this.server.setMethodPrefix(r),this.server.run()}}zt.util=Bn;function xc(){const t=zt.box.keyPair(),e=ar(t.publicKey),n=ar(t.secretKey);return{privateKey:t.secretKey,publicKey:t.publicKey,privateKeyHex:n,publicKeyHex:e}}zt.util=Bn;function wc(t){return t.publicKeyHex&&!t.publicKey&&(t.publicKey=Kr(t.publicKeyHex)),t.privateKeyHex&&!t.privateKey&&(t.privateKey=Kr(t.privateKeyHex)),t}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var Ac=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,f){r.__proto__=f}||function(r,f){for(var s in f)f.hasOwnProperty(s)&&(r[s]=f[s])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ec=Object.prototype.hasOwnProperty;function qr(t,e){return Ec.call(t,e)}function Yr(t){if(Array.isArray(t)){for(var n=new Array(t.length),e=0;e<n.length;e++)n[e]=""+e;return n}if(Object.keys)return Object.keys(t);var n=[];for(var r in t)qr(t,r)&&n.push(r);return n}function It(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function Fr(t){for(var e=0,n=t.length,r;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function wn(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function As(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function Hr(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(Hr(t[e]))return!0}else if(typeof t=="object"){for(var r=Yr(t),f=r.length,e=0;e<f;e++)if(Hr(t[r[e]]))return!0}}return!1}function lf(t,e){var n=[t];for(var r in e){var f=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof f<"u"&&n.push(r+": "+f)}return n.join(`
`)}var Es=function(t){Ac(e,t);function e(n,r,f,s,l){var c=this.constructor,d=t.call(this,lf(n,{name:r,index:f,operation:s,tree:l}))||this;return d.name=r,d.index=f,d.operation=s,d.tree=l,Object.setPrototypeOf(d,c.prototype),d.message=lf(n,{name:r,index:f,operation:s,tree:l}),d}return e}(Error),_t=Es,Sc=It,In={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=hr(n,this.path);r&&(r=It(r));var f=Sn(n,{op:"remove",path:this.from}).removed;return Sn(n,{op:"add",path:this.path,value:f}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=hr(n,this.from);return Sn(n,{op:"add",path:this.path,value:It(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:Gn(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},Oc={add:function(t,e,n){return Fr(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:In.move,copy:In.copy,test:In.test,_get:In._get};function hr(t,e){if(e=="")return t;var n={op:"_get",path:e};return Sn(t,n),n.value}function Sn(t,e,n,r,f,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),f===void 0&&(f=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):_r(e,0)),e.path===""){var l={newDocument:t};if(e.op==="add")return l.newDocument=e.value,l;if(e.op==="replace")return l.newDocument=e.value,l.removed=t,l;if(e.op==="move"||e.op==="copy")return l.newDocument=hr(t,e.from),e.op==="move"&&(l.removed=t),l;if(e.op==="test"){if(l.test=Gn(t,e.value),l.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l.newDocument=t,l}else{if(e.op==="remove")return l.removed=t,l.newDocument=null,l;if(e.op==="_get")return e.value=t,l;if(n)throw new _t("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return l}}else{r||(t=It(t));var c=e.path||"",d=c.split("/"),h=t,p=1,b=d.length,m=void 0,y=void 0,S=void 0;for(typeof n=="function"?S=n:S=_r;;){if(y=d[p],f&&y=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&m===void 0&&(h[y]===void 0?m=d.slice(0,p).join("/"):p==b-1&&(m=e.path),m!==void 0&&S(e,0,t,m)),p++,Array.isArray(h)){if(y==="-")y=h.length;else{if(n&&!Fr(y))throw new _t("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);Fr(y)&&(y=~~y)}if(p>=b){if(n&&e.op==="add"&&y>h.length)throw new _t("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var l=Oc[e.op].call(e,h,y,t);if(l.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}}else if(y&&y.indexOf("~")!=-1&&(y=As(y)),p>=b){var l=In[e.op].call(e,h,y,t);if(l.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}h=h[y]}}}function fi(t,e,n,r,f){if(r===void 0&&(r=!0),f===void 0&&(f=!0),n&&!Array.isArray(e))throw new _t("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=It(t));for(var s=new Array(e.length),l=0,c=e.length;l<c;l++)s[l]=Sn(t,e[l],n,!0,f,l),t=s[l].newDocument;return s.newDocument=t,s}function Tc(t,e,n){var r=Sn(t,e);if(r.test===!1)throw new _t("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function _r(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new _t("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(In[t.op]){if(typeof t.path!="string")throw new _t("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new _t('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new _t("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new _t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&Hr(t.value))throw new _t("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var f=t.path.split("/").length,s=r.split("/").length;if(f!==s+1&&f!==s)throw new _t("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new _t("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var l={op:"_get",path:t.from,value:void 0},c=Ss([l],n);if(c&&c.name==="OPERATION_PATH_UNRESOLVABLE")throw new _t("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new _t("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function Ss(t,e,n){try{if(!Array.isArray(t))throw new _t("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)fi(It(e),It(t),n||!0);else{n=n||_r;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(f){if(f instanceof _t)return f;throw f}}function Gn(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),f,s,l;if(n&&r){if(s=t.length,s!=e.length)return!1;for(f=s;f--!==0;)if(!Gn(t[f],e[f]))return!1;return!0}if(n!=r)return!1;var c=Object.keys(t);if(s=c.length,s!==Object.keys(e).length)return!1;for(f=s;f--!==0;)if(!e.hasOwnProperty(c[f]))return!1;for(f=s;f--!==0;)if(l=c[f],!Gn(t[l],e[l]))return!1;return!0}return t!==t&&e!==e}var Cc=Object.freeze({__proto__:null,JsonPatchError:_t,deepClone:Sc,getValueByPointer:hr,applyOperation:Sn,applyPatch:fi,applyReducer:Tc,validator:_r,validate:Ss,_areEquals:Gn});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var si=new WeakMap,kc=function(){function t(e){this.observers=new Map,this.obj=e}return t}(),Rc=function(){function t(e,n){this.callback=e,this.observer=n}return t}();function Nc(t){return si.get(t)}function Dc(t,e){return t.observers.get(e)}function $c(t,e){t.observers.delete(e.callback)}function Pc(t,e){e.unobserve()}function Ic(t,e){var n=[],r,f=Nc(t);if(!f)f=new kc(t),si.set(t,f);else{var s=Dc(f,e);r=s&&s.observer}if(r)return r;if(r={},f.value=It(t),e){r.callback=e,r.next=null;var l=function(){Jr(r)},c=function(){clearTimeout(r.next),r.next=setTimeout(l)};typeof window<"u"&&(window.addEventListener("mouseup",c),window.addEventListener("keyup",c),window.addEventListener("mousedown",c),window.addEventListener("keydown",c),window.addEventListener("change",c))}return r.patches=n,r.object=t,r.unobserve=function(){Jr(r),clearTimeout(r.next),$c(f,r),typeof window<"u"&&(window.removeEventListener("mouseup",c),window.removeEventListener("keyup",c),window.removeEventListener("mousedown",c),window.removeEventListener("keydown",c),window.removeEventListener("change",c))},f.observers.set(e,new Rc(e,r)),r}function Jr(t,e){e===void 0&&(e=!1);var n=si.get(t.object);oi(n.value,t.object,t.patches,"",e),t.patches.length&&fi(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function oi(t,e,n,r,f){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=Yr(e),l=Yr(t),c=!1,d=l.length-1;d>=0;d--){var h=l[d],p=t[h];if(qr(e,h)&&!(e[h]===void 0&&p!==void 0&&Array.isArray(e)===!1)){var b=e[h];typeof p=="object"&&p!=null&&typeof b=="object"&&b!=null?oi(p,b,n,r+"/"+wn(h),f):p!==b&&(f&&n.push({op:"test",path:r+"/"+wn(h),value:It(p)}),n.push({op:"replace",path:r+"/"+wn(h),value:It(b)}))}else Array.isArray(t)===Array.isArray(e)?(f&&n.push({op:"test",path:r+"/"+wn(h),value:It(p)}),n.push({op:"remove",path:r+"/"+wn(h)}),c=!0):(f&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!c&&s.length==l.length))for(var d=0;d<s.length;d++){var h=s[d];!qr(t,h)&&e[h]!==void 0&&n.push({op:"add",path:r+"/"+wn(h),value:It(e[h])})}}}function Mc(t,e,n){n===void 0&&(n=!1);var r=[];return oi(t,e,r,"",n),r}var Uc=Object.freeze({__proto__:null,unobserve:Pc,observe:Ic,generate:Jr,compare:Mc}),Lc=Object.assign({},Cc,Uc,{JsonPatchError:Es,deepClone:It,escapePathComponent:wn,unescapePathComponent:As});const{applyPatch:jc}=Lc;class Bc extends dr{constructor(e){super({}),this.connector=e,this.connector.on("receive_state",n=>{this.wireStateReceived=!0,this.set(n)}),this.connector.on("receive_diff",n=>{this.wireStateReceived&&(jc(this.state,n),this.announceStateChange())})}field(e){return this.connector.connectionState.get(e)}}class Kc extends dr{constructor(e){super({}),this.fields={},this.connector=e,this.connector.on("receive_state_field",({name:n,state:r})=>{this.get(n).set(r)})}get(e){return this.fields[e]||(this.fields[e]=new dr),this.fields[e]}}zt.util=Bn;const zc=700,qc=6e4,Yc=1;class Fc extends ri{constructor({endpoint:e,protocol:n,keypair:r=xc(),rpcRequestTimeout:f,verbose:s=!1,tag:l,log:c=console.log,autoDecommission:d=!1,dummy:h}={}){super(),this.protocol=n,this.log=c;const{privateKey:p,publicKey:b}=wc(r);this.clientPrivateKey=p,this.clientPublicKey=b,this.clientPublicKeyHex=ar(b),this.rpcClient=new yc(this,f),this.endpoint=e,this.verbose=s,this.tag=l,this.autoDecommission=d,this.sentCount=0,this.receivedCount=0,this.successfulConnectsCount=0,h||(this.state=new Bc(this),this.connectionState=new Kc(this)),this.connected=new dr,this.delayedAdjustConnectionStatus(),s&&et.green(this.log,`Connector ${this.endpoint} created`),this.decommissionCheckCounter=0,this.lastPongReceivedAt=Date.now(),this.on("pong",()=>{this.lastPongReceivedAt=Date.now()})}delayedAdjustConnectionStatus(){setTimeout(()=>{this.connected.get()==null&&this.connected.set(!1)},zc)}send(e){Xl({data:e,connector:this}),this.sentCount+=1}signal(e,n){this.connected.get()?this.send({signal:e,data:n}):et.write(this.log,"Warning: trying to send signal over disconnected connector, this should be prevented by GUI")}userAction({action:e,scope:n,payload:r}){this.signal("__action",{action:e,scope:n,payload:r})}on(e,n){e=="ready"&&this.isReady()&&n(),super.on(e,n)}getSharedSecret(){return this.sharedSecret?ar(this.sharedSecret):void 0}wireReceive({jsonData:e,encryptedData:n,rawMessage:r}){ms({jsonData:e,encryptedData:n,rawMessage:r,connector:this}),this.receivedCount+=1}field(e){return this.connectionState.get(e)}isReady(){return this.ready}closed(){return!this.transportConnected}connectStatus(e){if(e){this.sentCount=0,this.receivedCount=0,this.transportConnected=!0,this.successfulConnectsCount+=1,this.verbose&&et.green(this.log,`\u2713 Connector ${this.endpoint} connected #${this.successfulConnectsCount}`);const n=this.connection.websocket.__id;tc({connector:this,afterFirstStep:({sharedSecret:f,remotePubkeyHex:s})=>{this.sharedSecret=f,this._remotePubkeyHex=s}}).then(()=>{this.connectedAt=Date.now(),this.connected.set(!0),this.ready=!0,this.emit("ready")}).catch(f=>{this.connection.websocket.__id==n&&this.connection.websocket.readyState==Yc&&f.code==qt.TIMEOUT&&(et.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] handshake error: "${f.message}"`),et.write(this.log,`${this.endpoint} Connector dropping stale websocket after handshake error`),this.connection.terminate()),f.code!=qt.TIMEOUT&&et.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] on:ready error: "${f.stack}" \u2014 (will not try to reconnect, fix the error and reload this gui)`)})}else{let n;this.transportConnected&&(n=!0),this.transportConnected==null&&et.write(this.log,`${this.endpoint} Connector was not able to connect at first try`),this.transportConnected=!1,this.ready=!1,this.sharedSecret=void 0,delete this.connectedAt,n&&(this.emit("disconnect"),e==null&&this.delayedAdjustConnectionStatus(),this.connected.set(e))}}checkForDecommission(){!this.autoDecommission||(this.decommissionCheckRequestedAt&&Date.now()-this.decommissionCheckRequestedAt>3e3&&(this.decommissionCheckCounter=0),this.decommissionCheckRequestedAt=Date.now(),this.decommissionCheckCounter+=1,this.decommissionCheckCounter>12&&Date.now()-this.lastPongReceivedAt>qc&&(et.write(this.log,`Decommissioning connector ${this.endpoint} (long inactive)`),this.decommission(),this.emit("decommission")))}decommission(){this.decommissioned=!0}remoteObject(e){return{call:(n,r=[])=>this.rpcClient.remoteObject(e).call(n,zl(r))}}attachObject(e,n){new gc({serversideChannel:this,serverMethods:n,methodPrefix:e})}clientPubkey(){return this.clientPublicKeyHex}remotePubkeyHex(){return this._remotePubkeyHex}remoteAddress(){return this.endpoint}}const cf=typeof window<"u";function Hc({endpoint:t,host:e,port:n}){if(cf&&t&&t.startsWith("/")&&(t=`${window.location.protocol.includes("s")?"wss":"ws"}://${window.location.host}${t}`),!t)if(cf){e=e||window.location.hostname;const r=window.location.protocol.includes("s")?"wss":"ws";t=`${r}://${e}`,r=="wss"?t=`${r}://${e}/ws`:n?t=`${t}:${n}`:window.location.port&&(t=`${t}:${window.location.port}`)}else{if(!n)throw new Error(`Connectome determineEndpoint: No websocket port provided for ${e}`);t=`ws://${e||"localhost"}:${n}`}return t}const ln=typeof window<"u",Jc=0,Wc=1,Zc=1e3,Gc=3,Vc=5;function Qc({endpoint:t,host:e,port:n,protocol:r,keypair:f,remotePubkey:s,rpcRequestTimeout:l,autoDecommission:c,log:d,verbose:h,tag:p,dummy:b},{WebSocket:m}){t=Hc({endpoint:t,host:e,port:n});const y=new Fc({endpoint:t,protocol:r,rpcRequestTimeout:l,keypair:f,verbose:h,tag:p,log:d,autoDecommission:c,dummy:b}),S=()=>{ea({connector:y,endpoint:t},{WebSocket:m,reconnect:S,log:d,verbose:h})};y.connection={terminate(){this.websocket._removeAllCallbacks(),this.websocket.close(),y.connectStatus(!1),S()},endpoint:t,checkTicker:0};const E=()=>{y.decommissioned||(Xc({connector:y,reconnect:S,log:d}),setTimeout(E,Zc))};return setTimeout(E,10),y}function Xc({connector:t,reconnect:e,log:n}){const r=t.connection;if(na(r)||t.decommissioned){t.decommissioned?(et.yellow(n,`${t.endpoint} Connection decommisioned, closing websocket ${r.websocket.__id}, will not retry again `),Os(t)):(t.emit("inactive_connection"),et.yellow(n,`${t.endpoint} \u2716 Terminated inactive connection`)),r.terminate();return}Ts(r)?r.websocket.send("ping"):(t.connected==null&&(et.write(n,`${t.endpoint} Setting connector status to FALSE because connector.connected is undefined`),t.connectStatus(!1)),e()),r.checkTicker+=1}function ea({connector:t,endpoint:e},{WebSocket:n,reconnect:r,log:f,verbose:s}){const l=t.connection;if(t.checkForDecommission(),t.decommissioned){Os(t);return}if(l.currentlyTryingWS&&l.currentlyTryingWS.readyState==Jc){if(l.currentlyTryingWS._waitForConnectCounter<Vc){l.currentlyTryingWS._waitForConnectCounter+=1;return}(s||ln)&&et.write(f,`${e} Reconnect timeout, creating new ws`),l.currentlyTryingWS._removeAllCallbacks(),l.currentlyTryingWS.close()}else(s||ln)&&et.write(f,`${e} Created new websocket`);const c=new n(e);c.__id=Math.random(),l.currentlyTryingWS=c,l.currentlyTryingWS._waitForConnectCounter=0,ln&&(c.binaryType="arraybuffer"),ln||c.on("error",()=>{});const d=()=>{t.decommissioned||((s||ln)&&et.write(f,`${e} Websocket open`),l.currentlyTryingWS=null,l.checkTicker=0,ta({ws:c,connector:t,openCallback:d,reconnect:r},{log:f,verbose:s}),l.websocket=c,t.connectStatus(!0))};c._removeAllCallbacks=()=>{c.removeEventListener("open",d)},ln?c.addEventListener("open",d):c.on("open",d)}function ta({ws:t,connector:e,openCallback:n,reconnect:r},{log:f,verbose:s}){const l=e.connection,c=p=>{const b=`${e.endpoint} Websocket error`;console.log(b),console.log(p)},d=()=>{if(et.write(f,`${e.endpoint} \u2716 Connection closed`),e.decommissioned){e.connectStatus(!1);return}e.connectStatus(void 0),r()},h=p=>{if(e.decommissioned)return;l.checkTicker=0;const b=ln?p.data:p;if(b=="pong"){e.emit("pong");return}let m;try{m=JSON.parse(b)}catch{}if(m)e.wireReceive({jsonData:m,rawMessage:b});else{const y=ln?new Uint8Array(b):b;e.wireReceive({encryptedData:y})}};t._removeAllCallbacks=()=>{t.removeEventListener("error",c),t.removeEventListener("close",d),t.removeEventListener("message",h),t.removeEventListener("open",n)},ln?(t.addEventListener("error",c),t.addEventListener("close",d),t.addEventListener("message",h)):(t.on("error",c),t.on("close",d),t.on("message",h))}function Os(t){const e=t.connection;e.currentlyTryingWS&&(e.currentlyTryingWS._removeAllCallbacks(),e.currentlyTryingWS.close(),e.currentlyTryingWS=null),e.ws&&(e.ws._removeAllCallbacks(),e.ws.close(),e.ws=null),t.connectStatus(!1)}function Ts(t){return t.websocket&&t.websocket.readyState==Wc}function na(t){return Ts(t)&&t.checkTicker>Gc}function ra(t){return t.log=t.log||console.log,Qc(t,{WebSocket})}function af(t,e,n){const r=t.slice();return r[60]=e[n],r}function ia(t){let e,n=(t[0].network||"")+"",r;return{c(){e=U("h3"),r=K(n),L(e,"class","svelte-xmpa81")},m(f,s){D(f,e,s),O(e,r)},p(f,s){s[0]&1&&n!==(n=(f[0].network||"")+"")&&Pe(r,n)},i:xe,o:xe,d(f){f&&N(e)}}}function fa(t){let e,n,r,f,s;function l(h,p){return h[10]==0?oa:sa}let c=l(t),d=c(t);return{c(){e=U("h3"),n=K(`Vhod
      `),r=U("span"),f=K(`\u2014 odpiranje
        `),d.c(),L(r,"class","svelte-xmpa81"),L(e,"class","countdown svelte-xmpa81")},m(h,p){D(h,e,p),O(e,n),O(e,r),O(r,f),d.m(r,null)},p(h,p){c===(c=l(h))&&d?d.p(h,p):(d.d(1),d=c(h),d&&(d.c(),d.m(r,null)))},i(h){s||Dt(()=>{s=un(r,is,{}),s.start()})},o:xe,d(h){h&&N(e),d.d()}}}function sa(t){let e,n,r;return{c(){e=K("\u010Dez "),n=K(t[10]),r=K("s")},m(f,s){D(f,e,s),D(f,n,s),D(f,r,s)},p(f,s){s[0]&1024&&Pe(n,f[10])},d(f){f&&N(e),f&&N(n),f&&N(r)}}}function oa(t){let e;return{c(){e=K("ZDAJ")},m(n,r){D(n,e,r)},p:xe,d(n){n&&N(e)}}}function uf(t){let e,n,r,f,s,l,c,d,h,p,b,m,y,S;return{c(){e=U("div"),n=U("button"),r=K("ODPRI ZDAJ"),s=J(),l=U("button"),c=K("Zakasnitev +10s"),h=J(),p=U("button"),b=K("Prekli\u010Di"),L(n,"class","open svelte-xmpa81"),n.disabled=f=!t[11]||t[10]==0,L(l,"class","delayed_open svelte-xmpa81"),l.disabled=d=!t[11]||t[10]==0,L(p,"class","cancel svelte-xmpa81"),p.disabled=m=!t[11]||t[10]==0,L(e,"class","entry_door_options svelte-xmpa81")},m(E,I){D(E,e,I),O(e,n),O(n,r),O(e,s),O(e,l),O(l,c),O(e,h),O(e,p),O(p,b),y||(S=[Re(n,"click",t[32]),Re(l,"click",t[33]),Re(p,"click",t[34])],y=!0)},p(E,I){I[0]&3072&&f!==(f=!E[11]||E[10]==0)&&(n.disabled=f),I[0]&3072&&d!==(d=!E[11]||E[10]==0)&&(l.disabled=d),I[0]&3072&&m!==(m=!E[11]||E[10]==0)&&(p.disabled=m)},d(E){E&&N(e),y=!1,gt(S)}}}function la(t){var jt;let e,n,r,f,s,l,c,d,h,p,b,m,y,S,E,I=t[5]&&((jt=t[1])==null?void 0:jt.find(t[29])),T,F,oe,j,q,W,Oe,pe,ye,$e,ft,Je,ct,Ae,We,Fe,ht,st,we,qe,Ct,wt,He,Xe,be,Ze,At,Ht,bt,Nt,Ut,kt,Xt;function dn(te,Ne){return te[3]?aa:ua}let en=dn(t),Et=en(t);function tn(te,Ne){return te[4]?da:ha}let Lt=tn(t),nt=Lt(t),it=I&&hf(t),ot=t[11]&&t[7]!=null&&mf(t);return{c(){e=U("h3"),e.textContent="Ograja \u2014 parkiri\u0161\u010De",n=J(),r=U("div"),f=U("button"),s=K("ODPRI"),c=J(),d=U("button"),h=K("OSEBNI PREHOD"),b=J(),Et.c(),m=J(),y=U("h3"),y.textContent="Dnevna TV",S=J(),nt.c(),E=J(),it&&it.c(),T=J(),F=U("h3"),F.textContent="Lu\u010D kabinet",oe=J(),j=U("button"),q=K("PRI\u017DGI LU\u010C"),Oe=J(),pe=U("button"),ye=K("\u{1F6D1} UGASNI"),ft=J(),Je=U("button"),ct=K("\u23F1\uFE0F"),We=J(),ot&&ot.c(),Fe=J(),ht=U("h3"),ht.textContent="Alarm",st=J(),we=U("button"),qe=K("VKLOPI"),wt=J(),He=U("button"),Xe=K("IZKLOPI"),Ze=J(),At=U("h3"),At.textContent="Dodatne mo\u017Enosti",Ht=J(),bt=U("button"),Nt=K("\u2014 ZAPRI VSE \u2014"),L(e,"class","svelte-xmpa81"),f.disabled=l=!t[11]||t[9]||t[8],L(f,"class","svelte-xmpa81"),L(d,"class","personal_entry svelte-xmpa81"),d.disabled=p=!t[11]||t[9],ce(d,"personal_entry_in_progress",t[8]),L(r,"class","parking_door_options svelte-xmpa81"),L(y,"class","svelte-xmpa81"),L(F,"class","svelte-xmpa81"),j.disabled=W=!t[11],L(j,"class","svelte-xmpa81"),L(pe,"class","turn_off svelte-xmpa81"),pe.disabled=$e=!t[11],Je.disabled=Ae=!t[11],L(Je,"class","svelte-xmpa81"),L(ht,"class","svelte-xmpa81"),we.disabled=Ct=!t[11],L(we,"class","svelte-xmpa81"),He.disabled=be=!t[11],L(He,"class","svelte-xmpa81"),L(At,"class","close_options svelte-xmpa81"),L(bt,"class","close_options svelte-xmpa81"),bt.disabled=Ut=!t[11]},m(te,Ne){D(te,e,Ne),D(te,n,Ne),D(te,r,Ne),O(r,f),O(f,s),O(r,c),O(r,d),O(d,h),O(r,b),Et.m(r,null),D(te,m,Ne),D(te,y,Ne),D(te,S,Ne),nt.m(te,Ne),D(te,E,Ne),it&&it.m(te,Ne),D(te,T,Ne),D(te,F,Ne),D(te,oe,Ne),D(te,j,Ne),O(j,q),D(te,Oe,Ne),D(te,pe,Ne),O(pe,ye),D(te,ft,Ne),D(te,Je,Ne),O(Je,ct),D(te,We,Ne),ot&&ot.m(te,Ne),D(te,Fe,Ne),D(te,ht,Ne),D(te,st,Ne),D(te,we,Ne),O(we,qe),D(te,wt,Ne),D(te,He,Ne),O(He,Xe),D(te,Ze,Ne),D(te,At,Ne),D(te,Ht,Ne),D(te,bt,Ne),O(bt,Nt),kt||(Xt=[Re(f,"click",t[36]),Re(d,"click",t[37]),Re(j,"click",t[53]),Re(pe,"click",t[54]),Re(Je,"click",t[55]),Re(we,"click",t[56]),Re(He,"click",t[57]),Re(bt,"click",t[58])],kt=!0)},p(te,Ne){var Bt;Ne[0]&2816&&l!==(l=!te[11]||te[9]||te[8])&&(f.disabled=l),Ne[0]&2560&&p!==(p=!te[11]||te[9])&&(d.disabled=p),Ne[0]&256&&ce(d,"personal_entry_in_progress",te[8]),en===(en=dn(te))&&Et?Et.p(te,Ne):(Et.d(1),Et=en(te),Et&&(Et.c(),Et.m(r,null))),Lt===(Lt=tn(te))&&nt?nt.p(te,Ne):(nt.d(1),nt=Lt(te),nt&&(nt.c(),nt.m(E.parentNode,E))),Ne[0]&34&&(I=te[5]&&((Bt=te[1])==null?void 0:Bt.find(te[29]))),I?it?it.p(te,Ne):(it=hf(te),it.c(),it.m(T.parentNode,T)):it&&(it.d(1),it=null),Ne[0]&2048&&W!==(W=!te[11])&&(j.disabled=W),Ne[0]&2048&&$e!==($e=!te[11])&&(pe.disabled=$e),Ne[0]&2048&&Ae!==(Ae=!te[11])&&(Je.disabled=Ae),te[11]&&te[7]!=null?ot?(ot.p(te,Ne),Ne[0]&2176&&ne(ot,1)):(ot=mf(te),ot.c(),ne(ot,1),ot.m(Fe.parentNode,Fe)):ot&&(ot.d(1),ot=null),Ne[0]&2048&&Ct!==(Ct=!te[11])&&(we.disabled=Ct),Ne[0]&2048&&be!==(be=!te[11])&&(He.disabled=be),Ne[0]&2048&&Ut!==(Ut=!te[11])&&(bt.disabled=Ut)},i(te){ne(ot)},o:xe,d(te){te&&N(e),te&&N(n),te&&N(r),Et.d(),te&&N(m),te&&N(y),te&&N(S),nt.d(te),te&&N(E),it&&it.d(te),te&&N(T),te&&N(F),te&&N(oe),te&&N(j),te&&N(Oe),te&&N(pe),te&&N(ft),te&&N(Je),te&&N(We),ot&&ot.d(te),te&&N(Fe),te&&N(ht),te&&N(st),te&&N(we),te&&N(wt),te&&N(He),te&&N(Ze),te&&N(At),te&&N(Ht),te&&N(bt),kt=!1,gt(Xt)}}}function ca(t){let e,n,r,f,s=t[12]&&yf(t);return{c(){s&&s.c(),e=J(),n=U("button"),n.textContent="Ve\u010D mo\u017Enosti",L(n,"class","show_more_options svelte-xmpa81")},m(l,c){s&&s.m(l,c),D(l,e,c),D(l,n,c),r||(f=Re(n,"click",t[35]),r=!0)},p(l,c){l[12]?s?s.p(l,c):(s=yf(l),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null)},i:xe,o:xe,d(l){s&&s.d(l),l&&N(e),l&&N(n),r=!1,f()}}}function aa(t){let e,n,r,f,s,l,c,d,h,p,b,m,y,S=t[9]&&df();return{c(){e=U("h4"),e.textContent="\u2014 Odpri in ohrani \u2014",n=J(),r=U("button"),f=K("ODPRI IN OHRANI"),l=J(),c=U("button"),d=K("ZAPRI OGRAJO"),p=J(),S&&S.c(),b=xt(),L(e,"class","suboption svelte-xmpa81"),L(r,"class","fence_keep_open svelte-xmpa81"),r.disabled=s=!t[11]||t[8],ce(r,"keep_open_in_progress",t[9]),L(c,"class","close_fence svelte-xmpa81"),c.disabled=h=!t[11]||t[9]||t[8]},m(E,I){D(E,e,I),D(E,n,I),D(E,r,I),O(r,f),D(E,l,I),D(E,c,I),O(c,d),D(E,p,I),S&&S.m(E,I),D(E,b,I),m||(y=[Re(r,"click",t[39]),Re(c,"click",t[40])],m=!0)},p(E,I){I[0]&2304&&s!==(s=!E[11]||E[8])&&(r.disabled=s),I[0]&512&&ce(r,"keep_open_in_progress",E[9]),I[0]&2816&&h!==(h=!E[11]||E[9]||E[8])&&(c.disabled=h),E[9]?S||(S=df(),S.c(),S.m(b.parentNode,b)):S&&(S.d(1),S=null)},d(E){E&&N(e),E&&N(n),E&&N(r),E&&N(l),E&&N(c),E&&N(p),S&&S.d(E),E&&N(b),m=!1,gt(y)}}}function ua(t){let e,n,r;return{c(){e=U("button"),e.textContent="Ve\u010D",L(e,"class","show_more_options svelte-xmpa81")},m(f,s){D(f,e,s),n||(r=Re(e,"click",t[38]),n=!0)},p:xe,d(f){f&&N(e),n=!1,r()}}}function df(t){let e;return{c(){e=U("h4"),e.textContent="[ \u26A0\uFE0F v zadnji sekundi odpiranja ne sme biti prehoda, sicer vrata ne bodo ostala odprta ]",L(e,"class","suboption warn svelte-xmpa81")},m(n,r){D(n,e,r)},d(n){n&&N(e)}}}function da(t){let e,n,r,f,s,l,c,d,h,p,b,m,y,S,E=(t[13]||"")+"",I,T,F,oe,j,q,W,Oe,pe,ye,$e,ft,Je,ct,Ae,We,Fe,ht,st;return{c(){e=U("button"),n=K("TV"),f=J(),s=U("button"),l=K("DMT"),d=J(),h=U("button"),p=K("\u{1F6D1} UGASNI"),m=J(),y=U("h4"),y.textContent="\u2014 TV glasnost \u2014",S=J(),I=K(E),T=J(),F=U("button"),oe=K("VOL\u2191"),q=J(),W=U("button"),Oe=K("VOL \u2193"),ye=J(),$e=U("button"),ft=K("PRIVZETO"),ct=J(),Ae=U("button"),We=K("\u{1F507}"),e.disabled=r=!t[11],L(e,"class","svelte-xmpa81"),s.disabled=c=!t[11],L(s,"class","svelte-xmpa81"),L(h,"class","turn_off svelte-xmpa81"),h.disabled=b=!t[11],L(y,"class","suboption volume svelte-xmpa81"),L(F,"class","volume svelte-xmpa81"),F.disabled=j=!t[11],L(W,"class","volume svelte-xmpa81"),W.disabled=pe=!t[11],L($e,"class","volume svelte-xmpa81"),$e.disabled=Je=!t[11],L(Ae,"class","volume svelte-xmpa81"),Ae.disabled=Fe=!t[11]},m(we,qe){D(we,e,qe),O(e,n),D(we,f,qe),D(we,s,qe),O(s,l),D(we,d,qe),D(we,h,qe),O(h,p),D(we,m,qe),D(we,y,qe),D(we,S,qe),D(we,I,qe),D(we,T,qe),D(we,F,qe),O(F,oe),D(we,q,qe),D(we,W,qe),O(W,Oe),D(we,ye,qe),D(we,$e,qe),O($e,ft),D(we,ct,qe),D(we,Ae,qe),O(Ae,We),ht||(st=[Re(e,"click",t[42]),Re(s,"click",t[43]),Re(h,"click",t[44]),Re(F,"click",t[45]),Re(W,"click",t[46]),Re($e,"click",t[47]),Re(Ae,"click",t[48])],ht=!0)},p(we,qe){qe[0]&2048&&r!==(r=!we[11])&&(e.disabled=r),qe[0]&2048&&c!==(c=!we[11])&&(s.disabled=c),qe[0]&2048&&b!==(b=!we[11])&&(h.disabled=b),qe[0]&8192&&E!==(E=(we[13]||"")+"")&&Pe(I,E),qe[0]&2048&&j!==(j=!we[11])&&(F.disabled=j),qe[0]&2048&&pe!==(pe=!we[11])&&(W.disabled=pe),qe[0]&2048&&Je!==(Je=!we[11])&&($e.disabled=Je),qe[0]&2048&&Fe!==(Fe=!we[11])&&(Ae.disabled=Fe)},d(we){we&&N(e),we&&N(f),we&&N(s),we&&N(d),we&&N(h),we&&N(m),we&&N(y),we&&N(S),we&&N(I),we&&N(T),we&&N(F),we&&N(q),we&&N(W),we&&N(ye),we&&N($e),we&&N(ct),we&&N(Ae),ht=!1,gt(st)}}}function ha(t){let e,n,r;return{c(){e=U("button"),e.textContent="Mo\u017Enosti TV",L(e,"class","show_more_options svelte-xmpa81")},m(f,s){D(f,e,s),n||(r=Re(e,"click",t[41]),n=!0)},p:xe,d(f){f&&N(e),n=!1,r()}}}function hf(t){let e,n,r,f=t[27],s=[];for(let l=0;l<f.length;l+=1)s[l]=vf(af(t,f,l));return{c(){e=U("h3"),e.textContent="Izklop ra\u010Dunalnikov",n=J();for(let l=0;l<s.length;l+=1)s[l].c();r=xt(),L(e,"class","svelte-xmpa81")},m(l,c){D(l,e,c),D(l,n,c);for(let d=0;d<s.length;d+=1)s[d].m(l,c);D(l,r,c)},p(l,c){if(c[0]&192940066){f=l[27];let d;for(d=0;d<f.length;d+=1){const h=af(l,f,d);s[d]?s[d].p(h,c):(s[d]=vf(h),s[d].c(),s[d].m(r.parentNode,r))}for(;d<s.length;d+=1)s[d].d(1);s.length=f.length}},d(l){l&&N(e),l&&N(n),Cn(s,l),l&&N(r)}}}function _f(t){var p,b;let e,n,r,f;function s(m,y){var S;return(S=m[5][m[60]])!=null&&S.counter?pa:_a}let l=s(t),c=l(t),d=((p=t[5][t[60]])==null?void 0:p.counter)&&pf(t),h=t[11]&&((b=t[5][t[60]])==null?void 0:b.counter)!=null&&bf(t);return{c(){e=U("div"),c.c(),n=J(),d&&d.c(),r=J(),h&&h.c(),f=J(),L(e,"class","sleep_device svelte-xmpa81")},m(m,y){D(m,e,y),c.m(e,null),O(e,n),d&&d.m(e,null),O(e,r),h&&h.m(e,null),O(e,f)},p(m,y){var S,E;l===(l=s(m))&&c?c.p(m,y):(c.d(1),c=l(m),c&&(c.c(),c.m(e,n))),(S=m[5][m[60]])!=null&&S.counter?d?d.p(m,y):(d=pf(m),d.c(),d.m(e,r)):d&&(d.d(1),d=null),m[11]&&((E=m[5][m[60]])==null?void 0:E.counter)!=null?h?h.p(m,y):(h=bf(m),h.c(),h.m(e,f)):h&&(h.d(1),h=null)},d(m){m&&N(e),c.d(),d&&d.d(),h&&h.d()}}}function _a(t){let e,n,r=t[60]+"",f,s,l,c;function d(){return t[49](t[60])}return{c(){e=U("button"),n=K("\u{1F6D1}\u{1F4BB} "),f=K(r),e.disabled=s=!t[11],L(e,"class","svelte-xmpa81")},m(h,p){D(h,e,p),O(e,n),O(e,f),l||(c=Re(e,"click",d),l=!0)},p(h,p){t=h,p[0]&2048&&s!==(s=!t[11])&&(e.disabled=s)},d(h){h&&N(e),l=!1,c()}}}function pa(t){let e,n=t[60]+"",r;return{c(){e=U("h3"),r=K(n),L(e,"class","sleep_device svelte-xmpa81")},m(f,s){D(f,e,s),O(e,r)},p:xe,d(f){f&&N(e)}}}function pf(t){let e,n,r,f,s,l,c,d,h,p,b,m,y;function S(){return t[50](t[60])}function E(){return t[51](t[60])}function I(){return t[52](t[60])}return{c(){e=U("button"),n=K("\u{1F6D1} ZDAJ"),f=J(),s=U("button"),l=K("\u23F1 ZAKASNITEV"),d=J(),h=U("button"),p=K("Prekli\u010Di"),L(e,"class","turn_off svelte-xmpa81"),e.disabled=r=!t[11],L(s,"class","add_time svelte-xmpa81"),s.disabled=c=!t[11],L(h,"class","cancel svelte-xmpa81"),h.disabled=b=!t[11]},m(T,F){D(T,e,F),O(e,n),D(T,f,F),D(T,s,F),O(s,l),D(T,d,F),D(T,h,F),O(h,p),m||(y=[Re(e,"click",S),Re(s,"click",E),Re(h,"click",I)],m=!0)},p(T,F){t=T,F[0]&2048&&r!==(r=!t[11])&&(e.disabled=r),F[0]&2048&&c!==(c=!t[11])&&(s.disabled=c),F[0]&2048&&b!==(b=!t[11])&&(h.disabled=b)},d(T){T&&N(e),T&&N(f),T&&N(s),T&&N(d),T&&N(h),m=!1,gt(y)}}}function bf(t){let e,n,r=t[60]+"",f,s;function l(h,p){return h[5][h[60]].counter==0?va:ba}let c=l(t),d=c(t);return{c(){e=U("h3"),n=U("span"),f=K(r),s=K(` izklop
                `),d.c(),L(n,"class","svelte-xmpa81"),L(e,"class","countdown_turn_off svelte-xmpa81"),ce(e,"warn",t[5][t[60]].counter<=10)},m(h,p){D(h,e,p),O(e,n),O(n,f),O(e,s),d.m(e,null)},p(h,p){c===(c=l(h))&&d?d.p(h,p):(d.d(1),d=c(h),d&&(d.c(),d.m(e,null))),p[0]&134217760&&ce(e,"warn",h[5][h[60]].counter<=10)},d(h){h&&N(e),d.d()}}}function ba(t){let e,n=t[5][t[60]].delayStr+"",r;return{c(){e=K("\u010Dez "),r=K(n)},m(f,s){D(f,e,s),D(f,r,s)},p(f,s){s[0]&32&&n!==(n=f[5][f[60]].delayStr+"")&&Pe(r,n)},d(f){f&&N(e),f&&N(r)}}}function va(t){let e;return{c(){e=K("ZDAJ")},m(n,r){D(n,e,r)},p:xe,d(n){n&&N(e)}}}function vf(t){var s;let e=(s=t[1])==null?void 0:s.find(r),n;function r(...l){return t[30](t[60],...l)}let f=e&&_f(t);return{c(){f&&f.c(),n=xt()},m(l,c){f&&f.m(l,c),D(l,n,c)},p(l,c){var d;t=l,c[0]&2&&(e=(d=t[1])==null?void 0:d.find(r)),e?f?f.p(t,c):(f=_f(t),f.c(),f.m(n.parentNode,n)):f&&(f.d(1),f=null)},d(l){f&&f.d(l),l&&N(n)}}}function mf(t){let e,n,r,f;function s(d,h){return d[7]==0?ya:ma}let l=s(t),c=l(t);return{c(){e=U("h3"),n=K(`Uga\u0161anje
        `),r=U("span"),c.c(),L(r,"class","svelte-xmpa81"),L(e,"class","countdown svelte-xmpa81")},m(d,h){D(d,e,h),O(e,n),O(e,r),c.m(r,null)},p(d,h){l===(l=s(d))&&c?c.p(d,h):(c.d(1),c=l(d),c&&(c.c(),c.m(r,null)))},i(d){f||Dt(()=>{f=un(r,is,{}),f.start()})},o:xe,d(d){d&&N(e),c.d()}}}function ma(t){let e,n;return{c(){e=K("\u010Dez "),n=K(t[6])},m(r,f){D(r,e,f),D(r,n,f)},p(r,f){f[0]&64&&Pe(n,r[6])},d(r){r&&N(e),r&&N(n)}}}function ya(t){let e;return{c(){e=K("ZDAJ")},m(n,r){D(n,e,r)},p:xe,d(n){n&&N(e)}}}function yf(t){let e,n,r=(t[0].network||"")+"",f;return{c(){e=U("h3"),n=K("Ve\u010D mo\u017Enosti - "),f=K(r),L(e,"class","svelte-xmpa81")},m(s,l){D(s,e,l),O(e,n),O(e,f)},p(s,l){l[0]&1&&r!==(r=(s[0].network||"")+"")&&Pe(f,r)},d(s){s&&N(e)}}}function ga(t){let e,n,r,f,s,l,c,d,h;function p(T,F){return T[11]&&T[12]?fa:ia}let b=p(t),m=b(t),y=t[12]&&uf(t);function S(T,F){return T[2]?la:ca}let E=S(t),I=E(t);return{c(){e=U("div"),m.c(),n=J(),r=U("button"),f=K("ODPIRANJE VHODNIH VRAT"),l=J(),y&&y.c(),c=J(),I.c(),L(r,"class","open_door_show_options svelte-xmpa81"),r.disabled=s=!t[11],ce(r,"invisible",t[12]),L(e,"class","options svelte-xmpa81")},m(T,F){D(T,e,F),m.m(e,null),O(e,n),O(e,r),O(r,f),O(e,l),y&&y.m(e,null),O(e,c),I.m(e,null),d||(h=Re(r,"click",t[31]),d=!0)},p(T,F){b===(b=p(T))&&m?m.p(T,F):(m.d(1),m=b(T),m&&(m.c(),ne(m,1),m.m(e,n))),F[0]&2048&&s!==(s=!T[11])&&(r.disabled=s),F[0]&4096&&ce(r,"invisible",T[12]),T[12]?y?y.p(T,F):(y=uf(T),y.c(),y.m(e,c)):y&&(y.d(1),y=null),E===(E=S(T))&&I?I.p(T,F):(I.d(1),I=E(T),I&&(I.c(),ne(I,1),I.m(e,null)))},i(T){ne(m),ne(I)},o:xe,d(T){T&&N(e),m.d(),y&&y.d(),I.d(),d=!1,h()}}}const xa="192.168.0.20",wa=7780,Aa="david/home";function Ea(t,e,n){let r,f,s,l,c,d,h,p,b,m,{localDevice:y}=e,{nearbyDevices:S}=e;const E=ra({host:xa,port:wa,protocol:Aa}),{connected:I,state:T}=E;yt(t,I,Ie=>n(11,p=Ie)),yt(t,T,Ie=>n(28,h=Ie));const F=E.field("tvVolume");yt(t,F,Ie=>n(13,m=Ie));const oe=yo(T,Ie=>{var lt;return((lt=Ie.entryDoor)==null?void 0:lt.counter)!=null});yt(t,oe,Ie=>n(12,b=Ie));function j(Ie,lt){E.userAction({action:Ie,payload:lt,scope:"tv"})}function q(Ie,lt){E.userAction({action:Ie,payload:lt,scope:"alarm"})}function W(Ie,lt){E.userAction({action:Ie,payload:lt,scope:"entry-door"})}function Oe(Ie,lt){E.userAction({action:Ie,payload:lt,scope:"fence-door"})}function pe(Ie,lt){E.userAction({action:Ie,payload:lt,scope:"light-lab"})}function ye(Ie){E.userAction({action:"sleep",scope:"nearbyDevices",payload:{deviceName:Ie}})}function $e(Ie){E.userAction({action:"sleep",scope:"nearbyDevices",payload:{deviceName:Ie,delay:!0}})}function ft(Ie){E.userAction({action:"sleep",scope:"nearbyDevices",payload:{deviceName:Ie,cancel:!0}})}let Je=y.deviceName=="turbine",ct,Ae;function We(){n(2,Je=!1),n(4,Ae=!1),n(3,ct=!1)}const Fe=["kids","eclipse"];y.deviceName=="turbine"&&Fe.push("turbine");const ht=({deviceName:Ie})=>Fe.includes(Ie),st=(Ie,lt)=>lt.deviceName==Ie,we=()=>{W("delayed-open")},qe=()=>{W("open")},Ct=()=>{W("add-delay")},wt=()=>{W("cancel-opening")},He=()=>{n(2,Je=!0)},Xe=()=>{Oe("move")},be=()=>{Oe("personal-entry")},Ze=()=>{n(3,ct=!0)},At=()=>{Oe("keep-open")},Ht=()=>{Oe("close")},bt=()=>{n(4,Ae=!0),j("vol-report")},Nt=()=>{j("hdmi1")},Ut=()=>{j("hdmi2")},kt=()=>{j("off")},Xt=()=>{j("vol-up")},dn=()=>{j("vol-down")},en=()=>{j("vol-default")},Et=()=>{j("mute")},tn=Ie=>{$e(Ie)},Lt=Ie=>{ye(Ie)},nt=Ie=>{$e(Ie)},it=Ie=>{ft(Ie)},ot=()=>{pe("on")},jt=()=>{pe("off")},te=()=>{pe("off-delay")},Ne=()=>{q("enable")},Bt=()=>{q("disable")},Jt=()=>{We(),window.scrollTo({top:0,behavior:"smooth"})};return t.$$set=Ie=>{"localDevice"in Ie&&n(0,y=Ie.localDevice),"nearbyDevices"in Ie&&n(1,S=Ie.nearbyDevices)},t.$$.update=()=>{var Ie,lt,hn,Nn,nn;t.$$.dirty[0]&268435456&&n(10,r=(Ie=h.entryDoor)==null?void 0:Ie.counter),t.$$.dirty[0]&268435456&&n(9,f=(lt=h.parkingDoor)==null?void 0:lt.keepOpenInProgress),t.$$.dirty[0]&268435456&&n(8,s=(hn=h.parkingDoor)==null?void 0:hn.personalEntryInProgress),t.$$.dirty[0]&268435456&&n(7,l=(Nn=h.lights)==null?void 0:Nn.labLightOffDelay),t.$$.dirty[0]&268435456&&n(6,c=(nn=h.lights)==null?void 0:nn.labLightOffDelayStr),t.$$.dirty[0]&268435456&&n(5,d=h.deviceSleep)},[y,S,Je,ct,Ae,d,c,l,s,f,r,p,b,m,I,T,F,oe,j,q,W,Oe,pe,ye,$e,ft,We,Fe,h,ht,st,we,qe,Ct,wt,He,Xe,be,Ze,At,Ht,bt,Nt,Ut,kt,Xt,dn,en,Et,tn,Lt,nt,it,ot,jt,te,Ne,Bt,Jt]}class Sa extends dt{constructor(e){super(),ut(this,e,Ea,ga,at,{localDevice:0,nearbyDevices:1},null,[-1,-1,-1])}}function Oa(t){let e,n=gf(t[2])+"",r,f,s=t[1].replace("blinds","")+"",l,c,d,h;return{c(){e=U("button"),r=K(n),f=J(),l=K(s),e.disabled=c=!t[4],L(e,"class","svelte-1u4dkh7"),ce(e,"moving",t[3]&&t[3][_n(t[0],t[1],t[2])]&&t[3][_n(t[0],t[1],t[2])].blindsStatus=="moving"),ce(e,"present",t[3]&&t[3][_n(t[0],t[1],t[2])]&&t[3][_n(t[0],t[1],t[2])].present),ce(e,"disconnected",t[4]==!1)},m(p,b){D(p,e,b),O(e,r),O(e,f),O(e,l),d||(h=Re(e,"click",t[10]),d=!0)},p(p,[b]){b&4&&n!==(n=gf(p[2])+"")&&Pe(r,n),b&2&&s!==(s=p[1].replace("blinds","")+"")&&Pe(l,s),b&16&&c!==(c=!p[4])&&(e.disabled=c),b&15&&ce(e,"moving",p[3]&&p[3][_n(p[0],p[1],p[2])]&&p[3][_n(p[0],p[1],p[2])].blindsStatus=="moving"),b&15&&ce(e,"present",p[3]&&p[3][_n(p[0],p[1],p[2])]&&p[3][_n(p[0],p[1],p[2])].present),b&16&&ce(e,"disconnected",p[4]==!1)},i:xe,o:xe,d(p){p&&N(e),d=!1,h()}}}function gf(t){return t=="up"?"\u25B2":"\u25BC"}function _n(t,e,n){return`${t}-${e}-${n}`}function Ta(t,e,n){let r,f,s,{connector:l}=e,{placeId:c}=e,{blindsId:d}=e,{blindsDirection:h}=e;const{state:p,connected:b}=l;yt(t,p,E=>n(9,f=E)),yt(t,b,E=>n(4,s=E));function m(E,I){l.signal("action",{action:E,scope:"iot",payload:I})}function y(E,I,T){m("blinds",{placeId:E,blindsId:I,blindsDirection:T,blindsAction:"move"})}const S=()=>y(c,d,h);return t.$$set=E=>{"connector"in E&&n(8,l=E.connector),"placeId"in E&&n(0,c=E.placeId),"blindsId"in E&&n(1,d=E.blindsId),"blindsDirection"in E&&n(2,h=E.blindsDirection)},t.$$.update=()=>{t.$$.dirty&512&&n(3,r=f.blinds)},[c,d,h,r,s,p,b,y,l,f,S]}class vt extends dt{constructor(e){super(),ut(this,e,Ta,Oa,at,{connector:8,placeId:0,blindsId:1,blindsDirection:2})}}function Ca(t){let e,n,r,f,s,l,c,d,h,p,b,m,y,S,E,I,T,F,oe,j,q;return s=new vt({props:{placeId:"ap1",blindsId:"blinds4",blindsDirection:"up",connector:t[0]}}),c=new vt({props:{placeId:"ap1",blindsId:"blinds3",blindsDirection:"up",connector:t[0]}}),h=new vt({props:{placeId:"ap1",blindsId:"blinds2",blindsDirection:"up",connector:t[0]}}),b=new vt({props:{placeId:"ap1",blindsId:"blinds1",blindsDirection:"up",connector:t[0]}}),S=new vt({props:{placeId:"ap1",blindsId:"blinds4",blindsDirection:"down",connector:t[0]}}),I=new vt({props:{placeId:"ap1",blindsId:"blinds3",blindsDirection:"down",connector:t[0]}}),F=new vt({props:{placeId:"ap1",blindsId:"blinds2",blindsDirection:"down",connector:t[0]}}),j=new vt({props:{placeId:"ap1",blindsId:"blinds1",blindsDirection:"down",connector:t[0]}}),{c(){e=U("div"),n=U("h2"),n.textContent="Rolete",r=J(),f=U("div"),ze(s.$$.fragment),l=J(),ze(c.$$.fragment),d=K(`
        \u2014
        `),ze(h.$$.fragment),p=J(),ze(b.$$.fragment),m=J(),y=U("div"),ze(S.$$.fragment),E=J(),ze(I.$$.fragment),T=K(`
        \u2014
        `),ze(F.$$.fragment),oe=J(),ze(j.$$.fragment),L(f,"class","iot section svelte-1kxggon"),L(y,"class","iot section svelte-1kxggon"),L(e,"class","blinds_ap1")},m(W,Oe){D(W,e,Oe),O(e,n),O(e,r),O(e,f),je(s,f,null),O(f,l),je(c,f,null),O(f,d),je(h,f,null),O(f,p),je(b,f,null),O(e,m),O(e,y),je(S,y,null),O(y,E),je(I,y,null),O(y,T),je(F,y,null),O(y,oe),je(j,y,null),q=!0},p(W,Oe){const pe={};Oe&1&&(pe.connector=W[0]),s.$set(pe);const ye={};Oe&1&&(ye.connector=W[0]),c.$set(ye);const $e={};Oe&1&&($e.connector=W[0]),h.$set($e);const ft={};Oe&1&&(ft.connector=W[0]),b.$set(ft);const Je={};Oe&1&&(Je.connector=W[0]),S.$set(Je);const ct={};Oe&1&&(ct.connector=W[0]),I.$set(ct);const Ae={};Oe&1&&(Ae.connector=W[0]),F.$set(Ae);const We={};Oe&1&&(We.connector=W[0]),j.$set(We)},i(W){q||(ne(s.$$.fragment,W),ne(c.$$.fragment,W),ne(h.$$.fragment,W),ne(b.$$.fragment,W),ne(S.$$.fragment,W),ne(I.$$.fragment,W),ne(F.$$.fragment,W),ne(j.$$.fragment,W),q=!0)},o(W){ge(s.$$.fragment,W),ge(c.$$.fragment,W),ge(h.$$.fragment,W),ge(b.$$.fragment,W),ge(S.$$.fragment,W),ge(I.$$.fragment,W),ge(F.$$.fragment,W),ge(j.$$.fragment,W),q=!1},d(W){W&&N(e),Be(s),Be(c),Be(h),Be(b),Be(S),Be(I),Be(F),Be(j)}}}function ka(t){let e,n,r,f,s,l,c,d,h,p,b,m,y,S,E,I,T,F,oe,j,q,W,Oe,pe,ye,$e,ft,Je,ct;return s=new vt({props:{placeId:"ap2",blindsId:"blinds6",blindsDirection:"up",connector:t[0]}}),c=new vt({props:{placeId:"ap2",blindsId:"blinds5",blindsDirection:"up",connector:t[0]}}),h=new vt({props:{placeId:"ap2",blindsId:"blinds4",blindsDirection:"up",connector:t[0]}}),b=new vt({props:{placeId:"ap2",blindsId:"blinds3",blindsDirection:"up",connector:t[0]}}),y=new vt({props:{placeId:"ap2",blindsId:"blinds2",blindsDirection:"up",connector:t[0]}}),E=new vt({props:{placeId:"ap2",blindsId:"blinds1",blindsDirection:"up",connector:t[0]}}),F=new vt({props:{placeId:"ap2",blindsId:"blinds6",blindsDirection:"down",connector:t[0]}}),j=new vt({props:{placeId:"ap2",blindsId:"blinds5",blindsDirection:"down",connector:t[0]}}),W=new vt({props:{placeId:"ap2",blindsId:"blinds4",blindsDirection:"down",connector:t[0]}}),pe=new vt({props:{placeId:"ap2",blindsId:"blinds3",blindsDirection:"down",connector:t[0]}}),$e=new vt({props:{placeId:"ap2",blindsId:"blinds2",blindsDirection:"down",connector:t[0]}}),Je=new vt({props:{placeId:"ap2",blindsId:"blinds1",blindsDirection:"down",connector:t[0]}}),{c(){e=U("div"),n=U("h2"),n.textContent="Rolete",r=J(),f=U("div"),ze(s.$$.fragment),l=J(),ze(c.$$.fragment),d=K(`
        \u2014
        `),ze(h.$$.fragment),p=J(),ze(b.$$.fragment),m=K(`
        \u2014
        `),ze(y.$$.fragment),S=J(),ze(E.$$.fragment),I=J(),T=U("div"),ze(F.$$.fragment),oe=J(),ze(j.$$.fragment),q=K(`
        \u2014
        `),ze(W.$$.fragment),Oe=J(),ze(pe.$$.fragment),ye=K(`
        \u2014
        `),ze($e.$$.fragment),ft=J(),ze(Je.$$.fragment),L(f,"class","iot section svelte-1kxggon"),L(T,"class","iot section svelte-1kxggon"),L(e,"class","blinds_ap2 svelte-1kxggon"),ce(e,"visible",Na)},m(Ae,We){D(Ae,e,We),O(e,n),O(e,r),O(e,f),je(s,f,null),O(f,l),je(c,f,null),O(f,d),je(h,f,null),O(f,p),je(b,f,null),O(f,m),je(y,f,null),O(f,S),je(E,f,null),O(e,I),O(e,T),je(F,T,null),O(T,oe),je(j,T,null),O(T,q),je(W,T,null),O(T,Oe),je(pe,T,null),O(T,ye),je($e,T,null),O(T,ft),je(Je,T,null),ct=!0},p(Ae,We){const Fe={};We&1&&(Fe.connector=Ae[0]),s.$set(Fe);const ht={};We&1&&(ht.connector=Ae[0]),c.$set(ht);const st={};We&1&&(st.connector=Ae[0]),h.$set(st);const we={};We&1&&(we.connector=Ae[0]),b.$set(we);const qe={};We&1&&(qe.connector=Ae[0]),y.$set(qe);const Ct={};We&1&&(Ct.connector=Ae[0]),E.$set(Ct);const wt={};We&1&&(wt.connector=Ae[0]),F.$set(wt);const He={};We&1&&(He.connector=Ae[0]),j.$set(He);const Xe={};We&1&&(Xe.connector=Ae[0]),W.$set(Xe);const be={};We&1&&(be.connector=Ae[0]),pe.$set(be);const Ze={};We&1&&(Ze.connector=Ae[0]),$e.$set(Ze);const At={};We&1&&(At.connector=Ae[0]),Je.$set(At)},i(Ae){ct||(ne(s.$$.fragment,Ae),ne(c.$$.fragment,Ae),ne(h.$$.fragment,Ae),ne(b.$$.fragment,Ae),ne(y.$$.fragment,Ae),ne(E.$$.fragment,Ae),ne(F.$$.fragment,Ae),ne(j.$$.fragment,Ae),ne(W.$$.fragment,Ae),ne(pe.$$.fragment,Ae),ne($e.$$.fragment,Ae),ne(Je.$$.fragment,Ae),ct=!0)},o(Ae){ge(s.$$.fragment,Ae),ge(c.$$.fragment,Ae),ge(h.$$.fragment,Ae),ge(b.$$.fragment,Ae),ge(y.$$.fragment,Ae),ge(E.$$.fragment,Ae),ge(F.$$.fragment,Ae),ge(j.$$.fragment,Ae),ge(W.$$.fragment,Ae),ge(pe.$$.fragment,Ae),ge($e.$$.fragment,Ae),ge(Je.$$.fragment,Ae),ct=!1},d(Ae){Ae&&N(e),Be(s),Be(c),Be(h),Be(b),Be(y),Be(E),Be(F),Be(j),Be(W),Be(pe),Be($e),Be(Je)}}}function Ra(t){let e,n,r,f;const s=[ka,Ca],l=[];function c(d,h){return d[1].deviceName=="tv-ap2"?0:1}return n=c(t),r=l[n]=s[n](t),{c(){e=U("main"),r.c(),L(e,"class","svelte-1kxggon")},m(d,h){D(d,e,h),l[n].m(e,null),f=!0},p(d,[h]){let p=n;n=c(d),n===p?l[n].p(d,h):(St(),ge(l[p],1,1,()=>{l[p]=null}),Ot(),r=l[n],r?r.p(d,h):(r=l[n]=s[n](d),r.c()),ne(r,1),r.m(e,null))},i(d){f||(ne(r),f=!0)},o(d){ge(r),f=!1},d(d){d&&N(e),l[n].d()}}}let Na=!1;function Da(t,e,n){let r,f,{connector:s}=e;const{state:l,connected:c}=s;return yt(t,l,d=>n(3,f=d)),t.$$set=d=>{"connector"in d&&n(0,s=d.connector)},t.$$.update=()=>{t.$$.dirty&8&&n(1,r=f.device)},[s,r,l,f]}class $a extends dt{constructor(e){super(),ut(this,e,Da,Ra,at,{connector:0})}}function xf(t,e,n){const r=t.slice();return r[3]=e[n],r}function wf(t){let e,n=t[1].slice(0,4),r=[];for(let f=0;f<n.length;f+=1)r[f]=Ef(xf(t,n,f));return{c(){e=U("div");for(let f=0;f<r.length;f+=1)r[f].c();L(e,"class","notifications svelte-9jalg6")},m(f,s){D(f,e,s);for(let l=0;l<r.length;l+=1)r[l].m(e,null)},p(f,s){if(s&2){n=f[1].slice(0,4);let l;for(l=0;l<n.length;l+=1){const c=xf(f,n,l);r[l]?r[l].p(c,s):(r[l]=Ef(c),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(f){f&&N(e),Cn(r,f)}}}function Af(t){let e,n=t[3].title+"",r;return{c(){e=U("div"),r=K(n),L(e,"class","title svelte-9jalg6")},m(f,s){D(f,e,s),O(e,r)},p(f,s){s&2&&n!==(n=f[3].title+"")&&Pe(r,n)},d(f){f&&N(e)}}}function Pa(t){let e,n=t[3].relativeTimeAdded+"",r;return{c(){e=U("div"),r=K(n),L(e,"class","time svelte-9jalg6")},m(f,s){D(f,e,s),O(e,r)},p(f,s){s&2&&n!==(n=f[3].relativeTimeAdded+"")&&Pe(r,n)},d(f){f&&N(e)}}}function Ia(t){let e,n=t[3].replaceTtl+"",r;return{c(){e=U("div"),r=K(n),L(e,"class","time svelte-9jalg6")},m(f,s){D(f,e,s),O(e,r)},p(f,s){s&2&&n!==(n=f[3].replaceTtl+"")&&Pe(r,n)},d(f){f&&N(e)}}}function Ef(t){let e,n,r=t[3].msg+"",f,s,l,c=t[3].title&&Af(t);function d(b,m){if(b[3].replaceTtl)return Ia;if(!b[3].omitTtl)return Pa}let h=d(t),p=h&&h(t);return{c(){e=U("div"),c&&c.c(),n=J(),f=K(r),s=J(),p&&p.c(),l=J(),L(e,"class","notification svelte-9jalg6"),er(e,"color",t[3].color),er(e,"background-color",t[3].bgColor)},m(b,m){D(b,e,m),c&&c.m(e,null),O(e,n),O(e,f),O(e,s),p&&p.m(e,null),O(e,l)},p(b,m){b[3].title?c?c.p(b,m):(c=Af(b),c.c(),c.m(e,n)):c&&(c.d(1),c=null),m&2&&r!==(r=b[3].msg+"")&&Pe(f,r),h===(h=d(b))&&p?p.p(b,m):(p&&p.d(1),p=h&&h(b),p&&(p.c(),p.m(e,l))),m&2&&er(e,"color",b[3].color),m&2&&er(e,"background-color",b[3].bgColor)},d(b){b&&N(e),c&&c.d(),p&&p.d()}}}function Ma(t){let e,n=t[1]&&t[1].length&&wf(t);return{c(){n&&n.c(),e=xt()},m(r,f){n&&n.m(r,f),D(r,e,f)},p(r,[f]){r[1]&&r[1].length?n?n.p(r,f):(n=wf(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:xe,o:xe,d(r){n&&n.d(r),r&&N(e)}}}function Ua(t,e,n){let r,f,s=xe,l=()=>(s(),s=Tt(c,d=>n(2,f=d)),c);t.$$.on_destroy.push(()=>s());let{store:c}=e;return l(),t.$$set=d=>{"store"in d&&l(n(0,c=d.store))},t.$$.update=()=>{t.$$.dirty&4&&n(1,r=f.notifications.slice().reverse())},[c,r,f]}class La extends dt{constructor(e){super(),ut(this,e,Ua,Ma,at,{store:0})}}const Kt=Qt([]);Kt.LIMIT=300;Kt.log=(t,{dedup:e=!1}={})=>{Kt.update(n=>(e&&n.length>0&&n[n.length-1].entry==t&&n.pop(),n.push({entry:t,createdDate:new Date,createdAt:Date.now(),isRecent:!0,isVeryRecent:!0}),n.slice(-Kt.LIMIT)))};function Cs(){const t=Date.now();Kt.update(e=>{for(const n of e)n.isRecent=t-n.createdAt<6e4,n.isVeryRecent=t-n.createdAt<5e3;return e}),setTimeout(Cs,1e3)}Cs();function Sf(t,e,n){const r=t.slice();return r[11]=e[n].time,r[12]=e[n].entry,r[13]=e[n].isRecent,r[14]=e[n].isVeryRecent,r[15]=e[n].createdAt,r[17]=n,r}function Of(t){let e,n;return{c(){e=U("h2"),n=K(t[0]),L(e,"class","title svelte-19k2gjn")},m(r,f){D(r,e,f),O(e,n)},p(r,f){f&1&&Pe(n,r[0])},d(r){r&&N(e)}}}function ja(t){let e,n,r;return{c(){e=U("button"),e.textContent="Show Log",L(e,"class","svelte-19k2gjn")},m(f,s){D(f,e,s),n||(r=Re(e,"click",t[8]),n=!0)},p:xe,i:xe,o:xe,d(f){f&&N(e),n=!1,r()}}}function Ba(t){let e,n,r;const f=t[7].default,s=qf(f,t,t[6],null);let l=t[2].map(Cf),c=[];for(let d=0;d<l.length;d+=1)c[d]=Tf(Sf(t,l,d));return{c(){s&&s.c(),e=J();for(let d=0;d<c.length;d+=1)c[d].c();n=xt()},m(d,h){s&&s.m(d,h),D(d,e,h);for(let p=0;p<c.length;p+=1)c[p].m(d,h);D(d,n,h),r=!0},p(d,h){if(s&&s.p&&(!r||h&64)&&Hf(s,f,d,d[6],r?Ff(f,d[6],h,null):Jf(d[6]),null),h&4){l=d[2].map(Cf);let p;for(p=0;p<l.length;p+=1){const b=Sf(d,l,p);c[p]?c[p].p(b,h):(c[p]=Tf(b),c[p].c(),c[p].m(n.parentNode,n))}for(;p<c.length;p+=1)c[p].d(1);c.length=l.length}},i(d){r||(ne(s,d),r=!0)},o(d){ge(s,d),r=!1},d(d){s&&s.d(d),d&&N(e),Cn(c,d),d&&N(n)}}}function Ka(t){let e=t[11]+"",n;return{c(){n=K(e)},m(r,f){D(r,n,f)},p(r,f){f&4&&e!==(e=r[11]+"")&&Pe(n,e)},d(r){r&&N(n)}}}function za(t){let e;function n(s,l){return s[15]-s[2][s[17]+1].createdAt<1e4?Ya:qa}let r=n(t),f=r(t);return{c(){f.c(),e=xt()},m(s,l){f.m(s,l),D(s,e,l)},p(s,l){r===(r=n(s))&&f?f.p(s,l):(f.d(1),f=r(s),f&&(f.c(),f.m(e.parentNode,e)))},d(s){f.d(s),s&&N(e)}}}function qa(t){let e=t[11]+"",n;return{c(){n=K(e)},m(r,f){D(r,n,f)},p(r,f){f&4&&e!==(e=r[11]+"")&&Pe(n,e)},d(r){r&&N(n)}}}function Ya(t){let e,n,r=t[15]-t[2][t[17]+1].createdAt+"",f,s;return{c(){e=U("span"),n=K("+"),f=K(r),s=K("ms"),L(e,"class","diff svelte-19k2gjn")},m(l,c){D(l,e,c),O(e,n),O(e,f),O(e,s)},p(l,c){c&4&&r!==(r=l[15]-l[2][l[17]+1].createdAt+"")&&Pe(f,r)},d(l){l&&N(e)}}}function Tf(t){let e,n,r,f=t[12]+"",s,l;function c(p,b){return p[17]<p[2].length-1?za:Ka}let d=c(t),h=d(t);return{c(){e=U("div"),n=U("span"),h.c(),r=J(),s=K(f),l=J(),L(n,"class","time svelte-19k2gjn"),L(e,"class","log_entry svelte-19k2gjn"),ce(e,"recent",t[13]),ce(e,"very_recent",t[14])},m(p,b){D(p,e,b),O(e,n),h.m(n,null),O(e,r),O(e,s),O(e,l)},p(p,b){d===(d=c(p))&&h?h.p(p,b):(h.d(1),h=d(p),h&&(h.c(),h.m(n,null))),b&4&&f!==(f=p[12]+"")&&Pe(s,f),b&4&&ce(e,"recent",p[13]),b&4&&ce(e,"very_recent",p[14])},d(p){p&&N(e),h.d()}}}function Fa(t){let e,n,r,f,s,l=t[0]&&Of(t);const c=[Ba,ja],d=[];function h(p,b){return p[1]?0:1}return r=h(t),f=d[r]=c[r](t),{c(){e=U("div"),l&&l.c(),n=J(),f.c(),L(e,"class","logview svelte-19k2gjn")},m(p,b){D(p,e,b),l&&l.m(e,null),O(e,n),d[r].m(e,null),s=!0},p(p,[b]){p[0]?l?l.p(p,b):(l=Of(p),l.c(),l.m(e,n)):l&&(l.d(1),l=null);let m=r;r=h(p),r===m?d[r].p(p,b):(St(),ge(d[m],1,1,()=>{d[m]=null}),Ot(),f=d[r],f?f.p(p,b):(f=d[r]=c[r](p),f.c()),ne(f,1),f.m(e,null))},i(p){s||(ne(f),s=!0)},o(p){ge(f),s=!1},d(p){p&&N(e),l&&l.d(),d[r].d()}}}const Cf=t=>{const e=t.createdDate.toLocaleString().split(",")[1];return{...t,time:e}};function Ha(t,e,n){let r,f;yt(t,Kt,S=>n(5,f=S));let{$$slots:s={},$$scope:l}=e,{showLogInitially:c=!0}=e,{title:d}=e,{limit:h=0}=e;h>Kt.LIMIT&&(console.log(`Warning: provided LogView line limit (${h}) is larger than logStore limit  (${Kt.LIMIT})`),console.log("Utilizing the lower value ..."),h=Kt.LIMIT);let p=c,b;function m(){const S=Date.now();b&&S-b>500&&Kt.log("\u2014\u2014\u2014 Context switch / App wake \u2014\u2014\u2014",{dedup:!0}),b=S,setTimeout(m,300)}m();const y=()=>{n(1,p=!0)};return t.$$set=S=>{"showLogInitially"in S&&n(4,c=S.showLogInitially),"title"in S&&n(0,d=S.title),"limit"in S&&n(3,h=S.limit),"$$scope"in S&&n(6,l=S.$$scope)},t.$$.update=()=>{t.$$.dirty&40&&n(2,r=f.slice(-h).reverse())},[d,p,r,h,c,f,l,s,y]}class ks extends dt{constructor(e){super(),ut(this,e,Ha,Fa,at,{showLogInitially:4,title:0,limit:3})}}function Ja(t){let e,n,r,f,s;return{c(){e=U("div"),n=U("span"),n.textContent="DMT",r=J(),f=U("span"),s=K(t[0]),L(n,"class","dmt svelte-c00wah"),L(f,"class","app svelte-c00wah")},m(l,c){D(l,e,c),O(e,n),O(e,r),O(e,f),O(f,s)},p(l,[c]){c&1&&Pe(s,l[0])},i:xe,o:xe,d(l){l&&N(e)}}}function Wa(t,e,n){let{dmtApp:r}=e;return t.$$set=f=>{"dmtApp"in f&&n(0,r=f.dmtApp)},[r]}class Za extends dt{constructor(e){super(),ut(this,e,Wa,Ja,at,{dmtApp:0})}}function Ga(t){let e,n,r,f,s,l,c=".".repeat(t[1])+"",d,h,p,b,m;n=new Za({props:{dmtApp:t[0]}});const y=t[3].default,S=qf(y,t,t[2],null);return{c(){e=U("div"),ze(n.$$.fragment),r=J(),f=U("p"),s=K("Connecting "),l=U("span"),d=K(c),h=J(),S&&S.c(),L(l,"class","svelte-1afk0eu"),L(f,"class","svelte-1afk0eu"),L(e,"class","wrapper svelte-1afk0eu")},m(E,I){D(E,e,I),je(n,e,null),O(e,r),O(e,f),O(f,s),O(f,l),O(l,d),O(e,h),S&&S.m(e,null),m=!0},p(E,[I]){const T={};I&1&&(T.dmtApp=E[0]),n.$set(T),(!m||I&2)&&c!==(c=".".repeat(E[1])+"")&&Pe(d,c),S&&S.p&&(!m||I&4)&&Hf(S,y,E,E[2],m?Ff(y,E[2],I,null):Jf(E[2]),null)},i(E){m||(ne(n.$$.fragment,E),ne(S,E),Dt(()=>{b&&b.end(1),p=un(e,vn,{}),p.start()}),m=!0)},o(E){ge(n.$$.fragment,E),ge(S,E),p&&p.invalidate(),b=bo(e,vn,{}),m=!1},d(E){E&&N(e),Be(n),S&&S.d(E),E&&b&&b.end()}}}const Va=5;function Qa(t,e,n){let{$$slots:r={},$$scope:f}=e,{dmtApp:s}=e,l=1,c=!0;return uo(()=>{const d=setInterval(()=>{n(1,l=l+(c?1:-1)),l==Va&&(c=!1),l==1&&(c=!0)},500);return()=>clearInterval(d)}),t.$$set=d=>{"dmtApp"in d&&n(0,s=d.dmtApp),"$$scope"in d&&n(2,f=d.$$scope)},[s,l,f,r]}class Xa extends dt{constructor(e){super(),ut(this,e,Qa,Ga,at,{dmtApp:0})}}function kf(t,e,n){const r=t.slice();return r[2]=e[n],r}function Rf(t){let e,n=t[1].errors.slice(0,3),r=[];for(let f=0;f<n.length;f+=1)r[f]=Df(kf(t,n,f));return{c(){e=U("div");for(let f=0;f<r.length;f+=1)r[f].c();L(e,"class","errors svelte-173xjbh")},m(f,s){D(f,e,s);for(let l=0;l<r.length;l+=1)r[l].m(e,null)},p(f,s){if(s&2){n=f[1].errors.slice(0,3);let l;for(l=0;l<n.length;l+=1){const c=kf(f,n,l);r[l]?r[l].p(c,s):(r[l]=Df(c),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(f){f&&N(e),Cn(r,f)}}}function Nf(t){let e=t[2].stacktrace+"",n;return{c(){n=K(e)},m(r,f){D(r,n,f)},p(r,f){f&2&&e!==(e=r[2].stacktrace+"")&&Pe(n,e)},d(r){r&&N(n)}}}function Df(t){let e,n,r,f,s,l=t[2].time+"",c,d,h,p=t[2].msg+"",b,m,y,S=t[2].stacktrace&&Nf(t);return{c(){e=U("div"),n=U("div"),r=U("span"),f=K("\u26A0\uFE0F Error at "),s=U("span"),c=K(l),d=J(),h=U("span"),b=K(p),m=J(),S&&S.c(),y=J(),L(s,"class","time svelte-173xjbh"),L(r,"class","title svelte-173xjbh"),L(h,"class","msg svelte-173xjbh"),L(n,"class","header svelte-173xjbh"),L(e,"class","error svelte-173xjbh"),ce(e,"cors_problem",t[2].corsProblem)},m(E,I){D(E,e,I),O(e,n),O(n,r),O(r,f),O(r,s),O(s,c),O(n,d),O(n,h),O(h,b),O(e,m),S&&S.m(e,null),O(e,y)},p(E,I){I&2&&l!==(l=E[2].time+"")&&Pe(c,l),I&2&&p!==(p=E[2].msg+"")&&Pe(b,p),E[2].stacktrace?S?S.p(E,I):(S=Nf(E),S.c(),S.m(e,y)):S&&(S.d(1),S=null),I&2&&ce(e,"cors_problem",E[2].corsProblem)},d(E){E&&N(e),S&&S.d()}}}function eu(t){var r;let e,n=((r=t[1])==null?void 0:r.errors.length)&&Rf(t);return{c(){n&&n.c(),e=xt()},m(f,s){n&&n.m(f,s),D(f,e,s)},p(f,[s]){var l;(l=f[1])!=null&&l.errors.length?n?n.p(f,s):(n=Rf(f),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:xe,o:xe,d(f){n&&n.d(f),f&&N(e)}}}function tu(t,e,n){let r,f=xe,s=()=>(f(),f=Tt(l,c=>n(1,r=c)),l);t.$$.on_destroy.push(()=>f());let{errorStore:l}=e;return s(),t.$$set=c=>{"errorStore"in c&&s(n(0,l=c.errorStore))},[l,r]}class nu extends dt{constructor(e){super(),ut(this,e,tu,eu,at,{errorStore:0})}}function ru({store:t,action:e,payload:n}){console.log(`Action: ${e}`),t.signal("action",{action:e,scope:"player",payload:n})}function iu(t){let e,n;return e=new Xa({props:{dmtApp:"Mobile",$$slots:{default:[su]},$$scope:{ctx:t}}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p(r,f){const s={};f&131072&&(s.$$scope={dirty:f,ctx:r}),e.$set(s)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function fu(t){let e,n,r,f,s,l,c,d,h=(t[2].deviceKey=="ed4f0a8f470b3024f25c60a54cf832584c2c16081f364fabebc77186ae11d626"||t[2].deviceName=="turbine")&&$f(t),p=t[2].network=="zaboric"&&Pf(t),b=t[2].deviceName!="tv-ap2"&&If(t);f=new Co({props:{connected:t[9],device:t[3],nearbyDevices:t[6],deviceName:t[8],activeDeviceKey:t[5],player:t[7]}});let m=t[2].deviceName!="tv-ap2"&&Mf(t);return c=new Cl({props:{connected:t[9],player:t[7],deviceName:t[8],store:t[0],fnAction:t[12]}}),{c(){h&&h.c(),e=J(),p&&p.c(),n=J(),b&&b.c(),r=J(),ze(f.$$.fragment),s=J(),m&&m.c(),l=J(),ze(c.$$.fragment)},m(y,S){h&&h.m(y,S),D(y,e,S),p&&p.m(y,S),D(y,n,S),b&&b.m(y,S),D(y,r,S),je(f,y,S),D(y,s,S),m&&m.m(y,S),D(y,l,S),je(c,y,S),d=!0},p(y,S){y[2].deviceKey=="ed4f0a8f470b3024f25c60a54cf832584c2c16081f364fabebc77186ae11d626"||y[2].deviceName=="turbine"?h?(h.p(y,S),S&4&&ne(h,1)):(h=$f(y),h.c(),ne(h,1),h.m(e.parentNode,e)):h&&(St(),ge(h,1,1,()=>{h=null}),Ot()),y[2].network=="zaboric"?p?(p.p(y,S),S&4&&ne(p,1)):(p=Pf(y),p.c(),ne(p,1),p.m(n.parentNode,n)):p&&(St(),ge(p,1,1,()=>{p=null}),Ot()),y[2].deviceName!="tv-ap2"?b?(b.p(y,S),S&4&&ne(b,1)):(b=If(y),b.c(),ne(b,1),b.m(r.parentNode,r)):b&&(St(),ge(b,1,1,()=>{b=null}),Ot());const E={};S&8&&(E.device=y[3]),S&64&&(E.nearbyDevices=y[6]),S&256&&(E.deviceName=y[8]),S&32&&(E.activeDeviceKey=y[5]),S&128&&(E.player=y[7]),f.$set(E),y[2].deviceName!="tv-ap2"?m?(m.p(y,S),S&4&&ne(m,1)):(m=Mf(y),m.c(),ne(m,1),m.m(l.parentNode,l)):m&&(St(),ge(m,1,1,()=>{m=null}),Ot());const I={};S&128&&(I.player=y[7]),S&256&&(I.deviceName=y[8]),S&1&&(I.store=y[0]),c.$set(I)},i(y){d||(ne(h),ne(p),ne(b),ne(f.$$.fragment,y),ne(m),ne(c.$$.fragment,y),d=!0)},o(y){ge(h),ge(p),ge(b),ge(f.$$.fragment,y),ge(m),ge(c.$$.fragment,y),d=!1},d(y){h&&h.d(y),y&&N(e),p&&p.d(y),y&&N(n),b&&b.d(y),y&&N(r),Be(f,y),y&&N(s),m&&m.d(y),y&&N(l),Be(c,y)}}}function su(t){let e,n;return e=new ks({props:{showLogInitially:!0,limit:20}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p:xe,i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function $f(t){let e,n;return e=new Sa({props:{connector:t[10],localDevice:t[2],nearbyDevices:t[6]}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p(r,f){const s={};f&4&&(s.localDevice=r[2]),f&64&&(s.nearbyDevices=r[6]),e.$set(s)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function Pf(t){let e,n;return e=new $a({props:{connector:t[10]}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p:xe,i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function If(t){let e,n;return e=new La({props:{store:t[0]}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p(r,f){const s={};f&1&&(s.store=r[0]),e.$set(s)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function Mf(t){let e,n;return e=new Nl({props:{nearbyDevices:t[6],activeDeviceKey:t[5],store:t[0],log:t[1]}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p(r,f){const s={};f&64&&(s.nearbyDevices=r[6]),f&32&&(s.activeDeviceKey=r[5]),f&1&&(s.store=r[0]),f&2&&(s.log=r[1]),e.$set(s)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function Uf(t){let e,n;return e=new ks({props:{title:"Connectivity log",limit:200,showLogInitially:!1,$$slots:{default:[ou]},$$scope:{ctx:t}}}),{c(){ze(e.$$.fragment)},m(r,f){je(e,r,f),n=!0},p(r,f){const s={};f&131088&&(s.$$scope={dirty:f,ctx:r}),e.$set(s)},i(r){n||(ne(e.$$.fragment,r),n=!0)},o(r){ge(e.$$.fragment,r),n=!1},d(r){Be(e,r)}}}function ou(t){let e,n,r,f,s,l,c;return{c(){e=U("p"),n=K("Gui active: "),r=U("span"),f=K(t[4]),s=K("s"),l=J(),c=U("span"),c.textContent="[ also indicates that this app is processing events ]",L(r,"class","svelte-gx051d"),L(c,"class","small svelte-gx051d"),L(e,"class","logview_counter svelte-gx051d")},m(d,h){D(d,e,h),O(e,n),O(e,r),O(r,f),O(r,s),O(e,l),O(e,c)},p(d,h){h&16&&Pe(f,d[4])},d(d){d&&N(e)}}}function lu(t){let e,n,r,f,s,l,c;n=new nu({props:{errorStore:ss}});const d=[fu,iu],h=[];function p(m,y){return m[2]?0:1}f=p(t),s=h[f]=d[f](t);let b=t[2]&&Uf(t);return{c(){e=U("main"),ze(n.$$.fragment),r=J(),s.c(),l=J(),b&&b.c(),L(e,"class","svelte-gx051d")},m(m,y){D(m,e,y),je(n,e,null),O(e,r),h[f].m(e,null),O(e,l),b&&b.m(e,null),c=!0},p(m,[y]){let S=f;f=p(m),f===S?h[f].p(m,y):(St(),ge(h[S],1,1,()=>{h[S]=null}),Ot(),s=h[f],s?s.p(m,y):(s=h[f]=d[f](m),s.c()),ne(s,1),s.m(e,l)),m[2]?b?(b.p(m,y),y&4&&ne(b,1)):(b=Uf(m),b.c(),ne(b,1),b.m(e,null)):b&&(St(),ge(b,1,1,()=>{b=null}),Ot())},i(m){c||(ne(n.$$.fragment,m),ne(s),ne(b),c=!0)},o(m){ge(n.$$.fragment,m),ge(s),ge(b),c=!1},d(m){m&&N(e),Be(n),h[f].d(),b&&b.d()}}}function cu(t,e,n){let r,f,s,l,c,d,h,p=xe,b=()=>(p(),p=Tt(y,q=>n(13,h=q)),y),m;t.$$.on_destroy.push(()=>p());let{store:y}=e;b();let{log:S}=e;const{connected:E,localConnector:I}=y,{state:T}=I;yt(t,T,q=>n(14,m=q));function F(q,W){cs(),ru({store:y,action:q,payload:W})}T.subscribe(q=>{var Oe;const W=(Oe=q==null?void 0:q.device)==null?void 0:Oe.network;os.set(["zaboric","borovnjakova"].includes(W))});let oe=0;function j(){n(4,oe+=1),setTimeout(j,1e3)}return j(),t.$$set=q=>{"store"in q&&b(n(0,y=q.store)),"log"in q&&n(1,S=q.log)},t.$$.update=()=>{t.$$.dirty&8192&&n(3,r=h.device),t.$$.dirty&8192&&n(8,f=h.optimisticDeviceName),t.$$.dirty&16384&&n(2,s=m.device),t.$$.dirty&4&&(s==null||s.devMachine),t.$$.dirty&8192&&n(7,l=h.player||{}),t.$$.dirty&8192&&n(6,c=h.nearbyDevices?h.nearbyDevices.filter(q=>q.hasGui).sort(wo("deviceName")):[]),t.$$.dirty&8192&&n(5,d=h.activeDeviceKey)},[y,S,s,r,oe,d,c,l,f,E,I,T,F,h,m]}class au extends dt{constructor(e){super(),ut(this,e,cu,lu,at,{store:0,log:1})}}function uu(){}class $r{constructor(e,n,r){this.prev=e,this.next=n,this.fn=r||uu}run(e){this.fn(e),this.next&&this.next.run(e)}}class du{constructor(e){this.head=new $r,this.tail=new $r(this.head),this.head.next=this.tail,this.linkConstructor=e,this.reg={}}insert(e){const n=new $r(this.tail.prev,this.tail,e);return n.next.prev=n,n.prev.next=n,n}remove(e){e.prev.next=e.next,e.next.prev=e.prev}}let hu=0;class gr{constructor(){this.__events_list={}}on(e,n){const r=this.__events_list[e]||(this.__events_list[e]=new du),f=n._eev||(n._eev=++hu);r.reg[f]||(r.reg[f]=r.insert(n))}off(e,n){if(n){const r=this.__events_list[e];if(!r)return;const f=r.reg[n._eev];r.reg[n._eev]=void 0,r&&f&&r.remove(f)}}removeListener(...e){this.off(...e)}emit(e,n){const r=this.__events_list[e];r&&r.head.run(n)}}class _u extends gr{constructor(e){super(),this.state=e,this.subscriptions=[]}get(){return this.state}subscribe(e){return this.subscriptions.push(e),e(this.state),()=>{this.subscriptions=this.subscriptions.filter(n=>n!==e)}}announceStateChange(){this.subscriptions.forEach(e=>e(this.state))}}class jn extends _u{set(e){this.state=e,this.announceStateChange()}}class pu extends jn{constructor(e={}){super(e)}set(e,{ignore:n=[]}={}){const r={};for(const f of n)r[f]=this.state[f];super.set({...e,...r})}setMerge(e){super.set({...this.state,...e})}clearState({except:e=[]}={}){for(const n of Object.keys(this.state))e.includes(n)||delete this.state[n]}}var bu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Rs(t,e,n){return n={path:e,exports:{},require:function(r,f){return Ns(r,f==null?n.path:f)}},t(n,n.exports),n.exports}function vu(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}),e}function Ns(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var mu={},yu=Object.freeze({__proto__:null,default:mu}),gu=vu(yu),Yt=Rs(function(t){(function(e){var n=function(o){var u,a=new Float64Array(16);if(o)for(u=0;u<o.length;u++)a[u]=o[u];return a},r=function(){throw new Error("no PRNG")},f=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var l=n(),c=n([1]),d=n([56129,1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function S(o,u,a,i){o[u]=a>>24&255,o[u+1]=a>>16&255,o[u+2]=a>>8&255,o[u+3]=a&255,o[u+4]=i>>24&255,o[u+5]=i>>16&255,o[u+6]=i>>8&255,o[u+7]=i&255}function E(o,u,a,i,_){var g,x=0;for(g=0;g<_;g++)x|=o[u+g]^a[i+g];return(1&x-1>>>8)-1}function I(o,u,a,i){return E(o,u,a,i,16)}function T(o,u,a,i){return E(o,u,a,i,32)}function F(o,u,a,i){for(var _=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,k=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,M=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,Q=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,z=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,Te=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,H=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,re=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,ie=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,ue=a[16]&255|(a[17]&255)<<8|(a[18]&255)<<16|(a[19]&255)<<24,ae=a[20]&255|(a[21]&255)<<8|(a[22]&255)<<16|(a[23]&255)<<24,fe=a[24]&255|(a[25]&255)<<8|(a[26]&255)<<16|(a[27]&255)<<24,le=a[28]&255|(a[29]&255)<<8|(a[30]&255)<<16|(a[31]&255)<<24,se=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24,Z=_,X=g,Y=x,G=k,V=M,B=Q,w=z,A=Te,$=H,C=re,R=ie,P=ue,ee=ae,de=fe,_e=le,he=se,v,me=0;me<20;me+=2)v=Z+ee|0,V^=v<<7|v>>>32-7,v=V+Z|0,$^=v<<9|v>>>32-9,v=$+V|0,ee^=v<<13|v>>>32-13,v=ee+$|0,Z^=v<<18|v>>>32-18,v=B+X|0,C^=v<<7|v>>>32-7,v=C+B|0,de^=v<<9|v>>>32-9,v=de+C|0,X^=v<<13|v>>>32-13,v=X+de|0,B^=v<<18|v>>>32-18,v=R+w|0,_e^=v<<7|v>>>32-7,v=_e+R|0,Y^=v<<9|v>>>32-9,v=Y+_e|0,w^=v<<13|v>>>32-13,v=w+Y|0,R^=v<<18|v>>>32-18,v=he+P|0,G^=v<<7|v>>>32-7,v=G+he|0,A^=v<<9|v>>>32-9,v=A+G|0,P^=v<<13|v>>>32-13,v=P+A|0,he^=v<<18|v>>>32-18,v=Z+G|0,X^=v<<7|v>>>32-7,v=X+Z|0,Y^=v<<9|v>>>32-9,v=Y+X|0,G^=v<<13|v>>>32-13,v=G+Y|0,Z^=v<<18|v>>>32-18,v=B+V|0,w^=v<<7|v>>>32-7,v=w+B|0,A^=v<<9|v>>>32-9,v=A+w|0,V^=v<<13|v>>>32-13,v=V+A|0,B^=v<<18|v>>>32-18,v=R+C|0,P^=v<<7|v>>>32-7,v=P+R|0,$^=v<<9|v>>>32-9,v=$+P|0,C^=v<<13|v>>>32-13,v=C+$|0,R^=v<<18|v>>>32-18,v=he+_e|0,ee^=v<<7|v>>>32-7,v=ee+he|0,de^=v<<9|v>>>32-9,v=de+ee|0,_e^=v<<13|v>>>32-13,v=_e+de|0,he^=v<<18|v>>>32-18;Z=Z+_|0,X=X+g|0,Y=Y+x|0,G=G+k|0,V=V+M|0,B=B+Q|0,w=w+z|0,A=A+Te|0,$=$+H|0,C=C+re|0,R=R+ie|0,P=P+ue|0,ee=ee+ae|0,de=de+fe|0,_e=_e+le|0,he=he+se|0,o[0]=Z>>>0&255,o[1]=Z>>>8&255,o[2]=Z>>>16&255,o[3]=Z>>>24&255,o[4]=X>>>0&255,o[5]=X>>>8&255,o[6]=X>>>16&255,o[7]=X>>>24&255,o[8]=Y>>>0&255,o[9]=Y>>>8&255,o[10]=Y>>>16&255,o[11]=Y>>>24&255,o[12]=G>>>0&255,o[13]=G>>>8&255,o[14]=G>>>16&255,o[15]=G>>>24&255,o[16]=V>>>0&255,o[17]=V>>>8&255,o[18]=V>>>16&255,o[19]=V>>>24&255,o[20]=B>>>0&255,o[21]=B>>>8&255,o[22]=B>>>16&255,o[23]=B>>>24&255,o[24]=w>>>0&255,o[25]=w>>>8&255,o[26]=w>>>16&255,o[27]=w>>>24&255,o[28]=A>>>0&255,o[29]=A>>>8&255,o[30]=A>>>16&255,o[31]=A>>>24&255,o[32]=$>>>0&255,o[33]=$>>>8&255,o[34]=$>>>16&255,o[35]=$>>>24&255,o[36]=C>>>0&255,o[37]=C>>>8&255,o[38]=C>>>16&255,o[39]=C>>>24&255,o[40]=R>>>0&255,o[41]=R>>>8&255,o[42]=R>>>16&255,o[43]=R>>>24&255,o[44]=P>>>0&255,o[45]=P>>>8&255,o[46]=P>>>16&255,o[47]=P>>>24&255,o[48]=ee>>>0&255,o[49]=ee>>>8&255,o[50]=ee>>>16&255,o[51]=ee>>>24&255,o[52]=de>>>0&255,o[53]=de>>>8&255,o[54]=de>>>16&255,o[55]=de>>>24&255,o[56]=_e>>>0&255,o[57]=_e>>>8&255,o[58]=_e>>>16&255,o[59]=_e>>>24&255,o[60]=he>>>0&255,o[61]=he>>>8&255,o[62]=he>>>16&255,o[63]=he>>>24&255}function oe(o,u,a,i){for(var _=i[0]&255|(i[1]&255)<<8|(i[2]&255)<<16|(i[3]&255)<<24,g=a[0]&255|(a[1]&255)<<8|(a[2]&255)<<16|(a[3]&255)<<24,x=a[4]&255|(a[5]&255)<<8|(a[6]&255)<<16|(a[7]&255)<<24,k=a[8]&255|(a[9]&255)<<8|(a[10]&255)<<16|(a[11]&255)<<24,M=a[12]&255|(a[13]&255)<<8|(a[14]&255)<<16|(a[15]&255)<<24,Q=i[4]&255|(i[5]&255)<<8|(i[6]&255)<<16|(i[7]&255)<<24,z=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,Te=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,H=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,re=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,ie=i[8]&255|(i[9]&255)<<8|(i[10]&255)<<16|(i[11]&255)<<24,ue=a[16]&255|(a[17]&255)<<8|(a[18]&255)<<16|(a[19]&255)<<24,ae=a[20]&255|(a[21]&255)<<8|(a[22]&255)<<16|(a[23]&255)<<24,fe=a[24]&255|(a[25]&255)<<8|(a[26]&255)<<16|(a[27]&255)<<24,le=a[28]&255|(a[29]&255)<<8|(a[30]&255)<<16|(a[31]&255)<<24,se=i[12]&255|(i[13]&255)<<8|(i[14]&255)<<16|(i[15]&255)<<24,Z=_,X=g,Y=x,G=k,V=M,B=Q,w=z,A=Te,$=H,C=re,R=ie,P=ue,ee=ae,de=fe,_e=le,he=se,v,me=0;me<20;me+=2)v=Z+ee|0,V^=v<<7|v>>>32-7,v=V+Z|0,$^=v<<9|v>>>32-9,v=$+V|0,ee^=v<<13|v>>>32-13,v=ee+$|0,Z^=v<<18|v>>>32-18,v=B+X|0,C^=v<<7|v>>>32-7,v=C+B|0,de^=v<<9|v>>>32-9,v=de+C|0,X^=v<<13|v>>>32-13,v=X+de|0,B^=v<<18|v>>>32-18,v=R+w|0,_e^=v<<7|v>>>32-7,v=_e+R|0,Y^=v<<9|v>>>32-9,v=Y+_e|0,w^=v<<13|v>>>32-13,v=w+Y|0,R^=v<<18|v>>>32-18,v=he+P|0,G^=v<<7|v>>>32-7,v=G+he|0,A^=v<<9|v>>>32-9,v=A+G|0,P^=v<<13|v>>>32-13,v=P+A|0,he^=v<<18|v>>>32-18,v=Z+G|0,X^=v<<7|v>>>32-7,v=X+Z|0,Y^=v<<9|v>>>32-9,v=Y+X|0,G^=v<<13|v>>>32-13,v=G+Y|0,Z^=v<<18|v>>>32-18,v=B+V|0,w^=v<<7|v>>>32-7,v=w+B|0,A^=v<<9|v>>>32-9,v=A+w|0,V^=v<<13|v>>>32-13,v=V+A|0,B^=v<<18|v>>>32-18,v=R+C|0,P^=v<<7|v>>>32-7,v=P+R|0,$^=v<<9|v>>>32-9,v=$+P|0,C^=v<<13|v>>>32-13,v=C+$|0,R^=v<<18|v>>>32-18,v=he+_e|0,ee^=v<<7|v>>>32-7,v=ee+he|0,de^=v<<9|v>>>32-9,v=de+ee|0,_e^=v<<13|v>>>32-13,v=_e+de|0,he^=v<<18|v>>>32-18;o[0]=Z>>>0&255,o[1]=Z>>>8&255,o[2]=Z>>>16&255,o[3]=Z>>>24&255,o[4]=B>>>0&255,o[5]=B>>>8&255,o[6]=B>>>16&255,o[7]=B>>>24&255,o[8]=R>>>0&255,o[9]=R>>>8&255,o[10]=R>>>16&255,o[11]=R>>>24&255,o[12]=he>>>0&255,o[13]=he>>>8&255,o[14]=he>>>16&255,o[15]=he>>>24&255,o[16]=w>>>0&255,o[17]=w>>>8&255,o[18]=w>>>16&255,o[19]=w>>>24&255,o[20]=A>>>0&255,o[21]=A>>>8&255,o[22]=A>>>16&255,o[23]=A>>>24&255,o[24]=$>>>0&255,o[25]=$>>>8&255,o[26]=$>>>16&255,o[27]=$>>>24&255,o[28]=C>>>0&255,o[29]=C>>>8&255,o[30]=C>>>16&255,o[31]=C>>>24&255}function j(o,u,a,i){F(o,u,a,i)}function q(o,u,a,i){oe(o,u,a,i)}var W=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function Oe(o,u,a,i,_,g,x){var k=new Uint8Array(16),M=new Uint8Array(64),Q,z;for(z=0;z<16;z++)k[z]=0;for(z=0;z<8;z++)k[z]=g[z];for(;_>=64;){for(j(M,k,x,W),z=0;z<64;z++)o[u+z]=a[i+z]^M[z];for(Q=1,z=8;z<16;z++)Q=Q+(k[z]&255)|0,k[z]=Q&255,Q>>>=8;_-=64,u+=64,i+=64}if(_>0)for(j(M,k,x,W),z=0;z<_;z++)o[u+z]=a[i+z]^M[z];return 0}function pe(o,u,a,i,_){var g=new Uint8Array(16),x=new Uint8Array(64),k,M;for(M=0;M<16;M++)g[M]=0;for(M=0;M<8;M++)g[M]=i[M];for(;a>=64;){for(j(x,g,_,W),M=0;M<64;M++)o[u+M]=x[M];for(k=1,M=8;M<16;M++)k=k+(g[M]&255)|0,g[M]=k&255,k>>>=8;a-=64,u+=64}if(a>0)for(j(x,g,_,W),M=0;M<a;M++)o[u+M]=x[M];return 0}function ye(o,u,a,i,_){var g=new Uint8Array(32);q(g,i,_,W);for(var x=new Uint8Array(8),k=0;k<8;k++)x[k]=i[k+16];return pe(o,u,a,x,g)}function $e(o,u,a,i,_,g,x){var k=new Uint8Array(32);q(k,g,x,W);for(var M=new Uint8Array(8),Q=0;Q<8;Q++)M[Q]=g[Q+16];return Oe(o,u,a,i,_,M,k)}var ft=function(o){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var u,a,i,_,g,x,k,M;u=o[0]&255|(o[1]&255)<<8,this.r[0]=u&8191,a=o[2]&255|(o[3]&255)<<8,this.r[1]=(u>>>13|a<<3)&8191,i=o[4]&255|(o[5]&255)<<8,this.r[2]=(a>>>10|i<<6)&7939,_=o[6]&255|(o[7]&255)<<8,this.r[3]=(i>>>7|_<<9)&8191,g=o[8]&255|(o[9]&255)<<8,this.r[4]=(_>>>4|g<<12)&255,this.r[5]=g>>>1&8190,x=o[10]&255|(o[11]&255)<<8,this.r[6]=(g>>>14|x<<2)&8191,k=o[12]&255|(o[13]&255)<<8,this.r[7]=(x>>>11|k<<5)&8065,M=o[14]&255|(o[15]&255)<<8,this.r[8]=(k>>>8|M<<8)&8191,this.r[9]=M>>>5&127,this.pad[0]=o[16]&255|(o[17]&255)<<8,this.pad[1]=o[18]&255|(o[19]&255)<<8,this.pad[2]=o[20]&255|(o[21]&255)<<8,this.pad[3]=o[22]&255|(o[23]&255)<<8,this.pad[4]=o[24]&255|(o[25]&255)<<8,this.pad[5]=o[26]&255|(o[27]&255)<<8,this.pad[6]=o[28]&255|(o[29]&255)<<8,this.pad[7]=o[30]&255|(o[31]&255)<<8};ft.prototype.blocks=function(o,u,a){for(var i=this.fin?0:2048,_,g,x,k,M,Q,z,Te,H,re,ie,ue,ae,fe,le,se,Z,X,Y,G=this.h[0],V=this.h[1],B=this.h[2],w=this.h[3],A=this.h[4],$=this.h[5],C=this.h[6],R=this.h[7],P=this.h[8],ee=this.h[9],de=this.r[0],_e=this.r[1],he=this.r[2],v=this.r[3],me=this.r[4],Ce=this.r[5],ke=this.r[6],ve=this.r[7],Ee=this.r[8],Se=this.r[9];a>=16;)_=o[u+0]&255|(o[u+1]&255)<<8,G+=_&8191,g=o[u+2]&255|(o[u+3]&255)<<8,V+=(_>>>13|g<<3)&8191,x=o[u+4]&255|(o[u+5]&255)<<8,B+=(g>>>10|x<<6)&8191,k=o[u+6]&255|(o[u+7]&255)<<8,w+=(x>>>7|k<<9)&8191,M=o[u+8]&255|(o[u+9]&255)<<8,A+=(k>>>4|M<<12)&8191,$+=M>>>1&8191,Q=o[u+10]&255|(o[u+11]&255)<<8,C+=(M>>>14|Q<<2)&8191,z=o[u+12]&255|(o[u+13]&255)<<8,R+=(Q>>>11|z<<5)&8191,Te=o[u+14]&255|(o[u+15]&255)<<8,P+=(z>>>8|Te<<8)&8191,ee+=Te>>>5|i,H=0,re=H,re+=G*de,re+=V*(5*Se),re+=B*(5*Ee),re+=w*(5*ve),re+=A*(5*ke),H=re>>>13,re&=8191,re+=$*(5*Ce),re+=C*(5*me),re+=R*(5*v),re+=P*(5*he),re+=ee*(5*_e),H+=re>>>13,re&=8191,ie=H,ie+=G*_e,ie+=V*de,ie+=B*(5*Se),ie+=w*(5*Ee),ie+=A*(5*ve),H=ie>>>13,ie&=8191,ie+=$*(5*ke),ie+=C*(5*Ce),ie+=R*(5*me),ie+=P*(5*v),ie+=ee*(5*he),H+=ie>>>13,ie&=8191,ue=H,ue+=G*he,ue+=V*_e,ue+=B*de,ue+=w*(5*Se),ue+=A*(5*Ee),H=ue>>>13,ue&=8191,ue+=$*(5*ve),ue+=C*(5*ke),ue+=R*(5*Ce),ue+=P*(5*me),ue+=ee*(5*v),H+=ue>>>13,ue&=8191,ae=H,ae+=G*v,ae+=V*he,ae+=B*_e,ae+=w*de,ae+=A*(5*Se),H=ae>>>13,ae&=8191,ae+=$*(5*Ee),ae+=C*(5*ve),ae+=R*(5*ke),ae+=P*(5*Ce),ae+=ee*(5*me),H+=ae>>>13,ae&=8191,fe=H,fe+=G*me,fe+=V*v,fe+=B*he,fe+=w*_e,fe+=A*de,H=fe>>>13,fe&=8191,fe+=$*(5*Se),fe+=C*(5*Ee),fe+=R*(5*ve),fe+=P*(5*ke),fe+=ee*(5*Ce),H+=fe>>>13,fe&=8191,le=H,le+=G*Ce,le+=V*me,le+=B*v,le+=w*he,le+=A*_e,H=le>>>13,le&=8191,le+=$*de,le+=C*(5*Se),le+=R*(5*Ee),le+=P*(5*ve),le+=ee*(5*ke),H+=le>>>13,le&=8191,se=H,se+=G*ke,se+=V*Ce,se+=B*me,se+=w*v,se+=A*he,H=se>>>13,se&=8191,se+=$*_e,se+=C*de,se+=R*(5*Se),se+=P*(5*Ee),se+=ee*(5*ve),H+=se>>>13,se&=8191,Z=H,Z+=G*ve,Z+=V*ke,Z+=B*Ce,Z+=w*me,Z+=A*v,H=Z>>>13,Z&=8191,Z+=$*he,Z+=C*_e,Z+=R*de,Z+=P*(5*Se),Z+=ee*(5*Ee),H+=Z>>>13,Z&=8191,X=H,X+=G*Ee,X+=V*ve,X+=B*ke,X+=w*Ce,X+=A*me,H=X>>>13,X&=8191,X+=$*v,X+=C*he,X+=R*_e,X+=P*de,X+=ee*(5*Se),H+=X>>>13,X&=8191,Y=H,Y+=G*Se,Y+=V*Ee,Y+=B*ve,Y+=w*ke,Y+=A*Ce,H=Y>>>13,Y&=8191,Y+=$*me,Y+=C*v,Y+=R*he,Y+=P*_e,Y+=ee*de,H+=Y>>>13,Y&=8191,H=(H<<2)+H|0,H=H+re|0,re=H&8191,H=H>>>13,ie+=H,G=re,V=ie,B=ue,w=ae,A=fe,$=le,C=se,R=Z,P=X,ee=Y,u+=16,a-=16;this.h[0]=G,this.h[1]=V,this.h[2]=B,this.h[3]=w,this.h[4]=A,this.h[5]=$,this.h[6]=C,this.h[7]=R,this.h[8]=P,this.h[9]=ee},ft.prototype.finish=function(o,u){var a=new Uint16Array(10),i,_,g,x;if(this.leftover){for(x=this.leftover,this.buffer[x++]=1;x<16;x++)this.buffer[x]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(i=this.h[1]>>>13,this.h[1]&=8191,x=2;x<10;x++)this.h[x]+=i,i=this.h[x]>>>13,this.h[x]&=8191;for(this.h[0]+=i*5,i=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=i,i=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=i,a[0]=this.h[0]+5,i=a[0]>>>13,a[0]&=8191,x=1;x<10;x++)a[x]=this.h[x]+i,i=a[x]>>>13,a[x]&=8191;for(a[9]-=1<<13,_=(i^1)-1,x=0;x<10;x++)a[x]&=_;for(_=~_,x=0;x<10;x++)this.h[x]=this.h[x]&_|a[x];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,g=this.h[0]+this.pad[0],this.h[0]=g&65535,x=1;x<8;x++)g=(this.h[x]+this.pad[x]|0)+(g>>>16)|0,this.h[x]=g&65535;o[u+0]=this.h[0]>>>0&255,o[u+1]=this.h[0]>>>8&255,o[u+2]=this.h[1]>>>0&255,o[u+3]=this.h[1]>>>8&255,o[u+4]=this.h[2]>>>0&255,o[u+5]=this.h[2]>>>8&255,o[u+6]=this.h[3]>>>0&255,o[u+7]=this.h[3]>>>8&255,o[u+8]=this.h[4]>>>0&255,o[u+9]=this.h[4]>>>8&255,o[u+10]=this.h[5]>>>0&255,o[u+11]=this.h[5]>>>8&255,o[u+12]=this.h[6]>>>0&255,o[u+13]=this.h[6]>>>8&255,o[u+14]=this.h[7]>>>0&255,o[u+15]=this.h[7]>>>8&255},ft.prototype.update=function(o,u,a){var i,_;if(this.leftover){for(_=16-this.leftover,_>a&&(_=a),i=0;i<_;i++)this.buffer[this.leftover+i]=o[u+i];if(a-=_,u+=_,this.leftover+=_,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(a>=16&&(_=a-a%16,this.blocks(o,u,_),u+=_,a-=_),a){for(i=0;i<a;i++)this.buffer[this.leftover+i]=o[u+i];this.leftover+=a}};function Je(o,u,a,i,_,g){var x=new ft(g);return x.update(a,i,_),x.finish(o,u),0}function ct(o,u,a,i,_,g){var x=new Uint8Array(16);return Je(x,0,a,i,_,g),I(o,u,x,0)}function Ae(o,u,a,i,_){var g;if(a<32)return-1;for($e(o,0,u,0,a,i,_),Je(o,16,o,32,a-32,o),g=0;g<16;g++)o[g]=0;return 0}function We(o,u,a,i,_){var g,x=new Uint8Array(32);if(a<32||(ye(x,0,32,i,_),ct(u,16,u,32,a-32,x)!==0))return-1;for($e(o,0,u,0,a,i,_),g=0;g<32;g++)o[g]=0;return 0}function Fe(o,u){var a;for(a=0;a<16;a++)o[a]=u[a]|0}function ht(o){var u,a,i=1;for(u=0;u<16;u++)a=o[u]+i+65535,i=Math.floor(a/65536),o[u]=a-i*65536;o[0]+=i-1+37*(i-1)}function st(o,u,a){for(var i,_=~(a-1),g=0;g<16;g++)i=_&(o[g]^u[g]),o[g]^=i,u[g]^=i}function we(o,u){var a,i,_,g=n(),x=n();for(a=0;a<16;a++)x[a]=u[a];for(ht(x),ht(x),ht(x),i=0;i<2;i++){for(g[0]=x[0]-65517,a=1;a<15;a++)g[a]=x[a]-65535-(g[a-1]>>16&1),g[a-1]&=65535;g[15]=x[15]-32767-(g[14]>>16&1),_=g[15]>>16&1,g[14]&=65535,st(x,g,1-_)}for(a=0;a<16;a++)o[2*a]=x[a]&255,o[2*a+1]=x[a]>>8}function qe(o,u){var a=new Uint8Array(32),i=new Uint8Array(32);return we(a,o),we(i,u),T(a,0,i,0)}function Ct(o){var u=new Uint8Array(32);return we(u,o),u[0]&1}function wt(o,u){var a;for(a=0;a<16;a++)o[a]=u[2*a]+(u[2*a+1]<<8);o[15]&=32767}function He(o,u,a){for(var i=0;i<16;i++)o[i]=u[i]+a[i]}function Xe(o,u,a){for(var i=0;i<16;i++)o[i]=u[i]-a[i]}function be(o,u,a){var i,_,g=0,x=0,k=0,M=0,Q=0,z=0,Te=0,H=0,re=0,ie=0,ue=0,ae=0,fe=0,le=0,se=0,Z=0,X=0,Y=0,G=0,V=0,B=0,w=0,A=0,$=0,C=0,R=0,P=0,ee=0,de=0,_e=0,he=0,v=a[0],me=a[1],Ce=a[2],ke=a[3],ve=a[4],Ee=a[5],Se=a[6],Ke=a[7],De=a[8],Me=a[9],Ue=a[10],Le=a[11],Ye=a[12],Ge=a[13],Ve=a[14],Qe=a[15];i=u[0],g+=i*v,x+=i*me,k+=i*Ce,M+=i*ke,Q+=i*ve,z+=i*Ee,Te+=i*Se,H+=i*Ke,re+=i*De,ie+=i*Me,ue+=i*Ue,ae+=i*Le,fe+=i*Ye,le+=i*Ge,se+=i*Ve,Z+=i*Qe,i=u[1],x+=i*v,k+=i*me,M+=i*Ce,Q+=i*ke,z+=i*ve,Te+=i*Ee,H+=i*Se,re+=i*Ke,ie+=i*De,ue+=i*Me,ae+=i*Ue,fe+=i*Le,le+=i*Ye,se+=i*Ge,Z+=i*Ve,X+=i*Qe,i=u[2],k+=i*v,M+=i*me,Q+=i*Ce,z+=i*ke,Te+=i*ve,H+=i*Ee,re+=i*Se,ie+=i*Ke,ue+=i*De,ae+=i*Me,fe+=i*Ue,le+=i*Le,se+=i*Ye,Z+=i*Ge,X+=i*Ve,Y+=i*Qe,i=u[3],M+=i*v,Q+=i*me,z+=i*Ce,Te+=i*ke,H+=i*ve,re+=i*Ee,ie+=i*Se,ue+=i*Ke,ae+=i*De,fe+=i*Me,le+=i*Ue,se+=i*Le,Z+=i*Ye,X+=i*Ge,Y+=i*Ve,G+=i*Qe,i=u[4],Q+=i*v,z+=i*me,Te+=i*Ce,H+=i*ke,re+=i*ve,ie+=i*Ee,ue+=i*Se,ae+=i*Ke,fe+=i*De,le+=i*Me,se+=i*Ue,Z+=i*Le,X+=i*Ye,Y+=i*Ge,G+=i*Ve,V+=i*Qe,i=u[5],z+=i*v,Te+=i*me,H+=i*Ce,re+=i*ke,ie+=i*ve,ue+=i*Ee,ae+=i*Se,fe+=i*Ke,le+=i*De,se+=i*Me,Z+=i*Ue,X+=i*Le,Y+=i*Ye,G+=i*Ge,V+=i*Ve,B+=i*Qe,i=u[6],Te+=i*v,H+=i*me,re+=i*Ce,ie+=i*ke,ue+=i*ve,ae+=i*Ee,fe+=i*Se,le+=i*Ke,se+=i*De,Z+=i*Me,X+=i*Ue,Y+=i*Le,G+=i*Ye,V+=i*Ge,B+=i*Ve,w+=i*Qe,i=u[7],H+=i*v,re+=i*me,ie+=i*Ce,ue+=i*ke,ae+=i*ve,fe+=i*Ee,le+=i*Se,se+=i*Ke,Z+=i*De,X+=i*Me,Y+=i*Ue,G+=i*Le,V+=i*Ye,B+=i*Ge,w+=i*Ve,A+=i*Qe,i=u[8],re+=i*v,ie+=i*me,ue+=i*Ce,ae+=i*ke,fe+=i*ve,le+=i*Ee,se+=i*Se,Z+=i*Ke,X+=i*De,Y+=i*Me,G+=i*Ue,V+=i*Le,B+=i*Ye,w+=i*Ge,A+=i*Ve,$+=i*Qe,i=u[9],ie+=i*v,ue+=i*me,ae+=i*Ce,fe+=i*ke,le+=i*ve,se+=i*Ee,Z+=i*Se,X+=i*Ke,Y+=i*De,G+=i*Me,V+=i*Ue,B+=i*Le,w+=i*Ye,A+=i*Ge,$+=i*Ve,C+=i*Qe,i=u[10],ue+=i*v,ae+=i*me,fe+=i*Ce,le+=i*ke,se+=i*ve,Z+=i*Ee,X+=i*Se,Y+=i*Ke,G+=i*De,V+=i*Me,B+=i*Ue,w+=i*Le,A+=i*Ye,$+=i*Ge,C+=i*Ve,R+=i*Qe,i=u[11],ae+=i*v,fe+=i*me,le+=i*Ce,se+=i*ke,Z+=i*ve,X+=i*Ee,Y+=i*Se,G+=i*Ke,V+=i*De,B+=i*Me,w+=i*Ue,A+=i*Le,$+=i*Ye,C+=i*Ge,R+=i*Ve,P+=i*Qe,i=u[12],fe+=i*v,le+=i*me,se+=i*Ce,Z+=i*ke,X+=i*ve,Y+=i*Ee,G+=i*Se,V+=i*Ke,B+=i*De,w+=i*Me,A+=i*Ue,$+=i*Le,C+=i*Ye,R+=i*Ge,P+=i*Ve,ee+=i*Qe,i=u[13],le+=i*v,se+=i*me,Z+=i*Ce,X+=i*ke,Y+=i*ve,G+=i*Ee,V+=i*Se,B+=i*Ke,w+=i*De,A+=i*Me,$+=i*Ue,C+=i*Le,R+=i*Ye,P+=i*Ge,ee+=i*Ve,de+=i*Qe,i=u[14],se+=i*v,Z+=i*me,X+=i*Ce,Y+=i*ke,G+=i*ve,V+=i*Ee,B+=i*Se,w+=i*Ke,A+=i*De,$+=i*Me,C+=i*Ue,R+=i*Le,P+=i*Ye,ee+=i*Ge,de+=i*Ve,_e+=i*Qe,i=u[15],Z+=i*v,X+=i*me,Y+=i*Ce,G+=i*ke,V+=i*ve,B+=i*Ee,w+=i*Se,A+=i*Ke,$+=i*De,C+=i*Me,R+=i*Ue,P+=i*Le,ee+=i*Ye,de+=i*Ge,_e+=i*Ve,he+=i*Qe,g+=38*X,x+=38*Y,k+=38*G,M+=38*V,Q+=38*B,z+=38*w,Te+=38*A,H+=38*$,re+=38*C,ie+=38*R,ue+=38*P,ae+=38*ee,fe+=38*de,le+=38*_e,se+=38*he,_=1,i=g+_+65535,_=Math.floor(i/65536),g=i-_*65536,i=x+_+65535,_=Math.floor(i/65536),x=i-_*65536,i=k+_+65535,_=Math.floor(i/65536),k=i-_*65536,i=M+_+65535,_=Math.floor(i/65536),M=i-_*65536,i=Q+_+65535,_=Math.floor(i/65536),Q=i-_*65536,i=z+_+65535,_=Math.floor(i/65536),z=i-_*65536,i=Te+_+65535,_=Math.floor(i/65536),Te=i-_*65536,i=H+_+65535,_=Math.floor(i/65536),H=i-_*65536,i=re+_+65535,_=Math.floor(i/65536),re=i-_*65536,i=ie+_+65535,_=Math.floor(i/65536),ie=i-_*65536,i=ue+_+65535,_=Math.floor(i/65536),ue=i-_*65536,i=ae+_+65535,_=Math.floor(i/65536),ae=i-_*65536,i=fe+_+65535,_=Math.floor(i/65536),fe=i-_*65536,i=le+_+65535,_=Math.floor(i/65536),le=i-_*65536,i=se+_+65535,_=Math.floor(i/65536),se=i-_*65536,i=Z+_+65535,_=Math.floor(i/65536),Z=i-_*65536,g+=_-1+37*(_-1),_=1,i=g+_+65535,_=Math.floor(i/65536),g=i-_*65536,i=x+_+65535,_=Math.floor(i/65536),x=i-_*65536,i=k+_+65535,_=Math.floor(i/65536),k=i-_*65536,i=M+_+65535,_=Math.floor(i/65536),M=i-_*65536,i=Q+_+65535,_=Math.floor(i/65536),Q=i-_*65536,i=z+_+65535,_=Math.floor(i/65536),z=i-_*65536,i=Te+_+65535,_=Math.floor(i/65536),Te=i-_*65536,i=H+_+65535,_=Math.floor(i/65536),H=i-_*65536,i=re+_+65535,_=Math.floor(i/65536),re=i-_*65536,i=ie+_+65535,_=Math.floor(i/65536),ie=i-_*65536,i=ue+_+65535,_=Math.floor(i/65536),ue=i-_*65536,i=ae+_+65535,_=Math.floor(i/65536),ae=i-_*65536,i=fe+_+65535,_=Math.floor(i/65536),fe=i-_*65536,i=le+_+65535,_=Math.floor(i/65536),le=i-_*65536,i=se+_+65535,_=Math.floor(i/65536),se=i-_*65536,i=Z+_+65535,_=Math.floor(i/65536),Z=i-_*65536,g+=_-1+37*(_-1),o[0]=g,o[1]=x,o[2]=k,o[3]=M,o[4]=Q,o[5]=z,o[6]=Te,o[7]=H,o[8]=re,o[9]=ie,o[10]=ue,o[11]=ae,o[12]=fe,o[13]=le,o[14]=se,o[15]=Z}function Ze(o,u){be(o,u,u)}function At(o,u){var a=n(),i;for(i=0;i<16;i++)a[i]=u[i];for(i=253;i>=0;i--)Ze(a,a),i!==2&&i!==4&&be(a,a,u);for(i=0;i<16;i++)o[i]=a[i]}function Ht(o,u){var a=n(),i;for(i=0;i<16;i++)a[i]=u[i];for(i=250;i>=0;i--)Ze(a,a),i!==1&&be(a,a,u);for(i=0;i<16;i++)o[i]=a[i]}function bt(o,u,a){var i=new Uint8Array(32),_=new Float64Array(80),g,x,k=n(),M=n(),Q=n(),z=n(),Te=n(),H=n();for(x=0;x<31;x++)i[x]=u[x];for(i[31]=u[31]&127|64,i[0]&=248,wt(_,a),x=0;x<16;x++)M[x]=_[x],z[x]=k[x]=Q[x]=0;for(k[0]=z[0]=1,x=254;x>=0;--x)g=i[x>>>3]>>>(x&7)&1,st(k,M,g),st(Q,z,g),He(Te,k,Q),Xe(k,k,Q),He(Q,M,z),Xe(M,M,z),Ze(z,Te),Ze(H,k),be(k,Q,k),be(Q,M,Te),He(Te,k,Q),Xe(k,k,Q),Ze(M,k),Xe(Q,z,H),be(k,Q,d),He(k,k,z),be(Q,Q,k),be(k,z,H),be(z,M,_),Ze(M,Te),st(k,M,g),st(Q,z,g);for(x=0;x<16;x++)_[x+16]=k[x],_[x+32]=Q[x],_[x+48]=M[x],_[x+64]=z[x];var re=_.subarray(32),ie=_.subarray(16);return At(re,re),be(ie,ie,re),we(o,ie),0}function Nt(o,u){return bt(o,u,s)}function Ut(o,u){return r(u,32),Nt(o,u)}function kt(o,u,a){var i=new Uint8Array(32);return bt(i,a,u),q(o,f,i,W)}var Xt=Ae,dn=We;function en(o,u,a,i,_,g){var x=new Uint8Array(32);return kt(x,_,g),Xt(o,u,a,i,x)}function Et(o,u,a,i,_,g){var x=new Uint8Array(32);return kt(x,_,g),dn(o,u,a,i,x)}var tn=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Lt(o,u,a,i){for(var _=new Int32Array(16),g=new Int32Array(16),x,k,M,Q,z,Te,H,re,ie,ue,ae,fe,le,se,Z,X,Y,G,V,B,w,A,$,C,R,P,ee=o[0],de=o[1],_e=o[2],he=o[3],v=o[4],me=o[5],Ce=o[6],ke=o[7],ve=u[0],Ee=u[1],Se=u[2],Ke=u[3],De=u[4],Me=u[5],Ue=u[6],Le=u[7],Ye=0;i>=128;){for(V=0;V<16;V++)B=8*V+Ye,_[V]=a[B+0]<<24|a[B+1]<<16|a[B+2]<<8|a[B+3],g[V]=a[B+4]<<24|a[B+5]<<16|a[B+6]<<8|a[B+7];for(V=0;V<80;V++)if(x=ee,k=de,M=_e,Q=he,z=v,Te=me,H=Ce,re=ke,ie=ve,ue=Ee,ae=Se,fe=Ke,le=De,se=Me,Z=Ue,X=Le,w=ke,A=Le,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=(v>>>14|De<<32-14)^(v>>>18|De<<32-18)^(De>>>41-32|v<<32-(41-32)),A=(De>>>14|v<<32-14)^(De>>>18|v<<32-18)^(v>>>41-32|De<<32-(41-32)),$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,w=v&me^~v&Ce,A=De&Me^~De&Ue,$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,w=tn[V*2],A=tn[V*2+1],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,w=_[V%16],A=g[V%16],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,Y=R&65535|P<<16,G=$&65535|C<<16,w=Y,A=G,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=(ee>>>28|ve<<32-28)^(ve>>>34-32|ee<<32-(34-32))^(ve>>>39-32|ee<<32-(39-32)),A=(ve>>>28|ee<<32-28)^(ee>>>34-32|ve<<32-(34-32))^(ee>>>39-32|ve<<32-(39-32)),$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,w=ee&de^ee&_e^de&_e,A=ve&Ee^ve&Se^Ee&Se,$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,re=R&65535|P<<16,X=$&65535|C<<16,w=Q,A=fe,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=Y,A=G,$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,Q=R&65535|P<<16,fe=$&65535|C<<16,de=x,_e=k,he=M,v=Q,me=z,Ce=Te,ke=H,ee=re,Ee=ie,Se=ue,Ke=ae,De=fe,Me=le,Ue=se,Le=Z,ve=X,V%16===15)for(B=0;B<16;B++)w=_[B],A=g[B],$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=_[(B+9)%16],A=g[(B+9)%16],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,Y=_[(B+1)%16],G=g[(B+1)%16],w=(Y>>>1|G<<32-1)^(Y>>>8|G<<32-8)^Y>>>7,A=(G>>>1|Y<<32-1)^(G>>>8|Y<<32-8)^(G>>>7|Y<<32-7),$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,Y=_[(B+14)%16],G=g[(B+14)%16],w=(Y>>>19|G<<32-19)^(G>>>61-32|Y<<32-(61-32))^Y>>>6,A=(G>>>19|Y<<32-19)^(Y>>>61-32|G<<32-(61-32))^(G>>>6|Y<<32-6),$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,_[B]=R&65535|P<<16,g[B]=$&65535|C<<16;w=ee,A=ve,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[0],A=u[0],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[0]=ee=R&65535|P<<16,u[0]=ve=$&65535|C<<16,w=de,A=Ee,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[1],A=u[1],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[1]=de=R&65535|P<<16,u[1]=Ee=$&65535|C<<16,w=_e,A=Se,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[2],A=u[2],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[2]=_e=R&65535|P<<16,u[2]=Se=$&65535|C<<16,w=he,A=Ke,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[3],A=u[3],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[3]=he=R&65535|P<<16,u[3]=Ke=$&65535|C<<16,w=v,A=De,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[4],A=u[4],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[4]=v=R&65535|P<<16,u[4]=De=$&65535|C<<16,w=me,A=Me,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[5],A=u[5],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[5]=me=R&65535|P<<16,u[5]=Me=$&65535|C<<16,w=Ce,A=Ue,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[6],A=u[6],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[6]=Ce=R&65535|P<<16,u[6]=Ue=$&65535|C<<16,w=ke,A=Le,$=A&65535,C=A>>>16,R=w&65535,P=w>>>16,w=o[7],A=u[7],$+=A&65535,C+=A>>>16,R+=w&65535,P+=w>>>16,C+=$>>>16,R+=C>>>16,P+=R>>>16,o[7]=ke=R&65535|P<<16,u[7]=Le=$&65535|C<<16,Ye+=128,i-=128}return i}function nt(o,u,a){var i=new Int32Array(8),_=new Int32Array(8),g=new Uint8Array(256),x,k=a;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,_[0]=4089235720,_[1]=2227873595,_[2]=4271175723,_[3]=1595750129,_[4]=2917565137,_[5]=725511199,_[6]=4215389547,_[7]=327033209,Lt(i,_,u,a),a%=128,x=0;x<a;x++)g[x]=u[k-a+x];for(g[a]=128,a=256-128*(a<112?1:0),g[a-9]=0,S(g,a-8,k/536870912|0,k<<3),Lt(i,_,g,a),x=0;x<8;x++)S(o,8*x,i[x],_[x]);return 0}function it(o,u){var a=n(),i=n(),_=n(),g=n(),x=n(),k=n(),M=n(),Q=n(),z=n();Xe(a,o[1],o[0]),Xe(z,u[1],u[0]),be(a,a,z),He(i,o[0],o[1]),He(z,u[0],u[1]),be(i,i,z),be(_,o[3],u[3]),be(_,_,p),be(g,o[2],u[2]),He(g,g,g),Xe(x,i,a),Xe(k,g,_),He(M,g,_),He(Q,i,a),be(o[0],x,k),be(o[1],Q,M),be(o[2],M,k),be(o[3],x,Q)}function ot(o,u,a){var i;for(i=0;i<4;i++)st(o[i],u[i],a)}function jt(o,u){var a=n(),i=n(),_=n();At(_,u[2]),be(a,u[0],_),be(i,u[1],_),we(o,i),o[31]^=Ct(a)<<7}function te(o,u,a){var i,_;for(Fe(o[0],l),Fe(o[1],c),Fe(o[2],c),Fe(o[3],l),_=255;_>=0;--_)i=a[_/8|0]>>(_&7)&1,ot(o,u,i),it(u,o),it(o,o),ot(o,u,i)}function Ne(o,u){var a=[n(),n(),n(),n()];Fe(a[0],b),Fe(a[1],m),Fe(a[2],c),be(a[3],b,m),te(o,a,u)}function Bt(o,u,a){var i=new Uint8Array(64),_=[n(),n(),n(),n()],g;for(a||r(u,32),nt(i,u,32),i[0]&=248,i[31]&=127,i[31]|=64,Ne(_,i),jt(o,_),g=0;g<32;g++)u[g+32]=o[g];return 0}var Jt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Ie(o,u){var a,i,_,g;for(i=63;i>=32;--i){for(a=0,_=i-32,g=i-12;_<g;++_)u[_]+=a-16*u[i]*Jt[_-(i-32)],a=Math.floor((u[_]+128)/256),u[_]-=a*256;u[_]+=a,u[i]=0}for(a=0,_=0;_<32;_++)u[_]+=a-(u[31]>>4)*Jt[_],a=u[_]>>8,u[_]&=255;for(_=0;_<32;_++)u[_]-=a*Jt[_];for(i=0;i<32;i++)u[i+1]+=u[i]>>8,o[i]=u[i]&255}function lt(o){var u=new Float64Array(64),a;for(a=0;a<64;a++)u[a]=o[a];for(a=0;a<64;a++)o[a]=0;Ie(o,u)}function hn(o,u,a,i){var _=new Uint8Array(64),g=new Uint8Array(64),x=new Uint8Array(64),k,M,Q=new Float64Array(64),z=[n(),n(),n(),n()];nt(_,i,32),_[0]&=248,_[31]&=127,_[31]|=64;var Te=a+64;for(k=0;k<a;k++)o[64+k]=u[k];for(k=0;k<32;k++)o[32+k]=_[32+k];for(nt(x,o.subarray(32),a+32),lt(x),Ne(z,x),jt(o,z),k=32;k<64;k++)o[k]=i[k];for(nt(g,o,a+64),lt(g),k=0;k<64;k++)Q[k]=0;for(k=0;k<32;k++)Q[k]=x[k];for(k=0;k<32;k++)for(M=0;M<32;M++)Q[k+M]+=g[k]*_[M];return Ie(o.subarray(32),Q),Te}function Nn(o,u){var a=n(),i=n(),_=n(),g=n(),x=n(),k=n(),M=n();return Fe(o[2],c),wt(o[1],u),Ze(_,o[1]),be(g,_,h),Xe(_,_,o[2]),He(g,o[2],g),Ze(x,g),Ze(k,x),be(M,k,x),be(a,M,_),be(a,a,g),Ht(a,a),be(a,a,_),be(a,a,g),be(a,a,g),be(o[0],a,g),Ze(i,o[0]),be(i,i,g),qe(i,_)&&be(o[0],o[0],y),Ze(i,o[0]),be(i,i,g),qe(i,_)?-1:(Ct(o[0])===u[31]>>7&&Xe(o[0],l,o[0]),be(o[3],o[0],o[1]),0)}function nn(o,u,a,i){var _,g=new Uint8Array(32),x=new Uint8Array(64),k=[n(),n(),n(),n()],M=[n(),n(),n(),n()];if(a<64||Nn(M,i))return-1;for(_=0;_<a;_++)o[_]=u[_];for(_=0;_<32;_++)o[_+32]=i[_];if(nt(x,o,a),lt(x),te(k,M,x),Ne(M,u.subarray(32)),it(k,M),jt(g,k),a-=64,T(u,0,g,0)){for(_=0;_<a;_++)o[_]=0;return-1}for(_=0;_<a;_++)o[_]=u[_+64];return a}var mn=32,rn=24,Wt=32,$t=16,Zt=32,fn=32,Gt=32,Vt=32,yn=32,zn=rn,wr=Wt,Ar=$t,mt=64,Rt=32,Pt=64,gn=32,xn=64;e.lowlevel={crypto_core_hsalsa20:q,crypto_stream_xor:$e,crypto_stream:ye,crypto_stream_salsa20_xor:Oe,crypto_stream_salsa20:pe,crypto_onetimeauth:Je,crypto_onetimeauth_verify:ct,crypto_verify_16:I,crypto_verify_32:T,crypto_secretbox:Ae,crypto_secretbox_open:We,crypto_scalarmult:bt,crypto_scalarmult_base:Nt,crypto_box_beforenm:kt,crypto_box_afternm:Xt,crypto_box:en,crypto_box_open:Et,crypto_box_keypair:Ut,crypto_hash:nt,crypto_sign:hn,crypto_sign_keypair:Bt,crypto_sign_open:nn,crypto_secretbox_KEYBYTES:mn,crypto_secretbox_NONCEBYTES:rn,crypto_secretbox_ZEROBYTES:Wt,crypto_secretbox_BOXZEROBYTES:$t,crypto_scalarmult_BYTES:Zt,crypto_scalarmult_SCALARBYTES:fn,crypto_box_PUBLICKEYBYTES:Gt,crypto_box_SECRETKEYBYTES:Vt,crypto_box_BEFORENMBYTES:yn,crypto_box_NONCEBYTES:zn,crypto_box_ZEROBYTES:wr,crypto_box_BOXZEROBYTES:Ar,crypto_sign_BYTES:mt,crypto_sign_PUBLICKEYBYTES:Rt,crypto_sign_SECRETKEYBYTES:Pt,crypto_sign_SEEDBYTES:gn,crypto_hash_BYTES:xn,gf:n,D:h,L:Jt,pack25519:we,unpack25519:wt,M:be,A:He,S:Ze,Z:Xe,pow2523:Ht,add:it,set25519:Fe,modL:Ie,scalarmult:te,scalarbase:Ne};function qn(o,u){if(o.length!==mn)throw new Error("bad key size");if(u.length!==rn)throw new Error("bad nonce size")}function Er(o,u){if(o.length!==Gt)throw new Error("bad public key size");if(u.length!==Vt)throw new Error("bad secret key size")}function rt(){for(var o=0;o<arguments.length;o++)if(!(arguments[o]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Yn(o){for(var u=0;u<o.length;u++)o[u]=0}e.randomBytes=function(o){var u=new Uint8Array(o);return r(u,o),u},e.secretbox=function(o,u,a){rt(o,u,a),qn(a,u);for(var i=new Uint8Array(Wt+o.length),_=new Uint8Array(i.length),g=0;g<o.length;g++)i[g+Wt]=o[g];return Ae(_,i,i.length,u,a),_.subarray($t)},e.secretbox.open=function(o,u,a){rt(o,u,a),qn(a,u);for(var i=new Uint8Array($t+o.length),_=new Uint8Array(i.length),g=0;g<o.length;g++)i[g+$t]=o[g];return i.length<32||We(_,i,i.length,u,a)!==0?null:_.subarray(Wt)},e.secretbox.keyLength=mn,e.secretbox.nonceLength=rn,e.secretbox.overheadLength=$t,e.scalarMult=function(o,u){if(rt(o,u),o.length!==fn)throw new Error("bad n size");if(u.length!==Zt)throw new Error("bad p size");var a=new Uint8Array(Zt);return bt(a,o,u),a},e.scalarMult.base=function(o){if(rt(o),o.length!==fn)throw new Error("bad n size");var u=new Uint8Array(Zt);return Nt(u,o),u},e.scalarMult.scalarLength=fn,e.scalarMult.groupElementLength=Zt,e.box=function(o,u,a,i){var _=e.box.before(a,i);return e.secretbox(o,u,_)},e.box.before=function(o,u){rt(o,u),Er(o,u);var a=new Uint8Array(yn);return kt(a,o,u),a},e.box.after=e.secretbox,e.box.open=function(o,u,a,i){var _=e.box.before(a,i);return e.secretbox.open(o,u,_)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var o=new Uint8Array(Gt),u=new Uint8Array(Vt);return Ut(o,u),{publicKey:o,secretKey:u}},e.box.keyPair.fromSecretKey=function(o){if(rt(o),o.length!==Vt)throw new Error("bad secret key size");var u=new Uint8Array(Gt);return Nt(u,o),{publicKey:u,secretKey:new Uint8Array(o)}},e.box.publicKeyLength=Gt,e.box.secretKeyLength=Vt,e.box.sharedKeyLength=yn,e.box.nonceLength=zn,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(o,u){if(rt(o,u),u.length!==Pt)throw new Error("bad secret key size");var a=new Uint8Array(mt+o.length);return hn(a,o,o.length,u),a},e.sign.open=function(o,u){if(rt(o,u),u.length!==Rt)throw new Error("bad public key size");var a=new Uint8Array(o.length),i=nn(a,o,o.length,u);if(i<0)return null;for(var _=new Uint8Array(i),g=0;g<_.length;g++)_[g]=a[g];return _},e.sign.detached=function(o,u){for(var a=e.sign(o,u),i=new Uint8Array(mt),_=0;_<i.length;_++)i[_]=a[_];return i},e.sign.detached.verify=function(o,u,a){if(rt(o,u,a),u.length!==mt)throw new Error("bad signature size");if(a.length!==Rt)throw new Error("bad public key size");var i=new Uint8Array(mt+o.length),_=new Uint8Array(mt+o.length),g;for(g=0;g<mt;g++)i[g]=u[g];for(g=0;g<o.length;g++)i[g+mt]=o[g];return nn(_,i,i.length,a)>=0},e.sign.keyPair=function(){var o=new Uint8Array(Rt),u=new Uint8Array(Pt);return Bt(o,u),{publicKey:o,secretKey:u}},e.sign.keyPair.fromSecretKey=function(o){if(rt(o),o.length!==Pt)throw new Error("bad secret key size");for(var u=new Uint8Array(Rt),a=0;a<u.length;a++)u[a]=o[32+a];return{publicKey:u,secretKey:new Uint8Array(o)}},e.sign.keyPair.fromSeed=function(o){if(rt(o),o.length!==gn)throw new Error("bad seed size");for(var u=new Uint8Array(Rt),a=new Uint8Array(Pt),i=0;i<32;i++)a[i]=o[i];return Bt(u,a,!0),{publicKey:u,secretKey:a}},e.sign.publicKeyLength=Rt,e.sign.secretKeyLength=Pt,e.sign.seedLength=gn,e.sign.signatureLength=mt,e.hash=function(o){rt(o);var u=new Uint8Array(xn);return nt(u,o,o.length),u},e.hash.hashLength=xn,e.verify=function(o,u){return rt(o,u),o.length===0||u.length===0||o.length!==u.length?!1:E(o,0,u,0,o.length)===0},e.setPRNG=function(o){r=o},function(){var o=typeof self<"u"?self.crypto||self.msCrypto:null;if(o&&o.getRandomValues){var u=65536;e.setPRNG(function(a,i){var _,g=new Uint8Array(i);for(_=0;_<i;_+=u)o.getRandomValues(g.subarray(_,_+Math.min(i-_,u)));for(_=0;_<i;_++)a[_]=g[_];Yn(g)})}else typeof Ns<"u"&&(o=gu,o&&o.randomBytes&&e.setPRNG(function(a,i){var _,g=o.randomBytes(i);for(_=0;_<i;_++)a[_]=g[_];Yn(g)}))}()})(t.exports?t.exports:self.nacl=self.nacl||{})}),Kn=Rs(function(t){(function(e,n){t.exports?t.exports=n():(e.nacl||(e.nacl={}),e.nacl.util=n())})(bu,function(){var e={};function n(r){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(r))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(r){if(typeof r!="string")throw new TypeError("expected string");var f,s=unescape(encodeURIComponent(r)),l=new Uint8Array(s.length);for(f=0;f<s.length;f++)l[f]=s.charCodeAt(f);return l},e.encodeUTF8=function(r){var f,s=[];for(f=0;f<r.length;f++)s.push(String.fromCharCode(r[f]));return decodeURIComponent(escape(s.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(r){return Buffer.from(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(Buffer.from(r,"base64"),0))}):(e.encodeBase64=function(r){return new Buffer(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(new Buffer(r,"base64"),0))}):(e.encodeBase64=function(r){var f,s=[],l=r.length;for(f=0;f<l;f++)s.push(String.fromCharCode(r[f]));return btoa(s.join(""))},e.decodeBase64=function(r){n(r);var f,s=atob(r),l=new Uint8Array(s.length);for(f=0;f<s.length;f++)l[f]=s.charCodeAt(f);return l}),e})});function xu(t){return typeof t>"u"||t==null?[]:Array.isArray(t)?t:[t]}function pr(t){return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}function Wr(t){const e=t.match(/.{1,2}(?=(.{2})+(?!.))|.{1,2}$/g);return new Uint8Array(e.map(n=>parseInt(n,16)))}function Ds(t,e=8){const n=new Array(e).fill(0);for(let r=0;r<n.length;r++){const f=t&255;n[r]=f,t=(t-f)/256}return n}Yt.util=Kn;function $s(){const t=Yt.box.keyPair(),e=pr(t.publicKey),n=pr(t.secretKey);return{privateKey:t.secretKey,publicKey:t.publicKey,privateKeyHex:n,publicKeyHex:e}}Yt.util=Kn;function Ps(t){return t.publicKeyHex&&!t.publicKey&&(t.publicKey=Wr(t.publicKeyHex)),t.privateKeyHex&&!t.privateKey&&(t.privateKey=Wr(t.privateKeyHex)),t}function wu(t){return t!=null&&t.constructor==Object}function Au(t,e){const n=new Uint8Array(t.length+1),r=new Uint8Array(1);return r[0]=e,n.set(r),n.set(t,r.length),n}var Eu=On;/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 * @license MIT (© Joyent)
 */function On(t,e){var n={seen:[],stylize:Su};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),Is(e)?n.showHidden=e:e&&Du(n,e),Mn(n.showHidden)&&(n.showHidden=!1),Mn(n.depth)&&(n.depth=2),Mn(n.colors)&&(n.colors=!1),Mn(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Ou),br(n,t,n.depth)}On.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};On.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Su(t,e){return t}function Is(t){return typeof t=="boolean"}function Mn(t){return t===void 0}function Ou(t,e){var n=On.styles[e];return n?"\x1B["+On.colors[n][0]+"m"+t+"\x1B["+On.colors[n][1]+"m":t}function Pr(t){return typeof t=="function"}function Ms(t){return typeof t=="string"}function Tu(t){return typeof t=="number"}function Us(t){return t===null}function Ls(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Ir(t){return xr(t)&&li(t)==="[object RegExp]"}function xr(t){return typeof t=="object"&&t!==null}function Mr(t){return xr(t)&&(li(t)==="[object Error]"||t instanceof Error)}function Lf(t){return xr(t)&&li(t)==="[object Date]"}function li(t){return Object.prototype.toString.call(t)}function Cu(t){var e={};return t.forEach(function(n,r){e[n]=!0}),e}function ku(t,e,n,r,f){for(var s=[],l=0,c=e.length;l<c;++l)Ls(e,String(l))?s.push(Zr(t,e,n,r,String(l),!0)):s.push("");return f.forEach(function(d){d.match(/^\d+$/)||s.push(Zr(t,e,n,r,d,!0))}),s}function Ur(t){return"["+Error.prototype.toString.call(t)+"]"}function br(t,e,n){if(t.customInspect&&e&&Pr(e.inspect)&&e.inspect!==On&&!(e.constructor&&e.constructor.prototype===e)){var r=e.inspect(n,t);return Ms(r)||(r=br(t,r,n)),r}var f=Ru(t,e);if(f)return f;var s=Object.keys(e),l=Cu(s);try{t.showHidden&&Object.getOwnPropertyNames&&(s=Object.getOwnPropertyNames(e))}catch{}if(Mr(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return Ur(e);if(s.length===0){if(Pr(e)){var c=e.name?": "+e.name:"";return t.stylize("[Function"+c+"]","special")}if(Ir(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(Lf(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Mr(e))return Ur(e)}var d="",h=!1,p=["{","}"];if(Array.isArray(e)&&(h=!0,p=["[","]"]),Pr(e)){var b=e.name?": "+e.name:"";d=" [Function"+b+"]"}if(Ir(e)&&(d=" "+RegExp.prototype.toString.call(e)),Lf(e)&&(d=" "+Date.prototype.toUTCString.call(e)),Mr(e)&&(d=" "+Ur(e)),s.length===0&&(!h||e.length==0))return p[0]+d+p[1];if(n<0)return Ir(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var m;return h?m=ku(t,e,n,l,s):m=s.map(function(y){return Zr(t,e,n,l,y,h)}),t.seen.pop(),Nu(m,d,p)}function Zr(t,e,n,r,f,s){var l,c,d;d={value:void 0};try{d.value=e[f]}catch{}try{Object.getOwnPropertyDescriptor&&(d=Object.getOwnPropertyDescriptor(e,f)||d)}catch{}if(d.get?d.set?c=t.stylize("[Getter/Setter]","special"):c=t.stylize("[Getter]","special"):d.set&&(c=t.stylize("[Setter]","special")),Ls(r,f)||(l="["+f+"]"),c||(t.seen.indexOf(d.value)<0?(Us(n)?c=br(t,d.value,null):c=br(t,d.value,n-1),c.indexOf(`
`)>-1&&(s?c=c.split(`
`).map(function(h){return"  "+h}).join(`
`).substr(2):c=`
`+c.split(`
`).map(function(h){return"   "+h}).join(`
`))):c=t.stylize("[Circular]","special")),Mn(l)){if(s&&f.match(/^\d+$/))return c;l=JSON.stringify(""+f),l.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(l=l.substr(1,l.length-2),l=t.stylize(l,"name")):(l=l.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),l=t.stylize(l,"string"))}return l+": "+c}function Ru(t,e){if(Mn(e))return t.stylize("undefined","undefined");if(Ms(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(Tu(e))return t.stylize(""+e,"number");if(Is(e))return t.stylize(""+e,"boolean");if(Us(e))return t.stylize("null","null")}function Nu(t,e,n){var r=t.reduce(function(f,s){return s.indexOf(`
`)>=0,f+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function Du(t,e){if(!e||!xr(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}function on(t,e,...n){try{e==console.log?e(`${new Date().toLocaleString()} \u2192 ${Eu(...n).replace(/^'/,"").replace(/'$/,"")}`):typeof e=="function"?e(...n):e&&e.logOutput(t,{source:"connectome"},...n)}catch(r){console.log(r)}}class $u{write(e,...n){on(void 0,e,...n)}red(e,...n){on("red",e,...n)}green(e,...n){on("green",e,...n)}yellow(e,...n){on("yellow",e,...n)}blue(e,...n){on("blue",e,...n)}cyan(e,...n){on("cyan",e,...n)}magenta(e,...n){on("magenta",e,...n)}gray(e,...n){on("gray",e,...n)}white(e,...n){on("white",e,...n)}}var tt=new $u;Yt.util=Kn;function Pu({data:t,connector:e}){const{log:n}=e;wu(t)&&(t=JSON.stringify(t));const r=new Uint8Array(Ds(2*e.sentCount,24));if(e.closed())tt.red(n,`\u26A0\uFE0F Warning: "${t}" was not sent because connector is not ready`);else if(e.sentCount>1){let f=0;typeof t=="string"&&(f=1);const s=f==1?Yt.util.decodeUTF8(t):t,l=Au(s,f),c=Yt.secretbox(l,r,e.sharedSecret);e.verbose&&(tt.green(n,`Connector ${e.endpoint} \u2192 Sending encrypted message #${e.sentCount} \u21B4`),tt.gray(n,t)),e.connection.websocket.send(c)}else e.verbose&&(tt.green(n,`Connector ${e.endpoint} \u2192 Sending message #${e.sentCount} \u21B4`),tt.gray(n,t)),e.connection.websocket.send(t)}Yt.util=Kn;function Iu(t){return Object.keys(t).includes("result")||Object.keys(t).includes("error")}function js({jsonData:t,encryptedData:e,rawMessage:n,wasEncrypted:r,connector:f}){const{log:s}=f;f.lastMessageAt=Date.now();const l=new Uint8Array(Ds(2*f.receivedCount+1,24));if(f.verbose&&!r&&tt.magenta(s,`Connector ${f.endpoint} \u2192 Received message #${f.receivedCount} \u21B4`),t)t.jsonrpc?Iu(t)?(f.verbose&&!r&&(tt.magenta(s,`Connector ${f.endpoint} received plain-text rpc result \u21B4`),tt.gray(s,t)),f.rpcClient.jsonrpcMsgReceive(n)):f.emit("json_rpc",n):f.emit("receive",{jsonData:t,rawMessage:n});else if(e){f.verbose=="extra"&&(tt.magenta(s,`Connector ${f.endpoint} received bytes \u21B4`),tt.gray(s,e),tt.magenta(s,`Connector ${f.endpoint} decrypting with shared secret ${f.sharedSecret}...`));const c=Yt.secretbox.open(e,l,f.sharedSecret),d=c[0],h=c.subarray(1);if(d==1){const p=Yt.util.encodeUTF8(h);f.verbose&&tt.write(s,`Received message: ${p}`);try{const b=JSON.parse(p);b.jsonrpc?js({jsonData:b,rawMessage:p,wasEncrypted:!0,connector:f}):b.state?f.emit("receive_state",b.state):b.diff?f.emit("receive_diff",b.diff):b.signal?f.emit(b.signal,b.data):b.stateField?f.emit("receive_state_field",b.stateField):f.emit("receive",{jsonData:b,rawMessage:p})}catch(b){throw tt.red(s,"Couldn't parse json message although the flag was for string ..."),tt.red(s,p),b}}else f.emit("receive_binary",h)}}Yt.util=Kn;function Mu({connector:t,afterFirstStep:e=()=>{}}){const{clientPrivateKey:n,clientPublicKey:r,clientPublicKeyHex:f,protocol:s,tag:l,endpoint:c,verbose:d}=t;return new Promise((h,p)=>{t.remoteObject("Auth").call("exchangePubkeys",{pubkey:f}).then(b=>{const m=Yt.box.before(Wr(b),n);e({sharedSecret:m,remotePubkeyHex:b}),d&&tt.write(t.log,`Connector ${c} established shared secret through diffie-hellman exchange.`),t.remoteObject("Auth").call("finalizeHandshake",{protocol:s}).then(y=>{if(y&&y.error)console.log(y.error);else{h();const S=l?` (${l})`:"";tt.cyan(t.log,`${c}${S} \u2713 Connection [ ${s||'"no-name"'} ] ready`)}}).catch(p)}).catch(p)})}class Uu extends gr{constructor(e){super(),this.connector=e}send(...e){this.connector.send(...e)}}var Ft={PARSE_ERROR:-32700,INVALID_REQUEST:-32600,METHOD_NOT_FOUND:-32601,INVALID_PARAMS:-32602,REMOTE_INTERNAL_ERROR:-32603,TIMEOUT:-32701};class Bs{constructor({transports:e}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transportsToRegister=e,this.methods={}}setMethodPrefix(e){this.methodPrefix=e}expose(e){this.methods=e}registerTransport(e){e.onData(this._processRequest.bind(this,e))}async _processRequest(e,n){const r=JSON.parse(n);let f;return Array.isArray(r)?f=await Promise.all(r.map(s=>this._callMethod(s,e))):f=await this._callMethod(r,e),JSON.stringify(f)}async _callMethod(e,n){if(!e.hasOwnProperty("method"))return;const{method:f,params:s=[],id:l}=e;let c=f;if(c.includes("::")){const[p,b]=c.split("::");if(c=b,this.methodPrefix&&p!=this.methodPrefix)return}const d=!this.methods[c]||typeof this.methods[c]!="function"||c==="constructor"||c.startsWith("_")||this.methods[c]===Object.prototype[c];let h={};if(d)h={jsonrpc:"2.0",id:l,error:{code:Ft.METHOD_NOT_FOUND,message:`Method [${c}] not found on remote target object`}};else{this.currentTransport=n;try{const p=await this.methods[c].apply(this.methods,s);if(!l)return;h={jsonrpc:"2.0",result:typeof p>"u"?null:p,id:l}}catch(p){console.log(`Exposed RPC method ${f} internal error:`),console.log(p),console.log("Sending this error as a result to calling client ..."),h={jsonrpc:"2.0",error:{code:Ft.REMOTE_INTERNAL_ERROR,message:`Method [${f}] internal error: ${p.stack}`},id:l}}}return h}run(){for(const e of this.transportsToRegister)this.registerTransport(e);this.transportsToRegister=[]}}class Rn extends Error{constructor(e={}){if(super(),!e.code)throw new Error("Code required");if(!e.message)throw new Error("Message required");this.code=e.code,this.message=e.message}}class Lu extends Rn{constructor(e){super({code:Ft.METHOD_NOT_FOUND,message:e||"Method not found"})}}class ju extends Rn{constructor(){super({code:Ft.INVALID_PARAMS,message:"Invalid params"})}}class Bu extends Rn{constructor(e){super({code:Ft.REMOTE_INTERNAL_ERROR,message:`Error originating at remote endpoint: ${e}`||"Remote Internal error"})}}class Ku extends Rn{constructor(){super({code:Ft.PARSE_ERROR,message:"Parse error"})}}class zu extends Rn{constructor(){super({code:Ft.INVALID_REQUEST,message:"Invalid request"})}}class Ks extends Rn{}class qu extends Ks{constructor(e,n){super({code:Ft.TIMEOUT,message:`Request exceeded maximum execution time (${n}ms): ${e}`})}}var Lr={Base:Rn,MethodNotFound:Lu,InvalidRequest:zu,InvalidParams:ju,RemoteInternalError:Bu,ServerError:Ks,ParseError:Ku,RequestTimeout:qu};class zs{constructor({transport:e,requestTimeout:n=2e4}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transport=e,this.requestTimeout=n,this.pendingRequest={},this.initialized=!1}setMethodPrefix(e){this.methodPrefix=e}async callMethod(e,n){this._init();const r=this.methodPrefix?`${this.methodPrefix}::${e}`:e,f=this._makeRequestObject({method:r,params:n});return this._sendRequest({object:f,id:f.id})}notify(e,n){this._init();const r=this._makeRequestObject({method:e,params:n,mode:"notify"});return this.transport.sendData(JSON.stringify(r)),!0}async runBatch(e){const n=this._generateId();let r=!0;const f=[];for(const[s,l,c]of e){const d=this._makeRequestObject({method:s,params:l,mode:c,batchId:n});d.id&&(r=!1),f.push(d)}return r?this.transport.sendData(JSON.stringify(f)):this._sendRequest({object:f,id:n})}_init(){this.initialized||(this.transport.onData(this._processResponse.bind(this)),this.initialized=!0)}_sendRequest({object:e,id:n}){const r=JSON.stringify(e);return new Promise((f,s)=>{this.pendingRequest[n]={resolve:f,reject:s,sentObject:e},setTimeout(()=>{this.pendingRequest[n]&&(delete this.pendingRequest[n],s(new Lr.RequestTimeout(r,this.requestTimeout)))},this.requestTimeout);try{this.transport.sendData(r)}catch(l){delete this.pendingRequest[n],s(l)}})}_processResponse(e){const n=JSON.parse(e);Array.isArray(n)?this._processBatchResponse(n):this._processSingleCallResponse(n)}_processSingleCallResponse(e){const n=e.hasOwnProperty("result")||!1,r=e.hasOwnProperty("error");if(!n&&!r)return;const f=this.pendingRequest[e.id];if(delete this.pendingRequest[e.id],!!f){if(n)f.resolve(e.result);else if(r){const s=this._makeErrorObject(e.error);f.reject(s)}}}_processBatchResponse(e){let n;const r={},f=[];for(const h of e)h.id?(n||(n=h.id.split("|")[0]),r[h.id]=h):h.error&&f.push(h.error);if(!this.pendingRequest[n])return;const{sentObject:s,resolve:l}=this.pendingRequest[n];delete this.pendingRequest[n];const c=[];let d=0;for(const h of s){if(!h.id){c.push(null);continue}const p=r[h.id];p?p.hasOwnProperty("result")||!1?c.push({success:!0,result:p.result}):c.push({success:!1,result:this._makeErrorObject(p.error)}):(c.push({success:!1,error:this._makeErrorObject(f[d])}),d++)}l(c)}_makeRequestObject({method:e,params:n,mode:r,batchId:f}){const s={jsonrpc:"2.0",method:e};return n&&n.length&&(s.params=n),r!=="notify"&&(s.id=f?`${f}|${this._generateId()}`:this._generateId()),s}_makeErrorObject(e){const n={[Ft.METHOD_NOT_FOUND]:()=>new Lr.MethodNotFound(e.message),[Ft.REMOTE_INTERNAL_ERROR]:()=>new Lr.RemoteInternalError(e.message)}[e.code];return n()}_generateId(){const e="bjectSymhasOwnProp-0123456789ABCDEFGHIJKLMNQRTUVWXYZ_dfgiklquvxz";let n=10,r="";for(;0<n--;)r+=e[Math.random()*64|0];return r}}function Yu(t){const e=jf(t.callMethod.bind(t)),n=jf(t.notify.bind(t));return new Proxy(t,{get(r,f){if(f==="notify")return n;if(f==="callMethod")return e;if(f!=="then")return f==="setMethodPrefix"?(...s)=>t.setMethodPrefix(s):(...s)=>r.callMethod.call(r,f,s)}})}function jf(t){return new Proxy(t,{get(e,n){return(...r)=>e.call(null,n,r)},apply(e,n,r){return e.apply(null,r)}})}class Fu extends zs{constructor(...e){return super(...e),Yu(this)}}class Hu{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",e)}sendData(e){this.channel.send(e)}}class qs{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",async n=>{const r=await e(n);!r||this.channel.send(r)})}}var Ju=Object.freeze({__proto__:null,MoleServer:Bs,MoleClient:zs,MoleClientProxified:Fu,ClientTransport:Hu,ServerTransport:qs});class Wu extends Error{constructor(e,n){super(e),this.name=this.constructor.name,this.errorCode=n}errorCode(){return this.errorCode}}const{MoleClient:Zu,ClientTransport:Gu}=Ju;class Vu{constructor(e,n,r){this.moleChannel=new Uu(e),this.methodPrefix=n,this.connectorOrServersideChannel=e,this.client=new Zu({requestTimeout:r,transport:new Gu(this.moleChannel)})}jsonrpcMsgReceive(e){this.moleChannel.emit("json_rpc",e)}call(e,n){return this.connectorOrServersideChannel.closed()?new Promise((r,f)=>{f(new Wu(`Method call [${this.methodPrefix}::${e}] on closed channel or connector ignored. Please add a check for closed channel in your code.`,"CLOSED_CHANNEL"))}):this.client.callMethod(`${this.methodPrefix}::${e}`,n)}}const Qu=1e4;class Xu{constructor(e,n){this.connectorOrServersideChannel=e,this.remoteObjects={},this.requestTimeout=n||Qu}remoteObject(e){return this.remoteObjects[e]||(this.remoteObjects[e]=new Vu(this.connectorOrServersideChannel,e,this.requestTimeout)),this.remoteObjects[e]}jsonrpcMsgReceive(e){for(const n of Object.values(this.remoteObjects))n.jsonrpcMsgReceive(e)}}class e0{constructor({serversideChannel:e,serverMethods:n,methodPrefix:r}){const f=[new qs(e)];this.server=new Bs({transports:f}),this.server.expose(n),this.server.setMethodPrefix(r),this.server.run()}}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var t0=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,f){r.__proto__=f}||function(r,f){for(var s in f)f.hasOwnProperty(s)&&(r[s]=f[s])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),n0=Object.prototype.hasOwnProperty;function Gr(t,e){return n0.call(t,e)}function Vr(t){if(Array.isArray(t)){for(var n=new Array(t.length),e=0;e<n.length;e++)n[e]=""+e;return n}if(Object.keys)return Object.keys(t);var n=[];for(var r in t)Gr(t,r)&&n.push(r);return n}function Mt(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function Qr(t){for(var e=0,n=t.length,r;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function An(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function Ys(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function Xr(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(Xr(t[e]))return!0}else if(typeof t=="object"){for(var r=Vr(t),f=r.length,e=0;e<f;e++)if(Xr(t[r[e]]))return!0}}return!1}function Bf(t,e){var n=[t];for(var r in e){var f=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof f<"u"&&n.push(r+": "+f)}return n.join(`
`)}var Fs=function(t){t0(e,t);function e(n,r,f,s,l){var c=this.constructor,d=t.call(this,Bf(n,{name:r,index:f,operation:s,tree:l}))||this;return d.name=r,d.index=f,d.operation=s,d.tree=l,Object.setPrototypeOf(d,c.prototype),d.message=Bf(n,{name:r,index:f,operation:s,tree:l}),d}return e}(Error),pt=Fs,r0=Mt,Un={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=vr(n,this.path);r&&(r=Mt(r));var f=Tn(n,{op:"remove",path:this.from}).removed;return Tn(n,{op:"add",path:this.path,value:f}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=vr(n,this.from);return Tn(n,{op:"add",path:this.path,value:Mt(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:Vn(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},i0={add:function(t,e,n){return Qr(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:Un.move,copy:Un.copy,test:Un.test,_get:Un._get};function vr(t,e){if(e=="")return t;var n={op:"_get",path:e};return Tn(t,n),n.value}function Tn(t,e,n,r,f,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),f===void 0&&(f=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):mr(e,0)),e.path===""){var l={newDocument:t};if(e.op==="add")return l.newDocument=e.value,l;if(e.op==="replace")return l.newDocument=e.value,l.removed=t,l;if(e.op==="move"||e.op==="copy")return l.newDocument=vr(t,e.from),e.op==="move"&&(l.removed=t),l;if(e.op==="test"){if(l.test=Vn(t,e.value),l.test===!1)throw new pt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l.newDocument=t,l}else{if(e.op==="remove")return l.removed=t,l.newDocument=null,l;if(e.op==="_get")return e.value=t,l;if(n)throw new pt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return l}}else{r||(t=Mt(t));var c=e.path||"",d=c.split("/"),h=t,p=1,b=d.length,m=void 0,y=void 0,S=void 0;for(typeof n=="function"?S=n:S=mr;;){if(y=d[p],f&&y=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&m===void 0&&(h[y]===void 0?m=d.slice(0,p).join("/"):p==b-1&&(m=e.path),m!==void 0&&S(e,0,t,m)),p++,Array.isArray(h)){if(y==="-")y=h.length;else{if(n&&!Qr(y))throw new pt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);Qr(y)&&(y=~~y)}if(p>=b){if(n&&e.op==="add"&&y>h.length)throw new pt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var l=i0[e.op].call(e,h,y,t);if(l.test===!1)throw new pt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}}else if(y&&y.indexOf("~")!=-1&&(y=Ys(y)),p>=b){var l=Un[e.op].call(e,h,y,t);if(l.test===!1)throw new pt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}h=h[y]}}}function ci(t,e,n,r,f){if(r===void 0&&(r=!0),f===void 0&&(f=!0),n&&!Array.isArray(e))throw new pt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=Mt(t));for(var s=new Array(e.length),l=0,c=e.length;l<c;l++)s[l]=Tn(t,e[l],n,!0,f,l),t=s[l].newDocument;return s.newDocument=t,s}function f0(t,e,n){var r=Tn(t,e);if(r.test===!1)throw new pt("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function mr(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new pt("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(Un[t.op]){if(typeof t.path!="string")throw new pt("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new pt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new pt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new pt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&Xr(t.value))throw new pt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var f=t.path.split("/").length,s=r.split("/").length;if(f!==s+1&&f!==s)throw new pt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new pt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var l={op:"_get",path:t.from,value:void 0},c=Hs([l],n);if(c&&c.name==="OPERATION_PATH_UNRESOLVABLE")throw new pt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new pt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function Hs(t,e,n){try{if(!Array.isArray(t))throw new pt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)ci(Mt(e),Mt(t),n||!0);else{n=n||mr;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(f){if(f instanceof pt)return f;throw f}}function Vn(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),f,s,l;if(n&&r){if(s=t.length,s!=e.length)return!1;for(f=s;f--!==0;)if(!Vn(t[f],e[f]))return!1;return!0}if(n!=r)return!1;var c=Object.keys(t);if(s=c.length,s!==Object.keys(e).length)return!1;for(f=s;f--!==0;)if(!e.hasOwnProperty(c[f]))return!1;for(f=s;f--!==0;)if(l=c[f],!Vn(t[l],e[l]))return!1;return!0}return t!==t&&e!==e}var s0=Object.freeze({__proto__:null,JsonPatchError:pt,deepClone:r0,getValueByPointer:vr,applyOperation:Tn,applyPatch:ci,applyReducer:f0,validator:mr,validate:Hs,_areEquals:Vn});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var ai=new WeakMap,o0=function(){function t(e){this.observers=new Map,this.obj=e}return t}(),l0=function(){function t(e,n){this.callback=e,this.observer=n}return t}();function c0(t){return ai.get(t)}function a0(t,e){return t.observers.get(e)}function u0(t,e){t.observers.delete(e.callback)}function d0(t,e){e.unobserve()}function h0(t,e){var n=[],r,f=c0(t);if(!f)f=new o0(t),ai.set(t,f);else{var s=a0(f,e);r=s&&s.observer}if(r)return r;if(r={},f.value=Mt(t),e){r.callback=e,r.next=null;var l=function(){ei(r)},c=function(){clearTimeout(r.next),r.next=setTimeout(l)};typeof window<"u"&&(window.addEventListener("mouseup",c),window.addEventListener("keyup",c),window.addEventListener("mousedown",c),window.addEventListener("keydown",c),window.addEventListener("change",c))}return r.patches=n,r.object=t,r.unobserve=function(){ei(r),clearTimeout(r.next),u0(f,r),typeof window<"u"&&(window.removeEventListener("mouseup",c),window.removeEventListener("keyup",c),window.removeEventListener("mousedown",c),window.removeEventListener("keydown",c),window.removeEventListener("change",c))},f.observers.set(e,new l0(e,r)),r}function ei(t,e){e===void 0&&(e=!1);var n=ai.get(t.object);ui(n.value,t.object,t.patches,"",e),t.patches.length&&ci(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function ui(t,e,n,r,f){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=Vr(e),l=Vr(t),c=!1,d=l.length-1;d>=0;d--){var h=l[d],p=t[h];if(Gr(e,h)&&!(e[h]===void 0&&p!==void 0&&Array.isArray(e)===!1)){var b=e[h];typeof p=="object"&&p!=null&&typeof b=="object"&&b!=null?ui(p,b,n,r+"/"+An(h),f):p!==b&&(f&&n.push({op:"test",path:r+"/"+An(h),value:Mt(p)}),n.push({op:"replace",path:r+"/"+An(h),value:Mt(b)}))}else Array.isArray(t)===Array.isArray(e)?(f&&n.push({op:"test",path:r+"/"+An(h),value:Mt(p)}),n.push({op:"remove",path:r+"/"+An(h)}),c=!0):(f&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!c&&s.length==l.length))for(var d=0;d<s.length;d++){var h=s[d];!Gr(t,h)&&e[h]!==void 0&&n.push({op:"add",path:r+"/"+An(h),value:Mt(e[h])})}}}function _0(t,e,n){n===void 0&&(n=!1);var r=[];return ui(t,e,r,"",n),r}var p0=Object.freeze({__proto__:null,unobserve:d0,observe:h0,generate:ei,compare:_0}),b0=Object.assign({},s0,p0,{JsonPatchError:Fs,deepClone:Mt,escapePathComponent:An,unescapePathComponent:Ys});const{applyPatch:v0}=b0;class m0 extends jn{constructor(e){super({}),this.connector=e,this.connector.on("receive_state",n=>{this.wireStateReceived=!0,this.set(n)}),this.connector.on("receive_diff",n=>{this.wireStateReceived&&(v0(this.state,n),this.announceStateChange())})}field(e){return this.connector.connectionState.get(e)}}class y0 extends jn{constructor(e){super({}),this.fields={},this.connector=e,this.connector.on("receive_state_field",({name:n,state:r})=>{this.get(n).set(r)})}get(e){return this.fields[e]||(this.fields[e]=new jn),this.fields[e]}}Yt.util=Kn;const g0=700,x0=6e4,w0=1;class A0 extends gr{constructor({endpoint:e,protocol:n,keypair:r=$s(),rpcRequestTimeout:f,verbose:s=!1,tag:l,log:c=console.log,autoDecommission:d=!1,dummy:h}={}){super(),this.protocol=n,this.log=c;const{privateKey:p,publicKey:b}=Ps(r);this.clientPrivateKey=p,this.clientPublicKey=b,this.clientPublicKeyHex=pr(b),this.rpcClient=new Xu(this,f),this.endpoint=e,this.verbose=s,this.tag=l,this.autoDecommission=d,this.sentCount=0,this.receivedCount=0,this.successfulConnectsCount=0,h||(this.state=new m0(this),this.connectionState=new y0(this)),this.connected=new jn,this.delayedAdjustConnectionStatus(),s&&tt.green(this.log,`Connector ${this.endpoint} created`),this.decommissionCheckCounter=0,this.lastPongReceivedAt=Date.now(),this.on("pong",()=>{this.lastPongReceivedAt=Date.now()})}delayedAdjustConnectionStatus(){setTimeout(()=>{this.connected.get()==null&&this.connected.set(!1)},g0)}send(e){Pu({data:e,connector:this}),this.sentCount+=1}signal(e,n){this.connected.get()?this.send({signal:e,data:n}):tt.write(this.log,"Warning: trying to send signal over disconnected connector, this should be prevented by GUI")}userAction({action:e,scope:n,payload:r}){this.signal("__action",{action:e,scope:n,payload:r})}on(e,n){e=="ready"&&this.isReady()&&n(),super.on(e,n)}getSharedSecret(){return this.sharedSecret?pr(this.sharedSecret):void 0}wireReceive({jsonData:e,encryptedData:n,rawMessage:r}){js({jsonData:e,encryptedData:n,rawMessage:r,connector:this}),this.receivedCount+=1}field(e){return this.connectionState.get(e)}isReady(){return this.ready}closed(){return!this.transportConnected}connectStatus(e){if(e){this.sentCount=0,this.receivedCount=0,this.transportConnected=!0,this.successfulConnectsCount+=1,this.verbose&&tt.green(this.log,`\u2713 Connector ${this.endpoint} connected #${this.successfulConnectsCount}`);const n=this.connection.websocket.__id;Mu({connector:this,afterFirstStep:({sharedSecret:f,remotePubkeyHex:s})=>{this.sharedSecret=f,this._remotePubkeyHex=s}}).then(()=>{this.connectedAt=Date.now(),this.connected.set(!0),this.ready=!0,this.emit("ready")}).catch(f=>{this.connection.websocket.__id==n&&this.connection.websocket.readyState==w0&&f.code==Ft.TIMEOUT&&(tt.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] handshake error: "${f.message}"`),tt.write(this.log,`${this.endpoint} Connector dropping stale websocket after handshake error`),this.connection.terminate()),f.code!=Ft.TIMEOUT&&tt.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] on:ready error: "${f.stack}" \u2014 (will not try to reconnect, fix the error and reload this gui)`)})}else{let n;this.transportConnected&&(n=!0),this.transportConnected==null&&tt.write(this.log,`${this.endpoint} Connector was not able to connect at first try`),this.transportConnected=!1,this.ready=!1,this.sharedSecret=void 0,delete this.connectedAt,n&&(this.emit("disconnect"),e==null&&this.delayedAdjustConnectionStatus(),this.connected.set(e))}}checkForDecommission(){!this.autoDecommission||(this.decommissionCheckRequestedAt&&Date.now()-this.decommissionCheckRequestedAt>3e3&&(this.decommissionCheckCounter=0),this.decommissionCheckRequestedAt=Date.now(),this.decommissionCheckCounter+=1,this.decommissionCheckCounter>12&&Date.now()-this.lastPongReceivedAt>x0&&(tt.write(this.log,`Decommissioning connector ${this.endpoint} (long inactive)`),this.decommission(),this.emit("decommission")))}decommission(){this.decommissioned=!0}remoteObject(e){return{call:(n,r=[])=>this.rpcClient.remoteObject(e).call(n,xu(r))}}attachObject(e,n){new e0({serversideChannel:this,serverMethods:n,methodPrefix:e})}clientPubkey(){return this.clientPublicKeyHex}remotePubkeyHex(){return this._remotePubkeyHex}remoteAddress(){return this.endpoint}}const Kf=typeof window<"u";function E0({endpoint:t,host:e,port:n}){if(Kf&&t&&t.startsWith("/")&&(t=`${window.location.protocol.includes("s")?"wss":"ws"}://${window.location.host}${t}`),!t)if(Kf){e=e||window.location.hostname;const r=window.location.protocol.includes("s")?"wss":"ws";t=`${r}://${e}`,r=="wss"?t=`${r}://${e}/ws`:n?t=`${t}:${n}`:window.location.port&&(t=`${t}:${window.location.port}`)}else{if(!n)throw new Error(`Connectome determineEndpoint: No websocket port provided for ${e}`);t=`ws://${e||"localhost"}:${n}`}return t}const cn=typeof window<"u",S0=0,O0=1,T0=1e3,C0=3,k0=5;function R0({endpoint:t,host:e,port:n,protocol:r,keypair:f,remotePubkey:s,rpcRequestTimeout:l,autoDecommission:c,log:d,verbose:h,tag:p,dummy:b},{WebSocket:m}){t=E0({endpoint:t,host:e,port:n});const y=new A0({endpoint:t,protocol:r,rpcRequestTimeout:l,keypair:f,verbose:h,tag:p,log:d,autoDecommission:c,dummy:b}),S=()=>{D0({connector:y,endpoint:t},{WebSocket:m,reconnect:S,log:d,verbose:h})};y.connection={terminate(){this.websocket._removeAllCallbacks(),this.websocket.close(),y.connectStatus(!1),S()},endpoint:t,checkTicker:0};const E=()=>{y.decommissioned||(N0({connector:y,reconnect:S,log:d}),setTimeout(E,T0))};return setTimeout(E,10),y}function N0({connector:t,reconnect:e,log:n}){const r=t.connection;if(P0(r)||t.decommissioned){t.decommissioned?(tt.yellow(n,`${t.endpoint} Connection decommisioned, closing websocket ${r.websocket.__id}, will not retry again `),Js(t)):(t.emit("inactive_connection"),tt.yellow(n,`${t.endpoint} \u2716 Terminated inactive connection`)),r.terminate();return}Ws(r)?r.websocket.send("ping"):(t.connected==null&&(tt.write(n,`${t.endpoint} Setting connector status to FALSE because connector.connected is undefined`),t.connectStatus(!1)),e()),r.checkTicker+=1}function D0({connector:t,endpoint:e},{WebSocket:n,reconnect:r,log:f,verbose:s}){const l=t.connection;if(t.checkForDecommission(),t.decommissioned){Js(t);return}if(l.currentlyTryingWS&&l.currentlyTryingWS.readyState==S0){if(l.currentlyTryingWS._waitForConnectCounter<k0){l.currentlyTryingWS._waitForConnectCounter+=1;return}(s||cn)&&tt.write(f,`${e} Reconnect timeout, creating new ws`),l.currentlyTryingWS._removeAllCallbacks(),l.currentlyTryingWS.close()}else(s||cn)&&tt.write(f,`${e} Created new websocket`);const c=new n(e);c.__id=Math.random(),l.currentlyTryingWS=c,l.currentlyTryingWS._waitForConnectCounter=0,cn&&(c.binaryType="arraybuffer"),cn||c.on("error",()=>{});const d=()=>{t.decommissioned||((s||cn)&&tt.write(f,`${e} Websocket open`),l.currentlyTryingWS=null,l.checkTicker=0,$0({ws:c,connector:t,openCallback:d,reconnect:r},{log:f,verbose:s}),l.websocket=c,t.connectStatus(!0))};c._removeAllCallbacks=()=>{c.removeEventListener("open",d)},cn?c.addEventListener("open",d):c.on("open",d)}function $0({ws:t,connector:e,openCallback:n,reconnect:r},{log:f,verbose:s}){const l=e.connection,c=p=>{const b=`${e.endpoint} Websocket error`;console.log(b),console.log(p)},d=()=>{if(tt.write(f,`${e.endpoint} \u2716 Connection closed`),e.decommissioned){e.connectStatus(!1);return}e.connectStatus(void 0),r()},h=p=>{if(e.decommissioned)return;l.checkTicker=0;const b=cn?p.data:p;if(b=="pong"){e.emit("pong");return}let m;try{m=JSON.parse(b)}catch{}if(m)e.wireReceive({jsonData:m,rawMessage:b});else{const y=cn?new Uint8Array(b):b;e.wireReceive({encryptedData:y})}};t._removeAllCallbacks=()=>{t.removeEventListener("error",c),t.removeEventListener("close",d),t.removeEventListener("message",h),t.removeEventListener("open",n)},cn?(t.addEventListener("error",c),t.addEventListener("close",d),t.addEventListener("message",h)):(t.on("error",c),t.on("close",d),t.on("message",h))}function Js(t){const e=t.connection;e.currentlyTryingWS&&(e.currentlyTryingWS._removeAllCallbacks(),e.currentlyTryingWS.close(),e.currentlyTryingWS=null),e.ws&&(e.ws._removeAllCallbacks(),e.ws.close(),e.ws=null),t.connectStatus(!1)}function Ws(t){return t.websocket&&t.websocket.readyState==O0}function P0(t){return Ws(t)&&t.checkTicker>C0}function I0(t){return t.log=t.log||console.log,R0(t,{WebSocket})}class M0{constructor({mcs:e,foreground:n,connectToDeviceKey:r}){this.mcs=e,this.foreground=n,this.connectToDeviceKey=r}createConnector({host:e,autoDecommission:n=!1}){const{port:r,protocol:f,rpcRequestTimeout:s,log:l,verbose:c,keypair:d}=this.mcs;return I0({host:e,port:r,protocol:f,keypair:d,rpcRequestTimeout:s,autoDecommission:n,log:l,verbose:c})}getDeviceKey(e){var n;return(n=e==null?void 0:e.device)==null?void 0:n.deviceKey}connectThisDevice({host:e}){const n=this.createConnector({host:e});let r=!1;return n.state.subscribe(f=>{var l;f.nearbyDevices||(f.nearbyDevices=[]),f.notifications||(f.notifications=[]);const s=this.getDeviceKey(f);if(s){r||(n.on("pong",()=>{this.mcs.emit("pong",{deviceKey:s})}),r=!0),this.thisDeviceAlreadySetup||(this.mcs.set({activeDeviceKey:s}),this.initNewConnector({deviceKey:s,connector:n}));const c=this.connectToDeviceKey&&this.connectToDeviceKey!=s;if(!c&&this.mcs.activeDeviceKey()==s){const d=(l=f.device)==null?void 0:l.deviceName;this.foreground.set(f,{optimisticDeviceName:d})}this.foreground.setSpecial(f),this.thisDeviceAlreadySetup||(c&&(this.mcs.switch({deviceKey:this.connectToDeviceKey}),delete this.connectToDeviceKey),this.thisDeviceAlreadySetup=!0)}}),n}connectOtherDevice({host:e,deviceKey:n}){if(!this.mcs.connectors[n]){const r=this.createConnector({host:e,autoDecommission:!0});r.on("decommission",()=>{delete this.mcs.connectors[n],r.__removeListeners&&r.__removeListeners()});const f=()=>{this.mcs.emit("pong",{deviceKey:n})};r.on("pong",f),this.initNewConnector({deviceKey:n,connector:r});const s=r.state.subscribe(l=>{if(this.mcs.activeDeviceKey()==n){const c=l.device?l.device.deviceName:null;this.foreground.set(l,{optimisticDeviceName:c})}});r.__removeListeners=()=>{r.off("pong",f),s()}}return this.mcs.connectors[n]}initNewConnector({deviceKey:e,connector:n}){this.mcs.connectors[e]=n,this.setConnectedStore({deviceKey:e,connector:n})}setConnectedStore({deviceKey:e,connector:n}){n.connected.subscribe(r=>{this.mcs.activeDeviceKey()==e&&this.mcs.connected.set(r)})}}function Zs(t,e=0,n={}){const r=["day","h","min","s"],f=[24,60,60,1e3];if(e==r.length)return n.ms=t,n;e==0&&(n.totalSeconds=t/1e3);const s=f.slice(e).reduce((l,c)=>l*c,1);return n[r[e]]=Math.floor(t/s),Zs(t%s,e+1,n)}function U0(t){const e=["day","h","min","s"];let n="";for(const r of e)t[r]>0&&(r!="s"||r=="s"&&t.totalSeconds<60)&&(n=`${n} ${t[r]} ${r}`);return n.trim()}function Gs(t){if(t){const e=Date.now(),n=3e3;return t.filter(r=>e<r.expireAt).map(r=>({...r,relativeTimeAdded:e-r.addedAt<n?"now":`${U0(Zs(e-r.addedAt))} ago`}))}return[]}class L0{constructor({mcs:e,thisDeviceStateKeys:n}){this.mcs=e,this.thisDeviceStateKeys=n}specialStoreKeys(){return this.thisDeviceStateKeys.concat(["activeDeviceKey","optimisticDeviceName"])}clear(){this.mcs.clearState({except:this.specialStoreKeys()})}set(e,{optimisticDeviceName:n=void 0}={}){this.clear();const r={};for(const f of Object.keys(e))this.specialStoreKeys().includes(f)||(r[f]=e[f]);n&&(r.optimisticDeviceName=n),this.mcs.setMerge(r)}setSpecial(e){const n={};for(const r of this.thisDeviceStateKeys)r=="notifications"?n[r]=Gs(e[r]):n[r]=e[r];this.mcs.setMerge(n)}}class j0 extends gr{constructor({mcs:e,connectDevice:n,foreground:r}){super(),this.mcs=e,this.connectDevice=n,this.foreground=r}switchState({deviceKey:e,deviceName:n}){this.mcs.setMerge({activeDeviceKey:e});const{state:r,connected:f}=this.mcs.connectors[e];this.foreground.set(r.get(),{optimisticDeviceName:n}),this.mcs.connected.set(f.get())}switch({host:e,deviceKey:n,deviceName:r}){if(this.mcs.connectors[n])this.switchState({deviceKey:n,deviceName:r});else if(e)this.foreground.clear(),this.mcs.setMerge({activeDeviceKey:n,optimisticDeviceName:r}),this.connectDevice.connectOtherDevice({host:e,deviceKey:n});else{const f=this.mcs.localConnector.state.get(),{nearbyDevices:s}=f,l=s.find(c=>c.deviceKey==n&&!c.thisDevice);if(l){const{deviceKey:c,deviceName:d,ip:h}=l;this.switch({host:h,deviceKey:c,deviceName:d})}else this.emit("connect_to_device_key_failed"),this.switchState(f.device)}}}const B0=500;class K0 extends pu{constructor({host:e,port:n,protocol:r,keypair:f=$s(),connectToDeviceKey:s,rpcRequestTimeout:l=3e3,log:c,verbose:d}){super();const h=["time","environment","nearbyDevices","nearbySensors","notifications"],{publicKey:p,privateKey:b}=Ps(f);this.publicKey=p,this.privateKey=b,this.keypair=f,this.port=n,this.protocol=r,this.log=c,this.rpcRequestTimeout=l,this.verbose=d,this.connectors={},this.connected=new jn;const m=new L0({mcs:this,thisDeviceStateKeys:h}),y=new M0({mcs:this,foreground:m,connectToDeviceKey:s});this.connectDevice=y,this.switchDevice=new j0({mcs:this,connectDevice:y,foreground:m}),this.switchDevice.on("connect_to_device_key_failed",()=>{this.emit("connect_to_device_key_failed")}),this.localConnector=y.connectThisDevice({host:e}),this._notificationsExpireAndCalculateRelativeTime()}_notificationsExpireAndCalculateRelativeTime(){const{notifications:e}=this.get();this.setMerge({notifications:Gs(e)}),setTimeout(()=>{this._notificationsExpireAndCalculateRelativeTime()},B0)}signal(e,n){this.activeConnector()?this.activeConnector().signal(e,n):console.log(`MCS: Error emitting remote signal ${e} / ${n}. Debug info: activeDeviceKey=${this.activeDeviceKey()}`)}signalLocalDevice(e,n){this.localConnector.signal(e,n)}remoteObject(e){if(this.activeConnector())return this.activeConnector().remoteObject(e);console.log(`Error obtaining remote object ${e}. Debug info: activeDeviceKey=${this.activeDeviceKey()}`)}preconnect({host:e,deviceKey:n,thisDevice:r}){return r?this.localConnector:this.connectDevice.connectOtherDevice({host:e,deviceKey:n})}switch({host:e,deviceKey:n,deviceName:r}){this.switchDevice.switch({host:e,deviceKey:n,deviceName:r})}activeConnector(){if(this.activeDeviceKey())return this.connectors[this.activeDeviceKey()]}activeDeviceKey(){return this.get().activeDeviceKey}}const z0=7780,q0="dmt/gui",Vs=localStorage.getItem("current_device_key");console.log(`connectToDeviceKey: ${Vs}`);const Qs=new K0({port:z0,protocol:q0,connectToDeviceKey:Vs,log:Kt.log});Qs.on("connect_to_device_key_failed",()=>{console.log("connect_to_device_key_failed FAILED"),localStorage.removeItem("current_device_key")});window.onerror=xo(ss);new au({target:document.body,props:{store:Qs,log:Kt.log}});
