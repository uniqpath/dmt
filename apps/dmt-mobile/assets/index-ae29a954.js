(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function pe(){}const fi=t=>t;function po(t,e){for(const n in e)t[n]=e[n];return t}function ts(t){return t()}function vi(){return Object.create(null)}function yt(t){t.forEach(ts)}function qn(t){return typeof t=="function"}function st(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let rr;function mi(t,e){return rr||(rr=document.createElement("a")),rr.href=e,t===rr.href}function bo(t){return Object.keys(t).length===0}function St(t,...e){if(t==null)return pe;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function vo(t){let e;return St(t,n=>e=n)(),e}function mt(t,e,n){t.$$.on_destroy.push(St(e,n))}function ns(t,e,n,r){if(t){const i=rs(t,e,n,r);return t[0](i)}}function rs(t,e,n,r){return t[1]&&r?po(n.ctx.slice(),t[1](r(e))):n.ctx}function is(t,e,n,r){if(t[2]&&r){const i=t[2](r(n));if(e.dirty===void 0)return i;if(typeof i=="object"){const s=[],l=Math.max(e.dirty.length,i.length);for(let c=0;c<l;c+=1)s[c]=e.dirty[c]|i[c];return s}return e.dirty|i}return e.dirty}function fs(t,e,n,r,i,s){if(i){const l=rs(e,n,r,s);t.p(l,i)}}function ss(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let r=0;r<n;r++)e[r]=-1;return e}return-1}function yi(t){const e=typeof t=="string"&&t.match(/^\s*(-?[\d.]+)([^\s]*)\s*$/);return e?[parseFloat(e[1]),e[2]||"px"]:[t,"px"]}const os=typeof window<"u";let ls=os?()=>window.performance.now():()=>Date.now(),si=os?t=>requestAnimationFrame(t):pe;const zn=new Set;function cs(t){zn.forEach(e=>{e.c(t)||(zn.delete(e),e.f())}),zn.size!==0&&si(cs)}function as(t){let e;return zn.size===0&&si(cs),{promise:new Promise(n=>{zn.add(e={c:t,f:n})}),abort(){zn.delete(e)}}}function k(t,e){t.appendChild(e)}function us(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function mo(t){const e=M("style");return yo(us(t),e),e.sheet}function yo(t,e){return k(t.head||t,e),e.sheet}function T(t,e,n){t.insertBefore(e,n||null)}function C(t){t.parentNode&&t.parentNode.removeChild(t)}function gn(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function M(t){return document.createElement(t)}function K(t){return document.createTextNode(t)}function H(){return K(" ")}function _t(){return K("")}function Ae(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function ds(t){return function(e){return e.preventDefault(),t.call(this,e)}}function gi(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function U(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function go(t){return Array.from(t.childNodes)}function De(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function wi(t,e){t.value=e??""}function ir(t,e,n,r){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function le(t,e,n){t.classList[n?"add":"remove"](e)}function wo(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}const lr=new Map;let cr=0;function xo(t){let e=5381,n=t.length;for(;n--;)e=(e<<5)-e^t.charCodeAt(n);return e>>>0}function Ao(t,e){const n={stylesheet:mo(e),rules:{}};return lr.set(t,n),n}function hs(t,e,n,r,i,s,l,c=0){const a=16.666/r;let h=`{
`;for(let $=0;$<=1;$+=a){const A=e+(n-e)*s($);h+=$*100+`%{${l(A,1-A)}}
`}const p=h+`100% {${l(n,1-n)}}
}`,b=`__svelte_${xo(p)}_${c}`,m=us(t),{stylesheet:y,rules:E}=lr.get(m)||Ao(m,t);E[b]||(E[b]=!0,y.insertRule(`@keyframes ${b} ${p}`,y.cssRules.length));const x=t.style.animation||"";return t.style.animation=`${x?`${x}, `:""}${b} ${r}ms linear ${i}ms 1 both`,cr+=1,b}function qr(t,e){const n=(t.style.animation||"").split(", "),r=n.filter(e?s=>s.indexOf(e)<0:s=>s.indexOf("__svelte")===-1),i=n.length-r.length;i&&(t.style.animation=r.join(", "),cr-=i,cr||Eo())}function Eo(){si(()=>{cr||(lr.forEach(t=>{const{ownerNode:e}=t.stylesheet;e&&C(e)}),lr.clear())})}let er;function Xn(t){er=t}function So(){if(!er)throw new Error("Function called outside component initialization");return er}function Oo(t){So().$$.on_mount.push(t)}const Pn=[],xi=[];let Bn=[];const Ai=[],ko=Promise.resolve();let Yr=!1;function Co(){Yr||(Yr=!0,ko.then(_s))}function Tt(t){Bn.push(t)}const Tr=new Set;let Dn=0;function _s(){if(Dn!==0)return;const t=er;do{try{for(;Dn<Pn.length;){const e=Pn[Dn];Dn++,Xn(e),To(e.$$)}}catch(e){throw Pn.length=0,Dn=0,e}for(Xn(null),Pn.length=0,Dn=0;xi.length;)xi.pop()();for(let e=0;e<Bn.length;e+=1){const n=Bn[e];Tr.has(n)||(Tr.add(n),n())}Bn.length=0}while(Pn.length);for(;Ai.length;)Ai.pop()();Yr=!1,Tr.clear(),Xn(t)}function To(t){if(t.fragment!==null){t.update(),yt(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Tt)}}function Ro(t){const e=[],n=[];Bn.forEach(r=>t.indexOf(r)===-1?e.push(r):n.push(r)),n.forEach(r=>r()),Bn=e}let Zn;function ps(){return Zn||(Zn=Promise.resolve(),Zn.then(()=>{Zn=null})),Zn}function ar(t,e,n){t.dispatchEvent(wo(`${e?"intro":"outro"}${n}`))}const fr=new Set;let mn;function xt(){mn={r:0,c:[],p:mn}}function At(){mn.r||yt(mn.c),mn=mn.p}function te(t,e){t&&t.i&&(fr.delete(t),t.i(e))}function ye(t,e,n,r){if(t&&t.o){if(fr.has(t))return;fr.add(t),mn.c.push(()=>{fr.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const bs={duration:0};function pn(t,e,n){const r={direction:"in"};let i=e(t,n,r),s=!1,l,c,a=0;function h(){l&&qr(t,l)}function p(){const{delay:m=0,duration:y=300,easing:E=fi,tick:x=pe,css:$}=i||bs;$&&(l=hs(t,0,1,y,m,E,$,a++)),x(0,1);const A=ls()+m,B=A+y;c&&c.abort(),s=!0,Tt(()=>ar(t,!0,"start")),c=as(ee=>{if(s){if(ee>=B)return x(1,0),ar(t,!0,"end"),h(),s=!1;if(ee>=A){const L=E((ee-A)/y);x(L,1-L)}}return s})}let b=!1;return{start(){b||(b=!0,qr(t),qn(i)?(i=i(r),ps().then(p)):p())},invalidate(){b=!1},end(){s&&(h(),s=!1)}}}function No(t,e,n){const r={direction:"out"};let i=e(t,n,r),s=!0,l;const c=mn;c.r+=1;function a(){const{delay:h=0,duration:p=300,easing:b=fi,tick:m=pe,css:y}=i||bs;y&&(l=hs(t,1,0,p,h,b,y));const E=ls()+h,x=E+p;Tt(()=>ar(t,!1,"start")),as($=>{if(s){if($>=x)return m(0,1),ar(t,!1,"end"),--c.r||yt(c.c),!1;if($>=E){const A=b(($-E)/p);m(1-A,A)}}return s})}return qn(i)?ps().then(()=>{i=i(r),a()}):a(),{end(h){h&&i.tick&&i.tick(1,0),s&&(l&&qr(t,l),s=!1)}}}function Be(t){t&&t.c()}function Le(t,e,n,r){const{fragment:i,after_update:s}=t.$$;i&&i.m(e,n),r||Tt(()=>{const l=t.$$.on_mount.map(ts).filter(qn);t.$$.on_destroy?t.$$.on_destroy.push(...l):yt(l),t.$$.on_mount=[]}),s.forEach(Tt)}function ze(t,e){const n=t.$$;n.fragment!==null&&(Ro(n.after_update),yt(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Do(t,e){t.$$.dirty[0]===-1&&(Pn.push(t),Co(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ot(t,e,n,r,i,s,l,c=[-1]){const a=er;Xn(t);const h=t.$$={fragment:null,ctx:[],props:s,update:pe,not_equal:i,bound:vi(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:vi(),dirty:c,skip_bound:!1,root:e.target||a.$$.root};l&&l(h.root);let p=!1;if(h.ctx=n?n(t,e.props||{},(b,m,...y)=>{const E=y.length?y[0]:m;return h.ctx&&i(h.ctx[b],h.ctx[b]=E)&&(!h.skip_bound&&h.bound[b]&&h.bound[b](E),p&&Do(t,b)),m}):[],h.update(),p=!0,yt(h.before_update),h.fragment=r?r(h.ctx):!1,e.target){if(e.hydrate){const b=go(e.target);h.fragment&&h.fragment.l(b),b.forEach(C)}else h.fragment&&h.fragment.c();e.intro&&te(t.$$.fragment),Le(t,e.target,e.anchor,e.customElement),_s()}Xn(a)}class lt{$destroy(){ze(this,1),this.$destroy=pe}$on(e,n){if(!qn(n))return pe;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!bo(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const $n=[];function $o(t,e){return{subscribe:en(t,e).subscribe}}function en(t,e=pe){let n;const r=new Set;function i(c){if(st(t,c)&&(t=c,n)){const a=!$n.length;for(const h of r)h[1](),$n.push(h,t);if(a){for(let h=0;h<$n.length;h+=2)$n[h][0]($n[h+1]);$n.length=0}}}function s(c){i(c(t))}function l(c,a=pe){const h=[c,a];return r.add(h),r.size===1&&(n=e(i)||pe),c(t),()=>{r.delete(h),r.size===0&&n&&(n(),n=null)}}return{set:i,update:s,subscribe:l}}function Po(t,e,n){const r=!Array.isArray(t),i=r?[t]:t,s=e.length<2;return $o(n,l=>{let c=!1;const a=[];let h=0,p=pe;const b=()=>{if(h)return;p();const y=e(r?a[0]:a,l);s?l(y):p=qn(y)?y:pe},m=i.map((y,E)=>St(y,x=>{a[E]=x,h&=~(1<<E),c&&b()},()=>{h|=1<<E}));return c=!0,b(),function(){yt(m),p(),c=!1}})}function Io(t){const e=t-1;return e*e*e+1}function vs(t,{delay:e=0,duration:n=400,easing:r=fi}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:r,css:s=>`opacity: ${s*i}`}}function yn(t,{delay:e=0,duration:n=400,easing:r=Io,x:i=0,y:s=0,opacity:l=0}={}){const c=getComputedStyle(t),a=+c.opacity,h=c.transform==="none"?"":c.transform,p=a*(1-l),[b,m]=yi(i),[y,E]=yi(s);return{delay:e,duration:n,easing:r,css:(x,$)=>`
			transform: ${h} translate(${(1-x)*b}${m}, ${(1-x)*y}${E});
			opacity: ${a-p*$}`}}function Mo(t){function e(r,...i){const s=r.subscribe(...i);return s.unsubscribe?()=>s.unsubscribe():s}function n(r){let i;return e(r,s=>i=s)(),i}return(r,i,s,l,c)=>{const{errors:a}=n(t),h=new Date,p=`${h.getHours()}:${`0${h.getMinutes()}`.slice(-2)}`;c&&c.stack?a.push({msg:r,stacktrace:c.stack,time:p}):a.push({msg:`"${r}" (No more info because of CORS, fix: 1) check for the same error on device where gui runs on :80... 2) if more possible errors from this source, then rethrow - see example in dmt-connect/browser/connect around JSON.parse(msg))`,corsProblem:!0,time:p}),t.set({errors:a})}}function Uo(t,e="asc"){return function(r,i){if(!r.hasOwnProperty(t)||!i.hasOwnProperty(t))return 0;const s=typeof r[t]=="string"?r[t].toUpperCase():r[t],l=typeof i[t]=="string"?i[t].toUpperCase():i[t];let c=0;return s>l?c=1:s<l&&(c=-1),e==="desc"?c*-1:c}}function jo(t,e){localStorage.getItem(e)=="true"&&t.set(!0),localStorage.getItem(e)=="false"&&t.set(!1),t.subscribe(n=>{localStorage.setItem(e,n.toString())})}function Ei(t){console.log(`${new Date().toLocaleString()} → ${t}`)}Ei.write=Ei;const ms=en(!0);jo(ms,"show_all_nearby_devices");const ys=en({errors:[]}),gs=en(!1);function ur(t,{defaultSymbol:e="",showTimeLimitIndicator:n=!1}={}){return!t||!t.currentMedia||t.paused?e:n&&t.timeLimit>0?"⏱️":t.currentMedia.mediaType=="video"?"▶":"♫"}function Lo(t){let e;return{c(){e=K("disconnected")},m(n,r){T(n,e,r)},p:pe,d(n){n&&C(e)}}}function zo(t){let e,n=ur(t[2])+"",r,i,s,l,c,a=t[4]==!1&&Si();return{c(){e=M("span"),r=K(n),i=H(),s=M("h2"),l=K(t[1]),c=H(),a&&a.c(),U(e,"class","play_symbol svelte-5h63c7"),U(s,"class","svelte-5h63c7"),le(s,"disconnected",t[4]==!1)},m(h,p){T(h,e,p),k(e,r),T(h,i,p),T(h,s,p),k(s,l),k(s,c),a&&a.m(s,null)},p(h,p){p&4&&n!==(n=ur(h[2])+"")&&De(r,n),p&2&&De(l,h[1]),h[4]==!1?a||(a=Si(),a.c(),a.m(s,null)):a&&(a.d(1),a=null),p&16&&le(s,"disconnected",h[4]==!1)},d(h){h&&C(e),h&&C(i),h&&C(s),a&&a.d()}}}function Si(t){let e;return{c(){e=M("span"),U(e,"class","disconnected svelte-5h63c7")},m(n,r){T(n,e,r)},d(n){n&&C(e)}}}function Oi(t){let e,n,r,i=t[3].ip+"",s;return{c(){e=M("div"),n=M("span"),n.textContent="IP Address",r=H(),s=K(i),U(n,"class","svelte-5h63c7"),U(e,"class","device_stat svelte-5h63c7")},m(l,c){T(l,e,c),k(e,n),k(e,r),k(e,s)},p(l,c){c&8&&i!==(i=l[3].ip+"")&&De(s,i)},d(l){l&&C(e)}}}function ki(t){let e,n,r,i=t[3].cpuUsage+"",s,l;return{c(){var c,a,h;e=M("div"),n=M("span"),n.textContent="CPU Usage",r=H(),s=K(i),l=K("%"),U(n,"class","svelte-5h63c7"),U(e,"class","device_stat cpu_usage svelte-5h63c7"),le(e,"warn1",((c=t[3])==null?void 0:c.cpuUsage)>=50),le(e,"warn2",((a=t[3])==null?void 0:a.cpuUsage)>=70),le(e,"warn3",((h=t[3])==null?void 0:h.cpuUsage)>=80)},m(c,a){T(c,e,a),k(e,n),k(e,r),k(e,s),k(e,l)},p(c,a){var h,p,b;a&8&&i!==(i=c[3].cpuUsage+"")&&De(s,i),a&8&&le(e,"warn1",((h=c[3])==null?void 0:h.cpuUsage)>=50),a&8&&le(e,"warn2",((p=c[3])==null?void 0:p.cpuUsage)>=70),a&8&&le(e,"warn3",((b=c[3])==null?void 0:b.cpuUsage)>=80)},d(c){c&&C(e)}}}function Ci(t){let e,n,r,i=t[3].cpuTemp+"",s,l;return{c(){e=M("div"),n=M("span"),n.textContent="CPU Temperature",r=H(),s=K(i),l=K("°C"),U(n,"class","svelte-5h63c7"),U(e,"class","device_stat svelte-5h63c7")},m(c,a){T(c,e,a),k(e,n),k(e,r),k(e,s),k(e,l)},p(c,a){a&8&&i!==(i=c[3].cpuTemp+"")&&De(s,i)},d(c){c&&C(e)}}}function Ti(t){var l,c;let e,n,r,i=(((l=t[3])==null?void 0:l.wifiAP)||((c=t[3])==null?void 0:c.apssid))+"",s;return{c(){e=M("div"),n=M("span"),n.textContent="Wifi",r=H(),s=K(i),U(n,"class","svelte-5h63c7"),U(e,"class","wifi_ap svelte-5h63c7")},m(a,h){T(a,e,h),k(e,n),k(e,r),k(e,s)},p(a,h){var p,b;h&8&&i!==(i=(((p=a[3])==null?void 0:p.wifiAP)||((b=a[3])==null?void 0:b.apssid))+"")&&De(s,i)},d(a){a&&C(e)}}}function Bo(t){var x,$,A,B,ee;let e,n,r,i,s,l,c;function a(L,j){if(L[1])return zo;if(L[4]!=null)return Lo}let h=a(t),p=h&&h(t),b=((x=t[3])==null?void 0:x.ip)&&Oi(t),m=(($=t[3])==null?void 0:$.cpuUsage)&&ki(t),y=((A=t[3])==null?void 0:A.cpuTemp)&&Ci(t),E=(((B=t[3])==null?void 0:B.wifiAP)||((ee=t[3])==null?void 0:ee.apssid))&&Ti(t);return{c(){e=M("div"),p&&p.c(),r=H(),b&&b.c(),i=H(),m&&m.c(),s=H(),y&&y.c(),l=H(),E&&E.c(),c=_t(),U(e,"class","device_title svelte-5h63c7")},m(L,j){T(L,e,j),p&&p.m(e,null),T(L,r,j),b&&b.m(L,j),T(L,i,j),m&&m.m(L,j),T(L,s,j),y&&y.m(L,j),T(L,l,j),E&&E.m(L,j),T(L,c,j)},p(L,[j]){var q,xe,be,me,Ie;h===(h=a(L))&&p?p.p(L,j):(p&&p.d(1),p=h&&h(L),p&&(p.c(),p.m(e,null))),(q=L[3])!=null&&q.ip?b?b.p(L,j):(b=Oi(L),b.c(),b.m(i.parentNode,i)):b&&(b.d(1),b=null),(xe=L[3])!=null&&xe.cpuUsage?m?m.p(L,j):(m=ki(L),m.c(),m.m(s.parentNode,s)):m&&(m.d(1),m=null),(be=L[3])!=null&&be.cpuTemp?y?y.p(L,j):(y=Ci(L),y.c(),y.m(l.parentNode,l)):y&&(y.d(1),y=null),(me=L[3])!=null&&me.wifiAP||(Ie=L[3])!=null&&Ie.apssid?E?E.p(L,j):(E=Ti(L),E.c(),E.m(c.parentNode,c)):E&&(E.d(1),E=null)},i(L){n||Tt(()=>{n=pn(e,yn,{}),n.start()})},o:pe,d(L){L&&C(e),p&&p.d(),L&&C(r),b&&b.d(L),L&&C(i),m&&m.d(L),L&&C(s),y&&y.d(L),L&&C(l),E&&E.d(L),L&&C(c)}}}function Ko(t,e,n){let r,i,s=pe,l=()=>(s(),s=St(c,y=>n(4,i=y)),c);t.$$.on_destroy.push(()=>s());let{connected:c}=e;l();let{nearbyDevices:a}=e,{deviceName:h}=e,{device:p}=e,{activeDeviceKey:b}=e,{player:m}=e;return t.$$set=y=>{"connected"in y&&l(n(0,c=y.connected)),"nearbyDevices"in y&&n(5,a=y.nearbyDevices),"deviceName"in y&&n(1,h=y.deviceName),"device"in y&&n(6,p=y.device),"activeDeviceKey"in y&&n(7,b=y.activeDeviceKey),"player"in y&&n(2,m=y.player)},t.$$.update=()=>{t.$$.dirty&160&&n(3,r=a.find(y=>y.deviceKey==b))},[c,h,m,r,i,a,p,b]}class qo extends lt{constructor(e){super(),ot(this,e,Ko,Bo,st,{connected:0,nearbyDevices:5,deviceName:1,device:6,activeDeviceKey:7,player:2})}}function Rr(t,e=2){return Array(Math.max(e-String(t).length+1,0)).join(0)+t}function In(t){t=Math.round(t);const e=Math.floor(t/3600),n=t%3600,r=Math.floor(n/60);return t=n%60,e?`${e}h ${Rr(r)}min ${Rr(t)}s`:`${r}:${Rr(t)}`}function Yo(t){let e=In(t[0].currentMedia.duration)+"",n;return{c(){n=K(e)},m(r,i){T(r,n,i)},p(r,i){i&1&&e!==(e=In(r[0].currentMedia.duration)+"")&&De(n,e)},d(r){r&&C(n)}}}function Fo(t){let e=In(Math.floor(t[0].timeposition))+"",n,r,i=In(t[0].currentMedia.duration)+"",s,l,c,a=Math.round(t[0].percentposition)+"",h,p;return{c(){n=K(e),r=K(" / "),s=K(i),l=K(" — "),c=M("span"),h=K(a),p=K("%"),U(c,"class","svelte-b6jwnj")},m(b,m){T(b,n,m),T(b,r,m),T(b,s,m),T(b,l,m),T(b,c,m),k(c,h),k(c,p)},p(b,m){m&1&&e!==(e=In(Math.floor(b[0].timeposition))+"")&&De(n,e),m&1&&i!==(i=In(b[0].currentMedia.duration)+"")&&De(s,i),m&1&&a!==(a=Math.round(b[0].percentposition)+"")&&De(h,a)},d(b){b&&C(n),b&&C(r),b&&C(s),b&&C(l),b&&C(c)}}}function Ho(t){let e;return{c(){e=K("(radio)")},m(n,r){T(n,e,r)},p:pe,d(n){n&&C(e)}}}function Jo(t){let e;function n(s,l){if(s[0].isStream)return Ho;if(s[0].timeposition)return Fo;if(s[0].duration)return Yo}let r=n(t),i=r&&r(t);return{c(){e=M("section"),i&&i.c(),U(e,"class","progress svelte-b6jwnj"),le(e,"faded",t[0].paused)},m(s,l){T(s,e,l),i&&i.m(e,null)},p(s,[l]){r===(r=n(s))&&i?i.p(s,l):(i&&i.d(1),i=r&&r(s),i&&(i.c(),i.m(e,null))),l&1&&le(e,"faded",s[0].paused)},i:pe,o:pe,d(s){s&&C(e),i&&i.d()}}}function Wo(t,e,n){let{player:r}=e;return t.$$set=i=>{"player"in i&&n(0,r=i.player)},[r]}class Zo extends lt{constructor(e){super(),ot(this,e,Wo,Jo,st,{player:0})}}function Ri(t){let e,n,r,i;function s(a,h){if(a[2]&&a[6])return Vo;if(a[6])return Go}let l=s(t),c=l&&l(t);return r=new Zo({props:{player:t[0]}}),{c(){e=M("div"),c&&c.c(),n=H(),Be(r.$$.fragment),U(e,"class","wrapper svelte-120eh85")},m(a,h){T(a,e,h),c&&c.m(e,null),k(e,n),Le(r,e,null),i=!0},p(a,h){l===(l=s(a))&&c?c.p(a,h):(c&&c.d(1),c=l&&l(a),c&&(c.c(),te(c,1),c.m(e,n)));const p={};h&1&&(p.player=a[0]),r.$set(p)},i(a){i||(te(c),te(r.$$.fragment,a),i=!0)},o(a){ye(r.$$.fragment,a),i=!1},d(a){a&&C(e),c&&c.d(),ze(r)}}}function Go(t){let e,n;return{c(){e=M("section"),e.textContent="[ No media loaded ]",U(e,"class","no_media svelte-120eh85")},m(r,i){T(r,e,i)},p:pe,i(r){n||Tt(()=>{n=pn(e,yn,{}),n.start()})},o:pe,d(r){r&&C(e)}}}function Vo(t){let e,n,r=ur(t[0],{showTimeLimitIndicator:!0})+"",i,s,l,c,a,h,p=t[3]&&Ni(t);return{c(){var b;e=M("section"),n=M("span"),i=K(r),s=H(),l=K(t[2]),c=H(),a=M("div"),p&&p.c(),U(n,"class","play_symbol svelte-120eh85"),U(a,"class","file_path svelte-120eh85"),U(e,"class","current_media svelte-120eh85"),le(e,"playing",!t[0].paused),le(e,"within_limit",!t[0].isStream&&t[0].limit),le(e,"last_in_limit",!t[0].isStream&&t[0].limit==1),le(e,"error",t[5]==t[3]&&((b=t[4])==null?void 0:b.error))},m(b,m){T(b,e,m),k(e,n),k(n,i),k(e,s),k(e,l),k(e,c),k(e,a),p&&p.m(a,null)},p(b,m){var y;m&1&&r!==(r=ur(b[0],{showTimeLimitIndicator:!0})+"")&&De(i,r),m&4&&De(l,b[2]),b[3]?p?p.p(b,m):(p=Ni(b),p.c(),p.m(a,null)):p&&(p.d(1),p=null),m&1&&le(e,"playing",!b[0].paused),m&1&&le(e,"within_limit",!b[0].isStream&&b[0].limit),m&1&&le(e,"last_in_limit",!b[0].isStream&&b[0].limit==1),m&56&&le(e,"error",b[5]==b[3]&&((y=b[4])==null?void 0:y.error))},i(b){h||Tt(()=>{h=pn(e,yn,{}),h.start()})},o:pe,d(b){b&&C(e),p&&p.d()}}}function Ni(t){let e=Di(t[3])+"",n;return{c(){n=K(e)},m(r,i){T(r,n,i)},p(r,i){i&8&&e!==(e=Di(r[3])+"")&&De(n,e)},d(r){r&&C(n)}}}function Qo(t){let e,n,r=t[0]&&Ri(t);return{c(){r&&r.c(),e=_t()},m(i,s){r&&r.m(i,s),T(i,e,s),n=!0},p(i,[s]){i[0]?r?(r.p(i,s),s&1&&te(r,1)):(r=Ri(i),r.c(),te(r,1),r.m(e.parentNode,e)):r&&(xt(),ye(r,1,1,()=>{r=null}),At())},i(i){n||(te(r),n=!0)},o(i){ye(r),n=!1},d(i){r&&r.d(i),i&&C(e)}}}function Di(t){return t.replace("/root/DMTMountedMedia","")}function Xo(t,e,n){let r,i=pe,s=()=>(i(),i=St(c,y=>n(6,r=y)),c);t.$$.on_destroy.push(()=>i());let{player:l}=e,{connected:c}=e;s();let{store:a}=e,{songTitle:h}=e,{songPath:p}=e,{playlistCurrentMedia:b}=e,{playlistSongPath:m}=e;return t.$$set=y=>{"player"in y&&n(0,l=y.player),"connected"in y&&s(n(1,c=y.connected)),"store"in y&&n(7,a=y.store),"songTitle"in y&&n(2,h=y.songTitle),"songPath"in y&&n(3,p=y.songPath),"playlistCurrentMedia"in y&&n(4,b=y.playlistCurrentMedia),"playlistSongPath"in y&&n(5,m=y.playlistSongPath)},[l,c,h,p,b,m,r,a]}class el extends lt{constructor(e){super(),ot(this,e,Xo,Qo,st,{player:0,connected:1,store:7,songTitle:2,songPath:3,playlistCurrentMedia:4,playlistSongPath:5})}}function $i(t){let e;function n(s,l){return s[1].paused?nl:tl}let r=n(t),i=r(t);return{c(){i.c(),e=_t()},m(s,l){i.m(s,l),T(s,e,l)},p(s,l){r===(r=n(s))&&i?i.p(s,l):(i.d(1),i=r(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){i.d(s),s&&C(e)}}}function tl(t){let e,n,r,i=(t[2]||"")+"",s,l,c,a;return{c(){e=M("button"),n=K("● Pause "),r=M("span"),s=K(i),U(r,"class","svelte-p9vgzg"),U(e,"class","pause svelte-p9vgzg"),e.disabled=l=!t[5]},m(h,p){T(h,e,p),k(e,n),k(e,r),k(r,s),c||(a=Ae(e,"click",t[8]),c=!0)},p(h,p){p&4&&i!==(i=(h[2]||"")+"")&&De(s,i),p&32&&l!==(l=!h[5])&&(e.disabled=l)},d(h){h&&C(e),c=!1,a()}}}function nl(t){let e,n,r,i=(t[2]||"")+"",s,l,c,a;return{c(){e=M("button"),n=K("▶ Play "),r=M("span"),s=K(i),U(r,"class","svelte-p9vgzg"),U(e,"class","play svelte-p9vgzg"),e.disabled=l=!t[5]},m(h,p){T(h,e,p),k(e,n),k(e,r),k(r,s),c||(a=Ae(e,"click",t[7]),c=!0)},p(h,p){p&4&&i!==(i=(h[2]||"")+"")&&De(s,i),p&32&&l!==(l=!h[5])&&(e.disabled=l)},d(h){h&&C(e),c=!1,a()}}}function Pi(t){let e,n=t[1].volume+"",r;return{c(){e=M("div"),r=K(n),U(e,"class","volume_level svelte-p9vgzg"),le(e,"faded",t[1].paused)},m(i,s){T(i,e,s),k(e,r)},p(i,s){s&2&&n!==(n=i[1].volume+"")&&De(r,n),s&2&&le(e,"faded",i[1].paused)},d(i){i&&C(e)}}}function Ii(t){let e,n,r=t[1].isStream?"Close radio":"Stop",i,s,l,c;return{c(){e=M("button"),n=K("■ "),i=K(r),U(e,"class","stop svelte-p9vgzg"),e.disabled=s=!t[5],le(e,"radio",t[1].isStream)},m(a,h){T(a,e,h),k(e,n),k(e,i),l||(c=Ae(e,"click",t[11]),l=!0)},p(a,h){h&2&&r!==(r=a[1].isStream?"Close radio":"Stop")&&De(i,r),h&32&&s!==(s=!a[5])&&(e.disabled=s),h&2&&le(e,"radio",a[1].isStream)},d(a){a&&C(e),l=!1,c()}}}function Mi(t){let e,n,r,i,s,l,c,a,h,p,b=(t[1].repeatCount||"")+"",m,y,E,x;return{c(){e=M("button"),n=K("Shuffle"),i=H(),s=M("button"),l=K("Similar"),a=H(),h=M("button"),p=K("Repeat "),m=K(b),U(e,"class","shuffle svelte-p9vgzg"),e.disabled=r=!t[5],U(s,"class","similar svelte-p9vgzg"),s.disabled=c=!t[5],U(h,"class","repeat svelte-p9vgzg"),h.disabled=y=!t[5],le(h,"repeat_set",t[1].repeatCount>0)},m($,A){T($,e,A),k(e,n),T($,i,A),T($,s,A),k(s,l),T($,a,A),T($,h,A),k(h,p),k(h,m),E||(x=[Ae(e,"click",t[12]),Ae(s,"click",t[13]),Ae(h,"click",t[14])],E=!0)},p($,A){A&32&&r!==(r=!$[5])&&(e.disabled=r),A&32&&c!==(c=!$[5])&&(s.disabled=c),A&2&&b!==(b=($[1].repeatCount||"")+"")&&De(m,b),A&32&&y!==(y=!$[5])&&(h.disabled=y),A&2&&le(h,"repeat_set",$[1].repeatCount>0)},d($){$&&C(e),$&&C(i),$&&C(s),$&&C(a),$&&C(h),E=!1,yt(x)}}}function Ui(t){let e,n,r,i,s,l,c,a,h;return{c(){e=M("button"),n=K("« 20s"),i=H(),s=M("button"),l=K("20s »"),U(e,"class","backward svelte-p9vgzg"),e.disabled=r=!t[5],U(s,"class","forward svelte-p9vgzg"),s.disabled=c=!t[5]},m(p,b){T(p,e,b),k(e,n),T(p,i,b),T(p,s,b),k(s,l),a||(h=[Ae(e,"click",t[15]),Ae(s,"click",t[16])],a=!0)},p(p,b){b&32&&r!==(r=!p[5])&&(e.disabled=r),b&32&&c!==(c=!p[5])&&(s.disabled=c)},d(p){p&&C(e),p&&C(i),p&&C(s),a=!1,yt(h)}}}function ji(t){let e;function n(s,l){return s[1].isStream?il:rl}let r=n(t),i=r(t);return{c(){i.c(),e=_t()},m(s,l){i.m(s,l),T(s,e,l)},p(s,l){r===(r=n(s))&&i?i.p(s,l):(i.d(1),i=r(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){i.d(s),s&&C(e)}}}function rl(t){let e,n,r,i,s,l,c=(t[1].limit>0||t[1].timeLimit>0)&&Li(t),a=t[1].limit>0&&zi(t);function h(m,y){return m[1].timeLimit>0?sl:fl}let p=h(t),b=p(t);return{c(){c&&c.c(),e=H(),a&&a.c(),n=H(),r=M("button"),b.c(),U(r,"class","limit svelte-p9vgzg"),r.disabled=i=!t[5],le(r,"limit_set",t[1].limit>0),le(r,"time_limit_set",t[1].timeLimit>0)},m(m,y){c&&c.m(m,y),T(m,e,y),a&&a.m(m,y),T(m,n,y),T(m,r,y),b.m(r,null),s||(l=Ae(r,"click",t[6]),s=!0)},p(m,y){m[1].limit>0||m[1].timeLimit>0?c?c.p(m,y):(c=Li(m),c.c(),c.m(e.parentNode,e)):c&&(c.d(1),c=null),m[1].limit>0?a?a.p(m,y):(a=zi(m),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null),p===(p=h(m))&&b?b.p(m,y):(b.d(1),b=p(m),b&&(b.c(),b.m(r,null))),y&32&&i!==(i=!m[5])&&(r.disabled=i),y&2&&le(r,"limit_set",m[1].limit>0),y&2&&le(r,"time_limit_set",m[1].timeLimit>0)},d(m){c&&c.d(m),m&&C(e),a&&a.d(m),m&&C(n),m&&C(r),b.d(),s=!1,l()}}}function il(t){let e,n,r,i,s,l=t[1].timeLimit>0&&Bi(t);function c(p,b){return p[1].timeLimit>0?ll:ol}let a=c(t),h=a(t);return{c(){l&&l.c(),e=H(),n=M("button"),h.c(),U(n,"class","limit svelte-p9vgzg"),n.disabled=r=!t[5],le(n,"time_limit_set",t[1].timeLimit>0)},m(p,b){l&&l.m(p,b),T(p,e,b),T(p,n,b),h.m(n,null),i||(s=Ae(n,"click",t[6]),i=!0)},p(p,b){p[1].timeLimit>0?l?l.p(p,b):(l=Bi(p),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),a===(a=c(p))&&h?h.p(p,b):(h.d(1),h=a(p),h&&(h.c(),h.m(n,null))),b&32&&r!==(r=!p[5])&&(n.disabled=r),b&2&&le(n,"time_limit_set",p[1].timeLimit>0)},d(p){l&&l.d(p),p&&C(e),p&&C(n),h.d(),i=!1,s()}}}function Li(t){let e,n,r,i,s;return{c(){e=M("button"),n=K("🗑️ Cancel"),U(e,"class","remove_limit svelte-p9vgzg"),e.disabled=r=!t[5],le(e,"remove_time_limit",t[1].timeLimit>0)},m(l,c){T(l,e,c),k(e,n),i||(s=Ae(e,"click",t[18]),i=!0)},p(l,c){c&32&&r!==(r=!l[5])&&(e.disabled=r),c&2&&le(e,"remove_time_limit",l[1].timeLimit>0)},d(l){l&&C(e),i=!1,s()}}}function zi(t){let e,n,r,i,s;return{c(){e=M("button"),n=K("⏱️ Limit"),U(e,"class","set_time_limit svelte-p9vgzg"),e.disabled=r=!t[5]},m(l,c){T(l,e,c),k(e,n),i||(s=Ae(e,"click",t[19]),i=!0)},p(l,c){c&32&&r!==(r=!l[5])&&(e.disabled=r)},d(l){l&&C(e),i=!1,s()}}}function fl(t){let e,n=(t[1].limit||"")+"",r;return{c(){e=K("Limit "),r=K(n)},m(i,s){T(i,e,s),T(i,r,s)},p(i,s){s&2&&n!==(n=(i[1].limit||"")+"")&&De(r,n)},d(i){i&&C(e),i&&C(r)}}}function sl(t){let e,n,r=dr(t[1])+"",i;return{c(){e=M("span"),n=K("⏱️ "),i=K(r)},m(s,l){T(s,e,l),k(e,n),k(e,i)},p(s,l){l&2&&r!==(r=dr(s[1])+"")&&De(i,r)},d(s){s&&C(e)}}}function Bi(t){let e,n,r,i,s;return{c(){e=M("button"),n=K("🗑️ Cancel"),U(e,"class","remove_limit svelte-p9vgzg"),e.disabled=r=!t[5],le(e,"remove_time_limit",t[1].timeLimit>0)},m(l,c){T(l,e,c),k(e,n),i||(s=Ae(e,"click",t[17]),i=!0)},p(l,c){c&32&&r!==(r=!l[5])&&(e.disabled=r),c&2&&le(e,"remove_time_limit",l[1].timeLimit>0)},d(l){l&&C(e),i=!1,s()}}}function ol(t){let e;return{c(){e=M("span"),e.textContent="⏱️ Limit"},m(n,r){T(n,e,r)},p:pe,d(n){n&&C(e)}}}function ll(t){let e,n,r=dr(t[1])+"",i;return{c(){e=M("span"),n=K("⏱️ "),i=K(r)},m(s,l){T(s,e,l),k(e,n),k(e,i)},p(s,l){l&2&&r!==(r=dr(s[1])+"")&&De(i,r)},d(s){s&&C(e)}}}function cl(t){let e,n,r,i,s,l,c,a,h,p,b,m,y,E,x,$,A,B,ee=t[3]&&$i(t),L=t[5]&&t[1].volume!=null&&Pi(t),j=t[3]&&Ii(t),q=!t[1].isStream&&t[3]&&Mi(t),xe=!t[1].isStream&&t[3]&&Ui(t),be=t[3]&&ji(t);return{c(){e=M("section"),ee&&ee.c(),n=H(),r=M("button"),i=K("Vol ↓"),l=H(),c=M("button"),a=K("Vol ↑"),p=H(),L&&L.c(),b=H(),m=M("section"),j&&j.c(),y=H(),q&&q.c(),E=H(),x=M("section"),xe&&xe.c(),$=H(),be&&be.c(),U(r,"class","volume svelte-p9vgzg"),r.disabled=s=!t[5],U(c,"class","volume svelte-p9vgzg"),c.disabled=h=!t[5],U(e,"class","main svelte-p9vgzg"),U(m,"class","svelte-p9vgzg"),U(x,"class","svelte-p9vgzg")},m(me,Ie){T(me,e,Ie),ee&&ee.m(e,null),k(e,n),k(e,r),k(r,i),k(e,l),k(e,c),k(c,a),k(e,p),L&&L.m(e,null),T(me,b,Ie),T(me,m,Ie),j&&j.m(m,null),k(m,y),q&&q.m(m,null),T(me,E,Ie),T(me,x,Ie),xe&&xe.m(x,null),k(x,$),be&&be.m(x,null),A||(B=[Ae(r,"click",t[9]),Ae(c,"click",t[10])],A=!0)},p(me,[Ie]){me[3]?ee?ee.p(me,Ie):(ee=$i(me),ee.c(),ee.m(e,n)):ee&&(ee.d(1),ee=null),Ie&32&&s!==(s=!me[5])&&(r.disabled=s),Ie&32&&h!==(h=!me[5])&&(c.disabled=h),me[5]&&me[1].volume!=null?L?L.p(me,Ie):(L=Pi(me),L.c(),L.m(e,null)):L&&(L.d(1),L=null),me[3]?j?j.p(me,Ie):(j=Ii(me),j.c(),j.m(m,y)):j&&(j.d(1),j=null),!me[1].isStream&&me[3]?q?q.p(me,Ie):(q=Mi(me),q.c(),q.m(m,null)):q&&(q.d(1),q=null),!me[1].isStream&&me[3]?xe?xe.p(me,Ie):(xe=Ui(me),xe.c(),xe.m(x,$)):xe&&(xe.d(1),xe=null),me[3]?be?be.p(me,Ie):(be=ji(me),be.c(),be.m(x,null)):be&&(be.d(1),be=null)},i:pe,o:pe,d(me){me&&C(e),ee&&ee.d(),L&&L.d(),me&&C(b),me&&C(m),j&&j.d(),q&&q.d(),me&&C(E),me&&C(x),xe&&xe.d(),be&&be.d(),A=!1,yt(B)}}}function dr(t){return t.timeLimit>2?`${Math.round(t.timeLimit)} min`:`${Math.round(t.timeLimit*60)} s`}function al(t,e,n){let r,i=pe,s=()=>(i(),i=St(l,me=>n(5,r=me)),l);t.$$.on_destroy.push(()=>i());let{connected:l}=e;s();let{player:c}=e,{deviceName:a}=e,{songTitle:h}=e,{fnAction:p}=e;function b(){c.isStream||c.timeLimit>0?p("time_limit"):p("limit")}const m=()=>p("play"),y=()=>p("pause"),E=()=>p("volume_down"),x=()=>p("volume_up"),$=()=>p("stop"),A=()=>p("shuffle"),B=()=>p("similar"),ee=()=>p("repeat"),L=()=>p("backward"),j=()=>p("forward"),q=()=>p("remove_time_limit"),xe=()=>p("remove_limit"),be=()=>p("time_limit");return t.$$set=me=>{"connected"in me&&s(n(0,l=me.connected)),"player"in me&&n(1,c=me.player),"deviceName"in me&&n(2,a=me.deviceName),"songTitle"in me&&n(3,h=me.songTitle),"fnAction"in me&&n(4,p=me.fnAction)},[l,c,a,h,p,r,b,m,y,E,x,$,A,B,ee,L,j,q,xe,be]}class ul extends lt{constructor(e){super(),ot(this,e,al,cl,st,{connected:0,player:1,deviceName:2,songTitle:3,fnAction:4})}}const hr=en(),dn=en();function ws(){hr.set(""),dn.set(null)}const Gn=en();function xs(){Gn.set(null)}const dl=""+new URL("close-28a6104f.png",import.meta.url).href,hl=""+new URL("magnifying_glass-a4a7aab7.svg",import.meta.url).href;function Ki(t){let e,n,r,i,s,l;return{c(){e=M("button"),n=K("▼ SET NEXT"),e.disabled=r=!t[2],U(e,"class","svelte-11smw5j")},m(c,a){T(c,e,a),k(e,n),s||(l=Ae(e,"click",ds(t[5])),s=!0)},p(c,a){a&4&&r!==(r=!c[2])&&(e.disabled=r)},i(c){i||Tt(()=>{i=pn(e,yn,{}),i.start()})},o:pe,d(c){c&&C(e),s=!1,l()}}}function _l(t){var $,A;let e,n,r,i,s,l,c,a,h,p,b,m=(($=t[1])==null?void 0:$.trim())&&((A=t[3])==null?void 0:A.length),y,E,x=m&&Ki(t);return{c(){var B;e=M("form"),n=M("div"),r=M("input"),s=H(),l=M("img"),a=H(),h=M("img"),b=H(),x&&x.c(),U(r,"id","search"),U(r,"placeholder","Playlist Search"),U(r,"type","text"),r.disabled=i=!t[2],U(r,"class","svelte-11smw5j"),U(l,"class","magnifying_glass svelte-11smw5j"),mi(l.src,c=hl)||U(l,"src",c),U(h,"class","clear_search svelte-11smw5j"),mi(h.src,p=dl)||U(h,"src",p),le(h,"invisible",!((B=t[1])!=null&&B.trim())),U(n,"class","input_wrapper svelte-11smw5j"),U(e,"class","svelte-11smw5j")},m(B,ee){T(B,e,ee),k(e,n),k(n,r),wi(r,t[1]),k(n,s),k(n,l),k(n,a),k(n,h),k(e,b),x&&x.m(e,null),y||(E=[Ae(r,"input",t[8]),Ae(r,"keyup",t[4]),Ae(h,"click",ws)],y=!0)},p(B,[ee]){var L,j,q;ee&4&&i!==(i=!B[2])&&(r.disabled=i),ee&2&&r.value!==B[1]&&wi(r,B[1]),ee&2&&le(h,"invisible",!((L=B[1])!=null&&L.trim())),ee&10&&(m=((j=B[1])==null?void 0:j.trim())&&((q=B[3])==null?void 0:q.length)),m?x?(x.p(B,ee),ee&10&&te(x,1)):(x=Ki(B),x.c(),te(x,1),x.m(e,null)):x&&(x.d(1),x=null)},i(B){te(x)},o:pe,d(B){B&&C(e),x&&x.d(),y=!1,yt(E)}}}function pl(t,e,n){let r,i,s=pe,l=()=>(s(),s=St(a,A=>n(2,i=A)),a),c;mt(t,hr,A=>n(1,r=A)),mt(t,dn,A=>n(3,c=A)),t.$$.on_destroy.push(()=>s());let{connected:a}=e;l();let{store:h}=e,{fnAction:p}=e,b;function m(A){h.remoteObject("player").call("playlistSearch",{query:r}).then(B=>{B?A==b&&dn.set(B):dn.set(null)}).catch(console.log)}let y;function E(){xs(),clearTimeout(y),r!=null&&r.trim()?(b=Math.random(),y=setTimeout(()=>{m(b)},300)):(b=null,dn.set(null))}function x(){h.remoteObject("player").call("bump",{query:r}).then(()=>{dn.set(null)}).catch(console.log)}function $(){r=this.value,hr.set(r)}return t.$$set=A=>{"connected"in A&&l(n(0,a=A.connected)),"store"in A&&n(6,h=A.store),"fnAction"in A&&n(7,p=A.fnAction)},[a,r,i,c,E,x,h,p,$]}class bl extends lt{constructor(e){super(),ot(this,e,pl,_l,st,{connected:0,store:6,fnAction:7})}}function vl(t){let e,n,r,i,s,l;return{c(){e=M("div"),n=M("button"),n.textContent="Play",r=H(),i=M("button"),i.textContent="Bump",U(n,"class","svelte-27xey9"),U(i,"class","svelte-27xey9"),U(e,"class","controls svelte-27xey9")},m(c,a){T(c,e,a),k(e,n),k(e,r),k(e,i),s||(l=[Ae(n,"click",gi(t[4])),Ae(i,"click",gi(t[5]))],s=!0)},p:pe,i:pe,o:pe,d(c){c&&C(e),s=!1,yt(l)}}}function ml(t,e,n){let{fnAction:r}=e,{entry:i}=e;function s(h){window.scrollTo({top:0,behavior:"smooth"}),ws(),r("next",{songId:h})}function l(h){r("bump",{args:h})}const c=()=>{s(i.id)},a=()=>{l(i.id)};return t.$$set=h=>{"fnAction"in h&&n(3,r=h.fnAction),"entry"in h&&n(0,i=h.entry)},[i,s,l,r,c,a]}class yl extends lt{constructor(e){super(),ot(this,e,ml,vl,st,{fnAction:3,entry:0})}}function qi(t){let e,n,r=t[0].metadata.duration+"",i,s;return{c(){e=M("span"),n=K("["),i=K(r),s=K("]"),U(e,"class","duration svelte-5kr8d6")},m(l,c){T(l,e,c),k(e,n),k(e,i),k(e,s)},p(l,c){c&1&&r!==(r=l[0].metadata.duration+"")&&De(i,r)},d(l){l&&C(e)}}}function gl(t){var B,ee;let e,n,r,i=t[0].title+"",s,l,c,a=Yi(t[0].path)+"",h,p,b,m,y,E,x,$,A=((ee=(B=t[0])==null?void 0:B.metadata)==null?void 0:ee.duration)&&qi(t);return m=new yl({props:{entry:t[0],fnAction:t[1]}}),{c(){e=M("div"),n=M("div"),A&&A.c(),r=H(),s=K(i),l=H(),c=M("div"),h=K(a),p=H(),b=M("div"),Be(m.$$.fragment),U(c,"class","file_path svelte-5kr8d6"),U(b,"class","controls svelte-5kr8d6"),U(n,"class","entry svelte-5kr8d6"),le(n,"selected",t[0].id==t[3]),le(n,"just_bumped",!t[2]&&t[0].justBumped),le(n,"within_limit",!t[2]&&t[0].withinLimit),le(n,"is_search_result",t[2]),le(n,"error",t[0].error),U(e,"class","entry_wrapper svelte-5kr8d6")},m(L,j){T(L,e,j),k(e,n),A&&A.m(n,null),k(n,r),k(n,s),k(n,l),k(n,c),k(c,h),k(n,p),k(n,b),Le(m,b,null),E=!0,x||($=Ae(n,"click",t[5]),x=!0)},p(L,[j]){var xe,be;(be=(xe=L[0])==null?void 0:xe.metadata)!=null&&be.duration?A?A.p(L,j):(A=qi(L),A.c(),A.m(n,r)):A&&(A.d(1),A=null),(!E||j&1)&&i!==(i=L[0].title+"")&&De(s,i),(!E||j&1)&&a!==(a=Yi(L[0].path)+"")&&De(h,a);const q={};j&1&&(q.entry=L[0]),j&2&&(q.fnAction=L[1]),m.$set(q),(!E||j&9)&&le(n,"selected",L[0].id==L[3]),(!E||j&5)&&le(n,"just_bumped",!L[2]&&L[0].justBumped),(!E||j&5)&&le(n,"within_limit",!L[2]&&L[0].withinLimit),(!E||j&4)&&le(n,"is_search_result",L[2]),(!E||j&1)&&le(n,"error",L[0].error)},i(L){E||(te(m.$$.fragment,L),y||Tt(()=>{y=pn(n,yn,{}),y.start()}),E=!0)},o(L){ye(m.$$.fragment,L),E=!1},d(L){L&&C(e),A&&A.d(),ze(m),x=!1,$()}}}function Yi(t){return t.replace("/root/DMTMountedMedia","")}function wl(t,e,n){let r;mt(t,Gn,h=>n(3,r=h));let{entry:i}=e,{fnAction:s}=e,{isSearchResult:l}=e;function c(h){h==vo(Gn)?Gn.set(null):Gn.set(h)}const a=()=>{c(i.id)};return t.$$set=h=>{"entry"in h&&n(0,i=h.entry),"fnAction"in h&&n(1,s=h.fnAction),"isSearchResult"in h&&n(2,l=h.isSearchResult)},[i,s,l,r,c,a]}class As extends lt{constructor(e){super(),ot(this,e,wl,gl,st,{entry:0,fnAction:1,isSearchResult:2})}}function Fi(t,e,n){const r=t.slice();return r[7]=e[n],r}function Hi(t){let e,n,r,i;const s=[Al,xl],l=[];function c(a,h){return a[2].length?0:1}return e=c(t),n=l[e]=s[e](t),{c(){n.c(),r=_t()},m(a,h){l[e].m(a,h),T(a,r,h),i=!0},p(a,h){let p=e;e=c(a),e===p?l[e].p(a,h):(xt(),ye(l[p],1,1,()=>{l[p]=null}),At(),n=l[e],n?n.p(a,h):(n=l[e]=s[e](a),n.c()),te(n,1),n.m(r.parentNode,r))},i(a){i||(te(n),i=!0)},o(a){ye(n),i=!1},d(a){l[e].d(a),a&&C(r)}}}function xl(t){let e,n;return{c(){e=M("h3"),e.textContent="[ No matches ]",U(e,"class","no_matches svelte-11vb31n")},m(r,i){T(r,e,i)},p:pe,i(r){n||Tt(()=>{n=pn(e,yn,{}),n.start()})},o:pe,d(r){r&&C(e)}}}function Al(t){let e,n,r,i,s,l,c;function a(x,$){return x[2].length>vn?Sl:El}let h=a(t),p=h(t),b=t[2].slice(0,vn),m=[];for(let x=0;x<b.length;x+=1)m[x]=Ji(Fi(t,b,x));const y=x=>ye(m[x],1,1,()=>{m[x]=null});let E=t[2].length>vn&&Wi(t);return{c(){e=M("h3"),p.c(),n=H();for(let x=0;x<m.length;x+=1)m[x].c();r=H(),i=M("div"),E&&E.c(),s=H(),l=M("span"),l.textContent="💡 Use comma (,) to separate multiple additive search terms.",U(e,"class","svelte-11vb31n"),U(l,"class","deemph svelte-11vb31n"),U(i,"class","result_count svelte-11vb31n")},m(x,$){T(x,e,$),p.m(e,null),T(x,n,$);for(let A=0;A<m.length;A+=1)m[A]&&m[A].m(x,$);T(x,r,$),T(x,i,$),E&&E.m(i,null),k(i,s),k(i,l),c=!0},p(x,$){if(h===(h=a(x))&&p?p.p(x,$):(p.d(1),p=h(x),p&&(p.c(),p.m(e,null))),$&6){b=x[2].slice(0,vn);let A;for(A=0;A<b.length;A+=1){const B=Fi(x,b,A);m[A]?(m[A].p(B,$),te(m[A],1)):(m[A]=Ji(B),m[A].c(),te(m[A],1),m[A].m(r.parentNode,r))}for(xt(),A=b.length;A<m.length;A+=1)y(A);At()}x[2].length>vn?E?E.p(x,$):(E=Wi(x),E.c(),E.m(i,s)):E&&(E.d(1),E=null)},i(x){if(!c){for(let $=0;$<b.length;$+=1)te(m[$]);c=!0}},o(x){m=m.filter(Boolean);for(let $=0;$<m.length;$+=1)ye(m[$]);c=!1},d(x){x&&C(e),p.d(),x&&C(n),gn(m,x),x&&C(r),x&&C(i),E&&E.d()}}}function El(t){let e=t[2].length+"",n,r,i=t[2].length==1?"match":"matches",s;return{c(){n=K(e),r=H(),s=K(i)},m(l,c){T(l,n,c),T(l,r,c),T(l,s,c)},p(l,c){c&4&&e!==(e=l[2].length+"")&&De(n,e),c&4&&i!==(i=l[2].length==1?"match":"matches")&&De(s,i)},d(l){l&&C(n),l&&C(r),l&&C(s)}}}function Sl(t){let e,n,r;return{c(){e=K("First "),n=K(vn),r=K(" matches")},m(i,s){T(i,e,s),T(i,n,s),T(i,r,s)},p:pe,d(i){i&&C(e),i&&C(n),i&&C(r)}}}function Ji(t){let e,n;return e=new As({props:{entry:t[7],fnAction:t[1],isSearchResult:"true"}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&4&&(s.entry=r[7]),i&2&&(s.fnAction=r[1]),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function Wi(t){let e,n,r=t[2].length-vn+"",i,s;return{c(){e=M("div"),n=K("… there are "),i=K(r),s=K(" more matches")},m(l,c){T(l,e,c),k(e,n),k(e,i),k(e,s)},p(l,c){c&4&&r!==(r=l[2].length-vn+"")&&De(i,r)},d(l){l&&C(e)}}}function Ol(t){let e,n,r=t[2]&&Hi(t);return{c(){r&&r.c(),e=_t()},m(i,s){r&&r.m(i,s),T(i,e,s),n=!0},p(i,[s]){i[2]?r?(r.p(i,s),s&4&&te(r,1)):(r=Hi(i),r.c(),te(r,1),r.m(e.parentNode,e)):r&&(xt(),ye(r,1,1,()=>{r=null}),At())},i(i){n||(te(r),n=!0)},o(i){ye(r),n=!1},d(i){r&&r.d(i),i&&C(e)}}}const vn=20;function kl(t,e,n){let r,i=pe,s=()=>(i(),i=St(c,p=>n(4,r=p)),c),l;mt(t,dn,p=>n(2,l=p)),t.$$.on_destroy.push(()=>i());let{store:c}=e;s();let{connected:a}=e,{fnAction:h}=e;return t.$$set=p=>{"store"in p&&s(n(0,c=p.store)),"connected"in p&&n(3,a=p.connected),"fnAction"in p&&n(1,h=p.fnAction)},t.$$.update=()=>{t.$$.dirty&16&&r.playlist,t.$$.dirty&16&&r.playlistMetadata},[c,h,l,a,r]}class Cl extends lt{constructor(e){super(),ot(this,e,kl,Ol,st,{store:0,connected:3,fnAction:1})}}function Zi(t){let e,n=(t[1]=="televizija"||t[1]=="tv")&&Gi(t);return{c(){n&&n.c(),e=_t()},m(r,i){n&&n.m(r,i),T(r,e,i)},p(r,i){r[1]=="televizija"||r[1]=="tv"?n?n.p(r,i):(n=Gi(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(r){n&&n.d(r),r&&C(e)}}}function Gi(t){let e,n,r,i,s,l,c,a,h,p,b,m,y,E,x,$,A,B,ee,L;return{c(){e=M("div"),n=M("button"),n.textContent="Celovečerne risanke",r=H(),i=M("button"),i.textContent="Radovednica Bibi",s=H(),l=M("button"),l.textContent="Booba",c=H(),a=M("button"),a.textContent="Jellystone",h=H(),p=M("button"),p.textContent="Oddbods",b=H(),m=M("button"),m.textContent="Pika Nogavicka",y=H(),E=M("button"),E.textContent="Kuhar Štef",x=H(),$=M("button"),$.textContent="Pajek Lukas",A=H(),B=M("button"),B.textContent="Medvedek Paddington",U(n,"class","svelte-84hcn8"),U(i,"class","svelte-84hcn8"),U(l,"class","svelte-84hcn8"),U(a,"class","svelte-84hcn8"),U(p,"class","svelte-84hcn8"),U(m,"class","svelte-84hcn8"),U(E,"class","svelte-84hcn8"),U($,"class","svelte-84hcn8"),U(B,"class","svelte-84hcn8"),U(e,"class","sublist svelte-84hcn8")},m(j,q){T(j,e,q),k(e,n),k(e,r),k(e,i),k(e,s),k(e,l),k(e,c),k(e,a),k(e,h),k(e,p),k(e,b),k(e,m),k(e,y),k(e,E),k(e,x),k(e,$),k(e,A),k(e,B),ee||(L=[Ae(n,"click",t[6]),Ae(i,"click",t[7]),Ae(l,"click",t[8]),Ae(a,"click",t[9]),Ae(p,"click",t[10]),Ae(m,"click",t[11]),Ae(E,"click",t[12]),Ae($,"click",t[13]),Ae(B,"click",t[14])],ee=!0)},p:pe,d(j){j&&C(e),ee=!1,yt(L)}}}function Tl(t){let e,n=t[2]&&t[3]&&Zi(t);return{c(){n&&n.c(),e=_t()},m(r,i){n&&n.m(r,i),T(r,e,i)},p(r,[i]){r[2]&&r[3]?n?n.p(r,i):(n=Zi(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:pe,o:pe,d(r){n&&n.d(r),r&&C(e)}}}function Rl(t,e,n){let r,i,s=pe,l=()=>(s(),s=St(a,L=>n(3,i=L)),a);mt(t,gs,L=>n(2,r=L)),t.$$.on_destroy.push(()=>s());function c(L){h("sublist",{tag:L})}let{connected:a}=e;l();let{fnAction:h}=e,{deviceName:p}=e;const b=()=>{c("cartoons-slo/")},m=()=>{c("Radovednica Bibi")},y=()=>{c("Booba")},E=()=>{c("Jellystone")},x=()=>{c("Oddbods")},$=()=>{c("Pika Nogavicka")},A=()=>{c("Kuhar Štef")},B=()=>{c("Lucas the spider")},ee=()=>{c("Adventure Paddington")};return t.$$set=L=>{"connected"in L&&l(n(0,a=L.connected)),"fnAction"in L&&n(5,h=L.fnAction),"deviceName"in L&&n(1,p=L.deviceName)},[a,p,r,i,c,h,b,m,y,E,x,$,A,B,ee]}class Nl extends lt{constructor(e){super(),ot(this,e,Rl,Tl,st,{connected:0,fnAction:5,deviceName:1})}}function Vi(t,e,n){const r=t.slice();return r[10]=e[n],r}function Qi(t){let e,n,r,i,s,l,c=t[4].playlistLength+"",a,h,p,b,m,y,E,x,$,A=t[7]&&Xi(t);m=new Nl({props:{connected:t[1],deviceName:t[3],fnAction:t[2]}});let B=t[5].filter(nf).slice(0,1.5*tf),ee=[];for(let j=0;j<B.length;j+=1)ee[j]=ef(Vi(t,B,j));const L=j=>ye(ee[j],1,1,()=>{ee[j]=null});return{c(){e=M("h3"),n=K("Playlist @ "),r=K(t[3]),i=H(),s=M("span"),l=K("("),a=K(c),h=K(")"),p=H(),A&&A.c(),b=H(),Be(m.$$.fragment),y=H();for(let j=0;j<ee.length;j+=1)ee[j].c();E=H(),x=M("div"),x.textContent="...",U(s,"class","svelte-146wfrf"),U(e,"class","svelte-146wfrf")},m(j,q){T(j,e,q),k(e,n),k(e,r),k(e,i),k(e,s),k(s,l),k(s,a),k(s,h),k(e,p),A&&A.m(e,null),T(j,b,q),Le(m,j,q),T(j,y,q);for(let xe=0;xe<ee.length;xe+=1)ee[xe]&&ee[xe].m(j,q);T(j,E,q),T(j,x,q),$=!0},p(j,q){(!$||q&8)&&De(r,j[3]),(!$||q&16)&&c!==(c=j[4].playlistLength+"")&&De(a,c),j[7]?A?A.p(j,q):(A=Xi(j),A.c(),A.m(e,null)):A&&(A.d(1),A=null);const xe={};if(q&2&&(xe.connected=j[1]),q&8&&(xe.deviceName=j[3]),q&4&&(xe.fnAction=j[2]),m.$set(xe),q&36){B=j[5].filter(nf).slice(0,1.5*tf);let be;for(be=0;be<B.length;be+=1){const me=Vi(j,B,be);ee[be]?(ee[be].p(me,q),te(ee[be],1)):(ee[be]=ef(me),ee[be].c(),te(ee[be],1),ee[be].m(E.parentNode,E))}for(xt(),be=B.length;be<ee.length;be+=1)L(be);At()}},i(j){if(!$){te(m.$$.fragment,j);for(let q=0;q<B.length;q+=1)te(ee[q]);$=!0}},o(j){ye(m.$$.fragment,j),ee=ee.filter(Boolean);for(let q=0;q<ee.length;q+=1)ye(ee[q]);$=!1},d(j){j&&C(e),A&&A.d(),j&&C(b),ze(m,j),j&&C(y),gn(ee,j),j&&C(E),j&&C(x)}}}function Xi(t){let e,n,r,i,s,l;return{c(){e=K("| "),n=M("a"),r=K("▶ Next"),U(n,"href","#"),U(n,"class","next svelte-146wfrf"),U(n,"disabled",i=!t[7])},m(c,a){T(c,e,a),T(c,n,a),k(n,r),s||(l=Ae(n,"click",ds(t[8])),s=!0)},p(c,a){a&128&&i!==(i=!c[7])&&U(n,"disabled",i)},d(c){c&&C(e),c&&C(n),s=!1,l()}}}function ef(t){let e,n;return e=new As({props:{entry:t[10],fnAction:t[2]}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&32&&(s.entry=r[10]),i&4&&(s.fnAction=r[2]),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function Dl(t){var i;let e,n,r=!t[6]&&((i=t[5])==null?void 0:i.length)&&Qi(t);return{c(){r&&r.c(),e=_t()},m(s,l){r&&r.m(s,l),T(s,e,l),n=!0},p(s,[l]){var c;!s[6]&&((c=s[5])!=null&&c.length)?r?(r.p(s,l),l&96&&te(r,1)):(r=Qi(s),r.c(),te(r,1),r.m(e.parentNode,e)):r&&(xt(),ye(r,1,1,()=>{r=null}),At())},i(s){n||(te(r),n=!0)},o(s){ye(r),n=!1},d(s){r&&r.d(s),s&&C(e)}}}const tf=20,nf=({current:t,past:e})=>!t&&!e;function $l(t,e,n){let r,i,s,l=pe,c=()=>(l(),l=St(m,A=>n(9,s=A)),m),a,h,p=pe,b=()=>(p(),p=St(y,A=>n(7,h=A)),y);mt(t,dn,A=>n(6,a=A)),t.$$.on_destroy.push(()=>l()),t.$$.on_destroy.push(()=>p());let{store:m}=e;c();let{connected:y}=e;b();let{fnAction:E}=e,{deviceName:x}=e;function $(){window.scrollTo({top:0,behavior:"smooth"}),E("next")}return t.$$set=A=>{"store"in A&&c(n(0,m=A.store)),"connected"in A&&b(n(1,y=A.connected)),"fnAction"in A&&n(2,E=A.fnAction),"deviceName"in A&&n(3,x=A.deviceName)},t.$$.update=()=>{t.$$.dirty&512&&n(5,r=s.playlist),t.$$.dirty&512&&n(4,i=s.playlistMetadata)},[m,y,E,x,i,r,a,h,$,s]}class Pl extends lt{constructor(e){super(),ot(this,e,$l,Dl,st,{store:0,connected:1,fnAction:2,deviceName:3})}}function Il(t){let e,n,r,i,s,l,c;return n=new bl({props:{connected:t[1],store:t[0],fnAction:t[2]}}),i=new Cl({props:{connected:t[1],store:t[0],fnAction:t[2]}}),l=new Pl({props:{connected:t[1],store:t[0],fnAction:t[2],deviceName:t[3]}}),{c(){e=M("div"),Be(n.$$.fragment),r=H(),Be(i.$$.fragment),s=H(),Be(l.$$.fragment),U(e,"class","searchable_playlist svelte-1op3n77")},m(a,h){T(a,e,h),Le(n,e,null),k(e,r),Le(i,e,null),k(e,s),Le(l,e,null),c=!0},p(a,[h]){const p={};h&2&&(p.connected=a[1]),h&1&&(p.store=a[0]),h&4&&(p.fnAction=a[2]),n.$set(p);const b={};h&2&&(b.connected=a[1]),h&1&&(b.store=a[0]),h&4&&(b.fnAction=a[2]),i.$set(b);const m={};h&2&&(m.connected=a[1]),h&1&&(m.store=a[0]),h&4&&(m.fnAction=a[2]),h&8&&(m.deviceName=a[3]),l.$set(m)},i(a){c||(te(n.$$.fragment,a),te(i.$$.fragment,a),te(l.$$.fragment,a),c=!0)},o(a){ye(n.$$.fragment,a),ye(i.$$.fragment,a),ye(l.$$.fragment,a),c=!1},d(a){a&&C(e),ze(n),ze(i),ze(l)}}}function Ml(t,e,n){let{store:r}=e,{connected:i}=e,{fnAction:s}=e,{deviceName:l}=e;return t.$$set=c=>{"store"in c&&n(0,r=c.store),"connected"in c&&n(1,i=c.connected),"fnAction"in c&&n(2,s=c.fnAction),"deviceName"in c&&n(3,l=c.deviceName)},[r,i,s,l]}class Ul extends lt{constructor(e){super(),ot(this,e,Ml,Il,st,{store:0,connected:1,fnAction:2,deviceName:3})}}function rf(t){let e,n,r,i,s,l,c,a,h,p,b,m,y,E;return{c(){e=M("h3"),n=K("Play internet radio @ "),r=K(t[2]),i=H(),s=M("div"),l=M("button"),l.textContent="Rock",c=H(),a=M("button"),a.textContent="Jazz",h=H(),p=M("button"),p.textContent="Psytrance",b=H(),m=M("button"),m.textContent="Goatrance",U(l,"class","svelte-tpf42f"),U(a,"class","svelte-tpf42f"),U(p,"class","svelte-tpf42f"),U(m,"class","svelte-tpf42f"),U(s,"class","radios svelte-tpf42f")},m(x,$){T(x,e,$),k(e,n),k(e,r),T(x,i,$),T(x,s,$),k(s,l),k(s,c),k(s,a),k(s,h),k(s,p),k(s,b),k(s,m),y||(E=[Ae(l,"click",t[4]),Ae(a,"click",t[5]),Ae(p,"click",t[6]),Ae(m,"click",t[7])],y=!0)},p(x,$){$&4&&De(r,x[2])},d(x){x&&C(e),x&&C(i),x&&C(s),y=!1,yt(E)}}}function jl(t){let e,n=t[3]&&rf(t);return{c(){n&&n.c(),e=_t()},m(r,i){n&&n.m(r,i),T(r,e,i)},p(r,[i]){r[3]?n?n.p(r,i):(n=rf(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:pe,o:pe,d(r){n&&n.d(r),r&&C(e)}}}function Ll(t,e,n){let r,i=pe,s=()=>(i(),i=St(l,y=>n(3,r=y)),l);t.$$.on_destroy.push(()=>i());let{connected:l}=e;s();let{fnAction:c}=e,{deviceName:a}=e;const h=()=>{c("play_radio",{radioId:"rock"})},p=()=>{c("play_radio",{radioId:"jazz"})},b=()=>{c("play_radio",{radioId:"progressive-trance"})},m=()=>{c("play_radio",{radioId:"goa-trance"})};return t.$$set=y=>{"connected"in y&&s(n(0,l=y.connected)),"fnAction"in y&&n(1,c=y.fnAction),"deviceName"in y&&n(2,a=y.deviceName)},[l,c,a,r,h,p,b,m]}class zl extends lt{constructor(e){super(),ot(this,e,Ll,jl,st,{connected:0,fnAction:1,deviceName:2})}}function ff(t){let e,n;return e=new zl({props:{connected:t[0],fnAction:t[4],deviceName:t[1]}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&1&&(s.connected=r[0]),i&16&&(s.fnAction=r[4]),i&2&&(s.deviceName=r[1]),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function sf(t){let e,n;return e=new Ul({props:{connected:t[0],store:t[3],fnAction:t[4],deviceName:t[1]}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&1&&(s.connected=r[0]),i&8&&(s.store=r[3]),i&16&&(s.fnAction=r[4]),i&2&&(s.deviceName=r[1]),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function Bl(t){var p;let e,n,r,i,s,l,c;e=new el({props:{connected:t[0],store:t[3],player:t[2],songTitle:t[9],songPath:t[8],playlistCurrentMedia:t[6],playlistSongPath:t[5],fnAction:t[4]}}),r=new ul({props:{connected:t[0],player:t[2],fnAction:t[4],songTitle:t[9],deviceName:t[1]}});let a=t[1]!="tv-ap2"&&ff(t),h=!t[2].isStream&&((p=t[7])==null?void 0:p.length)&&sf(t);return{c(){Be(e.$$.fragment),n=H(),Be(r.$$.fragment),i=H(),a&&a.c(),s=H(),h&&h.c(),l=_t()},m(b,m){Le(e,b,m),T(b,n,m),Le(r,b,m),T(b,i,m),a&&a.m(b,m),T(b,s,m),h&&h.m(b,m),T(b,l,m),c=!0},p(b,[m]){var x;const y={};m&1&&(y.connected=b[0]),m&8&&(y.store=b[3]),m&4&&(y.player=b[2]),m&512&&(y.songTitle=b[9]),m&256&&(y.songPath=b[8]),m&64&&(y.playlistCurrentMedia=b[6]),m&32&&(y.playlistSongPath=b[5]),m&16&&(y.fnAction=b[4]),e.$set(y);const E={};m&1&&(E.connected=b[0]),m&4&&(E.player=b[2]),m&16&&(E.fnAction=b[4]),m&512&&(E.songTitle=b[9]),m&2&&(E.deviceName=b[1]),r.$set(E),b[1]!="tv-ap2"?a?(a.p(b,m),m&2&&te(a,1)):(a=ff(b),a.c(),te(a,1),a.m(s.parentNode,s)):a&&(xt(),ye(a,1,1,()=>{a=null}),At()),!b[2].isStream&&((x=b[7])!=null&&x.length)?h?(h.p(b,m),m&132&&te(h,1)):(h=sf(b),h.c(),te(h,1),h.m(l.parentNode,l)):h&&(xt(),ye(h,1,1,()=>{h=null}),At())},i(b){c||(te(e.$$.fragment,b),te(r.$$.fragment,b),te(a),te(h),c=!0)},o(b){ye(e.$$.fragment,b),ye(r.$$.fragment,b),ye(a),ye(h),c=!1},d(b){ze(e,b),b&&C(n),ze(r,b),b&&C(i),a&&a.d(b),b&&C(s),h&&h.d(b),b&&C(l)}}}function Kl(t,e,n){let r,i,s,l,c,a,h,p,b,m,y=pe,E=()=>(y(),y=St(B,L=>n(14,m=L)),B);t.$$.on_destroy.push(()=>y());let{connected:x}=e,{deviceName:$}=e,{player:A}=e,{store:B}=e;E();let{fnAction:ee}=e;return t.$$set=L=>{"connected"in L&&n(0,x=L.connected),"deviceName"in L&&n(1,$=L.deviceName),"player"in L&&n(2,A=L.player),"store"in L&&E(n(3,B=L.store)),"fnAction"in L&&n(4,ee=L.fnAction)},t.$$.update=()=>{t.$$.dirty&4&&n(13,r=A.currentMedia||{}),t.$$.dirty&8192&&n(12,i=r.artist&&r.song?`${r.artist} - ${r.song}`:r.song),t.$$.dirty&8192&&n(10,s=r.songPath),t.$$.dirty&16384&&n(7,l=m.playlist),t.$$.dirty&128&&n(6,c=(l||[]).find(({current:L})=>L)),t.$$.dirty&64&&n(11,a=c==null?void 0:c.title),t.$$.dirty&64&&n(5,h=c==null?void 0:c.path),t.$$.dirty&6144&&n(9,p=i||a),t.$$.dirty&1056&&n(8,b=s||h)},[x,$,A,B,ee,h,c,l,b,p,s,a,i,r,m]}class ql extends lt{constructor(e){super(),ot(this,e,Kl,Bl,st,{connected:0,deviceName:1,player:2,store:3,fnAction:4})}}function of(t,e,n){const r=t.slice();return r[15]=e[n],r}function lf(t){let e,n=t[3],r=[];for(let i=0;i<n.length;i+=1)r[i]=uf(of(t,n,i));return{c(){e=M("div");for(let i=0;i<r.length;i+=1)r[i].c();U(e,"class","nearby_devices svelte-f8wsgm")},m(i,s){T(i,e,s);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(i,s){if(s&251){n=i[3];let l;for(l=0;l<n.length;l+=1){const c=of(i,n,l);r[l]?r[l].p(c,s):(r[l]=uf(c),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(i){i&&C(e),gn(r,i)}}}function cf(t){let e;return{c(){e=M("span"),e.textContent="!",U(e,"class","error svelte-f8wsgm")},m(n,r){T(n,e,r)},d(n){n&&C(e)}}}function af(t){let e,n=t[15].mediaType=="music"?"♫":"▶",r;return{c(){e=M("span"),r=K(n),U(e,"class","play_symbol svelte-f8wsgm")},m(i,s){T(i,e,s),k(e,r)},p(i,s){s&8&&n!==(n=i[15].mediaType=="music"?"♫":"▶")&&De(r,n)},d(i){i&&C(e)}}}function uf(t){let e,n,r,i=t[15].deviceName+"",s,l,c,a,h=t[15].hasErrors&&cf(),p=t[15].playing&&af(t);return{c(){e=M("button"),h&&h.c(),n=H(),p&&p.c(),r=H(),s=K(i),l=H(),U(e,"class","svelte-f8wsgm"),le(e,"active",t[15].deviceKey==t[0]),le(e,"local_device",t[15].thisDevice),le(e,"playing",t[15].playing),le(e,"late_pong1",t[4]-t[5][t[15].deviceKey]>2e3),le(e,"late_pong2",t[4]-t[5][t[15].deviceKey]>2500),le(e,"late_pong3",t[4]-t[5][t[15].deviceKey]>3500),le(e,"connected",t[6][t[15].deviceKey]),le(e,"disconnected",t[6][t[15].deviceKey]==!1),le(e,"cpu_usage_warn1",t[15].cpuUsage>50),le(e,"cpu_usage_warn2",t[15].cpuUsage>70),le(e,"cpu_usage_warn3",t[15].cpuUsage>80)},m(b,m){T(b,e,m),h&&h.m(e,null),k(e,n),p&&p.m(e,null),k(e,r),k(e,s),k(e,l),c||(a=Ae(e,"click",function(){qn(t[7]({store:t[1],device:t[15]}))&&t[7]({store:t[1],device:t[15]}).apply(this,arguments)}),c=!0)},p(b,m){t=b,t[15].hasErrors?h||(h=cf(),h.c(),h.m(e,n)):h&&(h.d(1),h=null),t[15].playing?p?p.p(t,m):(p=af(t),p.c(),p.m(e,r)):p&&(p.d(1),p=null),m&8&&i!==(i=t[15].deviceName+"")&&De(s,i),m&9&&le(e,"active",t[15].deviceKey==t[0]),m&8&&le(e,"local_device",t[15].thisDevice),m&8&&le(e,"playing",t[15].playing),m&56&&le(e,"late_pong1",t[4]-t[5][t[15].deviceKey]>2e3),m&56&&le(e,"late_pong2",t[4]-t[5][t[15].deviceKey]>2500),m&56&&le(e,"late_pong3",t[4]-t[5][t[15].deviceKey]>3500),m&72&&le(e,"connected",t[6][t[15].deviceKey]),m&72&&le(e,"disconnected",t[6][t[15].deviceKey]==!1),m&8&&le(e,"cpu_usage_warn1",t[15].cpuUsage>50),m&8&&le(e,"cpu_usage_warn2",t[15].cpuUsage>70),m&8&&le(e,"cpu_usage_warn3",t[15].cpuUsage>80)},d(b){b&&C(e),h&&h.d(),p&&p.d(),c=!1,a()}}}function Yl(t){let e,n=t[3].length&&lf(t);return{c(){n&&n.c(),e=_t()},m(r,i){n&&n.m(r,i),T(r,e,i)},p(r,[i]){r[3].length?n?n.p(r,i):(n=lf(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:pe,o:pe,d(r){n&&n.d(r),r&&C(e)}}}function Fl(t,e,n){let r,i,s,l,c;mt(t,ms,A=>n(12,i=A));let{nearbyDevices:a}=e,{activeDeviceKey:h}=e,{store:p}=e,{log:b}=e;function m({store:A,device:B}){hr.set(null),dn.set(null),localStorage.setItem("current_device_key",B.deviceKey),A.switch(B)}const y=en({});mt(t,y,A=>n(5,l=A)),p.on("pong",({deviceKey:A})=>{y.update(B=>(B[A]=Date.now(),B))});const E=en({});mt(t,E,A=>n(6,c=A)),E.alreadyDone={};const x=en(Date.now());mt(t,x,A=>n(4,s=A));function $(){x.set(Date.now()),setTimeout($,300)}return $(),t.$$set=A=>{"nearbyDevices"in A&&n(10,a=A.nearbyDevices),"activeDeviceKey"in A&&n(0,h=A.activeDeviceKey),"store"in A&&n(1,p=A.store),"log"in A&&n(11,b=A.log)},t.$$.update=()=>{t.$$.dirty&7175&&n(3,r=a.filter(({deviceName:A,playing:B,deviceKey:ee,thisDevice:L,ip:j,isRPi:q})=>(ee==h||B||i)&&(q||L)).map(A=>{const{ip:B,deviceKey:ee,deviceName:L,thisDevice:j,playing:q}=A;return E.alreadyDone[ee]||(n(2,E.alreadyDone[ee]=!0,E),setTimeout(()=>{b(`${B} Preconnecting ${L}`);const be=p.preconnect({host:B,deviceKey:ee,thisDevice:j});be.__prevSubUnsubscribe?be.__prevSubUnsubscribe():be.on("decommission",()=>{b(`dmt-mobile: Decommissioned connector ${L} @ ${B}`),n(2,E.alreadyDone[ee]=!1,E),be.__prevSubUnsubscribe&&be.__prevSubUnsubscribe()}),be.__prevSubUnsubscribe=be.connected.subscribe(me=>{E.update(Ie=>(Ie[ee]=me,Ie))})},0)),A}))},[h,p,E,r,s,l,c,m,y,x,a,b,i]}class Hl extends lt{constructor(e){super(),ot(this,e,Fl,Yl,st,{nearbyDevices:10,activeDeviceKey:0,store:1,log:11})}}var Jl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Es(t,e,n){return n={path:e,exports:{},require:function(r,i){return Ss(r,i??n.path)}},t(n,n.exports),n.exports}function Wl(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}),e}function Ss(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Zl={},Gl=Object.freeze({__proto__:null,default:Zl}),Vl=Wl(Gl),Yt=Es(function(t){(function(e){var n=function(o){var d,u=new Float64Array(16);if(o)for(d=0;d<o.length;d++)u[d]=o[d];return u},r=function(){throw new Error("no PRNG")},i=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var l=n(),c=n([1]),a=n([56129,1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function E(o,d,u,f){o[d]=u>>24&255,o[d+1]=u>>16&255,o[d+2]=u>>8&255,o[d+3]=u&255,o[d+4]=f>>24&255,o[d+5]=f>>16&255,o[d+6]=f>>8&255,o[d+7]=f&255}function x(o,d,u,f,_){var g,w=0;for(g=0;g<_;g++)w|=o[d+g]^u[f+g];return(1&w-1>>>8)-1}function $(o,d,u,f){return x(o,d,u,f,16)}function A(o,d,u,f){return x(o,d,u,f,32)}function B(o,d,u,f){for(var _=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,g=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,w=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,N=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,z=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,Q=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,F=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,ke=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,W=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,ie=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,fe=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,ue=u[16]&255|(u[17]&255)<<8|(u[18]&255)<<16|(u[19]&255)<<24,ae=u[20]&255|(u[21]&255)<<8|(u[22]&255)<<16|(u[23]&255)<<24,se=u[24]&255|(u[25]&255)<<8|(u[26]&255)<<16|(u[27]&255)<<24,ce=u[28]&255|(u[29]&255)<<8|(u[30]&255)<<16|(u[31]&255)<<24,oe=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,Z=_,X=g,J=w,G=N,V=z,Y=Q,S=F,O=ke,P=W,R=ie,D=fe,I=ue,ne=ae,de=se,_e=ce,he=oe,v,ge=0;ge<20;ge+=2)v=Z+ne|0,V^=v<<7|v>>>32-7,v=V+Z|0,P^=v<<9|v>>>32-9,v=P+V|0,ne^=v<<13|v>>>32-13,v=ne+P|0,Z^=v<<18|v>>>32-18,v=Y+X|0,R^=v<<7|v>>>32-7,v=R+Y|0,de^=v<<9|v>>>32-9,v=de+R|0,X^=v<<13|v>>>32-13,v=X+de|0,Y^=v<<18|v>>>32-18,v=D+S|0,_e^=v<<7|v>>>32-7,v=_e+D|0,J^=v<<9|v>>>32-9,v=J+_e|0,S^=v<<13|v>>>32-13,v=S+J|0,D^=v<<18|v>>>32-18,v=he+I|0,G^=v<<7|v>>>32-7,v=G+he|0,O^=v<<9|v>>>32-9,v=O+G|0,I^=v<<13|v>>>32-13,v=I+O|0,he^=v<<18|v>>>32-18,v=Z+G|0,X^=v<<7|v>>>32-7,v=X+Z|0,J^=v<<9|v>>>32-9,v=J+X|0,G^=v<<13|v>>>32-13,v=G+J|0,Z^=v<<18|v>>>32-18,v=Y+V|0,S^=v<<7|v>>>32-7,v=S+Y|0,O^=v<<9|v>>>32-9,v=O+S|0,V^=v<<13|v>>>32-13,v=V+O|0,Y^=v<<18|v>>>32-18,v=D+R|0,I^=v<<7|v>>>32-7,v=I+D|0,P^=v<<9|v>>>32-9,v=P+I|0,R^=v<<13|v>>>32-13,v=R+P|0,D^=v<<18|v>>>32-18,v=he+_e|0,ne^=v<<7|v>>>32-7,v=ne+he|0,de^=v<<9|v>>>32-9,v=de+ne|0,_e^=v<<13|v>>>32-13,v=_e+de|0,he^=v<<18|v>>>32-18;Z=Z+_|0,X=X+g|0,J=J+w|0,G=G+N|0,V=V+z|0,Y=Y+Q|0,S=S+F|0,O=O+ke|0,P=P+W|0,R=R+ie|0,D=D+fe|0,I=I+ue|0,ne=ne+ae|0,de=de+se|0,_e=_e+ce|0,he=he+oe|0,o[0]=Z>>>0&255,o[1]=Z>>>8&255,o[2]=Z>>>16&255,o[3]=Z>>>24&255,o[4]=X>>>0&255,o[5]=X>>>8&255,o[6]=X>>>16&255,o[7]=X>>>24&255,o[8]=J>>>0&255,o[9]=J>>>8&255,o[10]=J>>>16&255,o[11]=J>>>24&255,o[12]=G>>>0&255,o[13]=G>>>8&255,o[14]=G>>>16&255,o[15]=G>>>24&255,o[16]=V>>>0&255,o[17]=V>>>8&255,o[18]=V>>>16&255,o[19]=V>>>24&255,o[20]=Y>>>0&255,o[21]=Y>>>8&255,o[22]=Y>>>16&255,o[23]=Y>>>24&255,o[24]=S>>>0&255,o[25]=S>>>8&255,o[26]=S>>>16&255,o[27]=S>>>24&255,o[28]=O>>>0&255,o[29]=O>>>8&255,o[30]=O>>>16&255,o[31]=O>>>24&255,o[32]=P>>>0&255,o[33]=P>>>8&255,o[34]=P>>>16&255,o[35]=P>>>24&255,o[36]=R>>>0&255,o[37]=R>>>8&255,o[38]=R>>>16&255,o[39]=R>>>24&255,o[40]=D>>>0&255,o[41]=D>>>8&255,o[42]=D>>>16&255,o[43]=D>>>24&255,o[44]=I>>>0&255,o[45]=I>>>8&255,o[46]=I>>>16&255,o[47]=I>>>24&255,o[48]=ne>>>0&255,o[49]=ne>>>8&255,o[50]=ne>>>16&255,o[51]=ne>>>24&255,o[52]=de>>>0&255,o[53]=de>>>8&255,o[54]=de>>>16&255,o[55]=de>>>24&255,o[56]=_e>>>0&255,o[57]=_e>>>8&255,o[58]=_e>>>16&255,o[59]=_e>>>24&255,o[60]=he>>>0&255,o[61]=he>>>8&255,o[62]=he>>>16&255,o[63]=he>>>24&255}function ee(o,d,u,f){for(var _=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,g=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,w=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,N=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,z=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,Q=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,F=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,ke=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,W=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,ie=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,fe=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,ue=u[16]&255|(u[17]&255)<<8|(u[18]&255)<<16|(u[19]&255)<<24,ae=u[20]&255|(u[21]&255)<<8|(u[22]&255)<<16|(u[23]&255)<<24,se=u[24]&255|(u[25]&255)<<8|(u[26]&255)<<16|(u[27]&255)<<24,ce=u[28]&255|(u[29]&255)<<8|(u[30]&255)<<16|(u[31]&255)<<24,oe=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,Z=_,X=g,J=w,G=N,V=z,Y=Q,S=F,O=ke,P=W,R=ie,D=fe,I=ue,ne=ae,de=se,_e=ce,he=oe,v,ge=0;ge<20;ge+=2)v=Z+ne|0,V^=v<<7|v>>>32-7,v=V+Z|0,P^=v<<9|v>>>32-9,v=P+V|0,ne^=v<<13|v>>>32-13,v=ne+P|0,Z^=v<<18|v>>>32-18,v=Y+X|0,R^=v<<7|v>>>32-7,v=R+Y|0,de^=v<<9|v>>>32-9,v=de+R|0,X^=v<<13|v>>>32-13,v=X+de|0,Y^=v<<18|v>>>32-18,v=D+S|0,_e^=v<<7|v>>>32-7,v=_e+D|0,J^=v<<9|v>>>32-9,v=J+_e|0,S^=v<<13|v>>>32-13,v=S+J|0,D^=v<<18|v>>>32-18,v=he+I|0,G^=v<<7|v>>>32-7,v=G+he|0,O^=v<<9|v>>>32-9,v=O+G|0,I^=v<<13|v>>>32-13,v=I+O|0,he^=v<<18|v>>>32-18,v=Z+G|0,X^=v<<7|v>>>32-7,v=X+Z|0,J^=v<<9|v>>>32-9,v=J+X|0,G^=v<<13|v>>>32-13,v=G+J|0,Z^=v<<18|v>>>32-18,v=Y+V|0,S^=v<<7|v>>>32-7,v=S+Y|0,O^=v<<9|v>>>32-9,v=O+S|0,V^=v<<13|v>>>32-13,v=V+O|0,Y^=v<<18|v>>>32-18,v=D+R|0,I^=v<<7|v>>>32-7,v=I+D|0,P^=v<<9|v>>>32-9,v=P+I|0,R^=v<<13|v>>>32-13,v=R+P|0,D^=v<<18|v>>>32-18,v=he+_e|0,ne^=v<<7|v>>>32-7,v=ne+he|0,de^=v<<9|v>>>32-9,v=de+ne|0,_e^=v<<13|v>>>32-13,v=_e+de|0,he^=v<<18|v>>>32-18;o[0]=Z>>>0&255,o[1]=Z>>>8&255,o[2]=Z>>>16&255,o[3]=Z>>>24&255,o[4]=Y>>>0&255,o[5]=Y>>>8&255,o[6]=Y>>>16&255,o[7]=Y>>>24&255,o[8]=D>>>0&255,o[9]=D>>>8&255,o[10]=D>>>16&255,o[11]=D>>>24&255,o[12]=he>>>0&255,o[13]=he>>>8&255,o[14]=he>>>16&255,o[15]=he>>>24&255,o[16]=S>>>0&255,o[17]=S>>>8&255,o[18]=S>>>16&255,o[19]=S>>>24&255,o[20]=O>>>0&255,o[21]=O>>>8&255,o[22]=O>>>16&255,o[23]=O>>>24&255,o[24]=P>>>0&255,o[25]=P>>>8&255,o[26]=P>>>16&255,o[27]=P>>>24&255,o[28]=R>>>0&255,o[29]=R>>>8&255,o[30]=R>>>16&255,o[31]=R>>>24&255}function L(o,d,u,f){B(o,d,u,f)}function j(o,d,u,f){ee(o,d,u,f)}var q=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function xe(o,d,u,f,_,g,w){var N=new Uint8Array(16),z=new Uint8Array(64),Q,F;for(F=0;F<16;F++)N[F]=0;for(F=0;F<8;F++)N[F]=g[F];for(;_>=64;){for(L(z,N,w,q),F=0;F<64;F++)o[d+F]=u[f+F]^z[F];for(Q=1,F=8;F<16;F++)Q=Q+(N[F]&255)|0,N[F]=Q&255,Q>>>=8;_-=64,d+=64,f+=64}if(_>0)for(L(z,N,w,q),F=0;F<_;F++)o[d+F]=u[f+F]^z[F];return 0}function be(o,d,u,f,_){var g=new Uint8Array(16),w=new Uint8Array(64),N,z;for(z=0;z<16;z++)g[z]=0;for(z=0;z<8;z++)g[z]=f[z];for(;u>=64;){for(L(w,g,_,q),z=0;z<64;z++)o[d+z]=w[z];for(N=1,z=8;z<16;z++)N=N+(g[z]&255)|0,g[z]=N&255,N>>>=8;u-=64,d+=64}if(u>0)for(L(w,g,_,q),z=0;z<u;z++)o[d+z]=w[z];return 0}function me(o,d,u,f,_){var g=new Uint8Array(32);j(g,f,_,q);for(var w=new Uint8Array(8),N=0;N<8;N++)w[N]=f[N+16];return be(o,d,u,w,g)}function Ie(o,d,u,f,_,g,w){var N=new Uint8Array(32);j(N,g,w,q);for(var z=new Uint8Array(8),Q=0;Q<8;Q++)z[Q]=g[Q+16];return xe(o,d,u,f,_,z,N)}var ct=function(o){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var d,u,f,_,g,w,N,z;d=o[0]&255|(o[1]&255)<<8,this.r[0]=d&8191,u=o[2]&255|(o[3]&255)<<8,this.r[1]=(d>>>13|u<<3)&8191,f=o[4]&255|(o[5]&255)<<8,this.r[2]=(u>>>10|f<<6)&7939,_=o[6]&255|(o[7]&255)<<8,this.r[3]=(f>>>7|_<<9)&8191,g=o[8]&255|(o[9]&255)<<8,this.r[4]=(_>>>4|g<<12)&255,this.r[5]=g>>>1&8190,w=o[10]&255|(o[11]&255)<<8,this.r[6]=(g>>>14|w<<2)&8191,N=o[12]&255|(o[13]&255)<<8,this.r[7]=(w>>>11|N<<5)&8065,z=o[14]&255|(o[15]&255)<<8,this.r[8]=(N>>>8|z<<8)&8191,this.r[9]=z>>>5&127,this.pad[0]=o[16]&255|(o[17]&255)<<8,this.pad[1]=o[18]&255|(o[19]&255)<<8,this.pad[2]=o[20]&255|(o[21]&255)<<8,this.pad[3]=o[22]&255|(o[23]&255)<<8,this.pad[4]=o[24]&255|(o[25]&255)<<8,this.pad[5]=o[26]&255|(o[27]&255)<<8,this.pad[6]=o[28]&255|(o[29]&255)<<8,this.pad[7]=o[30]&255|(o[31]&255)<<8};ct.prototype.blocks=function(o,d,u){for(var f=this.fin?0:2048,_,g,w,N,z,Q,F,ke,W,ie,fe,ue,ae,se,ce,oe,Z,X,J,G=this.h[0],V=this.h[1],Y=this.h[2],S=this.h[3],O=this.h[4],P=this.h[5],R=this.h[6],D=this.h[7],I=this.h[8],ne=this.h[9],de=this.r[0],_e=this.r[1],he=this.r[2],v=this.r[3],ge=this.r[4],Ce=this.r[5],Te=this.r[6],ve=this.r[7],Se=this.r[8],Oe=this.r[9];u>=16;)_=o[d+0]&255|(o[d+1]&255)<<8,G+=_&8191,g=o[d+2]&255|(o[d+3]&255)<<8,V+=(_>>>13|g<<3)&8191,w=o[d+4]&255|(o[d+5]&255)<<8,Y+=(g>>>10|w<<6)&8191,N=o[d+6]&255|(o[d+7]&255)<<8,S+=(w>>>7|N<<9)&8191,z=o[d+8]&255|(o[d+9]&255)<<8,O+=(N>>>4|z<<12)&8191,P+=z>>>1&8191,Q=o[d+10]&255|(o[d+11]&255)<<8,R+=(z>>>14|Q<<2)&8191,F=o[d+12]&255|(o[d+13]&255)<<8,D+=(Q>>>11|F<<5)&8191,ke=o[d+14]&255|(o[d+15]&255)<<8,I+=(F>>>8|ke<<8)&8191,ne+=ke>>>5|f,W=0,ie=W,ie+=G*de,ie+=V*(5*Oe),ie+=Y*(5*Se),ie+=S*(5*ve),ie+=O*(5*Te),W=ie>>>13,ie&=8191,ie+=P*(5*Ce),ie+=R*(5*ge),ie+=D*(5*v),ie+=I*(5*he),ie+=ne*(5*_e),W+=ie>>>13,ie&=8191,fe=W,fe+=G*_e,fe+=V*de,fe+=Y*(5*Oe),fe+=S*(5*Se),fe+=O*(5*ve),W=fe>>>13,fe&=8191,fe+=P*(5*Te),fe+=R*(5*Ce),fe+=D*(5*ge),fe+=I*(5*v),fe+=ne*(5*he),W+=fe>>>13,fe&=8191,ue=W,ue+=G*he,ue+=V*_e,ue+=Y*de,ue+=S*(5*Oe),ue+=O*(5*Se),W=ue>>>13,ue&=8191,ue+=P*(5*ve),ue+=R*(5*Te),ue+=D*(5*Ce),ue+=I*(5*ge),ue+=ne*(5*v),W+=ue>>>13,ue&=8191,ae=W,ae+=G*v,ae+=V*he,ae+=Y*_e,ae+=S*de,ae+=O*(5*Oe),W=ae>>>13,ae&=8191,ae+=P*(5*Se),ae+=R*(5*ve),ae+=D*(5*Te),ae+=I*(5*Ce),ae+=ne*(5*ge),W+=ae>>>13,ae&=8191,se=W,se+=G*ge,se+=V*v,se+=Y*he,se+=S*_e,se+=O*de,W=se>>>13,se&=8191,se+=P*(5*Oe),se+=R*(5*Se),se+=D*(5*ve),se+=I*(5*Te),se+=ne*(5*Ce),W+=se>>>13,se&=8191,ce=W,ce+=G*Ce,ce+=V*ge,ce+=Y*v,ce+=S*he,ce+=O*_e,W=ce>>>13,ce&=8191,ce+=P*de,ce+=R*(5*Oe),ce+=D*(5*Se),ce+=I*(5*ve),ce+=ne*(5*Te),W+=ce>>>13,ce&=8191,oe=W,oe+=G*Te,oe+=V*Ce,oe+=Y*ge,oe+=S*v,oe+=O*he,W=oe>>>13,oe&=8191,oe+=P*_e,oe+=R*de,oe+=D*(5*Oe),oe+=I*(5*Se),oe+=ne*(5*ve),W+=oe>>>13,oe&=8191,Z=W,Z+=G*ve,Z+=V*Te,Z+=Y*Ce,Z+=S*ge,Z+=O*v,W=Z>>>13,Z&=8191,Z+=P*he,Z+=R*_e,Z+=D*de,Z+=I*(5*Oe),Z+=ne*(5*Se),W+=Z>>>13,Z&=8191,X=W,X+=G*Se,X+=V*ve,X+=Y*Te,X+=S*Ce,X+=O*ge,W=X>>>13,X&=8191,X+=P*v,X+=R*he,X+=D*_e,X+=I*de,X+=ne*(5*Oe),W+=X>>>13,X&=8191,J=W,J+=G*Oe,J+=V*Se,J+=Y*ve,J+=S*Te,J+=O*Ce,W=J>>>13,J&=8191,J+=P*ge,J+=R*v,J+=D*he,J+=I*_e,J+=ne*de,W+=J>>>13,J&=8191,W=(W<<2)+W|0,W=W+ie|0,ie=W&8191,W=W>>>13,fe+=W,G=ie,V=fe,Y=ue,S=ae,O=se,P=ce,R=oe,D=Z,I=X,ne=J,d+=16,u-=16;this.h[0]=G,this.h[1]=V,this.h[2]=Y,this.h[3]=S,this.h[4]=O,this.h[5]=P,this.h[6]=R,this.h[7]=D,this.h[8]=I,this.h[9]=ne},ct.prototype.finish=function(o,d){var u=new Uint16Array(10),f,_,g,w;if(this.leftover){for(w=this.leftover,this.buffer[w++]=1;w<16;w++)this.buffer[w]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(f=this.h[1]>>>13,this.h[1]&=8191,w=2;w<10;w++)this.h[w]+=f,f=this.h[w]>>>13,this.h[w]&=8191;for(this.h[0]+=f*5,f=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=f,f=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=f,u[0]=this.h[0]+5,f=u[0]>>>13,u[0]&=8191,w=1;w<10;w++)u[w]=this.h[w]+f,f=u[w]>>>13,u[w]&=8191;for(u[9]-=1<<13,_=(f^1)-1,w=0;w<10;w++)u[w]&=_;for(_=~_,w=0;w<10;w++)this.h[w]=this.h[w]&_|u[w];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,g=this.h[0]+this.pad[0],this.h[0]=g&65535,w=1;w<8;w++)g=(this.h[w]+this.pad[w]|0)+(g>>>16)|0,this.h[w]=g&65535;o[d+0]=this.h[0]>>>0&255,o[d+1]=this.h[0]>>>8&255,o[d+2]=this.h[1]>>>0&255,o[d+3]=this.h[1]>>>8&255,o[d+4]=this.h[2]>>>0&255,o[d+5]=this.h[2]>>>8&255,o[d+6]=this.h[3]>>>0&255,o[d+7]=this.h[3]>>>8&255,o[d+8]=this.h[4]>>>0&255,o[d+9]=this.h[4]>>>8&255,o[d+10]=this.h[5]>>>0&255,o[d+11]=this.h[5]>>>8&255,o[d+12]=this.h[6]>>>0&255,o[d+13]=this.h[6]>>>8&255,o[d+14]=this.h[7]>>>0&255,o[d+15]=this.h[7]>>>8&255},ct.prototype.update=function(o,d,u){var f,_;if(this.leftover){for(_=16-this.leftover,_>u&&(_=u),f=0;f<_;f++)this.buffer[this.leftover+f]=o[d+f];if(u-=_,d+=_,this.leftover+=_,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(u>=16&&(_=u-u%16,this.blocks(o,d,_),d+=_,u-=_),u){for(f=0;f<u;f++)this.buffer[this.leftover+f]=o[d+f];this.leftover+=u}};function Qe(o,d,u,f,_,g){var w=new ct(g);return w.update(u,f,_),w.finish(o,d),0}function ut(o,d,u,f,_,g){var w=new Uint8Array(16);return Qe(w,0,u,f,_,g),$(o,d,w,0)}function $e(o,d,u,f,_){var g;if(u<32)return-1;for(Ie(o,0,d,0,u,f,_),Qe(o,16,o,32,u-32,o),g=0;g<16;g++)o[g]=0;return 0}function pt(o,d,u,f,_){var g,w=new Uint8Array(32);if(u<32||(me(w,0,32,f,_),ut(d,16,d,32,u-32,w)!==0))return-1;for(Ie(o,0,d,0,u,f,_),g=0;g<32;g++)o[g]=0;return 0}function We(o,d){var u;for(u=0;u<16;u++)o[u]=d[u]|0}function gt(o){var d,u,f=1;for(d=0;d<16;d++)u=o[d]+f+65535,f=Math.floor(u/65536),o[d]=u-f*65536;o[0]+=f-1+37*(f-1)}function at(o,d,u){for(var f,_=~(u-1),g=0;g<16;g++)f=_&(o[g]^d[g]),o[g]^=f,d[g]^=f}function Ee(o,d){var u,f,_,g=n(),w=n();for(u=0;u<16;u++)w[u]=d[u];for(gt(w),gt(w),gt(w),f=0;f<2;f++){for(g[0]=w[0]-65517,u=1;u<15;u++)g[u]=w[u]-65535-(g[u-1]>>16&1),g[u-1]&=65535;g[15]=w[15]-32767-(g[14]>>16&1),_=g[15]>>16&1,g[14]&=65535,at(w,g,1-_)}for(u=0;u<16;u++)o[2*u]=w[u]&255,o[2*u+1]=w[u]>>8}function Ye(o,d){var u=new Uint8Array(32),f=new Uint8Array(32);return Ee(u,o),Ee(f,d),A(u,0,f,0)}function Mt(o){var d=new Uint8Array(32);return Ee(d,o),d[0]&1}function Rt(o,d){var u;for(u=0;u<16;u++)o[u]=d[2*u]+(d[2*u+1]<<8);o[15]&=32767}function Je(o,d,u){for(var f=0;f<16;f++)o[f]=d[f]+u[f]}function tt(o,d,u){for(var f=0;f<16;f++)o[f]=d[f]-u[f]}function we(o,d,u){var f,_,g=0,w=0,N=0,z=0,Q=0,F=0,ke=0,W=0,ie=0,fe=0,ue=0,ae=0,se=0,ce=0,oe=0,Z=0,X=0,J=0,G=0,V=0,Y=0,S=0,O=0,P=0,R=0,D=0,I=0,ne=0,de=0,_e=0,he=0,v=u[0],ge=u[1],Ce=u[2],Te=u[3],ve=u[4],Se=u[5],Oe=u[6],Ke=u[7],Ne=u[8],Me=u[9],Ue=u[10],je=u[11],qe=u[12],Ze=u[13],Ge=u[14],Ve=u[15];f=d[0],g+=f*v,w+=f*ge,N+=f*Ce,z+=f*Te,Q+=f*ve,F+=f*Se,ke+=f*Oe,W+=f*Ke,ie+=f*Ne,fe+=f*Me,ue+=f*Ue,ae+=f*je,se+=f*qe,ce+=f*Ze,oe+=f*Ge,Z+=f*Ve,f=d[1],w+=f*v,N+=f*ge,z+=f*Ce,Q+=f*Te,F+=f*ve,ke+=f*Se,W+=f*Oe,ie+=f*Ke,fe+=f*Ne,ue+=f*Me,ae+=f*Ue,se+=f*je,ce+=f*qe,oe+=f*Ze,Z+=f*Ge,X+=f*Ve,f=d[2],N+=f*v,z+=f*ge,Q+=f*Ce,F+=f*Te,ke+=f*ve,W+=f*Se,ie+=f*Oe,fe+=f*Ke,ue+=f*Ne,ae+=f*Me,se+=f*Ue,ce+=f*je,oe+=f*qe,Z+=f*Ze,X+=f*Ge,J+=f*Ve,f=d[3],z+=f*v,Q+=f*ge,F+=f*Ce,ke+=f*Te,W+=f*ve,ie+=f*Se,fe+=f*Oe,ue+=f*Ke,ae+=f*Ne,se+=f*Me,ce+=f*Ue,oe+=f*je,Z+=f*qe,X+=f*Ze,J+=f*Ge,G+=f*Ve,f=d[4],Q+=f*v,F+=f*ge,ke+=f*Ce,W+=f*Te,ie+=f*ve,fe+=f*Se,ue+=f*Oe,ae+=f*Ke,se+=f*Ne,ce+=f*Me,oe+=f*Ue,Z+=f*je,X+=f*qe,J+=f*Ze,G+=f*Ge,V+=f*Ve,f=d[5],F+=f*v,ke+=f*ge,W+=f*Ce,ie+=f*Te,fe+=f*ve,ue+=f*Se,ae+=f*Oe,se+=f*Ke,ce+=f*Ne,oe+=f*Me,Z+=f*Ue,X+=f*je,J+=f*qe,G+=f*Ze,V+=f*Ge,Y+=f*Ve,f=d[6],ke+=f*v,W+=f*ge,ie+=f*Ce,fe+=f*Te,ue+=f*ve,ae+=f*Se,se+=f*Oe,ce+=f*Ke,oe+=f*Ne,Z+=f*Me,X+=f*Ue,J+=f*je,G+=f*qe,V+=f*Ze,Y+=f*Ge,S+=f*Ve,f=d[7],W+=f*v,ie+=f*ge,fe+=f*Ce,ue+=f*Te,ae+=f*ve,se+=f*Se,ce+=f*Oe,oe+=f*Ke,Z+=f*Ne,X+=f*Me,J+=f*Ue,G+=f*je,V+=f*qe,Y+=f*Ze,S+=f*Ge,O+=f*Ve,f=d[8],ie+=f*v,fe+=f*ge,ue+=f*Ce,ae+=f*Te,se+=f*ve,ce+=f*Se,oe+=f*Oe,Z+=f*Ke,X+=f*Ne,J+=f*Me,G+=f*Ue,V+=f*je,Y+=f*qe,S+=f*Ze,O+=f*Ge,P+=f*Ve,f=d[9],fe+=f*v,ue+=f*ge,ae+=f*Ce,se+=f*Te,ce+=f*ve,oe+=f*Se,Z+=f*Oe,X+=f*Ke,J+=f*Ne,G+=f*Me,V+=f*Ue,Y+=f*je,S+=f*qe,O+=f*Ze,P+=f*Ge,R+=f*Ve,f=d[10],ue+=f*v,ae+=f*ge,se+=f*Ce,ce+=f*Te,oe+=f*ve,Z+=f*Se,X+=f*Oe,J+=f*Ke,G+=f*Ne,V+=f*Me,Y+=f*Ue,S+=f*je,O+=f*qe,P+=f*Ze,R+=f*Ge,D+=f*Ve,f=d[11],ae+=f*v,se+=f*ge,ce+=f*Ce,oe+=f*Te,Z+=f*ve,X+=f*Se,J+=f*Oe,G+=f*Ke,V+=f*Ne,Y+=f*Me,S+=f*Ue,O+=f*je,P+=f*qe,R+=f*Ze,D+=f*Ge,I+=f*Ve,f=d[12],se+=f*v,ce+=f*ge,oe+=f*Ce,Z+=f*Te,X+=f*ve,J+=f*Se,G+=f*Oe,V+=f*Ke,Y+=f*Ne,S+=f*Me,O+=f*Ue,P+=f*je,R+=f*qe,D+=f*Ze,I+=f*Ge,ne+=f*Ve,f=d[13],ce+=f*v,oe+=f*ge,Z+=f*Ce,X+=f*Te,J+=f*ve,G+=f*Se,V+=f*Oe,Y+=f*Ke,S+=f*Ne,O+=f*Me,P+=f*Ue,R+=f*je,D+=f*qe,I+=f*Ze,ne+=f*Ge,de+=f*Ve,f=d[14],oe+=f*v,Z+=f*ge,X+=f*Ce,J+=f*Te,G+=f*ve,V+=f*Se,Y+=f*Oe,S+=f*Ke,O+=f*Ne,P+=f*Me,R+=f*Ue,D+=f*je,I+=f*qe,ne+=f*Ze,de+=f*Ge,_e+=f*Ve,f=d[15],Z+=f*v,X+=f*ge,J+=f*Ce,G+=f*Te,V+=f*ve,Y+=f*Se,S+=f*Oe,O+=f*Ke,P+=f*Ne,R+=f*Me,D+=f*Ue,I+=f*je,ne+=f*qe,de+=f*Ze,_e+=f*Ge,he+=f*Ve,g+=38*X,w+=38*J,N+=38*G,z+=38*V,Q+=38*Y,F+=38*S,ke+=38*O,W+=38*P,ie+=38*R,fe+=38*D,ue+=38*I,ae+=38*ne,se+=38*de,ce+=38*_e,oe+=38*he,_=1,f=g+_+65535,_=Math.floor(f/65536),g=f-_*65536,f=w+_+65535,_=Math.floor(f/65536),w=f-_*65536,f=N+_+65535,_=Math.floor(f/65536),N=f-_*65536,f=z+_+65535,_=Math.floor(f/65536),z=f-_*65536,f=Q+_+65535,_=Math.floor(f/65536),Q=f-_*65536,f=F+_+65535,_=Math.floor(f/65536),F=f-_*65536,f=ke+_+65535,_=Math.floor(f/65536),ke=f-_*65536,f=W+_+65535,_=Math.floor(f/65536),W=f-_*65536,f=ie+_+65535,_=Math.floor(f/65536),ie=f-_*65536,f=fe+_+65535,_=Math.floor(f/65536),fe=f-_*65536,f=ue+_+65535,_=Math.floor(f/65536),ue=f-_*65536,f=ae+_+65535,_=Math.floor(f/65536),ae=f-_*65536,f=se+_+65535,_=Math.floor(f/65536),se=f-_*65536,f=ce+_+65535,_=Math.floor(f/65536),ce=f-_*65536,f=oe+_+65535,_=Math.floor(f/65536),oe=f-_*65536,f=Z+_+65535,_=Math.floor(f/65536),Z=f-_*65536,g+=_-1+37*(_-1),_=1,f=g+_+65535,_=Math.floor(f/65536),g=f-_*65536,f=w+_+65535,_=Math.floor(f/65536),w=f-_*65536,f=N+_+65535,_=Math.floor(f/65536),N=f-_*65536,f=z+_+65535,_=Math.floor(f/65536),z=f-_*65536,f=Q+_+65535,_=Math.floor(f/65536),Q=f-_*65536,f=F+_+65535,_=Math.floor(f/65536),F=f-_*65536,f=ke+_+65535,_=Math.floor(f/65536),ke=f-_*65536,f=W+_+65535,_=Math.floor(f/65536),W=f-_*65536,f=ie+_+65535,_=Math.floor(f/65536),ie=f-_*65536,f=fe+_+65535,_=Math.floor(f/65536),fe=f-_*65536,f=ue+_+65535,_=Math.floor(f/65536),ue=f-_*65536,f=ae+_+65535,_=Math.floor(f/65536),ae=f-_*65536,f=se+_+65535,_=Math.floor(f/65536),se=f-_*65536,f=ce+_+65535,_=Math.floor(f/65536),ce=f-_*65536,f=oe+_+65535,_=Math.floor(f/65536),oe=f-_*65536,f=Z+_+65535,_=Math.floor(f/65536),Z=f-_*65536,g+=_-1+37*(_-1),o[0]=g,o[1]=w,o[2]=N,o[3]=z,o[4]=Q,o[5]=F,o[6]=ke,o[7]=W,o[8]=ie,o[9]=fe,o[10]=ue,o[11]=ae,o[12]=se,o[13]=ce,o[14]=oe,o[15]=Z}function Xe(o,d){we(o,d,d)}function Nt(o,d){var u=n(),f;for(f=0;f<16;f++)u[f]=d[f];for(f=253;f>=0;f--)Xe(u,u),f!==2&&f!==4&&we(u,u,d);for(f=0;f<16;f++)o[f]=u[f]}function Wt(o,d){var u=n(),f;for(f=0;f<16;f++)u[f]=d[f];for(f=250;f>=0;f--)Xe(u,u),f!==1&&we(u,u,d);for(f=0;f<16;f++)o[f]=u[f]}function bt(o,d,u){var f=new Uint8Array(32),_=new Float64Array(80),g,w,N=n(),z=n(),Q=n(),F=n(),ke=n(),W=n();for(w=0;w<31;w++)f[w]=d[w];for(f[31]=d[31]&127|64,f[0]&=248,Rt(_,u),w=0;w<16;w++)z[w]=_[w],F[w]=N[w]=Q[w]=0;for(N[0]=F[0]=1,w=254;w>=0;--w)g=f[w>>>3]>>>(w&7)&1,at(N,z,g),at(Q,F,g),Je(ke,N,Q),tt(N,N,Q),Je(Q,z,F),tt(z,z,F),Xe(F,ke),Xe(W,N),we(N,Q,N),we(Q,z,ke),Je(ke,N,Q),tt(N,N,Q),Xe(z,N),tt(Q,F,W),we(N,Q,a),Je(N,N,F),we(Q,Q,N),we(N,F,W),we(F,z,_),Xe(z,ke),at(N,z,g),at(Q,F,g);for(w=0;w<16;w++)_[w+16]=N[w],_[w+32]=Q[w],_[w+48]=z[w],_[w+64]=F[w];var ie=_.subarray(32),fe=_.subarray(16);return Nt(ie,ie),we(fe,fe,ie),Ee(o,fe),0}function Ct(o,d){return bt(o,d,s)}function Ut(o,d){return r(d,32),Ct(o,d)}function Ot(o,d,u){var f=new Uint8Array(32);return bt(f,u,d),j(o,i,f,q)}var tn=$e,bn=pt;function nn(o,d,u,f,_,g){var w=new Uint8Array(32);return Ot(w,_,g),tn(o,d,u,f,w)}function Et(o,d,u,f,_,g){var w=new Uint8Array(32);return Ot(w,_,g),bn(o,d,u,f,w)}var rn=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function jt(o,d,u,f){for(var _=new Int32Array(16),g=new Int32Array(16),w,N,z,Q,F,ke,W,ie,fe,ue,ae,se,ce,oe,Z,X,J,G,V,Y,S,O,P,R,D,I,ne=o[0],de=o[1],_e=o[2],he=o[3],v=o[4],ge=o[5],Ce=o[6],Te=o[7],ve=d[0],Se=d[1],Oe=d[2],Ke=d[3],Ne=d[4],Me=d[5],Ue=d[6],je=d[7],qe=0;f>=128;){for(V=0;V<16;V++)Y=8*V+qe,_[V]=u[Y+0]<<24|u[Y+1]<<16|u[Y+2]<<8|u[Y+3],g[V]=u[Y+4]<<24|u[Y+5]<<16|u[Y+6]<<8|u[Y+7];for(V=0;V<80;V++)if(w=ne,N=de,z=_e,Q=he,F=v,ke=ge,W=Ce,ie=Te,fe=ve,ue=Se,ae=Oe,se=Ke,ce=Ne,oe=Me,Z=Ue,X=je,S=Te,O=je,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=(v>>>14|Ne<<32-14)^(v>>>18|Ne<<32-18)^(Ne>>>41-32|v<<32-(41-32)),O=(Ne>>>14|v<<32-14)^(Ne>>>18|v<<32-18)^(v>>>41-32|Ne<<32-(41-32)),P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,S=v&ge^~v&Ce,O=Ne&Me^~Ne&Ue,P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,S=rn[V*2],O=rn[V*2+1],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,S=_[V%16],O=g[V%16],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,J=D&65535|I<<16,G=P&65535|R<<16,S=J,O=G,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=(ne>>>28|ve<<32-28)^(ve>>>34-32|ne<<32-(34-32))^(ve>>>39-32|ne<<32-(39-32)),O=(ve>>>28|ne<<32-28)^(ne>>>34-32|ve<<32-(34-32))^(ne>>>39-32|ve<<32-(39-32)),P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,S=ne&de^ne&_e^de&_e,O=ve&Se^ve&Oe^Se&Oe,P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,ie=D&65535|I<<16,X=P&65535|R<<16,S=Q,O=se,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=J,O=G,P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,Q=D&65535|I<<16,se=P&65535|R<<16,de=w,_e=N,he=z,v=Q,ge=F,Ce=ke,Te=W,ne=ie,Se=fe,Oe=ue,Ke=ae,Ne=se,Me=ce,Ue=oe,je=Z,ve=X,V%16===15)for(Y=0;Y<16;Y++)S=_[Y],O=g[Y],P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=_[(Y+9)%16],O=g[(Y+9)%16],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,J=_[(Y+1)%16],G=g[(Y+1)%16],S=(J>>>1|G<<32-1)^(J>>>8|G<<32-8)^J>>>7,O=(G>>>1|J<<32-1)^(G>>>8|J<<32-8)^(G>>>7|J<<32-7),P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,J=_[(Y+14)%16],G=g[(Y+14)%16],S=(J>>>19|G<<32-19)^(G>>>61-32|J<<32-(61-32))^J>>>6,O=(G>>>19|J<<32-19)^(J>>>61-32|G<<32-(61-32))^(G>>>6|J<<32-6),P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,_[Y]=D&65535|I<<16,g[Y]=P&65535|R<<16;S=ne,O=ve,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[0],O=d[0],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[0]=ne=D&65535|I<<16,d[0]=ve=P&65535|R<<16,S=de,O=Se,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[1],O=d[1],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[1]=de=D&65535|I<<16,d[1]=Se=P&65535|R<<16,S=_e,O=Oe,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[2],O=d[2],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[2]=_e=D&65535|I<<16,d[2]=Oe=P&65535|R<<16,S=he,O=Ke,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[3],O=d[3],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[3]=he=D&65535|I<<16,d[3]=Ke=P&65535|R<<16,S=v,O=Ne,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[4],O=d[4],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[4]=v=D&65535|I<<16,d[4]=Ne=P&65535|R<<16,S=ge,O=Me,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[5],O=d[5],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[5]=ge=D&65535|I<<16,d[5]=Me=P&65535|R<<16,S=Ce,O=Ue,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[6],O=d[6],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[6]=Ce=D&65535|I<<16,d[6]=Ue=P&65535|R<<16,S=Te,O=je,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[7],O=d[7],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[7]=Te=D&65535|I<<16,d[7]=je=P&65535|R<<16,qe+=128,f-=128}return f}function nt(o,d,u){var f=new Int32Array(8),_=new Int32Array(8),g=new Uint8Array(256),w,N=u;for(f[0]=1779033703,f[1]=3144134277,f[2]=1013904242,f[3]=2773480762,f[4]=1359893119,f[5]=2600822924,f[6]=528734635,f[7]=1541459225,_[0]=4089235720,_[1]=2227873595,_[2]=4271175723,_[3]=1595750129,_[4]=2917565137,_[5]=725511199,_[6]=4215389547,_[7]=327033209,jt(f,_,d,u),u%=128,w=0;w<u;w++)g[w]=d[N-u+w];for(g[u]=128,u=256-128*(u<112?1:0),g[u-9]=0,E(g,u-8,N/536870912|0,N<<3),jt(f,_,g,u),w=0;w<8;w++)E(o,8*w,f[w],_[w]);return 0}function it(o,d){var u=n(),f=n(),_=n(),g=n(),w=n(),N=n(),z=n(),Q=n(),F=n();tt(u,o[1],o[0]),tt(F,d[1],d[0]),we(u,u,F),Je(f,o[0],o[1]),Je(F,d[0],d[1]),we(f,f,F),we(_,o[3],d[3]),we(_,_,p),we(g,o[2],d[2]),Je(g,g,g),tt(w,f,u),tt(N,g,_),Je(z,g,_),Je(Q,f,u),we(o[0],w,N),we(o[1],Q,z),we(o[2],z,N),we(o[3],w,Q)}function ft(o,d,u){var f;for(f=0;f<4;f++)at(o[f],d[f],u)}function Lt(o,d){var u=n(),f=n(),_=n();Nt(_,d[2]),we(u,d[0],_),we(f,d[1],_),Ee(o,f),o[31]^=Mt(u)<<7}function re(o,d,u){var f,_;for(We(o[0],l),We(o[1],c),We(o[2],c),We(o[3],l),_=255;_>=0;--_)f=u[_/8|0]>>(_&7)&1,ft(o,d,f),it(d,o),it(o,o),ft(o,d,f)}function Re(o,d){var u=[n(),n(),n(),n()];We(u[0],b),We(u[1],m),We(u[2],c),we(u[3],b,m),re(o,u,d)}function zt(o,d,u){var f=new Uint8Array(64),_=[n(),n(),n(),n()],g;for(u||r(d,32),nt(f,d,32),f[0]&=248,f[31]&=127,f[31]|=64,Re(_,f),Lt(o,_),g=0;g<32;g++)d[g+32]=o[g];return 0}var Zt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function on(o,d){var u,f,_,g;for(f=63;f>=32;--f){for(u=0,_=f-32,g=f-12;_<g;++_)d[_]+=u-16*d[f]*Zt[_-(f-32)],u=Math.floor((d[_]+128)/256),d[_]-=u*256;d[_]+=u,d[f]=0}for(u=0,_=0;_<32;_++)d[_]+=u-(d[31]>>4)*Zt[_],u=d[_]>>8,d[_]&=255;for(_=0;_<32;_++)d[_]-=u*Zt[_];for(f=0;f<32;f++)d[f+1]+=d[f]>>8,o[f]=d[f]&255}function ln(o){var d=new Float64Array(64),u;for(u=0;u<64;u++)d[u]=o[u];for(u=0;u<64;u++)o[u]=0;on(o,d)}function Pe(o,d,u,f){var _=new Uint8Array(64),g=new Uint8Array(64),w=new Uint8Array(64),N,z,Q=new Float64Array(64),F=[n(),n(),n(),n()];nt(_,f,32),_[0]&=248,_[31]&=127,_[31]|=64;var ke=u+64;for(N=0;N<u;N++)o[64+N]=d[N];for(N=0;N<32;N++)o[32+N]=_[32+N];for(nt(w,o.subarray(32),u+32),ln(w),Re(F,w),Lt(o,F),N=32;N<64;N++)o[N]=f[N];for(nt(g,o,u+64),ln(g),N=0;N<64;N++)Q[N]=0;for(N=0;N<32;N++)Q[N]=w[N];for(N=0;N<32;N++)for(z=0;z<32;z++)Q[N+z]+=g[N]*_[z];return on(o.subarray(32),Q),ke}function et(o,d){var u=n(),f=n(),_=n(),g=n(),w=n(),N=n(),z=n();return We(o[2],c),Rt(o[1],d),Xe(_,o[1]),we(g,_,h),tt(_,_,o[2]),Je(g,o[2],g),Xe(w,g),Xe(N,w),we(z,N,w),we(u,z,_),we(u,u,g),Wt(u,u),we(u,u,_),we(u,u,g),we(u,u,g),we(o[0],u,g),Xe(f,o[0]),we(f,f,g),Ye(f,_)&&we(o[0],o[0],y),Xe(f,o[0]),we(f,f,g),Ye(f,_)?-1:(Mt(o[0])===d[31]>>7&&tt(o[0],l,o[0]),we(o[3],o[0],o[1]),0)}function fn(o,d,u,f){var _,g=new Uint8Array(32),w=new Uint8Array(64),N=[n(),n(),n(),n()],z=[n(),n(),n(),n()];if(u<64||et(z,f))return-1;for(_=0;_<u;_++)o[_]=d[_];for(_=0;_<32;_++)o[_+32]=f[_];if(nt(w,o,u),ln(w),re(N,z,w),Re(z,d.subarray(32)),it(N,z),Lt(g,N),u-=64,A(d,0,g,0)){for(_=0;_<u;_++)o[_]=0;return-1}for(_=0;_<u;_++)o[_]=d[_+64];return u}var sn=32,Bt=24,Gt=32,Dt=16,Vt=32,cn=32,Qt=32,Xt=32,wn=32,Hn=Bt,Or=Gt,kr=Dt,wt=64,kt=32,$t=64,xn=32,An=64;e.lowlevel={crypto_core_hsalsa20:j,crypto_stream_xor:Ie,crypto_stream:me,crypto_stream_salsa20_xor:xe,crypto_stream_salsa20:be,crypto_onetimeauth:Qe,crypto_onetimeauth_verify:ut,crypto_verify_16:$,crypto_verify_32:A,crypto_secretbox:$e,crypto_secretbox_open:pt,crypto_scalarmult:bt,crypto_scalarmult_base:Ct,crypto_box_beforenm:Ot,crypto_box_afternm:tn,crypto_box:nn,crypto_box_open:Et,crypto_box_keypair:Ut,crypto_hash:nt,crypto_sign:Pe,crypto_sign_keypair:zt,crypto_sign_open:fn,crypto_secretbox_KEYBYTES:sn,crypto_secretbox_NONCEBYTES:Bt,crypto_secretbox_ZEROBYTES:Gt,crypto_secretbox_BOXZEROBYTES:Dt,crypto_scalarmult_BYTES:Vt,crypto_scalarmult_SCALARBYTES:cn,crypto_box_PUBLICKEYBYTES:Qt,crypto_box_SECRETKEYBYTES:Xt,crypto_box_BEFORENMBYTES:wn,crypto_box_NONCEBYTES:Hn,crypto_box_ZEROBYTES:Or,crypto_box_BOXZEROBYTES:kr,crypto_sign_BYTES:wt,crypto_sign_PUBLICKEYBYTES:kt,crypto_sign_SECRETKEYBYTES:$t,crypto_sign_SEEDBYTES:xn,crypto_hash_BYTES:An,gf:n,D:h,L:Zt,pack25519:Ee,unpack25519:Rt,M:we,A:Je,S:Xe,Z:tt,pow2523:Wt,add:it,set25519:We,modL:on,scalarmult:re,scalarbase:Re};function Jn(o,d){if(o.length!==sn)throw new Error("bad key size");if(d.length!==Bt)throw new Error("bad nonce size")}function Cr(o,d){if(o.length!==Qt)throw new Error("bad public key size");if(d.length!==Xt)throw new Error("bad secret key size")}function rt(){for(var o=0;o<arguments.length;o++)if(!(arguments[o]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Wn(o){for(var d=0;d<o.length;d++)o[d]=0}e.randomBytes=function(o){var d=new Uint8Array(o);return r(d,o),d},e.secretbox=function(o,d,u){rt(o,d,u),Jn(u,d);for(var f=new Uint8Array(Gt+o.length),_=new Uint8Array(f.length),g=0;g<o.length;g++)f[g+Gt]=o[g];return $e(_,f,f.length,d,u),_.subarray(Dt)},e.secretbox.open=function(o,d,u){rt(o,d,u),Jn(u,d);for(var f=new Uint8Array(Dt+o.length),_=new Uint8Array(f.length),g=0;g<o.length;g++)f[g+Dt]=o[g];return f.length<32||pt(_,f,f.length,d,u)!==0?null:_.subarray(Gt)},e.secretbox.keyLength=sn,e.secretbox.nonceLength=Bt,e.secretbox.overheadLength=Dt,e.scalarMult=function(o,d){if(rt(o,d),o.length!==cn)throw new Error("bad n size");if(d.length!==Vt)throw new Error("bad p size");var u=new Uint8Array(Vt);return bt(u,o,d),u},e.scalarMult.base=function(o){if(rt(o),o.length!==cn)throw new Error("bad n size");var d=new Uint8Array(Vt);return Ct(d,o),d},e.scalarMult.scalarLength=cn,e.scalarMult.groupElementLength=Vt,e.box=function(o,d,u,f){var _=e.box.before(u,f);return e.secretbox(o,d,_)},e.box.before=function(o,d){rt(o,d),Cr(o,d);var u=new Uint8Array(wn);return Ot(u,o,d),u},e.box.after=e.secretbox,e.box.open=function(o,d,u,f){var _=e.box.before(u,f);return e.secretbox.open(o,d,_)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var o=new Uint8Array(Qt),d=new Uint8Array(Xt);return Ut(o,d),{publicKey:o,secretKey:d}},e.box.keyPair.fromSecretKey=function(o){if(rt(o),o.length!==Xt)throw new Error("bad secret key size");var d=new Uint8Array(Qt);return Ct(d,o),{publicKey:d,secretKey:new Uint8Array(o)}},e.box.publicKeyLength=Qt,e.box.secretKeyLength=Xt,e.box.sharedKeyLength=wn,e.box.nonceLength=Hn,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(o,d){if(rt(o,d),d.length!==$t)throw new Error("bad secret key size");var u=new Uint8Array(wt+o.length);return Pe(u,o,o.length,d),u},e.sign.open=function(o,d){if(rt(o,d),d.length!==kt)throw new Error("bad public key size");var u=new Uint8Array(o.length),f=fn(u,o,o.length,d);if(f<0)return null;for(var _=new Uint8Array(f),g=0;g<_.length;g++)_[g]=u[g];return _},e.sign.detached=function(o,d){for(var u=e.sign(o,d),f=new Uint8Array(wt),_=0;_<f.length;_++)f[_]=u[_];return f},e.sign.detached.verify=function(o,d,u){if(rt(o,d,u),d.length!==wt)throw new Error("bad signature size");if(u.length!==kt)throw new Error("bad public key size");var f=new Uint8Array(wt+o.length),_=new Uint8Array(wt+o.length),g;for(g=0;g<wt;g++)f[g]=d[g];for(g=0;g<o.length;g++)f[g+wt]=o[g];return fn(_,f,f.length,u)>=0},e.sign.keyPair=function(){var o=new Uint8Array(kt),d=new Uint8Array($t);return zt(o,d),{publicKey:o,secretKey:d}},e.sign.keyPair.fromSecretKey=function(o){if(rt(o),o.length!==$t)throw new Error("bad secret key size");for(var d=new Uint8Array(kt),u=0;u<d.length;u++)d[u]=o[32+u];return{publicKey:d,secretKey:new Uint8Array(o)}},e.sign.keyPair.fromSeed=function(o){if(rt(o),o.length!==xn)throw new Error("bad seed size");for(var d=new Uint8Array(kt),u=new Uint8Array($t),f=0;f<32;f++)u[f]=o[f];return zt(d,u,!0),{publicKey:d,secretKey:u}},e.sign.publicKeyLength=kt,e.sign.secretKeyLength=$t,e.sign.seedLength=xn,e.sign.signatureLength=wt,e.hash=function(o){rt(o);var d=new Uint8Array(An);return nt(d,o,o.length),d},e.hash.hashLength=An,e.verify=function(o,d){return rt(o,d),o.length===0||d.length===0||o.length!==d.length?!1:x(o,0,d,0,o.length)===0},e.setPRNG=function(o){r=o},function(){var o=typeof self<"u"?self.crypto||self.msCrypto:null;if(o&&o.getRandomValues){var d=65536;e.setPRNG(function(u,f){var _,g=new Uint8Array(f);for(_=0;_<f;_+=d)o.getRandomValues(g.subarray(_,_+Math.min(f-_,d)));for(_=0;_<f;_++)u[_]=g[_];Wn(g)})}else typeof Ss<"u"&&(o=Vl,o&&o.randomBytes&&e.setPRNG(function(u,f){var _,g=o.randomBytes(f);for(_=0;_<f;_++)u[_]=g[_];Wn(g)}))}()})(t.exports?t.exports:self.nacl=self.nacl||{})}),Yn=Es(function(t){(function(e,n){t.exports?t.exports=n():(e.nacl||(e.nacl={}),e.nacl.util=n())})(Jl,function(){var e={};function n(r){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(r))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(r){if(typeof r!="string")throw new TypeError("expected string");var i,s=unescape(encodeURIComponent(r)),l=new Uint8Array(s.length);for(i=0;i<s.length;i++)l[i]=s.charCodeAt(i);return l},e.encodeUTF8=function(r){var i,s=[];for(i=0;i<r.length;i++)s.push(String.fromCharCode(r[i]));return decodeURIComponent(escape(s.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(r){return Buffer.from(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(Buffer.from(r,"base64"),0))}):(e.encodeBase64=function(r){return new Buffer(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(new Buffer(r,"base64"),0))}):(e.encodeBase64=function(r){var i,s=[],l=r.length;for(i=0;i<l;i++)s.push(String.fromCharCode(r[i]));return btoa(s.join(""))},e.decodeBase64=function(r){n(r);var i,s=atob(r),l=new Uint8Array(s.length);for(i=0;i<s.length;i++)l[i]=s.charCodeAt(i);return l}),e})});function Ql(t){return t!=null&&t.constructor==Object}function Xl(t,e){const n=new Uint8Array(t.length+1),r=new Uint8Array(1);return r[0]=e,n.set(r),n.set(t,r.length),n}function ec(){}let Nr=class{constructor(e,n,r){this.prev=e,this.next=n,this.fn=r||ec}run(e){this.fn(e),this.next&&this.next.run(e)}},tc=class{constructor(e){this.head=new Nr,this.tail=new Nr(this.head),this.head.next=this.tail,this.linkConstructor=e,this.reg={}}insert(e){const n=new Nr(this.tail.prev,this.tail,e);return n.next.prev=n,n.prev.next=n,n}remove(e){e.prev.next=e.next,e.next.prev=e.prev}},nc=0,oi=class{constructor(){this.__events_list={}}on(e,n){const r=this.__events_list[e]||(this.__events_list[e]=new tc),i=n._eev||(n._eev=++nc);r.reg[i]||(r.reg[i]=r.insert(n))}off(e,n){if(n){const r=this.__events_list[e];if(!r)return;const i=r.reg[n._eev];r.reg[n._eev]=void 0,r&&i&&r.remove(i)}}removeListener(...e){this.off(...e)}emit(e,n){const r=this.__events_list[e];r&&r.head.run(n)}};function rc(t){return typeof t>"u"||t==null?[]:Array.isArray(t)?t:[t]}function _r(t){return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}function Fr(t){const e=t.match(/.{1,2}(?=(.{2})+(?!.))|.{1,2}$/g);return new Uint8Array(e.map(n=>parseInt(n,16)))}function Os(t,e=8){const n=new Array(e).fill(0);for(let r=0;r<n.length;r++){const i=t&255;n[r]=i,t=(t-i)/256}return n}var ic=On;/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 * @license MIT (© Joyent)
 */function On(t,e){var n={seen:[],stylize:fc};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),ks(e)?n.showHidden=e:e&&dc(n,e),Mn(n.showHidden)&&(n.showHidden=!1),Mn(n.depth)&&(n.depth=2),Mn(n.colors)&&(n.colors=!1),Mn(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=sc),pr(n,t,n.depth)}On.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};On.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function fc(t,e){return t}function ks(t){return typeof t=="boolean"}function Mn(t){return t===void 0}function sc(t,e){var n=On.styles[e];return n?"\x1B["+On.colors[n][0]+"m"+t+"\x1B["+On.colors[n][1]+"m":t}function Dr(t){return typeof t=="function"}function Cs(t){return typeof t=="string"}function oc(t){return typeof t=="number"}function Ts(t){return t===null}function Rs(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function $r(t){return Ar(t)&&li(t)==="[object RegExp]"}function Ar(t){return typeof t=="object"&&t!==null}function Pr(t){return Ar(t)&&(li(t)==="[object Error]"||t instanceof Error)}function df(t){return Ar(t)&&li(t)==="[object Date]"}function li(t){return Object.prototype.toString.call(t)}function lc(t){var e={};return t.forEach(function(n,r){e[n]=!0}),e}function cc(t,e,n,r,i){for(var s=[],l=0,c=e.length;l<c;++l)Rs(e,String(l))?s.push(Hr(t,e,n,r,String(l),!0)):s.push("");return i.forEach(function(a){a.match(/^\d+$/)||s.push(Hr(t,e,n,r,a,!0))}),s}function Ir(t){return"["+Error.prototype.toString.call(t)+"]"}function pr(t,e,n){if(t.customInspect&&e&&Dr(e.inspect)&&e.inspect!==On&&!(e.constructor&&e.constructor.prototype===e)){var r=e.inspect(n,t);return Cs(r)||(r=pr(t,r,n)),r}var i=ac(t,e);if(i)return i;var s=Object.keys(e),l=lc(s);try{t.showHidden&&Object.getOwnPropertyNames&&(s=Object.getOwnPropertyNames(e))}catch{}if(Pr(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return Ir(e);if(s.length===0){if(Dr(e)){var c=e.name?": "+e.name:"";return t.stylize("[Function"+c+"]","special")}if($r(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(df(e))return t.stylize(Date.prototype.toString.call(e),"date");if(Pr(e))return Ir(e)}var a="",h=!1,p=["{","}"];if(Array.isArray(e)&&(h=!0,p=["[","]"]),Dr(e)){var b=e.name?": "+e.name:"";a=" [Function"+b+"]"}if($r(e)&&(a=" "+RegExp.prototype.toString.call(e)),df(e)&&(a=" "+Date.prototype.toUTCString.call(e)),Pr(e)&&(a=" "+Ir(e)),s.length===0&&(!h||e.length==0))return p[0]+a+p[1];if(n<0)return $r(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var m;return h?m=cc(t,e,n,l,s):m=s.map(function(y){return Hr(t,e,n,l,y,h)}),t.seen.pop(),uc(m,a,p)}function Hr(t,e,n,r,i,s){var l,c,a;a={value:void 0};try{a.value=e[i]}catch{}try{Object.getOwnPropertyDescriptor&&(a=Object.getOwnPropertyDescriptor(e,i)||a)}catch{}if(a.get?a.set?c=t.stylize("[Getter/Setter]","special"):c=t.stylize("[Getter]","special"):a.set&&(c=t.stylize("[Setter]","special")),Rs(r,i)||(l="["+i+"]"),c||(t.seen.indexOf(a.value)<0?(Ts(n)?c=pr(t,a.value,null):c=pr(t,a.value,n-1),c.indexOf(`
`)>-1&&(s?c=c.split(`
`).map(function(h){return"  "+h}).join(`
`).substr(2):c=`
`+c.split(`
`).map(function(h){return"   "+h}).join(`
`))):c=t.stylize("[Circular]","special")),Mn(l)){if(s&&i.match(/^\d+$/))return c;l=JSON.stringify(""+i),l.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(l=l.substr(1,l.length-2),l=t.stylize(l,"name")):(l=l.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),l=t.stylize(l,"string"))}return l+": "+c}function ac(t,e){if(Mn(e))return t.stylize("undefined","undefined");if(Cs(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(oc(e))return t.stylize(""+e,"number");if(ks(e))return t.stylize(""+e,"boolean");if(Ts(e))return t.stylize("null","null")}function uc(t,e,n){var r=t.reduce(function(i,s){return s.indexOf(`
`)>=0,i+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function dc(t,e){if(!e||!Ar(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}function an(t,e,...n){try{e==console.log?e(`${new Date().toLocaleString()} → ${ic(...n).replace(/^'/,"").replace(/'$/,"")}`):typeof e=="function"?e(...n):e&&e.logOutput(t,{source:"connectome"},...n)}catch(r){console.log(r)}}let hc=class{write(e,...n){an(void 0,e,...n)}red(e,...n){an("red",e,...n)}green(e,...n){an("green",e,...n)}yellow(e,...n){an("yellow",e,...n)}blue(e,...n){an("blue",e,...n)}cyan(e,...n){an("cyan",e,...n)}magenta(e,...n){an("magenta",e,...n)}gray(e,...n){an("gray",e,...n)}white(e,...n){an("white",e,...n)}};var Fe=new hc;Yt.util=Yn;function _c({data:t,connector:e}){const{log:n}=e;Ql(t)&&(t=JSON.stringify(t));const r=new Uint8Array(Os(2*e.sentCount,24));if(e.closed())Fe.red(n,`⚠️ Warning: "${t}" was not sent because connector is not ready`);else if(e.sentCount>1){let i=0;typeof t=="string"&&(i=1);const s=i==1?Yt.util.decodeUTF8(t):t,l=Xl(s,i),c=Yt.secretbox(l,r,e.sharedSecret);e.verbose&&(Fe.green(n,`Connector ${e.endpoint} → Sending encrypted message #${e.sentCount} ↴`),Fe.gray(n,t)),e.connection.websocket.send(c)}else e.verbose&&(Fe.green(n,`Connector ${e.endpoint} → Sending message #${e.sentCount} ↴`),Fe.cyan(n,t)),e.connection.websocket.send(t)}Yt.util=Yn;function pc(t){return Object.keys(t).includes("result")||Object.keys(t).includes("error")}function Ns({jsonData:t,encryptedData:e,rawMessage:n,wasEncrypted:r,connector:i}){const{log:s}=i;i.lastMessageAt=Date.now();const l=new Uint8Array(Os(2*i.receivedCount+1,24));if(i.verbose&&!r&&Fe.magenta(s,`Connector ${i.endpoint} → Received message #${i.receivedCount} ↴`),t)t.jsonrpc?pc(t)?(i.verbose&&!r&&(Fe.magenta(s,`Connector ${i.endpoint} received plain-text rpc result ↴`),Fe.gray(s,t)),i.rpcClient.jsonrpcMsgReceive(n)):i.emit("json_rpc",n):i.emit("receive",{jsonData:t,rawMessage:n});else if(e){i.verbose=="extra"&&(Fe.magenta(s,`Connector ${i.endpoint} received bytes ↴`),Fe.cyan(s,e),Fe.green(s,JSON.stringify(e)),Fe.gray(s,`Connector ${i.endpoint} decrypting with shared secret ${i.sharedSecret}...`)),i.sharedSecret||Fe.red(s,`Connector ${i.endpoint} missing sharedSecret - should not happen...`);const c=Yt.secretbox.open(e,l,i.sharedSecret),a=c[0],h=c.subarray(1);if(a==1){const p=Yt.util.encodeUTF8(h);i.verbose&&Fe.yellow(s,`Connector ${i.endpoint} received message: ${p}`);try{const b=JSON.parse(p);b.jsonrpc?Ns({jsonData:b,rawMessage:p,wasEncrypted:!0,connector:i}):b.state?i.emit("receive_state",b.state):b.diff?i.emit("receive_diff",b.diff):b.signal?i.emit(b.signal,b.data):b.stateField?i.emit("receive_state_field",b.stateField):i.emit("receive",{jsonData:b,rawMessage:p})}catch(b){throw Fe.red(s,"Couldn't parse json message although the flag was for string ..."),Fe.red(s,p),b}}else i.verbose&&Fe.yellow(s,`Connector ${i.endpoint} received binary data`),i.emit("receive_binary",h)}}Yt.util=Yn;const bc=1;function vc({connector:t,afterFirstStep:e=()=>{}}){const{clientPrivateKey:n,clientPublicKey:r,clientPublicKeyHex:i,protocol:s,tag:l,endpoint:c,verbose:a}=t;return new Promise((h,p)=>{t.remoteObject("Auth").call("exchangePubkeys",{pubkey:i}).then(b=>{const m=Yt.box.before(Fr(b),n);if(e({sharedSecret:m,remotePubkeyHex:b}),a&&Fe.write(t.log,`Connector ${c} established shared secret through diffie-hellman exchange.`),t.connection.websocket.readyState==bc)t.remoteObject("Auth").call("finalizeHandshake",{protocol:s}).then(y=>{if(y&&y.error)console.log(y.error);else{h();const E=l?` (${l})`:"";Fe.cyan(t.log,`☑️  ${c}${E} ✓ Connection #${t.connection.websocket.__id} [ ${s||'"no-name"'} ] ready`)}}).catch(p);else{const y=l?` (${l})`:"";Fe.yellow(t.log,`${c}${y} ✖ Connection [ ${s||'"no-name"'} ] closed just before finalizeHandshake step`)}}).catch(p)})}let mc=class extends oi{constructor(e){super(),this.state=e,this.subscriptions=[]}get(){return this.state}subscribe(e){return this.subscriptions.push(e),e(this.state),()=>{this.subscriptions=this.subscriptions.filter(n=>n!==e)}}announceStateChange(){this.subscriptions.forEach(e=>e(this.state))}},br=class extends mc{set(e){this.state=e,this.announceStateChange()}},yc=class extends oi{constructor(e){super(),this.connector=e}send(...e){this.connector.send(...e)}};var Ft={PARSE_ERROR:-32700,INVALID_REQUEST:-32600,METHOD_NOT_FOUND:-32601,INVALID_PARAMS:-32602,REMOTE_INTERNAL_ERROR:-32603,TIMEOUT:-32701};let Ds=class{constructor({transports:e}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transportsToRegister=e,this.methods={}}setMethodPrefix(e){this.methodPrefix=e}expose(e){this.methods=e}registerTransport(e){e.onData(this._processRequest.bind(this,e))}async _processRequest(e,n){const r=JSON.parse(n);let i;return Array.isArray(r)?i=await Promise.all(r.map(s=>this._callMethod(s,e))):i=await this._callMethod(r,e),JSON.stringify(i)}async _callMethod(e,n){if(!e.hasOwnProperty("method"))return;const{method:i,params:s=[],id:l}=e;let c=i;if(c.includes("::")){const[p,b]=c.split("::");if(c=b,this.methodPrefix&&p!=this.methodPrefix)return}const a=!this.methods[c]||typeof this.methods[c]!="function"||c==="constructor"||c.startsWith("_")||this.methods[c]===Object.prototype[c];let h={};if(a)h={jsonrpc:"2.0",id:l,error:{code:Ft.METHOD_NOT_FOUND,message:`Method [${c}] not found on remote target object`}};else{this.currentTransport=n;try{const p=await this.methods[c].apply(this.methods,s);if(!l)return;h={jsonrpc:"2.0",result:typeof p>"u"?null:p,id:l}}catch(p){console.log(`Exposed RPC method ${i} internal error:`),console.log(p),console.log("Sending this error as a result to calling client ..."),h={jsonrpc:"2.0",error:{code:Ft.REMOTE_INTERNAL_ERROR,message:`Method [${i}] internal error: ${p.stack}`},id:l}}}return h}run(){for(const e of this.transportsToRegister)this.registerTransport(e);this.transportsToRegister=[]}},Rn=class extends Error{constructor(e={}){if(super(),!e.code)throw new Error("Code required");if(!e.message)throw new Error("Message required");this.code=e.code,this.message=e.message}},gc=class extends Rn{constructor(e){super({code:Ft.METHOD_NOT_FOUND,message:e||"Method not found"})}},wc=class extends Rn{constructor(){super({code:Ft.INVALID_PARAMS,message:"Invalid params"})}},xc=class extends Rn{constructor(e){super({code:Ft.REMOTE_INTERNAL_ERROR,message:`Error originating at remote endpoint: ${e}`||"Remote Internal error"})}},Ac=class extends Rn{constructor(){super({code:Ft.PARSE_ERROR,message:"Parse error"})}},Ec=class extends Rn{constructor(){super({code:Ft.INVALID_REQUEST,message:"Invalid request"})}},$s=class extends Rn{},Sc=class extends $s{constructor(e,n){super({code:Ft.TIMEOUT,message:`Request exceeded maximum execution time (${n}ms): ${e}`})}};var Mr={Base:Rn,MethodNotFound:gc,InvalidRequest:Ec,InvalidParams:wc,RemoteInternalError:xc,ServerError:$s,ParseError:Ac,RequestTimeout:Sc};let Ps=class{constructor({transport:e,requestTimeout:n=2e4}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transport=e,this.requestTimeout=n,this.pendingRequest={},this.initialized=!1}setMethodPrefix(e){this.methodPrefix=e}async callMethod(e,n){this._init();const r=this.methodPrefix?`${this.methodPrefix}::${e}`:e,i=this._makeRequestObject({method:r,params:n});return this._sendRequest({object:i,id:i.id})}notify(e,n){this._init();const r=this._makeRequestObject({method:e,params:n,mode:"notify"});return this.transport.sendData(JSON.stringify(r)),!0}async runBatch(e){const n=this._generateId();let r=!0;const i=[];for(const[s,l,c]of e){const a=this._makeRequestObject({method:s,params:l,mode:c,batchId:n});a.id&&(r=!1),i.push(a)}return r?this.transport.sendData(JSON.stringify(i)):this._sendRequest({object:i,id:n})}_init(){this.initialized||(this.transport.onData(this._processResponse.bind(this)),this.initialized=!0)}_sendRequest({object:e,id:n}){const r=JSON.stringify(e);return new Promise((i,s)=>{this.pendingRequest[n]={resolve:i,reject:s,sentObject:e},setTimeout(()=>{this.pendingRequest[n]&&(delete this.pendingRequest[n],s(new Mr.RequestTimeout(r,this.requestTimeout)))},this.requestTimeout);try{this.transport.sendData(r)}catch(l){delete this.pendingRequest[n],s(l)}})}_processResponse(e){const n=JSON.parse(e);Array.isArray(n)?this._processBatchResponse(n):this._processSingleCallResponse(n)}_processSingleCallResponse(e){const n=e.hasOwnProperty("result")||!1,r=e.hasOwnProperty("error");if(!n&&!r)return;const i=this.pendingRequest[e.id];if(delete this.pendingRequest[e.id],!!i){if(n)i.resolve(e.result);else if(r){const s=this._makeErrorObject(e.error);i.reject(s)}}}_processBatchResponse(e){let n;const r={},i=[];for(const h of e)h.id?(n||(n=h.id.split("|")[0]),r[h.id]=h):h.error&&i.push(h.error);if(!this.pendingRequest[n])return;const{sentObject:s,resolve:l}=this.pendingRequest[n];delete this.pendingRequest[n];const c=[];let a=0;for(const h of s){if(!h.id){c.push(null);continue}const p=r[h.id];p?p.hasOwnProperty("result")||!1?c.push({success:!0,result:p.result}):c.push({success:!1,result:this._makeErrorObject(p.error)}):(c.push({success:!1,error:this._makeErrorObject(i[a])}),a++)}l(c)}_makeRequestObject({method:e,params:n,mode:r,batchId:i}){const s={jsonrpc:"2.0",method:e};return n&&n.length&&(s.params=n),r!=="notify"&&(s.id=i?`${i}|${this._generateId()}`:this._generateId()),s}_makeErrorObject(e){const n={[Ft.METHOD_NOT_FOUND]:()=>new Mr.MethodNotFound(e.message),[Ft.REMOTE_INTERNAL_ERROR]:()=>new Mr.RemoteInternalError(e.message)}[e.code];return n()}_generateId(){const e="bjectSymhasOwnProp-0123456789ABCDEFGHIJKLMNQRTUVWXYZ_dfgiklquvxz";let n=10,r="";for(;0<n--;)r+=e[Math.random()*64|0];return r}};function Oc(t){const e=hf(t.callMethod.bind(t)),n=hf(t.notify.bind(t));return new Proxy(t,{get(r,i){if(i==="notify")return n;if(i==="callMethod")return e;if(i!=="then")return i==="setMethodPrefix"?(...s)=>t.setMethodPrefix(s):(...s)=>r.callMethod.call(r,i,s)}})}function hf(t){return new Proxy(t,{get(e,n){return(...r)=>e.call(null,n,r)},apply(e,n,r){return e.apply(null,r)}})}let kc=class extends Ps{constructor(...e){return super(...e),Oc(this)}},Cc=class{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",e)}sendData(e){this.channel.send(e)}},Is=class{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",async n=>{const r=await e(n);r&&this.channel.send(r)})}};var Tc=Object.freeze({__proto__:null,MoleServer:Ds,MoleClient:Ps,MoleClientProxified:kc,ClientTransport:Cc,ServerTransport:Is});let Rc=class extends Error{constructor(e,n){super(e),this.name=this.constructor.name,this.errorCode=n}errorCode(){return this.errorCode}};const{MoleClient:Nc,ClientTransport:Dc}=Tc;let $c=class{constructor(e,n,r){this.moleChannel=new yc(e),this.methodPrefix=n,this.connectorOrServersideChannel=e,this.client=new Nc({requestTimeout:r,transport:new Dc(this.moleChannel)})}jsonrpcMsgReceive(e){this.moleChannel.emit("json_rpc",e)}call(e,n){return this.connectorOrServersideChannel.closed()?new Promise((r,i)=>{i(new Rc(`Method call [${this.methodPrefix}::${e}] on closed channel or connector ignored. Please add a check for closed channel in your code.`,"CLOSED_CHANNEL"))}):this.client.callMethod(`${this.methodPrefix}::${e}`,n)}};const Pc=1e4;let Ic=class{constructor(e,n){this.connectorOrServersideChannel=e,this.remoteObjects={},this.requestTimeout=n||Pc}remoteObject(e){return this.remoteObjects[e]||(this.remoteObjects[e]=new $c(this.connectorOrServersideChannel,e,this.requestTimeout)),this.remoteObjects[e]}jsonrpcMsgReceive(e){for(const n of Object.values(this.remoteObjects))n.jsonrpcMsgReceive(e)}},Mc=class{constructor({serversideChannel:e,serverMethods:n,methodPrefix:r}){const i=[new Is(e)];this.server=new Ds({transports:i}),this.server.expose(n),this.server.setMethodPrefix(r),this.server.run()}};Yt.util=Yn;function Uc(){const t=Yt.box.keyPair(),e=_r(t.publicKey),n=_r(t.secretKey);return{privateKey:t.secretKey,publicKey:t.publicKey,privateKeyHex:n,publicKeyHex:e}}Yt.util=Yn;function jc(t){return t.publicKeyHex&&!t.publicKey&&(t.publicKey=Fr(t.publicKeyHex)),t.privateKeyHex&&!t.privateKey&&(t.privateKey=Fr(t.privateKeyHex)),t}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var Lc=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),zc=Object.prototype.hasOwnProperty;function Jr(t,e){return zc.call(t,e)}function Wr(t){if(Array.isArray(t)){for(var n=new Array(t.length),e=0;e<n.length;e++)n[e]=""+e;return n}if(Object.keys)return Object.keys(t);var n=[];for(var r in t)Jr(t,r)&&n.push(r);return n}function Pt(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function Zr(t){for(var e=0,n=t.length,r;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function En(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function Ms(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function Gr(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(Gr(t[e]))return!0}else if(typeof t=="object"){for(var r=Wr(t),i=r.length,e=0;e<i;e++)if(Gr(t[r[e]]))return!0}}return!1}function _f(t,e){var n=[t];for(var r in e){var i=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var Us=function(t){Lc(e,t);function e(n,r,i,s,l){var c=this.constructor,a=t.call(this,_f(n,{name:r,index:i,operation:s,tree:l}))||this;return a.name=r,a.index=i,a.operation=s,a.tree=l,Object.setPrototypeOf(a,c.prototype),a.message=_f(n,{name:r,index:i,operation:s,tree:l}),a}return e}(Error),dt=Us,Bc=Pt,Un={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=vr(n,this.path);r&&(r=Pt(r));var i=kn(n,{op:"remove",path:this.from}).removed;return kn(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=vr(n,this.from);return kn(n,{op:"add",path:this.path,value:Pt(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:tr(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},Kc={add:function(t,e,n){return Zr(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:Un.move,copy:Un.copy,test:Un.test,_get:Un._get};function vr(t,e){if(e=="")return t;var n={op:"_get",path:e};return kn(t,n),n.value}function kn(t,e,n,r,i,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):mr(e,0)),e.path===""){var l={newDocument:t};if(e.op==="add")return l.newDocument=e.value,l;if(e.op==="replace")return l.newDocument=e.value,l.removed=t,l;if(e.op==="move"||e.op==="copy")return l.newDocument=vr(t,e.from),e.op==="move"&&(l.removed=t),l;if(e.op==="test"){if(l.test=tr(t,e.value),l.test===!1)throw new dt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l.newDocument=t,l}else{if(e.op==="remove")return l.removed=t,l.newDocument=null,l;if(e.op==="_get")return e.value=t,l;if(n)throw new dt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return l}}else{r||(t=Pt(t));var c=e.path||"",a=c.split("/"),h=t,p=1,b=a.length,m=void 0,y=void 0,E=void 0;for(typeof n=="function"?E=n:E=mr;;){if(y=a[p],i&&y=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&m===void 0&&(h[y]===void 0?m=a.slice(0,p).join("/"):p==b-1&&(m=e.path),m!==void 0&&E(e,0,t,m)),p++,Array.isArray(h)){if(y==="-")y=h.length;else{if(n&&!Zr(y))throw new dt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);Zr(y)&&(y=~~y)}if(p>=b){if(n&&e.op==="add"&&y>h.length)throw new dt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var l=Kc[e.op].call(e,h,y,t);if(l.test===!1)throw new dt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}}else if(y&&y.indexOf("~")!=-1&&(y=Ms(y)),p>=b){var l=Un[e.op].call(e,h,y,t);if(l.test===!1)throw new dt("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}h=h[y]}}}function ci(t,e,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(e))throw new dt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=Pt(t));for(var s=new Array(e.length),l=0,c=e.length;l<c;l++)s[l]=kn(t,e[l],n,!0,i,l),t=s[l].newDocument;return s.newDocument=t,s}function qc(t,e,n){var r=kn(t,e);if(r.test===!1)throw new dt("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function mr(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new dt("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(Un[t.op]){if(typeof t.path!="string")throw new dt("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new dt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new dt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new dt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&Gr(t.value))throw new dt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var i=t.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new dt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new dt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var l={op:"_get",path:t.from,value:void 0},c=js([l],n);if(c&&c.name==="OPERATION_PATH_UNRESOLVABLE")throw new dt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new dt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function js(t,e,n){try{if(!Array.isArray(t))throw new dt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)ci(Pt(e),Pt(t),n||!0);else{n=n||mr;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof dt)return i;throw i}}function tr(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),i,s,l;if(n&&r){if(s=t.length,s!=e.length)return!1;for(i=s;i--!==0;)if(!tr(t[i],e[i]))return!1;return!0}if(n!=r)return!1;var c=Object.keys(t);if(s=c.length,s!==Object.keys(e).length)return!1;for(i=s;i--!==0;)if(!e.hasOwnProperty(c[i]))return!1;for(i=s;i--!==0;)if(l=c[i],!tr(t[l],e[l]))return!1;return!0}return t!==t&&e!==e}var Yc=Object.freeze({__proto__:null,JsonPatchError:dt,deepClone:Bc,getValueByPointer:vr,applyOperation:kn,applyPatch:ci,applyReducer:qc,validator:mr,validate:js,_areEquals:tr});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var ai=new WeakMap,Fc=function(){function t(e){this.observers=new Map,this.obj=e}return t}(),Hc=function(){function t(e,n){this.callback=e,this.observer=n}return t}();function Jc(t){return ai.get(t)}function Wc(t,e){return t.observers.get(e)}function Zc(t,e){t.observers.delete(e.callback)}function Gc(t,e){e.unobserve()}function Vc(t,e){var n=[],r,i=Jc(t);if(!i)i=new Fc(t),ai.set(t,i);else{var s=Wc(i,e);r=s&&s.observer}if(r)return r;if(r={},i.value=Pt(t),e){r.callback=e,r.next=null;var l=function(){Vr(r)},c=function(){clearTimeout(r.next),r.next=setTimeout(l)};typeof window<"u"&&(window.addEventListener("mouseup",c),window.addEventListener("keyup",c),window.addEventListener("mousedown",c),window.addEventListener("keydown",c),window.addEventListener("change",c))}return r.patches=n,r.object=t,r.unobserve=function(){Vr(r),clearTimeout(r.next),Zc(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",c),window.removeEventListener("keyup",c),window.removeEventListener("mousedown",c),window.removeEventListener("keydown",c),window.removeEventListener("change",c))},i.observers.set(e,new Hc(e,r)),r}function Vr(t,e){e===void 0&&(e=!1);var n=ai.get(t.object);ui(n.value,t.object,t.patches,"",e),t.patches.length&&ci(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function ui(t,e,n,r,i){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=Wr(e),l=Wr(t),c=!1,a=l.length-1;a>=0;a--){var h=l[a],p=t[h];if(Jr(e,h)&&!(e[h]===void 0&&p!==void 0&&Array.isArray(e)===!1)){var b=e[h];typeof p=="object"&&p!=null&&typeof b=="object"&&b!=null?ui(p,b,n,r+"/"+En(h),i):p!==b&&(i&&n.push({op:"test",path:r+"/"+En(h),value:Pt(p)}),n.push({op:"replace",path:r+"/"+En(h),value:Pt(b)}))}else Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+En(h),value:Pt(p)}),n.push({op:"remove",path:r+"/"+En(h)}),c=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!c&&s.length==l.length))for(var a=0;a<s.length;a++){var h=s[a];!Jr(t,h)&&e[h]!==void 0&&n.push({op:"add",path:r+"/"+En(h),value:Pt(e[h])})}}}function Qc(t,e,n){n===void 0&&(n=!1);var r=[];return ui(t,e,r,"",n),r}var Xc=Object.freeze({__proto__:null,unobserve:Gc,observe:Vc,generate:Vr,compare:Qc}),ea=Object.assign({},Yc,Xc,{JsonPatchError:Us,deepClone:Pt,escapePathComponent:En,unescapePathComponent:Ms});const{applyPatch:ta}=ea;let na=class extends br{constructor(e){super({}),this.connector=e,this.connector.on("receive_state",n=>{this.wireStateReceived=!0,this.set(n)}),this.connector.on("receive_diff",n=>{this.wireStateReceived&&(ta(this.state,n),this.announceStateChange())})}field(e){return this.connector.connectionState.get(e)}},ra=class extends br{constructor(e){super({}),this.fields={},this.connector=e,this.connector.on("receive_state_field",({name:n,state:r})=>{this.get(n).set(r)})}get(e){return this.fields[e]||(this.fields[e]=new br),this.fields[e]}};Yt.util=Yn;const ia=700,fa=6e4,sa=1;let oa=class extends oi{constructor({endpoint:e,protocol:n,keypair:r=Uc(),rpcRequestTimeout:i,verbose:s=!1,tag:l,log:c=console.log,autoDecommission:a=!1,dummy:h}={}){super(),this.protocol=n,this.log=c;const{privateKey:p,publicKey:b}=jc(r);this.clientPrivateKey=p,this.clientPublicKey=b,this.clientPublicKeyHex=_r(b),this.rpcClient=new Ic(this,i),this.endpoint=e,this.verbose=s,this.tag=l,this.autoDecommission=a,this.sentCount=0,this.receivedCount=0,this.successfulConnectsCount=0,h||(this.state=new na(this),this.connectionState=new ra(this)),this.connected=new br,this.delayedAdjustConnectionStatus(),s&&Fe.green(this.log,`Connector ${this.endpoint} created`),this.decommissionCheckCounter=0,this.lastPongReceivedAt=Date.now(),this.on("pong",()=>{this.lastPongReceivedAt=Date.now()})}delayedAdjustConnectionStatus(){setTimeout(()=>{this.connected.get()==null&&this.connected.set(!1)},ia)}send(e){_c({data:e,connector:this}),this.sentCount+=1}signal(e,n){this.connected.get()?this.send({signal:e,data:n}):Fe.write(this.log,"Warning: trying to send signal over disconnected connector, this should be prevented by GUI")}userAction({action:e,scope:n,payload:r}){this.signal("__action",{action:e,scope:n,payload:r})}on(e,n){e=="ready"&&this.isReady()&&n(),super.on(e,n)}getSharedSecret(){return this.sharedSecret?_r(this.sharedSecret):void 0}wireReceive({jsonData:e,encryptedData:n,rawMessage:r}){Ns({jsonData:e,encryptedData:n,rawMessage:r,connector:this}),this.receivedCount+=1}field(e){return this.connectionState.get(e)}isReady(){return this.ready}closed(){return!this.transportConnected}connectStatus(e){if(e){this.sentCount=0,this.receivedCount=0,this.transportConnected=!0,this.successfulConnectsCount+=1,this.verbose&&Fe.white(this.log,`✓ Connector ${this.endpoint} connected (${this.successfulConnectsCount} total reconnects)`);const n=this.connection.websocket.__id;vc({connector:this,afterFirstStep:({sharedSecret:i,remotePubkeyHex:s})=>{this.sharedSecret=i,this._remotePubkeyHex=s}}).then(()=>{this.connectedAt=Date.now(),this.connected.set(!0),this.ready=!0,this.emit("ready")}).catch(i=>{this.connection.websocket.__id==n&&this.connection.websocket.readyState==sa&&i.code==Ft.TIMEOUT&&(Fe.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] handshake error: "${i.message}"`),Fe.write(this.log,`${this.endpoint} Connector dropping stale websocket after handshake error`),this.connection.terminate()),i.code!=Ft.TIMEOUT&&Fe.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] on:ready error: "${i.stack}" — (will not try to reconnect, fix the error and reload this gui)`)})}else{let n;this.transportConnected&&(n=!0),this.transportConnected==null&&Fe.write(this.log,`${this.endpoint} Connector was not able to connect at first try`),this.transportConnected=!1,this.ready=!1,this.sharedSecret=void 0,delete this.connectedAt,n&&(this.emit("disconnect"),e==null&&this.delayedAdjustConnectionStatus(),this.connected.set(e))}}checkForDecommission(){this.autoDecommission&&(this.decommissionCheckRequestedAt&&Date.now()-this.decommissionCheckRequestedAt>3e3&&(this.decommissionCheckCounter=0),this.decommissionCheckRequestedAt=Date.now(),this.decommissionCheckCounter+=1,this.decommissionCheckCounter>12&&Date.now()-this.lastPongReceivedAt>fa&&(Fe.write(this.log,`Decommissioning connector ${this.endpoint} (long inactive)`),this.decommission(),this.emit("decommission")))}decommission(){this.decommissioned=!0}remoteObject(e){return{call:(n,r=[])=>this.rpcClient.remoteObject(e).call(n,rc(r))}}attachObject(e,n){new Mc({serversideChannel:this,serverMethods:n,methodPrefix:e})}clientPubkey(){return this.clientPublicKeyHex}remotePubkeyHex(){return this._remotePubkeyHex}remoteAddress(){return this.endpoint}};const pf=typeof window<"u";function la({endpoint:t,host:e,port:n}){if(pf&&t&&t.startsWith("/")&&(t=`${window.location.protocol.includes("s")?"wss":"ws"}://${window.location.host}${t}`),!t)if(pf){e=e||window.location.hostname;const r=window.location.protocol.includes("s")?"wss":"ws";t=`${r}://${e}`,r=="wss"?t=`${r}://${e}/ws`:n?t=`${t}:${n}`:window.location.port&&(t=`${t}:${window.location.port}`)}else{if(!n)throw new Error(`Connectome determineEndpoint: No websocket port provided for ${e}`);t=`ws://${e||"localhost"}:${n}`}return t}const hn=typeof window<"u",ca=0,Ls=1,aa=1e3,ua=3,da=5;function sr(t,e,n){hn?n.addEventListener(t,e):n.on(t,e)}function Vn(t,e,n){hn?n.removeEventListener(t,e):n.off(t,e)}function ha({endpoint:t,host:e,port:n,protocol:r,keypair:i,remotePubkey:s,rpcRequestTimeout:l,autoDecommission:c,log:a,verbose:h,tag:p,dummy:b},{WebSocket:m}){t=la({endpoint:t,host:e,port:n});const y=new oa({endpoint:t,protocol:r,rpcRequestTimeout:l,keypair:i,verbose:h,tag:p,log:a,autoDecommission:c,dummy:b}),E=()=>{pa({connector:y,endpoint:t},{WebSocket:m,reconnect:E,log:a,verbose:h})};y.connection={terminate(){this.websocket._removeAllCallbacks(),this.websocket.__closed=!0,this.websocket.close(),y.connectStatus(!1),E()},isOpen(){return this.websocket.readyState==Ls&&!this.websocket.__closed},endpoint:t,checkTicker:0};const x=()=>{y.decommissioned||(_a({connector:y,reconnect:E,log:a}),setTimeout(x,aa))};return setTimeout(x,10),y}function _a({connector:t,reconnect:e,log:n}){const r=t.connection;if(va(r)||t.decommissioned){t.decommissioned?(Fe.yellow(n,`${t.endpoint} Connection decommisioned, closing websocket #${r.websocket.__id}, will not retry again `),zs(t)):(t.emit("inactive_connection"),Fe.yellow(n,`${t.endpoint} ✖ Terminated inactive connection #${r.websocket.__id}`)),r.terminate();return}Bs(r)?r.websocket.send("ping"):(t.connected==null&&(Fe.write(n,`${t.endpoint} Setting connector status to FALSE because connector.connected is undefined`),t.connectStatus(!1)),e()),r.checkTicker+=1}function pa({connector:t,endpoint:e},{WebSocket:n,reconnect:r,log:i,verbose:s}){const l=t.connection;if(t.checkForDecommission(),t.decommissioned){zs(t);return}const c=Math.round(10**5*Math.random()).toString();if(l.currentlyTryingWS&&l.currentlyTryingWS.readyState==ca){if(l.currentlyTryingWS._waitForConnectCounter<da){l.currentlyTryingWS._waitForConnectCounter+=1;return}(s||hn)&&Fe.write(i,`${e} Reconnect timeout, creating new ws`),l.currentlyTryingWS._removeAllCallbacks(),l.currentlyTryingWS.__closed=!0,l.currentlyTryingWS.close()}else(s||hn)&&Fe.write(i,`${e} Created new websocket #${c}`);const a=new n(e);a.__id=c,l.currentlyTryingWS=a,l.currentlyTryingWS._waitForConnectCounter=0,hn&&(a.binaryType="arraybuffer"),hn||a.on("error",()=>{});const h=()=>{t.decommissioned||((s||hn)&&Fe.write(i,`${e} Websocket #${c} open`),l.currentlyTryingWS=null,l.checkTicker=0,ba({ws:a,connector:t,openCallback:h,reconnect:r},{log:i,verbose:s}),l.websocket=a,t.connectStatus(!0))};a._removeAllCallbacks=()=>{Vn("open",h,a)},sr("open",h,a)}function ba({ws:t,connector:e,openCallback:n,reconnect:r},{log:i,verbose:s}){const l=e.connection,c=p=>{const b=`${e.endpoint} Websocket error`;console.log(b),console.log(p)},a=()=>{if(t.__closed=!0,Fe.blue(i,`${e.endpoint} ✖ Connection #${t.__id} [ ${e.protocol} ] closed`),e.decommissioned){e.connectStatus(!1);return}e.connectStatus(void 0),r()},h=p=>{if(e.decommissioned)return;l.checkTicker=0;const b=hn?p.data:p;if(t.__closed)return;if(b=="pong"){e.emit("pong");return}let m;try{m=JSON.parse(b)}catch{}if(m)e.wireReceive({jsonData:m,rawMessage:b});else{const y=hn?new Uint8Array(b):b;e.wireReceive({encryptedData:y})}};t._removeAllCallbacks=()=>{Vn("error",c,t),Vn("close",a,t),Vn("message",h,t),Vn("open",n,t)},sr("error",c,t),sr("close",a,t),sr("message",h,t)}function zs(t){const e=t.connection;e.currentlyTryingWS&&(e.currentlyTryingWS._removeAllCallbacks(),e.currentlyTryingWS.__closed=!0,e.currentlyTryingWS.close(),e.currentlyTryingWS=null),e.websocket&&(e.websocket._removeAllCallbacks(),e.websocket.__closed=!0,e.websocket.close(),e.websocket=null),t.connectStatus(!1)}function Bs(t){return t.websocket&&t.websocket.readyState==Ls&&!t.websocket.__closed}function va(t){return Bs(t)&&t.checkTicker>ua}function di(t){return t.log=t.log||console.log,ha(t,{WebSocket})}function bf(t,e,n){const r=t.slice();return r[62]=e[n],r}function ma(t){let e,n=(t[0].network||"")+"",r;return{c(){e=M("h3"),r=K(n),U(e,"class","svelte-zpx74i")},m(i,s){T(i,e,s),k(e,r)},p(i,s){s[0]&1&&n!==(n=(i[0].network||"")+"")&&De(r,n)},i:pe,o:pe,d(i){i&&C(e)}}}function ya(t){let e,n,r,i,s;function l(h,p){return h[10]==0?wa:ga}let c=l(t),a=c(t);return{c(){e=M("h3"),n=K(`Vhod
      `),r=M("span"),i=K(`— odpiranje
        `),a.c(),U(r,"class","svelte-zpx74i"),U(e,"class","countdown svelte-zpx74i")},m(h,p){T(h,e,p),k(e,n),k(e,r),k(r,i),a.m(r,null)},p(h,p){c===(c=l(h))&&a?a.p(h,p):(a.d(1),a=c(h),a&&(a.c(),a.m(r,null)))},i(h){s||Tt(()=>{s=pn(r,vs,{}),s.start()})},o:pe,d(h){h&&C(e),a.d()}}}function ga(t){let e,n,r;return{c(){e=K("čez "),n=K(t[10]),r=K("s")},m(i,s){T(i,e,s),T(i,n,s),T(i,r,s)},p(i,s){s[0]&1024&&De(n,i[10])},d(i){i&&C(e),i&&C(n),i&&C(r)}}}function wa(t){let e;return{c(){e=K("ZDAJ")},m(n,r){T(n,e,r)},p:pe,d(n){n&&C(e)}}}function vf(t){let e,n,r,i,s,l,c,a,h,p,b,m,y,E;return{c(){e=M("div"),n=M("button"),r=K("Zakasnitev +10s"),s=H(),l=M("button"),c=K("ODPRI ZDAJ"),h=H(),p=M("button"),b=K("Prekliči"),U(n,"class","delayed_open svelte-zpx74i"),n.disabled=i=!t[11]||t[10]==0,U(l,"class","open svelte-zpx74i"),l.disabled=a=!t[11]||t[10]==0,U(p,"class","cancel svelte-zpx74i"),p.disabled=m=!t[11]||t[10]==0,U(e,"class","entry_door_options svelte-zpx74i")},m(x,$){T(x,e,$),k(e,n),k(n,r),k(e,s),k(e,l),k(l,c),k(e,h),k(e,p),k(p,b),y||(E=[Ae(n,"click",t[32]),Ae(l,"click",t[33]),Ae(p,"click",t[34])],y=!0)},p(x,$){$[0]&3072&&i!==(i=!x[11]||x[10]==0)&&(n.disabled=i),$[0]&3072&&a!==(a=!x[11]||x[10]==0)&&(l.disabled=a),$[0]&3072&&m!==(m=!x[11]||x[10]==0)&&(p.disabled=m)},d(x){x&&C(e),y=!1,yt(E)}}}function xa(t){var Lt;let e,n,r,i,s,l,c,a,h,p,b,m,y,E,x,$=t[5]&&((Lt=t[1])==null?void 0:Lt.find(t[29])),A,B,ee,L,j,q,xe,be,me,Ie,ct,Qe,ut,$e,pt,We,gt,at,Ee,Ye,Mt,Rt,Je,tt,we,Xe,Nt,Wt,bt,Ct,Ut,Ot,tn;function bn(re,Re){return re[3]?Ea:Sa}let nn=bn(t),Et=nn(t);function rn(re,Re){return re[4]?Oa:ka}let jt=rn(t),nt=jt(t),it=$&&yf(t),ft=t[11]&&t[7]!=null&&Ef(t);return{c(){e=M("h3"),e.textContent="Ograja — parkirišče",n=H(),r=M("div"),i=M("button"),s=K("ODPRI"),c=H(),a=M("button"),h=K("OSEBNI PREHOD"),b=H(),Et.c(),m=H(),y=M("h3"),y.textContent="Dnevna TV",E=H(),nt.c(),x=H(),it&&it.c(),A=H(),B=M("h3"),B.textContent="Luč kabinet",ee=H(),L=M("button"),j=K("PRIŽGI LUČ"),xe=H(),be=M("button"),me=K("🛑 UGASNI"),ct=H(),Qe=M("button"),ut=K("⏱️"),pt=H(),ft&&ft.c(),We=H(),gt=M("h3"),gt.textContent="Alarm",at=H(),Ee=M("button"),Ye=K("VKLOPI"),Rt=H(),Je=M("button"),tt=K("IZKLOPI"),Xe=H(),Nt=M("h3"),Nt.textContent="Dodatne možnosti",Wt=H(),bt=M("button"),Ct=K("— ZAPRI VSE —"),U(e,"class","svelte-zpx74i"),i.disabled=l=!t[11]||t[9]||t[8],U(i,"class","svelte-zpx74i"),U(a,"class","personal_entry svelte-zpx74i"),a.disabled=p=!t[11]||t[9],le(a,"personal_entry_in_progress",t[8]),U(r,"class","parking_door_options svelte-zpx74i"),U(y,"class","svelte-zpx74i"),U(B,"class","svelte-zpx74i"),L.disabled=q=!t[11],U(L,"class","svelte-zpx74i"),U(be,"class","turn_off svelte-zpx74i"),be.disabled=Ie=!t[11],Qe.disabled=$e=!t[11],U(Qe,"class","svelte-zpx74i"),U(gt,"class","svelte-zpx74i"),Ee.disabled=Mt=!t[11],U(Ee,"class","svelte-zpx74i"),Je.disabled=we=!t[11],U(Je,"class","svelte-zpx74i"),U(Nt,"class","close_options svelte-zpx74i"),U(bt,"class","close_options svelte-zpx74i"),bt.disabled=Ut=!t[11]},m(re,Re){T(re,e,Re),T(re,n,Re),T(re,r,Re),k(r,i),k(i,s),k(r,c),k(r,a),k(a,h),k(r,b),Et.m(r,null),T(re,m,Re),T(re,y,Re),T(re,E,Re),nt.m(re,Re),T(re,x,Re),it&&it.m(re,Re),T(re,A,Re),T(re,B,Re),T(re,ee,Re),T(re,L,Re),k(L,j),T(re,xe,Re),T(re,be,Re),k(be,me),T(re,ct,Re),T(re,Qe,Re),k(Qe,ut),T(re,pt,Re),ft&&ft.m(re,Re),T(re,We,Re),T(re,gt,Re),T(re,at,Re),T(re,Ee,Re),k(Ee,Ye),T(re,Rt,Re),T(re,Je,Re),k(Je,tt),T(re,Xe,Re),T(re,Nt,Re),T(re,Wt,Re),T(re,bt,Re),k(bt,Ct),Ot||(tn=[Ae(i,"click",t[36]),Ae(a,"click",t[37]),Ae(L,"click",t[55]),Ae(be,"click",t[56]),Ae(Qe,"click",t[57]),Ae(Ee,"click",t[58]),Ae(Je,"click",t[59]),Ae(bt,"click",t[60])],Ot=!0)},p(re,Re){var zt;Re[0]&2816&&l!==(l=!re[11]||re[9]||re[8])&&(i.disabled=l),Re[0]&2560&&p!==(p=!re[11]||re[9])&&(a.disabled=p),Re[0]&256&&le(a,"personal_entry_in_progress",re[8]),nn===(nn=bn(re))&&Et?Et.p(re,Re):(Et.d(1),Et=nn(re),Et&&(Et.c(),Et.m(r,null))),jt===(jt=rn(re))&&nt?nt.p(re,Re):(nt.d(1),nt=jt(re),nt&&(nt.c(),nt.m(x.parentNode,x))),Re[0]&34&&($=re[5]&&((zt=re[1])==null?void 0:zt.find(re[29]))),$?it?it.p(re,Re):(it=yf(re),it.c(),it.m(A.parentNode,A)):it&&(it.d(1),it=null),Re[0]&2048&&q!==(q=!re[11])&&(L.disabled=q),Re[0]&2048&&Ie!==(Ie=!re[11])&&(be.disabled=Ie),Re[0]&2048&&$e!==($e=!re[11])&&(Qe.disabled=$e),re[11]&&re[7]!=null?ft?(ft.p(re,Re),Re[0]&2176&&te(ft,1)):(ft=Ef(re),ft.c(),te(ft,1),ft.m(We.parentNode,We)):ft&&(ft.d(1),ft=null),Re[0]&2048&&Mt!==(Mt=!re[11])&&(Ee.disabled=Mt),Re[0]&2048&&we!==(we=!re[11])&&(Je.disabled=we),Re[0]&2048&&Ut!==(Ut=!re[11])&&(bt.disabled=Ut)},i(re){te(ft)},o:pe,d(re){re&&C(e),re&&C(n),re&&C(r),Et.d(),re&&C(m),re&&C(y),re&&C(E),nt.d(re),re&&C(x),it&&it.d(re),re&&C(A),re&&C(B),re&&C(ee),re&&C(L),re&&C(xe),re&&C(be),re&&C(ct),re&&C(Qe),re&&C(pt),ft&&ft.d(re),re&&C(We),re&&C(gt),re&&C(at),re&&C(Ee),re&&C(Rt),re&&C(Je),re&&C(Xe),re&&C(Nt),re&&C(Wt),re&&C(bt),Ot=!1,yt(tn)}}}function Aa(t){let e,n,r,i,s=t[12]&&Sf(t);return{c(){s&&s.c(),e=H(),n=M("button"),n.textContent="Več možnosti",U(n,"class","show_more_options svelte-zpx74i")},m(l,c){s&&s.m(l,c),T(l,e,c),T(l,n,c),r||(i=Ae(n,"click",t[35]),r=!0)},p(l,c){l[12]?s?s.p(l,c):(s=Sf(l),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null)},i:pe,o:pe,d(l){s&&s.d(l),l&&C(e),l&&C(n),r=!1,i()}}}function Ea(t){let e,n,r,i,s,l,c,a,h,p,b,m,y,E=t[9]&&mf();return{c(){e=M("h4"),e.textContent="— Odpri in ohrani —",n=H(),r=M("button"),i=K("ODPRI IN OHRANI"),l=H(),c=M("button"),a=K("ZAPRI OGRAJO"),p=H(),E&&E.c(),b=_t(),U(e,"class","suboption svelte-zpx74i"),U(r,"class","fence_keep_open svelte-zpx74i"),r.disabled=s=!t[11]||t[8],le(r,"keep_open_in_progress",t[9]),U(c,"class","close_fence svelte-zpx74i"),c.disabled=h=!t[11]||t[9]||t[8]},m(x,$){T(x,e,$),T(x,n,$),T(x,r,$),k(r,i),T(x,l,$),T(x,c,$),k(c,a),T(x,p,$),E&&E.m(x,$),T(x,b,$),m||(y=[Ae(r,"click",t[39]),Ae(c,"click",t[40])],m=!0)},p(x,$){$[0]&2304&&s!==(s=!x[11]||x[8])&&(r.disabled=s),$[0]&512&&le(r,"keep_open_in_progress",x[9]),$[0]&2816&&h!==(h=!x[11]||x[9]||x[8])&&(c.disabled=h),x[9]?E||(E=mf(),E.c(),E.m(b.parentNode,b)):E&&(E.d(1),E=null)},d(x){x&&C(e),x&&C(n),x&&C(r),x&&C(l),x&&C(c),x&&C(p),E&&E.d(x),x&&C(b),m=!1,yt(y)}}}function Sa(t){let e,n,r;return{c(){e=M("button"),e.textContent="Več",U(e,"class","show_more_options svelte-zpx74i")},m(i,s){T(i,e,s),n||(r=Ae(e,"click",t[38]),n=!0)},p:pe,d(i){i&&C(e),n=!1,r()}}}function mf(t){let e;return{c(){e=M("h4"),e.textContent="[ ⚠️ v zadnji sekundi odpiranja ne sme biti prehoda, sicer vrata ne bodo ostala odprta ]",U(e,"class","suboption warn svelte-zpx74i")},m(n,r){T(n,e,r)},d(n){n&&C(e)}}}function Oa(t){let e,n,r,i,s,l,c,a,h,p,b,m,y,E,x=(t[13]||"")+"",$,A,B,ee,L,j,q,xe,be,me,Ie,ct,Qe,ut,$e,pt,We,gt,at;return{c(){e=M("button"),n=K("TV"),i=H(),s=M("button"),l=K("DMT"),a=H(),h=M("button"),p=K("🛑 UGASNI"),m=H(),y=M("h4"),y.textContent="— TV glasnost —",E=H(),$=K(x),A=H(),B=M("button"),ee=K("VOL↑"),j=H(),q=M("button"),xe=K("VOL ↓"),me=H(),Ie=M("button"),ct=K("PRIVZETO"),ut=H(),$e=M("button"),pt=K("🔇"),e.disabled=r=!t[11],U(e,"class","svelte-zpx74i"),s.disabled=c=!t[11],U(s,"class","svelte-zpx74i"),U(h,"class","turn_off svelte-zpx74i"),h.disabled=b=!t[11],U(y,"class","suboption volume svelte-zpx74i"),U(B,"class","volume svelte-zpx74i"),B.disabled=L=!t[11],U(q,"class","volume svelte-zpx74i"),q.disabled=be=!t[11],U(Ie,"class","volume svelte-zpx74i"),Ie.disabled=Qe=!t[11],U($e,"class","volume svelte-zpx74i"),$e.disabled=We=!t[11]},m(Ee,Ye){T(Ee,e,Ye),k(e,n),T(Ee,i,Ye),T(Ee,s,Ye),k(s,l),T(Ee,a,Ye),T(Ee,h,Ye),k(h,p),T(Ee,m,Ye),T(Ee,y,Ye),T(Ee,E,Ye),T(Ee,$,Ye),T(Ee,A,Ye),T(Ee,B,Ye),k(B,ee),T(Ee,j,Ye),T(Ee,q,Ye),k(q,xe),T(Ee,me,Ye),T(Ee,Ie,Ye),k(Ie,ct),T(Ee,ut,Ye),T(Ee,$e,Ye),k($e,pt),gt||(at=[Ae(e,"click",t[42]),Ae(s,"click",t[43]),Ae(h,"click",t[44]),Ae(B,"click",t[45]),Ae(q,"click",t[46]),Ae(Ie,"click",t[47]),Ae($e,"click",t[48])],gt=!0)},p(Ee,Ye){Ye[0]&2048&&r!==(r=!Ee[11])&&(e.disabled=r),Ye[0]&2048&&c!==(c=!Ee[11])&&(s.disabled=c),Ye[0]&2048&&b!==(b=!Ee[11])&&(h.disabled=b),Ye[0]&8192&&x!==(x=(Ee[13]||"")+"")&&De($,x),Ye[0]&2048&&L!==(L=!Ee[11])&&(B.disabled=L),Ye[0]&2048&&be!==(be=!Ee[11])&&(q.disabled=be),Ye[0]&2048&&Qe!==(Qe=!Ee[11])&&(Ie.disabled=Qe),Ye[0]&2048&&We!==(We=!Ee[11])&&($e.disabled=We)},d(Ee){Ee&&C(e),Ee&&C(i),Ee&&C(s),Ee&&C(a),Ee&&C(h),Ee&&C(m),Ee&&C(y),Ee&&C(E),Ee&&C($),Ee&&C(A),Ee&&C(B),Ee&&C(j),Ee&&C(q),Ee&&C(me),Ee&&C(Ie),Ee&&C(ut),Ee&&C($e),gt=!1,yt(at)}}}function ka(t){let e,n,r;return{c(){e=M("button"),e.textContent="Možnosti TV",U(e,"class","show_more_options svelte-zpx74i")},m(i,s){T(i,e,s),n||(r=Ae(e,"click",t[41]),n=!0)},p:pe,d(i){i&&C(e),n=!1,r()}}}function yf(t){let e,n,r,i=t[16],s=[];for(let l=0;l<i.length;l+=1)s[l]=Af(bf(t,i,l));return{c(){e=M("h3"),e.textContent="Spanje",n=H();for(let l=0;l<s.length;l+=1)s[l].c();r=_t(),U(e,"class","svelte-zpx74i")},m(l,c){T(l,e,c),T(l,n,c);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(l,c);T(l,r,c)},p(l,c){if(c[0]&117508130){i=l[16];let a;for(a=0;a<i.length;a+=1){const h=bf(l,i,a);s[a]?s[a].p(h,c):(s[a]=Af(h),s[a].c(),s[a].m(r.parentNode,r))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}},d(l){l&&C(e),l&&C(n),gn(s,l),l&&C(r)}}}function gf(t){var p,b;let e,n,r,i;function s(m,y){var E;return(E=m[5][m[62]])!=null&&E.counter?Ta:Ca}let l=s(t),c=l(t),a=((p=t[5][t[62]])==null?void 0:p.counter)&&wf(t),h=t[11]&&((b=t[5][t[62]])==null?void 0:b.counter)!=null&&xf(t);return{c(){e=M("div"),c.c(),n=H(),a&&a.c(),r=H(),h&&h.c(),i=H(),U(e,"class","sleep_device")},m(m,y){T(m,e,y),c.m(e,null),k(e,n),a&&a.m(e,null),k(e,r),h&&h.m(e,null),k(e,i)},p(m,y){var E,x;l===(l=s(m))&&c?c.p(m,y):(c.d(1),c=l(m),c&&(c.c(),c.m(e,n))),(E=m[5][m[62]])!=null&&E.counter?a?a.p(m,y):(a=wf(m),a.c(),a.m(e,r)):a&&(a.d(1),a=null),m[11]&&((x=m[5][m[62]])==null?void 0:x.counter)!=null?h?h.p(m,y):(h=xf(m),h.c(),h.m(e,i)):h&&(h.d(1),h=null)},d(m){m&&C(e),c.d(),a&&a.d(),h&&h.d()}}}function Ca(t){var m,y;let e,n=(y=(m=t[1])==null?void 0:m.find(p))!=null&&y.playing?"🔊":"🌚",r,i,s=t[62].replace("-room","")+"",l,c,a,h;function p(...E){return t[49](t[62],...E)}function b(){return t[50](t[62])}return{c(){e=M("button"),r=K(n),i=H(),l=K(s),e.disabled=c=!t[11],U(e,"class","svelte-zpx74i")},m(E,x){T(E,e,x),k(e,r),k(e,i),k(e,l),a||(h=Ae(e,"click",b),a=!0)},p(E,x){var $,A;t=E,x[0]&2&&n!==(n=(A=($=t[1])==null?void 0:$.find(p))!=null&&A.playing?"🔊":"🌚")&&De(r,n),x[0]&2048&&c!==(c=!t[11])&&(e.disabled=c)},d(E){E&&C(e),a=!1,h()}}}function Ta(t){let e,n=t[62].replace("-room","")+"",r;return{c(){e=M("h3"),r=K(n),U(e,"class","sleep_device svelte-zpx74i")},m(i,s){T(i,e,s),k(e,r)},p:pe,d(i){i&&C(e)}}}function wf(t){var L,j;let e,n=(j=(L=t[1])==null?void 0:L.find($))!=null&&j.playing?"🔊":"🌚",r,i,s,l,c,a,h,p,b,m,y,E,x;function $(...q){return t[51](t[62],...q)}function A(){return t[52](t[62])}function B(){return t[53](t[62])}function ee(){return t[54](t[62])}return{c(){e=M("button"),r=K(n),i=K(" ZDAJ"),l=H(),c=M("button"),a=K("⏱ ZAKASNITEV"),p=H(),b=M("button"),m=K("Prekliči"),U(e,"class","turn_off svelte-zpx74i"),e.disabled=s=!t[11],U(c,"class","add_time svelte-zpx74i"),c.disabled=h=!t[11],U(b,"class","cancel svelte-zpx74i"),b.disabled=y=!t[11]},m(q,xe){T(q,e,xe),k(e,r),k(e,i),T(q,l,xe),T(q,c,xe),k(c,a),T(q,p,xe),T(q,b,xe),k(b,m),E||(x=[Ae(e,"click",A),Ae(c,"click",B),Ae(b,"click",ee)],E=!0)},p(q,xe){var be,me;t=q,xe[0]&2&&n!==(n=(me=(be=t[1])==null?void 0:be.find($))!=null&&me.playing?"🔊":"🌚")&&De(r,n),xe[0]&2048&&s!==(s=!t[11])&&(e.disabled=s),xe[0]&2048&&h!==(h=!t[11])&&(c.disabled=h),xe[0]&2048&&y!==(y=!t[11])&&(b.disabled=y)},d(q){q&&C(e),q&&C(l),q&&C(c),q&&C(p),q&&C(b),E=!1,yt(x)}}}function xf(t){let e,n,r=t[62].replace("-room","")+"",i,s;function l(h,p){return h[5][h[62]].counter==0?Na:Ra}let c=l(t),a=c(t);return{c(){e=M("h3"),n=M("span"),i=K(r),s=K(` glasba
                `),a.c(),U(n,"class","svelte-zpx74i"),U(e,"class","countdown_turn_off svelte-zpx74i"),le(e,"warn",t[5][t[62]].counter<=5)},m(h,p){T(h,e,p),k(e,n),k(n,i),k(e,s),a.m(e,null)},p(h,p){c===(c=l(h))&&a?a.p(h,p):(a.d(1),a=c(h),a&&(a.c(),a.m(e,null))),p[0]&65568&&le(e,"warn",h[5][h[62]].counter<=5)},d(h){h&&C(e),a.d()}}}function Ra(t){let e,n=t[5][t[62]].delayStr+"",r;return{c(){e=K("čez "),r=K(n)},m(i,s){T(i,e,s),T(i,r,s)},p(i,s){s[0]&32&&n!==(n=i[5][i[62]].delayStr+"")&&De(r,n)},d(i){i&&C(e),i&&C(r)}}}function Na(t){let e;return{c(){e=K("ZDAJ")},m(n,r){T(n,e,r)},p:pe,d(n){n&&C(e)}}}function Af(t){var s;let e=(s=t[1])==null?void 0:s.find(r),n;function r(...l){return t[30](t[62],...l)}let i=e&&gf(t);return{c(){i&&i.c(),n=_t()},m(l,c){i&&i.m(l,c),T(l,n,c)},p(l,c){var a;t=l,c[0]&2&&(e=(a=t[1])==null?void 0:a.find(r)),e?i?i.p(t,c):(i=gf(t),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(l){i&&i.d(l),l&&C(n)}}}function Ef(t){let e,n,r,i;function s(a,h){return a[7]==0?$a:Da}let l=s(t),c=l(t);return{c(){e=M("h3"),n=K(`Ugašanje
        `),r=M("span"),c.c(),U(r,"class","svelte-zpx74i"),U(e,"class","countdown svelte-zpx74i")},m(a,h){T(a,e,h),k(e,n),k(e,r),c.m(r,null)},p(a,h){l===(l=s(a))&&c?c.p(a,h):(c.d(1),c=l(a),c&&(c.c(),c.m(r,null)))},i(a){i||Tt(()=>{i=pn(r,vs,{}),i.start()})},o:pe,d(a){a&&C(e),c.d()}}}function Da(t){let e,n;return{c(){e=K("čez "),n=K(t[6])},m(r,i){T(r,e,i),T(r,n,i)},p(r,i){i[0]&64&&De(n,r[6])},d(r){r&&C(e),r&&C(n)}}}function $a(t){let e;return{c(){e=K("ZDAJ")},m(n,r){T(n,e,r)},p:pe,d(n){n&&C(e)}}}function Sf(t){let e,n,r=(t[0].network||"")+"",i;return{c(){e=M("h3"),n=K("Več možnosti - "),i=K(r),U(e,"class","svelte-zpx74i")},m(s,l){T(s,e,l),k(e,n),k(e,i)},p(s,l){l[0]&1&&r!==(r=(s[0].network||"")+"")&&De(i,r)},d(s){s&&C(e)}}}function Pa(t){let e,n,r,i,s,l,c,a,h;function p(A,B){return A[11]&&A[12]?ya:ma}let b=p(t),m=b(t),y=t[12]&&vf(t);function E(A,B){return A[2]?xa:Aa}let x=E(t),$=x(t);return{c(){e=M("div"),m.c(),n=H(),r=M("button"),i=K("ODPIRANJE VHODNIH VRAT"),l=H(),y&&y.c(),c=H(),$.c(),U(r,"class","open_door_show_options svelte-zpx74i"),r.disabled=s=!t[11],le(r,"invisible",t[12]),U(e,"class","options svelte-zpx74i")},m(A,B){T(A,e,B),m.m(e,null),k(e,n),k(e,r),k(r,i),k(e,l),y&&y.m(e,null),k(e,c),$.m(e,null),a||(h=Ae(r,"click",t[31]),a=!0)},p(A,B){b===(b=p(A))&&m?m.p(A,B):(m.d(1),m=b(A),m&&(m.c(),te(m,1),m.m(e,n))),B[0]&2048&&s!==(s=!A[11])&&(r.disabled=s),B[0]&4096&&le(r,"invisible",A[12]),A[12]?y?y.p(A,B):(y=vf(A),y.c(),y.m(e,c)):y&&(y.d(1),y=null),x===(x=E(A))&&$?$.p(A,B):($.d(1),$=x(A),$&&($.c(),te($,1),$.m(e,null)))},i(A){te(m),te($)},o:pe,d(A){A&&C(e),m.d(),y&&y.d(),$.d(),a=!1,h()}}}const Ia="192.168.0.20",Ma=7780,Ua="david/home";function ja(t,e,n){let r,i,s,l,c,a,h,p,b,m,{localDevice:y}=e,{nearbyDevices:E}=e;const x=di({host:Ia,port:Ma,protocol:Ua}),{connected:$,state:A}=x;mt(t,$,Pe=>n(11,p=Pe)),mt(t,A,Pe=>n(28,h=Pe));const B=["david-room","ela-room"],ee=x.field("tvVolume");mt(t,ee,Pe=>n(13,m=Pe));const L=Po(A,Pe=>{var et;return((et=Pe.entryDoor)==null?void 0:et.counter)!=null});mt(t,L,Pe=>n(12,b=Pe));function j(Pe,et){x.userAction({action:Pe,payload:et,scope:"tv"})}function q(Pe,et){x.userAction({action:Pe,payload:et,scope:"alarm"})}function xe(Pe,et){x.userAction({action:Pe,payload:et,scope:"entry-door"})}function be(Pe,et){x.userAction({action:Pe,payload:et,scope:"fence-door"})}function me(Pe,et){x.userAction({action:Pe,payload:et,scope:"light-lab"})}function Ie(Pe,et){x.userAction({action:Pe,scope:"nearbyDevices",payload:{deviceName:et}})}function ct(Pe,et){x.userAction({action:Pe,scope:"nearbyDevices",payload:{deviceName:et,delay:!0}})}function Qe(Pe,et){x.userAction({action:Pe,scope:"nearbyDevices",payload:{deviceName:et,cancel:!0}})}let ut=y.deviceName=="turbine",$e,pt;function We(){n(2,ut=!1),n(4,pt=!1),n(3,$e=!1)}const gt=({deviceName:Pe})=>B.includes(Pe),at=(Pe,et)=>et.deviceName==Pe,Ee=()=>{xe("delayed-open")},Ye=()=>{xe("add-delay")},Mt=()=>{xe("open")},Rt=()=>{xe("cancel-opening")},Je=()=>{n(2,ut=!0)},tt=()=>{be("move")},we=()=>{be("personal-entry")},Xe=()=>{n(3,$e=!0)},Nt=()=>{be("keep-open")},Wt=()=>{be("close")},bt=()=>{n(4,pt=!0),j("vol-report")},Ct=()=>{j("hdmi1")},Ut=()=>{j("hdmi2")},Ot=()=>{j("off")},tn=()=>{j("vol-up")},bn=()=>{j("vol-down")},nn=()=>{j("vol-default")},Et=()=>{j("mute")},rn=(Pe,et)=>et.deviceName==Pe,jt=Pe=>{ct("kid_sleep",Pe)},nt=(Pe,et)=>et.deviceName==Pe,it=Pe=>{Ie("kid_sleep",Pe)},ft=Pe=>{ct("kid_sleep",Pe)},Lt=Pe=>{Qe("kid_sleep",Pe)},re=()=>{me("on")},Re=()=>{me("off")},zt=()=>{me("off-delay")},Zt=()=>{q("enable")},on=()=>{q("disable")},ln=()=>{We(),window.scrollTo({top:0,behavior:"smooth"})};return t.$$set=Pe=>{"localDevice"in Pe&&n(0,y=Pe.localDevice),"nearbyDevices"in Pe&&n(1,E=Pe.nearbyDevices)},t.$$.update=()=>{var Pe,et,fn,sn,Bt;t.$$.dirty[0]&268435456&&n(10,r=(Pe=h.entryDoor)==null?void 0:Pe.counter),t.$$.dirty[0]&268435456&&n(9,i=(et=h.parkingDoor)==null?void 0:et.keepOpenInProgress),t.$$.dirty[0]&268435456&&n(8,s=(fn=h.parkingDoor)==null?void 0:fn.personalEntryInProgress),t.$$.dirty[0]&268435456&&n(7,l=(sn=h.lights)==null?void 0:sn.labLightOffDelay),t.$$.dirty[0]&268435456&&n(6,c=(Bt=h.lights)==null?void 0:Bt.labLightOffDelayStr),t.$$.dirty[0]&268435456&&n(5,a=h.kidSleepStarter)},[y,E,ut,$e,pt,a,c,l,s,i,r,p,b,m,$,A,B,ee,L,j,q,xe,be,me,Ie,ct,Qe,We,h,gt,at,Ee,Ye,Mt,Rt,Je,tt,we,Xe,Nt,Wt,bt,Ct,Ut,Ot,tn,bn,nn,Et,rn,jt,nt,it,ft,Lt,re,Re,zt,Zt,on,ln]}class La extends lt{constructor(e){super(),ot(this,e,ja,Pa,st,{localDevice:0,nearbyDevices:1},null,[-1,-1,-1])}}function Of(t,e,n){const r=t.slice();return r[18]=e[n],r}function kf(t){let e,n,r,i=t[5],s=[];for(let l=0;l<i.length;l+=1)s[l]=Nf(Of(t,i,l));return{c(){e=M("h3"),e.textContent="Izklop računalnikov",n=H();for(let l=0;l<s.length;l+=1)s[l].c();r=_t(),U(e,"class","svelte-xmpa81")},m(l,c){T(l,e,c),T(l,n,c);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(l,c);T(l,r,c)},p(l,c){if(c&487){i=l[5];let a;for(a=0;a<i.length;a+=1){const h=Of(l,i,a);s[a]?s[a].p(h,c):(s[a]=Nf(h),s[a].c(),s[a].m(r.parentNode,r))}for(;a<s.length;a+=1)s[a].d(1);s.length=i.length}},d(l){l&&C(e),l&&C(n),gn(s,l),l&&C(r)}}}function Cf(t){var p,b;let e,n,r,i;function s(m,y){var E;return(E=m[1][m[18]])!=null&&E.counter?Ba:za}let l=s(t),c=l(t),a=((p=t[1][t[18]])==null?void 0:p.counter)&&Tf(t),h=t[2]&&((b=t[1][t[18]])==null?void 0:b.counter)!=null&&Rf(t);return{c(){e=M("div"),c.c(),n=H(),a&&a.c(),r=H(),h&&h.c(),i=H(),U(e,"class","sleep_device svelte-xmpa81")},m(m,y){T(m,e,y),c.m(e,null),k(e,n),a&&a.m(e,null),k(e,r),h&&h.m(e,null),k(e,i)},p(m,y){var E,x;l===(l=s(m))&&c?c.p(m,y):(c.d(1),c=l(m),c&&(c.c(),c.m(e,n))),(E=m[1][m[18]])!=null&&E.counter?a?a.p(m,y):(a=Tf(m),a.c(),a.m(e,r)):a&&(a.d(1),a=null),m[2]&&((x=m[1][m[18]])==null?void 0:x.counter)!=null?h?h.p(m,y):(h=Rf(m),h.c(),h.m(e,i)):h&&(h.d(1),h=null)},d(m){m&&C(e),c.d(),a&&a.d(),h&&h.d()}}}function za(t){let e,n,r=t[18]+"",i,s,l,c;function a(){return t[13](t[18])}return{c(){e=M("button"),n=K("🛑💻 "),i=K(r),e.disabled=s=!t[2],U(e,"class","svelte-xmpa81")},m(h,p){T(h,e,p),k(e,n),k(e,i),l||(c=Ae(e,"click",a),l=!0)},p(h,p){t=h,p&4&&s!==(s=!t[2])&&(e.disabled=s)},d(h){h&&C(e),l=!1,c()}}}function Ba(t){let e,n=t[18]+"",r;return{c(){e=M("h3"),r=K(n),U(e,"class","sleep_device svelte-xmpa81")},m(i,s){T(i,e,s),k(e,r)},p:pe,d(i){i&&C(e)}}}function Tf(t){let e,n,r,i,s,l,c,a,h,p,b,m,y;function E(){return t[14](t[18])}function x(){return t[15](t[18])}function $(){return t[16](t[18])}return{c(){e=M("button"),n=K("🛑 ZDAJ"),i=H(),s=M("button"),l=K("⏱ ZAKASNITEV"),a=H(),h=M("button"),p=K("Prekliči"),U(e,"class","turn_off svelte-xmpa81"),e.disabled=r=!t[2],U(s,"class","add_time svelte-xmpa81"),s.disabled=c=!t[2],U(h,"class","cancel svelte-xmpa81"),h.disabled=b=!t[2]},m(A,B){T(A,e,B),k(e,n),T(A,i,B),T(A,s,B),k(s,l),T(A,a,B),T(A,h,B),k(h,p),m||(y=[Ae(e,"click",E),Ae(s,"click",x),Ae(h,"click",$)],m=!0)},p(A,B){t=A,B&4&&r!==(r=!t[2])&&(e.disabled=r),B&4&&c!==(c=!t[2])&&(s.disabled=c),B&4&&b!==(b=!t[2])&&(h.disabled=b)},d(A){A&&C(e),A&&C(i),A&&C(s),A&&C(a),A&&C(h),m=!1,yt(y)}}}function Rf(t){let e,n,r=t[18]+"",i,s;function l(h,p){return h[1][h[18]].counter==0?qa:Ka}let c=l(t),a=c(t);return{c(){e=M("h3"),n=M("span"),i=K(r),s=K(` izklop
              `),a.c(),U(n,"class","svelte-xmpa81"),U(e,"class","countdown_turn_off svelte-xmpa81"),le(e,"warn",t[1][t[18]].counter<=15)},m(h,p){T(h,e,p),k(e,n),k(n,i),k(e,s),a.m(e,null)},p(h,p){c===(c=l(h))&&a?a.p(h,p):(a.d(1),a=c(h),a&&(a.c(),a.m(e,null))),p&34&&le(e,"warn",h[1][h[18]].counter<=15)},d(h){h&&C(e),a.d()}}}function Ka(t){let e,n=t[1][t[18]].delayStr+"",r;return{c(){e=K("čez "),r=K(n)},m(i,s){T(i,e,s),T(i,r,s)},p(i,s){s&2&&n!==(n=i[1][i[18]].delayStr+"")&&De(r,n)},d(i){i&&C(e),i&&C(r)}}}function qa(t){let e;return{c(){e=K("ZDAJ")},m(n,r){T(n,e,r)},p:pe,d(n){n&&C(e)}}}function Nf(t){var s;let e=(s=t[0])==null?void 0:s.find(r),n;function r(...l){return t[12](t[18],...l)}let i=e&&Cf(t);return{c(){i&&i.c(),n=_t()},m(l,c){i&&i.m(l,c),T(l,n,c)},p(l,c){var a;t=l,c&1&&(e=(a=t[0])==null?void 0:a.find(r)),e?i?i.p(t,c):(i=Cf(t),i.c(),i.m(n.parentNode,n)):i&&(i.d(1),i=null)},d(l){i&&i.d(l),l&&C(n)}}}function Ya(t){var i;let e,n=t[1]&&((i=t[0])==null?void 0:i.find(t[11])),r=n&&kf(t);return{c(){e=M("div"),r&&r.c(),U(e,"class","options svelte-xmpa81")},m(s,l){T(s,e,l),r&&r.m(e,null)},p(s,[l]){var c;l&3&&(n=s[1]&&((c=s[0])==null?void 0:c.find(s[11]))),n?r?r.p(s,l):(r=kf(s),r.c(),r.m(e,null)):r&&(r.d(1),r=null)},i:pe,o:pe,d(s){s&&C(e),r&&r.d()}}}const Fa="192.168.0.20",Ha=7780,Ja="david/home";function Wa(t,e,n){let r,i,s,{localDevice:l}=e,{nearbyDevices:c}=e;const a=di({host:Fa,port:Ha,protocol:Ja}),{connected:h,state:p}=a;mt(t,h,j=>n(2,s=j)),mt(t,p,j=>n(10,i=j));const b=["kids","eclipse","turbine","andreja"];function m(j,q){a.userAction({action:j,scope:"nearbyDevices",payload:{deviceName:q}})}function y(j,q){a.userAction({action:j,scope:"nearbyDevices",payload:{deviceName:q,delay:!0}})}function E(j,q){a.userAction({action:j,scope:"nearbyDevices",payload:{deviceName:q,cancel:!0}})}const x=({deviceName:j})=>b.includes(j),$=(j,q)=>q.deviceName==j,A=j=>{y("sleep",j)},B=j=>{m("sleep",j)},ee=j=>{y("sleep",j)},L=j=>{E("sleep",j)};return t.$$set=j=>{"localDevice"in j&&n(9,l=j.localDevice),"nearbyDevices"in j&&n(0,c=j.nearbyDevices)},t.$$.update=()=>{t.$$.dirty&1024&&n(1,r=i.deviceSleepStarter)},[c,r,s,h,p,b,m,y,E,l,i,x,$,A,B,ee,L]}class Za extends lt{constructor(e){super(),ot(this,e,Wa,Ya,st,{localDevice:9,nearbyDevices:0})}}function Ga(t){let e,n=Df(t[2])+"",r,i,s=t[1].replace("blinds","")+"",l,c,a,h;return{c(){e=M("button"),r=K(n),i=H(),l=K(s),e.disabled=c=!t[4],U(e,"class","svelte-o08zau"),le(e,"moving",t[3]&&t[3][Kt(t[0],t[1],t[2])]&&t[3][Kt(t[0],t[1],t[2])].blindsStatus=="moving"),le(e,"present",t[3]&&t[3][Kt(t[0],t[1],t[2])]&&t[3][Kt(t[0],t[1],t[2])].present),le(e,"halted",t[3]&&t[3][Kt(t[0],t[1],t[2])]&&t[3][Kt(t[0],t[1],t[2])].halted),le(e,"disconnected",t[4]==!1)},m(p,b){T(p,e,b),k(e,r),k(e,i),k(e,l),a||(h=Ae(e,"click",t[10]),a=!0)},p(p,[b]){b&4&&n!==(n=Df(p[2])+"")&&De(r,n),b&2&&s!==(s=p[1].replace("blinds","")+"")&&De(l,s),b&16&&c!==(c=!p[4])&&(e.disabled=c),b&15&&le(e,"moving",p[3]&&p[3][Kt(p[0],p[1],p[2])]&&p[3][Kt(p[0],p[1],p[2])].blindsStatus=="moving"),b&15&&le(e,"present",p[3]&&p[3][Kt(p[0],p[1],p[2])]&&p[3][Kt(p[0],p[1],p[2])].present),b&15&&le(e,"halted",p[3]&&p[3][Kt(p[0],p[1],p[2])]&&p[3][Kt(p[0],p[1],p[2])].halted),b&16&&le(e,"disconnected",p[4]==!1)},i:pe,o:pe,d(p){p&&C(e),a=!1,h()}}}function Df(t){return t=="up"?"▲":"▼"}function Kt(t,e,n){return`${t}-${e}-${n}`}function Va(t,e,n){let r,i,s,{connector:l}=e,{placeId:c}=e,{blindsId:a}=e,{blindsDirection:h}=e;const{state:p,connected:b}=l;mt(t,p,x=>n(9,i=x)),mt(t,b,x=>n(4,s=x));function m(x){l.userAction({action:"command",payload:x,scope:"blinds"})}function y(x,$,A){m({placeId:x,blindsId:$,blindsDirection:A,blindsAction:"move"})}const E=()=>y(c,a,h);return t.$$set=x=>{"connector"in x&&n(8,l=x.connector),"placeId"in x&&n(0,c=x.placeId),"blindsId"in x&&n(1,a=x.blindsId),"blindsDirection"in x&&n(2,h=x.blindsDirection)},t.$$.update=()=>{t.$$.dirty&512&&n(3,r=i)},[c,a,h,r,s,p,b,y,l,i,E]}class vt extends lt{constructor(e){super(),ot(this,e,Va,Ga,st,{connector:8,placeId:0,blindsId:1,blindsDirection:2})}}function Qa(t){let e,n,r,i,s,l,c,a,h,p,b,m,y,E,x,$,A,B,ee,L,j;return s=new vt({props:{placeId:"ap1",blindsId:"blinds4",blindsDirection:"up",connector:t[1]}}),c=new vt({props:{placeId:"ap1",blindsId:"blinds3",blindsDirection:"up",connector:t[1]}}),h=new vt({props:{placeId:"ap1",blindsId:"blinds2",blindsDirection:"up",connector:t[1]}}),b=new vt({props:{placeId:"ap1",blindsId:"blinds1",blindsDirection:"up",connector:t[1]}}),E=new vt({props:{placeId:"ap1",blindsId:"blinds4",blindsDirection:"down",connector:t[1]}}),$=new vt({props:{placeId:"ap1",blindsId:"blinds3",blindsDirection:"down",connector:t[1]}}),B=new vt({props:{placeId:"ap1",blindsId:"blinds2",blindsDirection:"down",connector:t[1]}}),L=new vt({props:{placeId:"ap1",blindsId:"blinds1",blindsDirection:"down",connector:t[1]}}),{c(){e=M("div"),n=M("h2"),n.textContent="Rolete AP1",r=H(),i=M("div"),Be(s.$$.fragment),l=H(),Be(c.$$.fragment),a=K(`
        —
        `),Be(h.$$.fragment),p=H(),Be(b.$$.fragment),m=H(),y=M("div"),Be(E.$$.fragment),x=H(),Be($.$$.fragment),A=K(`
        —
        `),Be(B.$$.fragment),ee=H(),Be(L.$$.fragment),U(i,"class","iot section svelte-1kxggon"),U(y,"class","iot section svelte-1kxggon"),U(e,"class","blinds_ap1")},m(q,xe){T(q,e,xe),k(e,n),k(e,r),k(e,i),Le(s,i,null),k(i,l),Le(c,i,null),k(i,a),Le(h,i,null),k(i,p),Le(b,i,null),k(e,m),k(e,y),Le(E,y,null),k(y,x),Le($,y,null),k(y,A),Le(B,y,null),k(y,ee),Le(L,y,null),j=!0},p:pe,i(q){j||(te(s.$$.fragment,q),te(c.$$.fragment,q),te(h.$$.fragment,q),te(b.$$.fragment,q),te(E.$$.fragment,q),te($.$$.fragment,q),te(B.$$.fragment,q),te(L.$$.fragment,q),j=!0)},o(q){ye(s.$$.fragment,q),ye(c.$$.fragment,q),ye(h.$$.fragment,q),ye(b.$$.fragment,q),ye(E.$$.fragment,q),ye($.$$.fragment,q),ye(B.$$.fragment,q),ye(L.$$.fragment,q),j=!1},d(q){q&&C(e),ze(s),ze(c),ze(h),ze(b),ze(E),ze($),ze(B),ze(L)}}}function Xa(t){let e,n,r,i,s,l,c,a,h,p,b,m,y,E,x,$,A,B,ee,L,j,q,xe,be,me,Ie,ct,Qe,ut;return s=new vt({props:{placeId:"ap2",blindsId:"blinds6",blindsDirection:"up",connector:t[1]}}),c=new vt({props:{placeId:"ap2",blindsId:"blinds5",blindsDirection:"up",connector:t[1]}}),h=new vt({props:{placeId:"ap2",blindsId:"blinds4",blindsDirection:"up",connector:t[1]}}),b=new vt({props:{placeId:"ap2",blindsId:"blinds3",blindsDirection:"up",connector:t[1]}}),y=new vt({props:{placeId:"ap2",blindsId:"blinds2",blindsDirection:"up",connector:t[1]}}),x=new vt({props:{placeId:"ap2",blindsId:"blinds1",blindsDirection:"up",connector:t[1]}}),B=new vt({props:{placeId:"ap2",blindsId:"blinds6",blindsDirection:"down",connector:t[1]}}),L=new vt({props:{placeId:"ap2",blindsId:"blinds5",blindsDirection:"down",connector:t[1]}}),q=new vt({props:{placeId:"ap2",blindsId:"blinds4",blindsDirection:"down",connector:t[1]}}),be=new vt({props:{placeId:"ap2",blindsId:"blinds3",blindsDirection:"down",connector:t[1]}}),Ie=new vt({props:{placeId:"ap2",blindsId:"blinds2",blindsDirection:"down",connector:t[1]}}),Qe=new vt({props:{placeId:"ap2",blindsId:"blinds1",blindsDirection:"down",connector:t[1]}}),{c(){e=M("div"),n=M("h2"),n.textContent="Rolete AP2",r=H(),i=M("div"),Be(s.$$.fragment),l=H(),Be(c.$$.fragment),a=K(`
        —
        `),Be(h.$$.fragment),p=H(),Be(b.$$.fragment),m=K(`
        —
        `),Be(y.$$.fragment),E=H(),Be(x.$$.fragment),$=H(),A=M("div"),Be(B.$$.fragment),ee=H(),Be(L.$$.fragment),j=K(`
        —
        `),Be(q.$$.fragment),xe=H(),Be(be.$$.fragment),me=K(`
        —
        `),Be(Ie.$$.fragment),ct=H(),Be(Qe.$$.fragment),U(i,"class","iot section svelte-1kxggon"),U(A,"class","iot section svelte-1kxggon"),U(e,"class","blinds_ap2 svelte-1kxggon"),le(e,"visible",ru)},m($e,pt){T($e,e,pt),k(e,n),k(e,r),k(e,i),Le(s,i,null),k(i,l),Le(c,i,null),k(i,a),Le(h,i,null),k(i,p),Le(b,i,null),k(i,m),Le(y,i,null),k(i,E),Le(x,i,null),k(e,$),k(e,A),Le(B,A,null),k(A,ee),Le(L,A,null),k(A,j),Le(q,A,null),k(A,xe),Le(be,A,null),k(A,me),Le(Ie,A,null),k(A,ct),Le(Qe,A,null),ut=!0},p:pe,i($e){ut||(te(s.$$.fragment,$e),te(c.$$.fragment,$e),te(h.$$.fragment,$e),te(b.$$.fragment,$e),te(y.$$.fragment,$e),te(x.$$.fragment,$e),te(B.$$.fragment,$e),te(L.$$.fragment,$e),te(q.$$.fragment,$e),te(be.$$.fragment,$e),te(Ie.$$.fragment,$e),te(Qe.$$.fragment,$e),ut=!0)},o($e){ye(s.$$.fragment,$e),ye(c.$$.fragment,$e),ye(h.$$.fragment,$e),ye(b.$$.fragment,$e),ye(y.$$.fragment,$e),ye(x.$$.fragment,$e),ye(B.$$.fragment,$e),ye(L.$$.fragment,$e),ye(q.$$.fragment,$e),ye(be.$$.fragment,$e),ye(Ie.$$.fragment,$e),ye(Qe.$$.fragment,$e),ut=!1},d($e){$e&&C(e),ze(s),ze(c),ze(h),ze(b),ze(y),ze(x),ze(B),ze(L),ze(q),ze(be),ze(Ie),ze(Qe)}}}function eu(t){let e,n,r,i;const s=[Xa,Qa],l=[];function c(a,h){return a[0].deviceName=="tv-ap2"?0:1}return n=c(t),r=l[n]=s[n](t),{c(){e=M("main"),r.c(),U(e,"class","svelte-1kxggon")},m(a,h){T(a,e,h),l[n].m(e,null),i=!0},p(a,[h]){let p=n;n=c(a),n===p?l[n].p(a,h):(xt(),ye(l[p],1,1,()=>{l[p]=null}),At(),r=l[n],r?r.p(a,h):(r=l[n]=s[n](a),r.c()),te(r,1),r.m(e,null))},i(a){i||(te(r),i=!0)},o(a){ye(r),i=!1},d(a){a&&C(e),l[n].d()}}}const tu=7780,nu="david/blinds";let ru=!1;function iu(t,e,n){let{localDevice:r}=e;const i=di({port:tu,protocol:nu});return t.$$set=s=>{"localDevice"in s&&n(0,r=s.localDevice)},[r,i]}class fu extends lt{constructor(e){super(),ot(this,e,iu,eu,st,{localDevice:0})}}function $f(t,e,n){const r=t.slice();return r[3]=e[n],r}function Pf(t){let e,n=t[1].slice(0,4),r=[];for(let i=0;i<n.length;i+=1)r[i]=Mf($f(t,n,i));return{c(){e=M("div");for(let i=0;i<r.length;i+=1)r[i].c();U(e,"class","notifications svelte-9jalg6")},m(i,s){T(i,e,s);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(i,s){if(s&2){n=i[1].slice(0,4);let l;for(l=0;l<n.length;l+=1){const c=$f(i,n,l);r[l]?r[l].p(c,s):(r[l]=Mf(c),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(i){i&&C(e),gn(r,i)}}}function If(t){let e,n=t[3].title+"",r;return{c(){e=M("div"),r=K(n),U(e,"class","title svelte-9jalg6")},m(i,s){T(i,e,s),k(e,r)},p(i,s){s&2&&n!==(n=i[3].title+"")&&De(r,n)},d(i){i&&C(e)}}}function su(t){let e,n=t[3].relativeTimeAdded+"",r;return{c(){e=M("div"),r=K(n),U(e,"class","time svelte-9jalg6")},m(i,s){T(i,e,s),k(e,r)},p(i,s){s&2&&n!==(n=i[3].relativeTimeAdded+"")&&De(r,n)},d(i){i&&C(e)}}}function ou(t){let e,n=t[3].tagline+"",r;return{c(){e=M("div"),r=K(n),U(e,"class","time svelte-9jalg6")},m(i,s){T(i,e,s),k(e,r)},p(i,s){s&2&&n!==(n=i[3].tagline+"")&&De(r,n)},d(i){i&&C(e)}}}function Mf(t){let e,n,r=(t[3].msg||"")+"",i,s,l,c=t[3].title&&If(t);function a(b,m){if(b[3].tagline)return ou;if(!b[3].omitTtl)return su}let h=a(t),p=h&&h(t);return{c(){e=M("div"),c&&c.c(),n=H(),i=K(r),s=H(),p&&p.c(),l=H(),U(e,"class","notification svelte-9jalg6"),ir(e,"color",t[3].color),ir(e,"background-color",t[3].bgColor)},m(b,m){T(b,e,m),c&&c.m(e,null),k(e,n),k(e,i),k(e,s),p&&p.m(e,null),k(e,l)},p(b,m){b[3].title?c?c.p(b,m):(c=If(b),c.c(),c.m(e,n)):c&&(c.d(1),c=null),m&2&&r!==(r=(b[3].msg||"")+"")&&De(i,r),h===(h=a(b))&&p?p.p(b,m):(p&&p.d(1),p=h&&h(b),p&&(p.c(),p.m(e,l))),m&2&&ir(e,"color",b[3].color),m&2&&ir(e,"background-color",b[3].bgColor)},d(b){b&&C(e),c&&c.d(),p&&p.d()}}}function lu(t){let e,n=t[1]&&t[1].length&&Pf(t);return{c(){n&&n.c(),e=_t()},m(r,i){n&&n.m(r,i),T(r,e,i)},p(r,[i]){r[1]&&r[1].length?n?n.p(r,i):(n=Pf(r),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:pe,o:pe,d(r){n&&n.d(r),r&&C(e)}}}function cu(t,e,n){let r,i,s=pe,l=()=>(s(),s=St(c,a=>n(2,i=a)),c);t.$$.on_destroy.push(()=>s());let{store:c}=e;return l(),t.$$set=a=>{"store"in a&&l(n(0,c=a.store))},t.$$.update=()=>{t.$$.dirty&4&&n(1,r=i.notifications.slice().reverse())},[c,r,i]}class au extends lt{constructor(e){super(),ot(this,e,cu,lu,st,{store:0})}}const qt=en([]);qt.LIMIT=300;qt.log=(t,{dedup:e=!1}={})=>{qt.update(n=>(e&&n.length>0&&n[n.length-1].entry==t&&n.pop(),n.push({entry:t,createdDate:new Date,createdAt:Date.now(),isRecent:!0,isVeryRecent:!0}),n.slice(-qt.LIMIT)))};function Ks(){const t=Date.now();qt.update(e=>{for(const n of e)n.isRecent=t-n.createdAt<6e4,n.isVeryRecent=t-n.createdAt<5e3;return e}),setTimeout(Ks,1e3)}Ks();function Uf(t,e,n){const r=t.slice();return r[11]=e[n].time,r[12]=e[n].entry,r[13]=e[n].isRecent,r[14]=e[n].isVeryRecent,r[15]=e[n].createdAt,r[17]=n,r}function jf(t){let e,n;return{c(){e=M("h2"),n=K(t[0]),U(e,"class","title svelte-jdzn25")},m(r,i){T(r,e,i),k(e,n)},p(r,i){i&1&&De(n,r[0])},d(r){r&&C(e)}}}function uu(t){let e,n,r;return{c(){e=M("button"),e.textContent="Show Log",U(e,"class","svelte-jdzn25")},m(i,s){T(i,e,s),n||(r=Ae(e,"click",t[8]),n=!0)},p:pe,i:pe,o:pe,d(i){i&&C(e),n=!1,r()}}}function du(t){let e,n,r;const i=t[7].default,s=ns(i,t,t[6],null);let l=t[2].map(zf),c=[];for(let a=0;a<l.length;a+=1)c[a]=Lf(Uf(t,l,a));return{c(){s&&s.c(),e=H();for(let a=0;a<c.length;a+=1)c[a].c();n=_t()},m(a,h){s&&s.m(a,h),T(a,e,h);for(let p=0;p<c.length;p+=1)c[p]&&c[p].m(a,h);T(a,n,h),r=!0},p(a,h){if(s&&s.p&&(!r||h&64)&&fs(s,i,a,a[6],r?is(i,a[6],h,null):ss(a[6]),null),h&4){l=a[2].map(zf);let p;for(p=0;p<l.length;p+=1){const b=Uf(a,l,p);c[p]?c[p].p(b,h):(c[p]=Lf(b),c[p].c(),c[p].m(n.parentNode,n))}for(;p<c.length;p+=1)c[p].d(1);c.length=l.length}},i(a){r||(te(s,a),r=!0)},o(a){ye(s,a),r=!1},d(a){s&&s.d(a),a&&C(e),gn(c,a),a&&C(n)}}}function hu(t){let e=t[11]+"",n;return{c(){n=K(e)},m(r,i){T(r,n,i)},p(r,i){i&4&&e!==(e=r[11]+"")&&De(n,e)},d(r){r&&C(n)}}}function _u(t){let e;function n(s,l){return s[15]-s[2][s[17]+1].createdAt<1e4?bu:pu}let r=n(t),i=r(t);return{c(){i.c(),e=_t()},m(s,l){i.m(s,l),T(s,e,l)},p(s,l){r===(r=n(s))&&i?i.p(s,l):(i.d(1),i=r(s),i&&(i.c(),i.m(e.parentNode,e)))},d(s){i.d(s),s&&C(e)}}}function pu(t){let e=t[11]+"",n;return{c(){n=K(e)},m(r,i){T(r,n,i)},p(r,i){i&4&&e!==(e=r[11]+"")&&De(n,e)},d(r){r&&C(n)}}}function bu(t){let e,n,r=t[15]-t[2][t[17]+1].createdAt+"",i,s;return{c(){e=M("span"),n=K("+"),i=K(r),s=K("ms"),U(e,"class","diff svelte-jdzn25")},m(l,c){T(l,e,c),k(e,n),k(e,i),k(e,s)},p(l,c){c&4&&r!==(r=l[15]-l[2][l[17]+1].createdAt+"")&&De(i,r)},d(l){l&&C(e)}}}function Lf(t){let e,n,r,i=t[12]+"",s,l;function c(p,b){return p[17]<p[2].length-1?_u:hu}let a=c(t),h=a(t);return{c(){e=M("div"),n=M("span"),h.c(),r=H(),s=K(i),l=H(),U(n,"class","time svelte-jdzn25"),U(e,"class","log_entry svelte-jdzn25"),le(e,"recent",t[13]),le(e,"very_recent",t[14])},m(p,b){T(p,e,b),k(e,n),h.m(n,null),k(e,r),k(e,s),k(e,l)},p(p,b){a===(a=c(p))&&h?h.p(p,b):(h.d(1),h=a(p),h&&(h.c(),h.m(n,null))),b&4&&i!==(i=p[12]+"")&&De(s,i),b&4&&le(e,"recent",p[13]),b&4&&le(e,"very_recent",p[14])},d(p){p&&C(e),h.d()}}}function vu(t){let e,n,r,i,s,l=t[0]&&jf(t);const c=[du,uu],a=[];function h(p,b){return p[1]?0:1}return r=h(t),i=a[r]=c[r](t),{c(){e=M("div"),l&&l.c(),n=H(),i.c(),U(e,"class","logview svelte-jdzn25")},m(p,b){T(p,e,b),l&&l.m(e,null),k(e,n),a[r].m(e,null),s=!0},p(p,[b]){p[0]?l?l.p(p,b):(l=jf(p),l.c(),l.m(e,n)):l&&(l.d(1),l=null);let m=r;r=h(p),r===m?a[r].p(p,b):(xt(),ye(a[m],1,1,()=>{a[m]=null}),At(),i=a[r],i?i.p(p,b):(i=a[r]=c[r](p),i.c()),te(i,1),i.m(e,null))},i(p){s||(te(i),s=!0)},o(p){ye(i),s=!1},d(p){p&&C(e),l&&l.d(),a[r].d()}}}const zf=t=>{const e=t.createdDate.toLocaleString().split(",")[1];return{...t,time:e}};function mu(t,e,n){let r,i;mt(t,qt,E=>n(5,i=E));let{$$slots:s={},$$scope:l}=e,{showLogInitially:c=!0}=e,{title:a}=e,{limit:h=0}=e;h>qt.LIMIT&&(console.log(`Warning: provided LogView line limit (${h}) is larger than logStore limit  (${qt.LIMIT})`),console.log("Utilizing the lower value ..."),h=qt.LIMIT);let p=c,b;function m(){const E=Date.now();b&&E-b>500&&qt.log("——— Context switch / App wake ———",{dedup:!0}),b=E,setTimeout(m,300)}m();const y=()=>{n(1,p=!0)};return t.$$set=E=>{"showLogInitially"in E&&n(4,c=E.showLogInitially),"title"in E&&n(0,a=E.title),"limit"in E&&n(3,h=E.limit),"$$scope"in E&&n(6,l=E.$$scope)},t.$$.update=()=>{t.$$.dirty&40&&n(2,r=i.slice(-h).reverse())},[a,p,r,h,c,i,l,s,y]}class qs extends lt{constructor(e){super(),ot(this,e,mu,vu,st,{showLogInitially:4,title:0,limit:3})}}function yu(t){let e,n,r,i,s;return{c(){e=M("div"),n=M("span"),n.textContent="DMT",r=H(),i=M("span"),s=K(t[0]),U(n,"class","dmt svelte-vrzjix"),U(i,"class","app svelte-vrzjix")},m(l,c){T(l,e,c),k(e,n),k(e,r),k(e,i),k(i,s)},p(l,[c]){c&1&&De(s,l[0])},i:pe,o:pe,d(l){l&&C(e)}}}function gu(t,e,n){let{dmtApp:r}=e;return t.$$set=i=>{"dmtApp"in i&&n(0,r=i.dmtApp)},[r]}class wu extends lt{constructor(e){super(),ot(this,e,gu,yu,st,{dmtApp:0})}}function xu(t){let e,n,r,i,s,l,c=".".repeat(t[1])+"",a,h,p,b,m;n=new wu({props:{dmtApp:t[0]}});const y=t[3].default,E=ns(y,t,t[2],null);return{c(){e=M("div"),Be(n.$$.fragment),r=H(),i=M("p"),s=K("Connecting "),l=M("span"),a=K(c),h=H(),E&&E.c(),U(l,"class","svelte-mtqbfw"),U(i,"class","svelte-mtqbfw"),U(e,"class","wrapper svelte-mtqbfw")},m(x,$){T(x,e,$),Le(n,e,null),k(e,r),k(e,i),k(i,s),k(i,l),k(l,a),k(e,h),E&&E.m(e,null),m=!0},p(x,[$]){const A={};$&1&&(A.dmtApp=x[0]),n.$set(A),(!m||$&2)&&c!==(c=".".repeat(x[1])+"")&&De(a,c),E&&E.p&&(!m||$&4)&&fs(E,y,x,x[2],m?is(y,x[2],$,null):ss(x[2]),null)},i(x){m||(te(n.$$.fragment,x),te(E,x),Tt(()=>{m&&(b&&b.end(1),p=pn(e,yn,{}),p.start())}),m=!0)},o(x){ye(n.$$.fragment,x),ye(E,x),p&&p.invalidate(),b=No(e,yn,{}),m=!1},d(x){x&&C(e),ze(n),E&&E.d(x),x&&b&&b.end()}}}const Au=5;function Eu(t,e,n){let{$$slots:r={},$$scope:i}=e,{dmtApp:s}=e,l=1,c=!0;return Oo(()=>{const a=setInterval(()=>{n(1,l=l+(c?1:-1)),l==Au&&(c=!1),l==1&&(c=!0)},500);return()=>clearInterval(a)}),t.$$set=a=>{"dmtApp"in a&&n(0,s=a.dmtApp),"$$scope"in a&&n(2,i=a.$$scope)},[s,l,i,r]}class Su extends lt{constructor(e){super(),ot(this,e,Eu,xu,st,{dmtApp:0})}}function Bf(t,e,n){const r=t.slice();return r[2]=e[n],r}function Kf(t){let e,n=t[1].errors.slice(0,3),r=[];for(let i=0;i<n.length;i+=1)r[i]=Yf(Bf(t,n,i));return{c(){e=M("div");for(let i=0;i<r.length;i+=1)r[i].c();U(e,"class","errors svelte-1nzvkt5")},m(i,s){T(i,e,s);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(i,s){if(s&2){n=i[1].errors.slice(0,3);let l;for(l=0;l<n.length;l+=1){const c=Bf(i,n,l);r[l]?r[l].p(c,s):(r[l]=Yf(c),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=n.length}},d(i){i&&C(e),gn(r,i)}}}function qf(t){let e=t[2].stacktrace+"",n;return{c(){n=K(e)},m(r,i){T(r,n,i)},p(r,i){i&2&&e!==(e=r[2].stacktrace+"")&&De(n,e)},d(r){r&&C(n)}}}function Yf(t){let e,n,r,i,s,l=t[2].time+"",c,a,h,p=t[2].msg+"",b,m,y,E=t[2].stacktrace&&qf(t);return{c(){e=M("div"),n=M("div"),r=M("span"),i=K("⚠️ Error at "),s=M("span"),c=K(l),a=H(),h=M("span"),b=K(p),m=H(),E&&E.c(),y=H(),U(s,"class","time svelte-1nzvkt5"),U(r,"class","title svelte-1nzvkt5"),U(h,"class","msg svelte-1nzvkt5"),U(n,"class","header svelte-1nzvkt5"),U(e,"class","error svelte-1nzvkt5"),le(e,"cors_problem",t[2].corsProblem)},m(x,$){T(x,e,$),k(e,n),k(n,r),k(r,i),k(r,s),k(s,c),k(n,a),k(n,h),k(h,b),k(e,m),E&&E.m(e,null),k(e,y)},p(x,$){$&2&&l!==(l=x[2].time+"")&&De(c,l),$&2&&p!==(p=x[2].msg+"")&&De(b,p),x[2].stacktrace?E?E.p(x,$):(E=qf(x),E.c(),E.m(e,y)):E&&(E.d(1),E=null),$&2&&le(e,"cors_problem",x[2].corsProblem)},d(x){x&&C(e),E&&E.d()}}}function Ou(t){var r;let e,n=((r=t[1])==null?void 0:r.errors.length)&&Kf(t);return{c(){n&&n.c(),e=_t()},m(i,s){n&&n.m(i,s),T(i,e,s)},p(i,[s]){var l;(l=i[1])!=null&&l.errors.length?n?n.p(i,s):(n=Kf(i),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:pe,o:pe,d(i){n&&n.d(i),i&&C(e)}}}function ku(t,e,n){let r,i=pe,s=()=>(i(),i=St(l,c=>n(1,r=c)),l);t.$$.on_destroy.push(()=>i());let{errorStore:l}=e;return s(),t.$$set=c=>{"errorStore"in c&&s(n(0,l=c.errorStore))},[l,r]}class Cu extends lt{constructor(e){super(),ot(this,e,ku,Ou,st,{errorStore:0})}}function Tu({store:t,action:e,payload:n}){console.log(`Action: ${e}`),t.signal("action",{action:e,scope:"player",payload:n})}function Ru(t){let e,n;return e=new Su({props:{dmtApp:"Mobile",$$slots:{default:[Du]},$$scope:{ctx:t}}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&131072&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function Nu(t){let e=["borovnjakova"].includes(t[2].network),n,r=["borovnjakova","zaboric","vrbisce"].includes(t[2].network),i,s,l,c,a,h,p,b,m=e&&Ff(t),y=r&&Hf(t),E=t[2].network=="zaboric"&&Jf(t),x=t[2].deviceName!="tv-ap2"&&Wf(t);c=new qo({props:{connected:t[9],device:t[3],nearbyDevices:t[6],deviceName:t[8],activeDeviceKey:t[5],player:t[7]}});let $=t[2].deviceName!="tv-ap2"&&Zf(t);return p=new ql({props:{connected:t[9],player:t[7],deviceName:t[8],store:t[0],fnAction:t[12]}}),{c(){m&&m.c(),n=H(),y&&y.c(),i=H(),E&&E.c(),s=H(),x&&x.c(),l=H(),Be(c.$$.fragment),a=H(),$&&$.c(),h=H(),Be(p.$$.fragment)},m(A,B){m&&m.m(A,B),T(A,n,B),y&&y.m(A,B),T(A,i,B),E&&E.m(A,B),T(A,s,B),x&&x.m(A,B),T(A,l,B),Le(c,A,B),T(A,a,B),$&&$.m(A,B),T(A,h,B),Le(p,A,B),b=!0},p(A,B){B&4&&(e=["borovnjakova"].includes(A[2].network)),e?m?(m.p(A,B),B&4&&te(m,1)):(m=Ff(A),m.c(),te(m,1),m.m(n.parentNode,n)):m&&(xt(),ye(m,1,1,()=>{m=null}),At()),B&4&&(r=["borovnjakova","zaboric","vrbisce"].includes(A[2].network)),r?y?(y.p(A,B),B&4&&te(y,1)):(y=Hf(A),y.c(),te(y,1),y.m(i.parentNode,i)):y&&(xt(),ye(y,1,1,()=>{y=null}),At()),A[2].network=="zaboric"?E?(E.p(A,B),B&4&&te(E,1)):(E=Jf(A),E.c(),te(E,1),E.m(s.parentNode,s)):E&&(xt(),ye(E,1,1,()=>{E=null}),At()),A[2].deviceName!="tv-ap2"?x?(x.p(A,B),B&4&&te(x,1)):(x=Wf(A),x.c(),te(x,1),x.m(l.parentNode,l)):x&&(xt(),ye(x,1,1,()=>{x=null}),At());const ee={};B&8&&(ee.device=A[3]),B&64&&(ee.nearbyDevices=A[6]),B&256&&(ee.deviceName=A[8]),B&32&&(ee.activeDeviceKey=A[5]),B&128&&(ee.player=A[7]),c.$set(ee),A[2].deviceName!="tv-ap2"?$?($.p(A,B),B&4&&te($,1)):($=Zf(A),$.c(),te($,1),$.m(h.parentNode,h)):$&&(xt(),ye($,1,1,()=>{$=null}),At());const L={};B&128&&(L.player=A[7]),B&256&&(L.deviceName=A[8]),B&1&&(L.store=A[0]),p.$set(L)},i(A){b||(te(m),te(y),te(E),te(x),te(c.$$.fragment,A),te($),te(p.$$.fragment,A),b=!0)},o(A){ye(m),ye(y),ye(E),ye(x),ye(c.$$.fragment,A),ye($),ye(p.$$.fragment,A),b=!1},d(A){m&&m.d(A),A&&C(n),y&&y.d(A),A&&C(i),E&&E.d(A),A&&C(s),x&&x.d(A),A&&C(l),ze(c,A),A&&C(a),$&&$.d(A),A&&C(h),ze(p,A)}}}function Du(t){let e,n;return e=new qs({props:{showLogInitially:!0,limit:20}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p:pe,i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function Ff(t){let e,n;return e=new La({props:{connector:t[10],localDevice:t[2],nearbyDevices:t[6]}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&4&&(s.localDevice=r[2]),i&64&&(s.nearbyDevices=r[6]),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function Hf(t){let e,n;return e=new Za({props:{connector:t[10],localDevice:t[2],nearbyDevices:t[6]}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&4&&(s.localDevice=r[2]),i&64&&(s.nearbyDevices=r[6]),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function Jf(t){let e,n;return e=new fu({props:{localDevice:t[2],connector:t[10]}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&4&&(s.localDevice=r[2]),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function Wf(t){let e,n;return e=new au({props:{store:t[0]}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&1&&(s.store=r[0]),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function Zf(t){let e,n;return e=new Hl({props:{nearbyDevices:t[6],activeDeviceKey:t[5],store:t[0],log:t[1]}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&64&&(s.nearbyDevices=r[6]),i&32&&(s.activeDeviceKey=r[5]),i&1&&(s.store=r[0]),i&2&&(s.log=r[1]),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function Gf(t){let e,n;return e=new qs({props:{title:"Connectivity log",limit:200,showLogInitially:!1,$$slots:{default:[$u]},$$scope:{ctx:t}}}),{c(){Be(e.$$.fragment)},m(r,i){Le(e,r,i),n=!0},p(r,i){const s={};i&131088&&(s.$$scope={dirty:i,ctx:r}),e.$set(s)},i(r){n||(te(e.$$.fragment,r),n=!0)},o(r){ye(e.$$.fragment,r),n=!1},d(r){ze(e,r)}}}function $u(t){let e,n,r,i,s,l,c;return{c(){e=M("p"),n=K("Gui active: "),r=M("span"),i=K(t[4]),s=K("s"),l=H(),c=M("span"),c.textContent="[ also indicates that this app is processing events ]",U(r,"class","svelte-gx051d"),U(c,"class","small svelte-gx051d"),U(e,"class","logview_counter svelte-gx051d")},m(a,h){T(a,e,h),k(e,n),k(e,r),k(r,i),k(r,s),k(e,l),k(e,c)},p(a,h){h&16&&De(i,a[4])},d(a){a&&C(e)}}}function Pu(t){let e,n,r,i,s,l,c;n=new Cu({props:{errorStore:ys}});const a=[Nu,Ru],h=[];function p(m,y){return m[2]?0:1}i=p(t),s=h[i]=a[i](t);let b=t[2]&&Gf(t);return{c(){e=M("main"),Be(n.$$.fragment),r=H(),s.c(),l=H(),b&&b.c(),U(e,"class","svelte-gx051d")},m(m,y){T(m,e,y),Le(n,e,null),k(e,r),h[i].m(e,null),k(e,l),b&&b.m(e,null),c=!0},p(m,[y]){let E=i;i=p(m),i===E?h[i].p(m,y):(xt(),ye(h[E],1,1,()=>{h[E]=null}),At(),s=h[i],s?s.p(m,y):(s=h[i]=a[i](m),s.c()),te(s,1),s.m(e,l)),m[2]?b?(b.p(m,y),y&4&&te(b,1)):(b=Gf(m),b.c(),te(b,1),b.m(e,null)):b&&(xt(),ye(b,1,1,()=>{b=null}),At())},i(m){c||(te(n.$$.fragment,m),te(s),te(b),c=!0)},o(m){ye(n.$$.fragment,m),ye(s),ye(b),c=!1},d(m){m&&C(e),ze(n),h[i].d(),b&&b.d()}}}function Iu(t,e,n){let r,i,s,l,c,a,h,p=pe,b=()=>(p(),p=St(y,j=>n(13,h=j)),y),m;t.$$.on_destroy.push(()=>p());let{store:y}=e;b();let{log:E}=e;const{connected:x,localConnector:$}=y,{state:A}=$;mt(t,A,j=>n(14,m=j));function B(j,q){xs(),Tu({store:y,action:j,payload:q})}A.subscribe(j=>{var xe;const q=(xe=j==null?void 0:j.device)==null?void 0:xe.network;gs.set(["zaboric","borovnjakova"].includes(q))});let ee=0;function L(){n(4,ee+=1),setTimeout(L,1e3)}return L(),t.$$set=j=>{"store"in j&&b(n(0,y=j.store)),"log"in j&&n(1,E=j.log)},t.$$.update=()=>{t.$$.dirty&8192&&n(3,r=h.device),t.$$.dirty&8192&&n(8,i=h.optimisticDeviceName),t.$$.dirty&16384&&n(2,s=m.device),t.$$.dirty&4&&(s==null||s.devMachine),t.$$.dirty&8192&&n(7,l=h.player||{}),t.$$.dirty&8192&&n(6,c=h.nearbyDevices?h.nearbyDevices.filter(j=>j.hasGui).sort(Uo("deviceName")):[]),t.$$.dirty&8192&&n(5,a=h.activeDeviceKey)},[y,E,s,r,ee,a,c,l,i,x,$,A,B,h,m]}class Mu extends lt{constructor(e){super(),ot(this,e,Iu,Pu,st,{store:0,log:1})}}function Uu(){}class Ur{constructor(e,n,r){this.prev=e,this.next=n,this.fn=r||Uu}run(e){this.fn(e),this.next&&this.next.run(e)}}class ju{constructor(e){this.head=new Ur,this.tail=new Ur(this.head),this.head.next=this.tail,this.linkConstructor=e,this.reg={}}insert(e){const n=new Ur(this.tail.prev,this.tail,e);return n.next.prev=n,n.prev.next=n,n}remove(e){e.prev.next=e.next,e.next.prev=e.prev}}let Lu=0;class Er{constructor(){this.__events_list={}}on(e,n){const r=this.__events_list[e]||(this.__events_list[e]=new ju),i=n._eev||(n._eev=++Lu);r.reg[i]||(r.reg[i]=r.insert(n))}off(e,n){if(n){const r=this.__events_list[e];if(!r)return;const i=r.reg[n._eev];r.reg[n._eev]=void 0,r&&i&&r.remove(i)}}removeListener(...e){this.off(...e)}emit(e,n){const r=this.__events_list[e];r&&r.head.run(n)}}class zu extends Er{constructor(e){super(),this.state=e,this.subscriptions=[]}get(){return this.state}subscribe(e){return this.subscriptions.push(e),e(this.state),()=>{this.subscriptions=this.subscriptions.filter(n=>n!==e)}}announceStateChange(){this.subscriptions.forEach(e=>e(this.state))}}class Kn extends zu{set(e){this.state=e,this.announceStateChange()}}class Bu extends Kn{constructor(e={}){super(e)}set(e,{ignore:n=[]}={}){const r={};for(const i of n)r[i]=this.state[i];super.set({...e,...r})}setMerge(e){super.set({...this.state,...e})}clearState({except:e=[]}={}){for(const n of Object.keys(this.state))e.includes(n)||delete this.state[n]}}var Ku=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ys(t,e,n){return n={path:e,exports:{},require:function(r,i){return Fs(r,i??n.path)}},t(n,n.exports),n.exports}function qu(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach(function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})}),e}function Fs(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Yu={},Fu=Object.freeze({__proto__:null,default:Yu}),Hu=qu(Fu),Ht=Ys(function(t){(function(e){var n=function(o){var d,u=new Float64Array(16);if(o)for(d=0;d<o.length;d++)u[d]=o[d];return u},r=function(){throw new Error("no PRNG")},i=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var l=n(),c=n([1]),a=n([56129,1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),y=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function E(o,d,u,f){o[d]=u>>24&255,o[d+1]=u>>16&255,o[d+2]=u>>8&255,o[d+3]=u&255,o[d+4]=f>>24&255,o[d+5]=f>>16&255,o[d+6]=f>>8&255,o[d+7]=f&255}function x(o,d,u,f,_){var g,w=0;for(g=0;g<_;g++)w|=o[d+g]^u[f+g];return(1&w-1>>>8)-1}function $(o,d,u,f){return x(o,d,u,f,16)}function A(o,d,u,f){return x(o,d,u,f,32)}function B(o,d,u,f){for(var _=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,g=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,w=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,N=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,z=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,Q=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,F=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,ke=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,W=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,ie=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,fe=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,ue=u[16]&255|(u[17]&255)<<8|(u[18]&255)<<16|(u[19]&255)<<24,ae=u[20]&255|(u[21]&255)<<8|(u[22]&255)<<16|(u[23]&255)<<24,se=u[24]&255|(u[25]&255)<<8|(u[26]&255)<<16|(u[27]&255)<<24,ce=u[28]&255|(u[29]&255)<<8|(u[30]&255)<<16|(u[31]&255)<<24,oe=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,Z=_,X=g,J=w,G=N,V=z,Y=Q,S=F,O=ke,P=W,R=ie,D=fe,I=ue,ne=ae,de=se,_e=ce,he=oe,v,ge=0;ge<20;ge+=2)v=Z+ne|0,V^=v<<7|v>>>32-7,v=V+Z|0,P^=v<<9|v>>>32-9,v=P+V|0,ne^=v<<13|v>>>32-13,v=ne+P|0,Z^=v<<18|v>>>32-18,v=Y+X|0,R^=v<<7|v>>>32-7,v=R+Y|0,de^=v<<9|v>>>32-9,v=de+R|0,X^=v<<13|v>>>32-13,v=X+de|0,Y^=v<<18|v>>>32-18,v=D+S|0,_e^=v<<7|v>>>32-7,v=_e+D|0,J^=v<<9|v>>>32-9,v=J+_e|0,S^=v<<13|v>>>32-13,v=S+J|0,D^=v<<18|v>>>32-18,v=he+I|0,G^=v<<7|v>>>32-7,v=G+he|0,O^=v<<9|v>>>32-9,v=O+G|0,I^=v<<13|v>>>32-13,v=I+O|0,he^=v<<18|v>>>32-18,v=Z+G|0,X^=v<<7|v>>>32-7,v=X+Z|0,J^=v<<9|v>>>32-9,v=J+X|0,G^=v<<13|v>>>32-13,v=G+J|0,Z^=v<<18|v>>>32-18,v=Y+V|0,S^=v<<7|v>>>32-7,v=S+Y|0,O^=v<<9|v>>>32-9,v=O+S|0,V^=v<<13|v>>>32-13,v=V+O|0,Y^=v<<18|v>>>32-18,v=D+R|0,I^=v<<7|v>>>32-7,v=I+D|0,P^=v<<9|v>>>32-9,v=P+I|0,R^=v<<13|v>>>32-13,v=R+P|0,D^=v<<18|v>>>32-18,v=he+_e|0,ne^=v<<7|v>>>32-7,v=ne+he|0,de^=v<<9|v>>>32-9,v=de+ne|0,_e^=v<<13|v>>>32-13,v=_e+de|0,he^=v<<18|v>>>32-18;Z=Z+_|0,X=X+g|0,J=J+w|0,G=G+N|0,V=V+z|0,Y=Y+Q|0,S=S+F|0,O=O+ke|0,P=P+W|0,R=R+ie|0,D=D+fe|0,I=I+ue|0,ne=ne+ae|0,de=de+se|0,_e=_e+ce|0,he=he+oe|0,o[0]=Z>>>0&255,o[1]=Z>>>8&255,o[2]=Z>>>16&255,o[3]=Z>>>24&255,o[4]=X>>>0&255,o[5]=X>>>8&255,o[6]=X>>>16&255,o[7]=X>>>24&255,o[8]=J>>>0&255,o[9]=J>>>8&255,o[10]=J>>>16&255,o[11]=J>>>24&255,o[12]=G>>>0&255,o[13]=G>>>8&255,o[14]=G>>>16&255,o[15]=G>>>24&255,o[16]=V>>>0&255,o[17]=V>>>8&255,o[18]=V>>>16&255,o[19]=V>>>24&255,o[20]=Y>>>0&255,o[21]=Y>>>8&255,o[22]=Y>>>16&255,o[23]=Y>>>24&255,o[24]=S>>>0&255,o[25]=S>>>8&255,o[26]=S>>>16&255,o[27]=S>>>24&255,o[28]=O>>>0&255,o[29]=O>>>8&255,o[30]=O>>>16&255,o[31]=O>>>24&255,o[32]=P>>>0&255,o[33]=P>>>8&255,o[34]=P>>>16&255,o[35]=P>>>24&255,o[36]=R>>>0&255,o[37]=R>>>8&255,o[38]=R>>>16&255,o[39]=R>>>24&255,o[40]=D>>>0&255,o[41]=D>>>8&255,o[42]=D>>>16&255,o[43]=D>>>24&255,o[44]=I>>>0&255,o[45]=I>>>8&255,o[46]=I>>>16&255,o[47]=I>>>24&255,o[48]=ne>>>0&255,o[49]=ne>>>8&255,o[50]=ne>>>16&255,o[51]=ne>>>24&255,o[52]=de>>>0&255,o[53]=de>>>8&255,o[54]=de>>>16&255,o[55]=de>>>24&255,o[56]=_e>>>0&255,o[57]=_e>>>8&255,o[58]=_e>>>16&255,o[59]=_e>>>24&255,o[60]=he>>>0&255,o[61]=he>>>8&255,o[62]=he>>>16&255,o[63]=he>>>24&255}function ee(o,d,u,f){for(var _=f[0]&255|(f[1]&255)<<8|(f[2]&255)<<16|(f[3]&255)<<24,g=u[0]&255|(u[1]&255)<<8|(u[2]&255)<<16|(u[3]&255)<<24,w=u[4]&255|(u[5]&255)<<8|(u[6]&255)<<16|(u[7]&255)<<24,N=u[8]&255|(u[9]&255)<<8|(u[10]&255)<<16|(u[11]&255)<<24,z=u[12]&255|(u[13]&255)<<8|(u[14]&255)<<16|(u[15]&255)<<24,Q=f[4]&255|(f[5]&255)<<8|(f[6]&255)<<16|(f[7]&255)<<24,F=d[0]&255|(d[1]&255)<<8|(d[2]&255)<<16|(d[3]&255)<<24,ke=d[4]&255|(d[5]&255)<<8|(d[6]&255)<<16|(d[7]&255)<<24,W=d[8]&255|(d[9]&255)<<8|(d[10]&255)<<16|(d[11]&255)<<24,ie=d[12]&255|(d[13]&255)<<8|(d[14]&255)<<16|(d[15]&255)<<24,fe=f[8]&255|(f[9]&255)<<8|(f[10]&255)<<16|(f[11]&255)<<24,ue=u[16]&255|(u[17]&255)<<8|(u[18]&255)<<16|(u[19]&255)<<24,ae=u[20]&255|(u[21]&255)<<8|(u[22]&255)<<16|(u[23]&255)<<24,se=u[24]&255|(u[25]&255)<<8|(u[26]&255)<<16|(u[27]&255)<<24,ce=u[28]&255|(u[29]&255)<<8|(u[30]&255)<<16|(u[31]&255)<<24,oe=f[12]&255|(f[13]&255)<<8|(f[14]&255)<<16|(f[15]&255)<<24,Z=_,X=g,J=w,G=N,V=z,Y=Q,S=F,O=ke,P=W,R=ie,D=fe,I=ue,ne=ae,de=se,_e=ce,he=oe,v,ge=0;ge<20;ge+=2)v=Z+ne|0,V^=v<<7|v>>>32-7,v=V+Z|0,P^=v<<9|v>>>32-9,v=P+V|0,ne^=v<<13|v>>>32-13,v=ne+P|0,Z^=v<<18|v>>>32-18,v=Y+X|0,R^=v<<7|v>>>32-7,v=R+Y|0,de^=v<<9|v>>>32-9,v=de+R|0,X^=v<<13|v>>>32-13,v=X+de|0,Y^=v<<18|v>>>32-18,v=D+S|0,_e^=v<<7|v>>>32-7,v=_e+D|0,J^=v<<9|v>>>32-9,v=J+_e|0,S^=v<<13|v>>>32-13,v=S+J|0,D^=v<<18|v>>>32-18,v=he+I|0,G^=v<<7|v>>>32-7,v=G+he|0,O^=v<<9|v>>>32-9,v=O+G|0,I^=v<<13|v>>>32-13,v=I+O|0,he^=v<<18|v>>>32-18,v=Z+G|0,X^=v<<7|v>>>32-7,v=X+Z|0,J^=v<<9|v>>>32-9,v=J+X|0,G^=v<<13|v>>>32-13,v=G+J|0,Z^=v<<18|v>>>32-18,v=Y+V|0,S^=v<<7|v>>>32-7,v=S+Y|0,O^=v<<9|v>>>32-9,v=O+S|0,V^=v<<13|v>>>32-13,v=V+O|0,Y^=v<<18|v>>>32-18,v=D+R|0,I^=v<<7|v>>>32-7,v=I+D|0,P^=v<<9|v>>>32-9,v=P+I|0,R^=v<<13|v>>>32-13,v=R+P|0,D^=v<<18|v>>>32-18,v=he+_e|0,ne^=v<<7|v>>>32-7,v=ne+he|0,de^=v<<9|v>>>32-9,v=de+ne|0,_e^=v<<13|v>>>32-13,v=_e+de|0,he^=v<<18|v>>>32-18;o[0]=Z>>>0&255,o[1]=Z>>>8&255,o[2]=Z>>>16&255,o[3]=Z>>>24&255,o[4]=Y>>>0&255,o[5]=Y>>>8&255,o[6]=Y>>>16&255,o[7]=Y>>>24&255,o[8]=D>>>0&255,o[9]=D>>>8&255,o[10]=D>>>16&255,o[11]=D>>>24&255,o[12]=he>>>0&255,o[13]=he>>>8&255,o[14]=he>>>16&255,o[15]=he>>>24&255,o[16]=S>>>0&255,o[17]=S>>>8&255,o[18]=S>>>16&255,o[19]=S>>>24&255,o[20]=O>>>0&255,o[21]=O>>>8&255,o[22]=O>>>16&255,o[23]=O>>>24&255,o[24]=P>>>0&255,o[25]=P>>>8&255,o[26]=P>>>16&255,o[27]=P>>>24&255,o[28]=R>>>0&255,o[29]=R>>>8&255,o[30]=R>>>16&255,o[31]=R>>>24&255}function L(o,d,u,f){B(o,d,u,f)}function j(o,d,u,f){ee(o,d,u,f)}var q=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function xe(o,d,u,f,_,g,w){var N=new Uint8Array(16),z=new Uint8Array(64),Q,F;for(F=0;F<16;F++)N[F]=0;for(F=0;F<8;F++)N[F]=g[F];for(;_>=64;){for(L(z,N,w,q),F=0;F<64;F++)o[d+F]=u[f+F]^z[F];for(Q=1,F=8;F<16;F++)Q=Q+(N[F]&255)|0,N[F]=Q&255,Q>>>=8;_-=64,d+=64,f+=64}if(_>0)for(L(z,N,w,q),F=0;F<_;F++)o[d+F]=u[f+F]^z[F];return 0}function be(o,d,u,f,_){var g=new Uint8Array(16),w=new Uint8Array(64),N,z;for(z=0;z<16;z++)g[z]=0;for(z=0;z<8;z++)g[z]=f[z];for(;u>=64;){for(L(w,g,_,q),z=0;z<64;z++)o[d+z]=w[z];for(N=1,z=8;z<16;z++)N=N+(g[z]&255)|0,g[z]=N&255,N>>>=8;u-=64,d+=64}if(u>0)for(L(w,g,_,q),z=0;z<u;z++)o[d+z]=w[z];return 0}function me(o,d,u,f,_){var g=new Uint8Array(32);j(g,f,_,q);for(var w=new Uint8Array(8),N=0;N<8;N++)w[N]=f[N+16];return be(o,d,u,w,g)}function Ie(o,d,u,f,_,g,w){var N=new Uint8Array(32);j(N,g,w,q);for(var z=new Uint8Array(8),Q=0;Q<8;Q++)z[Q]=g[Q+16];return xe(o,d,u,f,_,z,N)}var ct=function(o){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var d,u,f,_,g,w,N,z;d=o[0]&255|(o[1]&255)<<8,this.r[0]=d&8191,u=o[2]&255|(o[3]&255)<<8,this.r[1]=(d>>>13|u<<3)&8191,f=o[4]&255|(o[5]&255)<<8,this.r[2]=(u>>>10|f<<6)&7939,_=o[6]&255|(o[7]&255)<<8,this.r[3]=(f>>>7|_<<9)&8191,g=o[8]&255|(o[9]&255)<<8,this.r[4]=(_>>>4|g<<12)&255,this.r[5]=g>>>1&8190,w=o[10]&255|(o[11]&255)<<8,this.r[6]=(g>>>14|w<<2)&8191,N=o[12]&255|(o[13]&255)<<8,this.r[7]=(w>>>11|N<<5)&8065,z=o[14]&255|(o[15]&255)<<8,this.r[8]=(N>>>8|z<<8)&8191,this.r[9]=z>>>5&127,this.pad[0]=o[16]&255|(o[17]&255)<<8,this.pad[1]=o[18]&255|(o[19]&255)<<8,this.pad[2]=o[20]&255|(o[21]&255)<<8,this.pad[3]=o[22]&255|(o[23]&255)<<8,this.pad[4]=o[24]&255|(o[25]&255)<<8,this.pad[5]=o[26]&255|(o[27]&255)<<8,this.pad[6]=o[28]&255|(o[29]&255)<<8,this.pad[7]=o[30]&255|(o[31]&255)<<8};ct.prototype.blocks=function(o,d,u){for(var f=this.fin?0:2048,_,g,w,N,z,Q,F,ke,W,ie,fe,ue,ae,se,ce,oe,Z,X,J,G=this.h[0],V=this.h[1],Y=this.h[2],S=this.h[3],O=this.h[4],P=this.h[5],R=this.h[6],D=this.h[7],I=this.h[8],ne=this.h[9],de=this.r[0],_e=this.r[1],he=this.r[2],v=this.r[3],ge=this.r[4],Ce=this.r[5],Te=this.r[6],ve=this.r[7],Se=this.r[8],Oe=this.r[9];u>=16;)_=o[d+0]&255|(o[d+1]&255)<<8,G+=_&8191,g=o[d+2]&255|(o[d+3]&255)<<8,V+=(_>>>13|g<<3)&8191,w=o[d+4]&255|(o[d+5]&255)<<8,Y+=(g>>>10|w<<6)&8191,N=o[d+6]&255|(o[d+7]&255)<<8,S+=(w>>>7|N<<9)&8191,z=o[d+8]&255|(o[d+9]&255)<<8,O+=(N>>>4|z<<12)&8191,P+=z>>>1&8191,Q=o[d+10]&255|(o[d+11]&255)<<8,R+=(z>>>14|Q<<2)&8191,F=o[d+12]&255|(o[d+13]&255)<<8,D+=(Q>>>11|F<<5)&8191,ke=o[d+14]&255|(o[d+15]&255)<<8,I+=(F>>>8|ke<<8)&8191,ne+=ke>>>5|f,W=0,ie=W,ie+=G*de,ie+=V*(5*Oe),ie+=Y*(5*Se),ie+=S*(5*ve),ie+=O*(5*Te),W=ie>>>13,ie&=8191,ie+=P*(5*Ce),ie+=R*(5*ge),ie+=D*(5*v),ie+=I*(5*he),ie+=ne*(5*_e),W+=ie>>>13,ie&=8191,fe=W,fe+=G*_e,fe+=V*de,fe+=Y*(5*Oe),fe+=S*(5*Se),fe+=O*(5*ve),W=fe>>>13,fe&=8191,fe+=P*(5*Te),fe+=R*(5*Ce),fe+=D*(5*ge),fe+=I*(5*v),fe+=ne*(5*he),W+=fe>>>13,fe&=8191,ue=W,ue+=G*he,ue+=V*_e,ue+=Y*de,ue+=S*(5*Oe),ue+=O*(5*Se),W=ue>>>13,ue&=8191,ue+=P*(5*ve),ue+=R*(5*Te),ue+=D*(5*Ce),ue+=I*(5*ge),ue+=ne*(5*v),W+=ue>>>13,ue&=8191,ae=W,ae+=G*v,ae+=V*he,ae+=Y*_e,ae+=S*de,ae+=O*(5*Oe),W=ae>>>13,ae&=8191,ae+=P*(5*Se),ae+=R*(5*ve),ae+=D*(5*Te),ae+=I*(5*Ce),ae+=ne*(5*ge),W+=ae>>>13,ae&=8191,se=W,se+=G*ge,se+=V*v,se+=Y*he,se+=S*_e,se+=O*de,W=se>>>13,se&=8191,se+=P*(5*Oe),se+=R*(5*Se),se+=D*(5*ve),se+=I*(5*Te),se+=ne*(5*Ce),W+=se>>>13,se&=8191,ce=W,ce+=G*Ce,ce+=V*ge,ce+=Y*v,ce+=S*he,ce+=O*_e,W=ce>>>13,ce&=8191,ce+=P*de,ce+=R*(5*Oe),ce+=D*(5*Se),ce+=I*(5*ve),ce+=ne*(5*Te),W+=ce>>>13,ce&=8191,oe=W,oe+=G*Te,oe+=V*Ce,oe+=Y*ge,oe+=S*v,oe+=O*he,W=oe>>>13,oe&=8191,oe+=P*_e,oe+=R*de,oe+=D*(5*Oe),oe+=I*(5*Se),oe+=ne*(5*ve),W+=oe>>>13,oe&=8191,Z=W,Z+=G*ve,Z+=V*Te,Z+=Y*Ce,Z+=S*ge,Z+=O*v,W=Z>>>13,Z&=8191,Z+=P*he,Z+=R*_e,Z+=D*de,Z+=I*(5*Oe),Z+=ne*(5*Se),W+=Z>>>13,Z&=8191,X=W,X+=G*Se,X+=V*ve,X+=Y*Te,X+=S*Ce,X+=O*ge,W=X>>>13,X&=8191,X+=P*v,X+=R*he,X+=D*_e,X+=I*de,X+=ne*(5*Oe),W+=X>>>13,X&=8191,J=W,J+=G*Oe,J+=V*Se,J+=Y*ve,J+=S*Te,J+=O*Ce,W=J>>>13,J&=8191,J+=P*ge,J+=R*v,J+=D*he,J+=I*_e,J+=ne*de,W+=J>>>13,J&=8191,W=(W<<2)+W|0,W=W+ie|0,ie=W&8191,W=W>>>13,fe+=W,G=ie,V=fe,Y=ue,S=ae,O=se,P=ce,R=oe,D=Z,I=X,ne=J,d+=16,u-=16;this.h[0]=G,this.h[1]=V,this.h[2]=Y,this.h[3]=S,this.h[4]=O,this.h[5]=P,this.h[6]=R,this.h[7]=D,this.h[8]=I,this.h[9]=ne},ct.prototype.finish=function(o,d){var u=new Uint16Array(10),f,_,g,w;if(this.leftover){for(w=this.leftover,this.buffer[w++]=1;w<16;w++)this.buffer[w]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(f=this.h[1]>>>13,this.h[1]&=8191,w=2;w<10;w++)this.h[w]+=f,f=this.h[w]>>>13,this.h[w]&=8191;for(this.h[0]+=f*5,f=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=f,f=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=f,u[0]=this.h[0]+5,f=u[0]>>>13,u[0]&=8191,w=1;w<10;w++)u[w]=this.h[w]+f,f=u[w]>>>13,u[w]&=8191;for(u[9]-=1<<13,_=(f^1)-1,w=0;w<10;w++)u[w]&=_;for(_=~_,w=0;w<10;w++)this.h[w]=this.h[w]&_|u[w];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,g=this.h[0]+this.pad[0],this.h[0]=g&65535,w=1;w<8;w++)g=(this.h[w]+this.pad[w]|0)+(g>>>16)|0,this.h[w]=g&65535;o[d+0]=this.h[0]>>>0&255,o[d+1]=this.h[0]>>>8&255,o[d+2]=this.h[1]>>>0&255,o[d+3]=this.h[1]>>>8&255,o[d+4]=this.h[2]>>>0&255,o[d+5]=this.h[2]>>>8&255,o[d+6]=this.h[3]>>>0&255,o[d+7]=this.h[3]>>>8&255,o[d+8]=this.h[4]>>>0&255,o[d+9]=this.h[4]>>>8&255,o[d+10]=this.h[5]>>>0&255,o[d+11]=this.h[5]>>>8&255,o[d+12]=this.h[6]>>>0&255,o[d+13]=this.h[6]>>>8&255,o[d+14]=this.h[7]>>>0&255,o[d+15]=this.h[7]>>>8&255},ct.prototype.update=function(o,d,u){var f,_;if(this.leftover){for(_=16-this.leftover,_>u&&(_=u),f=0;f<_;f++)this.buffer[this.leftover+f]=o[d+f];if(u-=_,d+=_,this.leftover+=_,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(u>=16&&(_=u-u%16,this.blocks(o,d,_),d+=_,u-=_),u){for(f=0;f<u;f++)this.buffer[this.leftover+f]=o[d+f];this.leftover+=u}};function Qe(o,d,u,f,_,g){var w=new ct(g);return w.update(u,f,_),w.finish(o,d),0}function ut(o,d,u,f,_,g){var w=new Uint8Array(16);return Qe(w,0,u,f,_,g),$(o,d,w,0)}function $e(o,d,u,f,_){var g;if(u<32)return-1;for(Ie(o,0,d,0,u,f,_),Qe(o,16,o,32,u-32,o),g=0;g<16;g++)o[g]=0;return 0}function pt(o,d,u,f,_){var g,w=new Uint8Array(32);if(u<32||(me(w,0,32,f,_),ut(d,16,d,32,u-32,w)!==0))return-1;for(Ie(o,0,d,0,u,f,_),g=0;g<32;g++)o[g]=0;return 0}function We(o,d){var u;for(u=0;u<16;u++)o[u]=d[u]|0}function gt(o){var d,u,f=1;for(d=0;d<16;d++)u=o[d]+f+65535,f=Math.floor(u/65536),o[d]=u-f*65536;o[0]+=f-1+37*(f-1)}function at(o,d,u){for(var f,_=~(u-1),g=0;g<16;g++)f=_&(o[g]^d[g]),o[g]^=f,d[g]^=f}function Ee(o,d){var u,f,_,g=n(),w=n();for(u=0;u<16;u++)w[u]=d[u];for(gt(w),gt(w),gt(w),f=0;f<2;f++){for(g[0]=w[0]-65517,u=1;u<15;u++)g[u]=w[u]-65535-(g[u-1]>>16&1),g[u-1]&=65535;g[15]=w[15]-32767-(g[14]>>16&1),_=g[15]>>16&1,g[14]&=65535,at(w,g,1-_)}for(u=0;u<16;u++)o[2*u]=w[u]&255,o[2*u+1]=w[u]>>8}function Ye(o,d){var u=new Uint8Array(32),f=new Uint8Array(32);return Ee(u,o),Ee(f,d),A(u,0,f,0)}function Mt(o){var d=new Uint8Array(32);return Ee(d,o),d[0]&1}function Rt(o,d){var u;for(u=0;u<16;u++)o[u]=d[2*u]+(d[2*u+1]<<8);o[15]&=32767}function Je(o,d,u){for(var f=0;f<16;f++)o[f]=d[f]+u[f]}function tt(o,d,u){for(var f=0;f<16;f++)o[f]=d[f]-u[f]}function we(o,d,u){var f,_,g=0,w=0,N=0,z=0,Q=0,F=0,ke=0,W=0,ie=0,fe=0,ue=0,ae=0,se=0,ce=0,oe=0,Z=0,X=0,J=0,G=0,V=0,Y=0,S=0,O=0,P=0,R=0,D=0,I=0,ne=0,de=0,_e=0,he=0,v=u[0],ge=u[1],Ce=u[2],Te=u[3],ve=u[4],Se=u[5],Oe=u[6],Ke=u[7],Ne=u[8],Me=u[9],Ue=u[10],je=u[11],qe=u[12],Ze=u[13],Ge=u[14],Ve=u[15];f=d[0],g+=f*v,w+=f*ge,N+=f*Ce,z+=f*Te,Q+=f*ve,F+=f*Se,ke+=f*Oe,W+=f*Ke,ie+=f*Ne,fe+=f*Me,ue+=f*Ue,ae+=f*je,se+=f*qe,ce+=f*Ze,oe+=f*Ge,Z+=f*Ve,f=d[1],w+=f*v,N+=f*ge,z+=f*Ce,Q+=f*Te,F+=f*ve,ke+=f*Se,W+=f*Oe,ie+=f*Ke,fe+=f*Ne,ue+=f*Me,ae+=f*Ue,se+=f*je,ce+=f*qe,oe+=f*Ze,Z+=f*Ge,X+=f*Ve,f=d[2],N+=f*v,z+=f*ge,Q+=f*Ce,F+=f*Te,ke+=f*ve,W+=f*Se,ie+=f*Oe,fe+=f*Ke,ue+=f*Ne,ae+=f*Me,se+=f*Ue,ce+=f*je,oe+=f*qe,Z+=f*Ze,X+=f*Ge,J+=f*Ve,f=d[3],z+=f*v,Q+=f*ge,F+=f*Ce,ke+=f*Te,W+=f*ve,ie+=f*Se,fe+=f*Oe,ue+=f*Ke,ae+=f*Ne,se+=f*Me,ce+=f*Ue,oe+=f*je,Z+=f*qe,X+=f*Ze,J+=f*Ge,G+=f*Ve,f=d[4],Q+=f*v,F+=f*ge,ke+=f*Ce,W+=f*Te,ie+=f*ve,fe+=f*Se,ue+=f*Oe,ae+=f*Ke,se+=f*Ne,ce+=f*Me,oe+=f*Ue,Z+=f*je,X+=f*qe,J+=f*Ze,G+=f*Ge,V+=f*Ve,f=d[5],F+=f*v,ke+=f*ge,W+=f*Ce,ie+=f*Te,fe+=f*ve,ue+=f*Se,ae+=f*Oe,se+=f*Ke,ce+=f*Ne,oe+=f*Me,Z+=f*Ue,X+=f*je,J+=f*qe,G+=f*Ze,V+=f*Ge,Y+=f*Ve,f=d[6],ke+=f*v,W+=f*ge,ie+=f*Ce,fe+=f*Te,ue+=f*ve,ae+=f*Se,se+=f*Oe,ce+=f*Ke,oe+=f*Ne,Z+=f*Me,X+=f*Ue,J+=f*je,G+=f*qe,V+=f*Ze,Y+=f*Ge,S+=f*Ve,f=d[7],W+=f*v,ie+=f*ge,fe+=f*Ce,ue+=f*Te,ae+=f*ve,se+=f*Se,ce+=f*Oe,oe+=f*Ke,Z+=f*Ne,X+=f*Me,J+=f*Ue,G+=f*je,V+=f*qe,Y+=f*Ze,S+=f*Ge,O+=f*Ve,f=d[8],ie+=f*v,fe+=f*ge,ue+=f*Ce,ae+=f*Te,se+=f*ve,ce+=f*Se,oe+=f*Oe,Z+=f*Ke,X+=f*Ne,J+=f*Me,G+=f*Ue,V+=f*je,Y+=f*qe,S+=f*Ze,O+=f*Ge,P+=f*Ve,f=d[9],fe+=f*v,ue+=f*ge,ae+=f*Ce,se+=f*Te,ce+=f*ve,oe+=f*Se,Z+=f*Oe,X+=f*Ke,J+=f*Ne,G+=f*Me,V+=f*Ue,Y+=f*je,S+=f*qe,O+=f*Ze,P+=f*Ge,R+=f*Ve,f=d[10],ue+=f*v,ae+=f*ge,se+=f*Ce,ce+=f*Te,oe+=f*ve,Z+=f*Se,X+=f*Oe,J+=f*Ke,G+=f*Ne,V+=f*Me,Y+=f*Ue,S+=f*je,O+=f*qe,P+=f*Ze,R+=f*Ge,D+=f*Ve,f=d[11],ae+=f*v,se+=f*ge,ce+=f*Ce,oe+=f*Te,Z+=f*ve,X+=f*Se,J+=f*Oe,G+=f*Ke,V+=f*Ne,Y+=f*Me,S+=f*Ue,O+=f*je,P+=f*qe,R+=f*Ze,D+=f*Ge,I+=f*Ve,f=d[12],se+=f*v,ce+=f*ge,oe+=f*Ce,Z+=f*Te,X+=f*ve,J+=f*Se,G+=f*Oe,V+=f*Ke,Y+=f*Ne,S+=f*Me,O+=f*Ue,P+=f*je,R+=f*qe,D+=f*Ze,I+=f*Ge,ne+=f*Ve,f=d[13],ce+=f*v,oe+=f*ge,Z+=f*Ce,X+=f*Te,J+=f*ve,G+=f*Se,V+=f*Oe,Y+=f*Ke,S+=f*Ne,O+=f*Me,P+=f*Ue,R+=f*je,D+=f*qe,I+=f*Ze,ne+=f*Ge,de+=f*Ve,f=d[14],oe+=f*v,Z+=f*ge,X+=f*Ce,J+=f*Te,G+=f*ve,V+=f*Se,Y+=f*Oe,S+=f*Ke,O+=f*Ne,P+=f*Me,R+=f*Ue,D+=f*je,I+=f*qe,ne+=f*Ze,de+=f*Ge,_e+=f*Ve,f=d[15],Z+=f*v,X+=f*ge,J+=f*Ce,G+=f*Te,V+=f*ve,Y+=f*Se,S+=f*Oe,O+=f*Ke,P+=f*Ne,R+=f*Me,D+=f*Ue,I+=f*je,ne+=f*qe,de+=f*Ze,_e+=f*Ge,he+=f*Ve,g+=38*X,w+=38*J,N+=38*G,z+=38*V,Q+=38*Y,F+=38*S,ke+=38*O,W+=38*P,ie+=38*R,fe+=38*D,ue+=38*I,ae+=38*ne,se+=38*de,ce+=38*_e,oe+=38*he,_=1,f=g+_+65535,_=Math.floor(f/65536),g=f-_*65536,f=w+_+65535,_=Math.floor(f/65536),w=f-_*65536,f=N+_+65535,_=Math.floor(f/65536),N=f-_*65536,f=z+_+65535,_=Math.floor(f/65536),z=f-_*65536,f=Q+_+65535,_=Math.floor(f/65536),Q=f-_*65536,f=F+_+65535,_=Math.floor(f/65536),F=f-_*65536,f=ke+_+65535,_=Math.floor(f/65536),ke=f-_*65536,f=W+_+65535,_=Math.floor(f/65536),W=f-_*65536,f=ie+_+65535,_=Math.floor(f/65536),ie=f-_*65536,f=fe+_+65535,_=Math.floor(f/65536),fe=f-_*65536,f=ue+_+65535,_=Math.floor(f/65536),ue=f-_*65536,f=ae+_+65535,_=Math.floor(f/65536),ae=f-_*65536,f=se+_+65535,_=Math.floor(f/65536),se=f-_*65536,f=ce+_+65535,_=Math.floor(f/65536),ce=f-_*65536,f=oe+_+65535,_=Math.floor(f/65536),oe=f-_*65536,f=Z+_+65535,_=Math.floor(f/65536),Z=f-_*65536,g+=_-1+37*(_-1),_=1,f=g+_+65535,_=Math.floor(f/65536),g=f-_*65536,f=w+_+65535,_=Math.floor(f/65536),w=f-_*65536,f=N+_+65535,_=Math.floor(f/65536),N=f-_*65536,f=z+_+65535,_=Math.floor(f/65536),z=f-_*65536,f=Q+_+65535,_=Math.floor(f/65536),Q=f-_*65536,f=F+_+65535,_=Math.floor(f/65536),F=f-_*65536,f=ke+_+65535,_=Math.floor(f/65536),ke=f-_*65536,f=W+_+65535,_=Math.floor(f/65536),W=f-_*65536,f=ie+_+65535,_=Math.floor(f/65536),ie=f-_*65536,f=fe+_+65535,_=Math.floor(f/65536),fe=f-_*65536,f=ue+_+65535,_=Math.floor(f/65536),ue=f-_*65536,f=ae+_+65535,_=Math.floor(f/65536),ae=f-_*65536,f=se+_+65535,_=Math.floor(f/65536),se=f-_*65536,f=ce+_+65535,_=Math.floor(f/65536),ce=f-_*65536,f=oe+_+65535,_=Math.floor(f/65536),oe=f-_*65536,f=Z+_+65535,_=Math.floor(f/65536),Z=f-_*65536,g+=_-1+37*(_-1),o[0]=g,o[1]=w,o[2]=N,o[3]=z,o[4]=Q,o[5]=F,o[6]=ke,o[7]=W,o[8]=ie,o[9]=fe,o[10]=ue,o[11]=ae,o[12]=se,o[13]=ce,o[14]=oe,o[15]=Z}function Xe(o,d){we(o,d,d)}function Nt(o,d){var u=n(),f;for(f=0;f<16;f++)u[f]=d[f];for(f=253;f>=0;f--)Xe(u,u),f!==2&&f!==4&&we(u,u,d);for(f=0;f<16;f++)o[f]=u[f]}function Wt(o,d){var u=n(),f;for(f=0;f<16;f++)u[f]=d[f];for(f=250;f>=0;f--)Xe(u,u),f!==1&&we(u,u,d);for(f=0;f<16;f++)o[f]=u[f]}function bt(o,d,u){var f=new Uint8Array(32),_=new Float64Array(80),g,w,N=n(),z=n(),Q=n(),F=n(),ke=n(),W=n();for(w=0;w<31;w++)f[w]=d[w];for(f[31]=d[31]&127|64,f[0]&=248,Rt(_,u),w=0;w<16;w++)z[w]=_[w],F[w]=N[w]=Q[w]=0;for(N[0]=F[0]=1,w=254;w>=0;--w)g=f[w>>>3]>>>(w&7)&1,at(N,z,g),at(Q,F,g),Je(ke,N,Q),tt(N,N,Q),Je(Q,z,F),tt(z,z,F),Xe(F,ke),Xe(W,N),we(N,Q,N),we(Q,z,ke),Je(ke,N,Q),tt(N,N,Q),Xe(z,N),tt(Q,F,W),we(N,Q,a),Je(N,N,F),we(Q,Q,N),we(N,F,W),we(F,z,_),Xe(z,ke),at(N,z,g),at(Q,F,g);for(w=0;w<16;w++)_[w+16]=N[w],_[w+32]=Q[w],_[w+48]=z[w],_[w+64]=F[w];var ie=_.subarray(32),fe=_.subarray(16);return Nt(ie,ie),we(fe,fe,ie),Ee(o,fe),0}function Ct(o,d){return bt(o,d,s)}function Ut(o,d){return r(d,32),Ct(o,d)}function Ot(o,d,u){var f=new Uint8Array(32);return bt(f,u,d),j(o,i,f,q)}var tn=$e,bn=pt;function nn(o,d,u,f,_,g){var w=new Uint8Array(32);return Ot(w,_,g),tn(o,d,u,f,w)}function Et(o,d,u,f,_,g){var w=new Uint8Array(32);return Ot(w,_,g),bn(o,d,u,f,w)}var rn=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function jt(o,d,u,f){for(var _=new Int32Array(16),g=new Int32Array(16),w,N,z,Q,F,ke,W,ie,fe,ue,ae,se,ce,oe,Z,X,J,G,V,Y,S,O,P,R,D,I,ne=o[0],de=o[1],_e=o[2],he=o[3],v=o[4],ge=o[5],Ce=o[6],Te=o[7],ve=d[0],Se=d[1],Oe=d[2],Ke=d[3],Ne=d[4],Me=d[5],Ue=d[6],je=d[7],qe=0;f>=128;){for(V=0;V<16;V++)Y=8*V+qe,_[V]=u[Y+0]<<24|u[Y+1]<<16|u[Y+2]<<8|u[Y+3],g[V]=u[Y+4]<<24|u[Y+5]<<16|u[Y+6]<<8|u[Y+7];for(V=0;V<80;V++)if(w=ne,N=de,z=_e,Q=he,F=v,ke=ge,W=Ce,ie=Te,fe=ve,ue=Se,ae=Oe,se=Ke,ce=Ne,oe=Me,Z=Ue,X=je,S=Te,O=je,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=(v>>>14|Ne<<32-14)^(v>>>18|Ne<<32-18)^(Ne>>>41-32|v<<32-(41-32)),O=(Ne>>>14|v<<32-14)^(Ne>>>18|v<<32-18)^(v>>>41-32|Ne<<32-(41-32)),P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,S=v&ge^~v&Ce,O=Ne&Me^~Ne&Ue,P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,S=rn[V*2],O=rn[V*2+1],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,S=_[V%16],O=g[V%16],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,J=D&65535|I<<16,G=P&65535|R<<16,S=J,O=G,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=(ne>>>28|ve<<32-28)^(ve>>>34-32|ne<<32-(34-32))^(ve>>>39-32|ne<<32-(39-32)),O=(ve>>>28|ne<<32-28)^(ne>>>34-32|ve<<32-(34-32))^(ne>>>39-32|ve<<32-(39-32)),P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,S=ne&de^ne&_e^de&_e,O=ve&Se^ve&Oe^Se&Oe,P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,ie=D&65535|I<<16,X=P&65535|R<<16,S=Q,O=se,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=J,O=G,P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,Q=D&65535|I<<16,se=P&65535|R<<16,de=w,_e=N,he=z,v=Q,ge=F,Ce=ke,Te=W,ne=ie,Se=fe,Oe=ue,Ke=ae,Ne=se,Me=ce,Ue=oe,je=Z,ve=X,V%16===15)for(Y=0;Y<16;Y++)S=_[Y],O=g[Y],P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=_[(Y+9)%16],O=g[(Y+9)%16],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,J=_[(Y+1)%16],G=g[(Y+1)%16],S=(J>>>1|G<<32-1)^(J>>>8|G<<32-8)^J>>>7,O=(G>>>1|J<<32-1)^(G>>>8|J<<32-8)^(G>>>7|J<<32-7),P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,J=_[(Y+14)%16],G=g[(Y+14)%16],S=(J>>>19|G<<32-19)^(G>>>61-32|J<<32-(61-32))^J>>>6,O=(G>>>19|J<<32-19)^(J>>>61-32|G<<32-(61-32))^(G>>>6|J<<32-6),P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,_[Y]=D&65535|I<<16,g[Y]=P&65535|R<<16;S=ne,O=ve,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[0],O=d[0],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[0]=ne=D&65535|I<<16,d[0]=ve=P&65535|R<<16,S=de,O=Se,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[1],O=d[1],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[1]=de=D&65535|I<<16,d[1]=Se=P&65535|R<<16,S=_e,O=Oe,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[2],O=d[2],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[2]=_e=D&65535|I<<16,d[2]=Oe=P&65535|R<<16,S=he,O=Ke,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[3],O=d[3],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[3]=he=D&65535|I<<16,d[3]=Ke=P&65535|R<<16,S=v,O=Ne,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[4],O=d[4],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[4]=v=D&65535|I<<16,d[4]=Ne=P&65535|R<<16,S=ge,O=Me,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[5],O=d[5],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[5]=ge=D&65535|I<<16,d[5]=Me=P&65535|R<<16,S=Ce,O=Ue,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[6],O=d[6],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[6]=Ce=D&65535|I<<16,d[6]=Ue=P&65535|R<<16,S=Te,O=je,P=O&65535,R=O>>>16,D=S&65535,I=S>>>16,S=o[7],O=d[7],P+=O&65535,R+=O>>>16,D+=S&65535,I+=S>>>16,R+=P>>>16,D+=R>>>16,I+=D>>>16,o[7]=Te=D&65535|I<<16,d[7]=je=P&65535|R<<16,qe+=128,f-=128}return f}function nt(o,d,u){var f=new Int32Array(8),_=new Int32Array(8),g=new Uint8Array(256),w,N=u;for(f[0]=1779033703,f[1]=3144134277,f[2]=1013904242,f[3]=2773480762,f[4]=1359893119,f[5]=2600822924,f[6]=528734635,f[7]=1541459225,_[0]=4089235720,_[1]=2227873595,_[2]=4271175723,_[3]=1595750129,_[4]=2917565137,_[5]=725511199,_[6]=4215389547,_[7]=327033209,jt(f,_,d,u),u%=128,w=0;w<u;w++)g[w]=d[N-u+w];for(g[u]=128,u=256-128*(u<112?1:0),g[u-9]=0,E(g,u-8,N/536870912|0,N<<3),jt(f,_,g,u),w=0;w<8;w++)E(o,8*w,f[w],_[w]);return 0}function it(o,d){var u=n(),f=n(),_=n(),g=n(),w=n(),N=n(),z=n(),Q=n(),F=n();tt(u,o[1],o[0]),tt(F,d[1],d[0]),we(u,u,F),Je(f,o[0],o[1]),Je(F,d[0],d[1]),we(f,f,F),we(_,o[3],d[3]),we(_,_,p),we(g,o[2],d[2]),Je(g,g,g),tt(w,f,u),tt(N,g,_),Je(z,g,_),Je(Q,f,u),we(o[0],w,N),we(o[1],Q,z),we(o[2],z,N),we(o[3],w,Q)}function ft(o,d,u){var f;for(f=0;f<4;f++)at(o[f],d[f],u)}function Lt(o,d){var u=n(),f=n(),_=n();Nt(_,d[2]),we(u,d[0],_),we(f,d[1],_),Ee(o,f),o[31]^=Mt(u)<<7}function re(o,d,u){var f,_;for(We(o[0],l),We(o[1],c),We(o[2],c),We(o[3],l),_=255;_>=0;--_)f=u[_/8|0]>>(_&7)&1,ft(o,d,f),it(d,o),it(o,o),ft(o,d,f)}function Re(o,d){var u=[n(),n(),n(),n()];We(u[0],b),We(u[1],m),We(u[2],c),we(u[3],b,m),re(o,u,d)}function zt(o,d,u){var f=new Uint8Array(64),_=[n(),n(),n(),n()],g;for(u||r(d,32),nt(f,d,32),f[0]&=248,f[31]&=127,f[31]|=64,Re(_,f),Lt(o,_),g=0;g<32;g++)d[g+32]=o[g];return 0}var Zt=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function on(o,d){var u,f,_,g;for(f=63;f>=32;--f){for(u=0,_=f-32,g=f-12;_<g;++_)d[_]+=u-16*d[f]*Zt[_-(f-32)],u=Math.floor((d[_]+128)/256),d[_]-=u*256;d[_]+=u,d[f]=0}for(u=0,_=0;_<32;_++)d[_]+=u-(d[31]>>4)*Zt[_],u=d[_]>>8,d[_]&=255;for(_=0;_<32;_++)d[_]-=u*Zt[_];for(f=0;f<32;f++)d[f+1]+=d[f]>>8,o[f]=d[f]&255}function ln(o){var d=new Float64Array(64),u;for(u=0;u<64;u++)d[u]=o[u];for(u=0;u<64;u++)o[u]=0;on(o,d)}function Pe(o,d,u,f){var _=new Uint8Array(64),g=new Uint8Array(64),w=new Uint8Array(64),N,z,Q=new Float64Array(64),F=[n(),n(),n(),n()];nt(_,f,32),_[0]&=248,_[31]&=127,_[31]|=64;var ke=u+64;for(N=0;N<u;N++)o[64+N]=d[N];for(N=0;N<32;N++)o[32+N]=_[32+N];for(nt(w,o.subarray(32),u+32),ln(w),Re(F,w),Lt(o,F),N=32;N<64;N++)o[N]=f[N];for(nt(g,o,u+64),ln(g),N=0;N<64;N++)Q[N]=0;for(N=0;N<32;N++)Q[N]=w[N];for(N=0;N<32;N++)for(z=0;z<32;z++)Q[N+z]+=g[N]*_[z];return on(o.subarray(32),Q),ke}function et(o,d){var u=n(),f=n(),_=n(),g=n(),w=n(),N=n(),z=n();return We(o[2],c),Rt(o[1],d),Xe(_,o[1]),we(g,_,h),tt(_,_,o[2]),Je(g,o[2],g),Xe(w,g),Xe(N,w),we(z,N,w),we(u,z,_),we(u,u,g),Wt(u,u),we(u,u,_),we(u,u,g),we(u,u,g),we(o[0],u,g),Xe(f,o[0]),we(f,f,g),Ye(f,_)&&we(o[0],o[0],y),Xe(f,o[0]),we(f,f,g),Ye(f,_)?-1:(Mt(o[0])===d[31]>>7&&tt(o[0],l,o[0]),we(o[3],o[0],o[1]),0)}function fn(o,d,u,f){var _,g=new Uint8Array(32),w=new Uint8Array(64),N=[n(),n(),n(),n()],z=[n(),n(),n(),n()];if(u<64||et(z,f))return-1;for(_=0;_<u;_++)o[_]=d[_];for(_=0;_<32;_++)o[_+32]=f[_];if(nt(w,o,u),ln(w),re(N,z,w),Re(z,d.subarray(32)),it(N,z),Lt(g,N),u-=64,A(d,0,g,0)){for(_=0;_<u;_++)o[_]=0;return-1}for(_=0;_<u;_++)o[_]=d[_+64];return u}var sn=32,Bt=24,Gt=32,Dt=16,Vt=32,cn=32,Qt=32,Xt=32,wn=32,Hn=Bt,Or=Gt,kr=Dt,wt=64,kt=32,$t=64,xn=32,An=64;e.lowlevel={crypto_core_hsalsa20:j,crypto_stream_xor:Ie,crypto_stream:me,crypto_stream_salsa20_xor:xe,crypto_stream_salsa20:be,crypto_onetimeauth:Qe,crypto_onetimeauth_verify:ut,crypto_verify_16:$,crypto_verify_32:A,crypto_secretbox:$e,crypto_secretbox_open:pt,crypto_scalarmult:bt,crypto_scalarmult_base:Ct,crypto_box_beforenm:Ot,crypto_box_afternm:tn,crypto_box:nn,crypto_box_open:Et,crypto_box_keypair:Ut,crypto_hash:nt,crypto_sign:Pe,crypto_sign_keypair:zt,crypto_sign_open:fn,crypto_secretbox_KEYBYTES:sn,crypto_secretbox_NONCEBYTES:Bt,crypto_secretbox_ZEROBYTES:Gt,crypto_secretbox_BOXZEROBYTES:Dt,crypto_scalarmult_BYTES:Vt,crypto_scalarmult_SCALARBYTES:cn,crypto_box_PUBLICKEYBYTES:Qt,crypto_box_SECRETKEYBYTES:Xt,crypto_box_BEFORENMBYTES:wn,crypto_box_NONCEBYTES:Hn,crypto_box_ZEROBYTES:Or,crypto_box_BOXZEROBYTES:kr,crypto_sign_BYTES:wt,crypto_sign_PUBLICKEYBYTES:kt,crypto_sign_SECRETKEYBYTES:$t,crypto_sign_SEEDBYTES:xn,crypto_hash_BYTES:An,gf:n,D:h,L:Zt,pack25519:Ee,unpack25519:Rt,M:we,A:Je,S:Xe,Z:tt,pow2523:Wt,add:it,set25519:We,modL:on,scalarmult:re,scalarbase:Re};function Jn(o,d){if(o.length!==sn)throw new Error("bad key size");if(d.length!==Bt)throw new Error("bad nonce size")}function Cr(o,d){if(o.length!==Qt)throw new Error("bad public key size");if(d.length!==Xt)throw new Error("bad secret key size")}function rt(){for(var o=0;o<arguments.length;o++)if(!(arguments[o]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Wn(o){for(var d=0;d<o.length;d++)o[d]=0}e.randomBytes=function(o){var d=new Uint8Array(o);return r(d,o),d},e.secretbox=function(o,d,u){rt(o,d,u),Jn(u,d);for(var f=new Uint8Array(Gt+o.length),_=new Uint8Array(f.length),g=0;g<o.length;g++)f[g+Gt]=o[g];return $e(_,f,f.length,d,u),_.subarray(Dt)},e.secretbox.open=function(o,d,u){rt(o,d,u),Jn(u,d);for(var f=new Uint8Array(Dt+o.length),_=new Uint8Array(f.length),g=0;g<o.length;g++)f[g+Dt]=o[g];return f.length<32||pt(_,f,f.length,d,u)!==0?null:_.subarray(Gt)},e.secretbox.keyLength=sn,e.secretbox.nonceLength=Bt,e.secretbox.overheadLength=Dt,e.scalarMult=function(o,d){if(rt(o,d),o.length!==cn)throw new Error("bad n size");if(d.length!==Vt)throw new Error("bad p size");var u=new Uint8Array(Vt);return bt(u,o,d),u},e.scalarMult.base=function(o){if(rt(o),o.length!==cn)throw new Error("bad n size");var d=new Uint8Array(Vt);return Ct(d,o),d},e.scalarMult.scalarLength=cn,e.scalarMult.groupElementLength=Vt,e.box=function(o,d,u,f){var _=e.box.before(u,f);return e.secretbox(o,d,_)},e.box.before=function(o,d){rt(o,d),Cr(o,d);var u=new Uint8Array(wn);return Ot(u,o,d),u},e.box.after=e.secretbox,e.box.open=function(o,d,u,f){var _=e.box.before(u,f);return e.secretbox.open(o,d,_)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var o=new Uint8Array(Qt),d=new Uint8Array(Xt);return Ut(o,d),{publicKey:o,secretKey:d}},e.box.keyPair.fromSecretKey=function(o){if(rt(o),o.length!==Xt)throw new Error("bad secret key size");var d=new Uint8Array(Qt);return Ct(d,o),{publicKey:d,secretKey:new Uint8Array(o)}},e.box.publicKeyLength=Qt,e.box.secretKeyLength=Xt,e.box.sharedKeyLength=wn,e.box.nonceLength=Hn,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(o,d){if(rt(o,d),d.length!==$t)throw new Error("bad secret key size");var u=new Uint8Array(wt+o.length);return Pe(u,o,o.length,d),u},e.sign.open=function(o,d){if(rt(o,d),d.length!==kt)throw new Error("bad public key size");var u=new Uint8Array(o.length),f=fn(u,o,o.length,d);if(f<0)return null;for(var _=new Uint8Array(f),g=0;g<_.length;g++)_[g]=u[g];return _},e.sign.detached=function(o,d){for(var u=e.sign(o,d),f=new Uint8Array(wt),_=0;_<f.length;_++)f[_]=u[_];return f},e.sign.detached.verify=function(o,d,u){if(rt(o,d,u),d.length!==wt)throw new Error("bad signature size");if(u.length!==kt)throw new Error("bad public key size");var f=new Uint8Array(wt+o.length),_=new Uint8Array(wt+o.length),g;for(g=0;g<wt;g++)f[g]=d[g];for(g=0;g<o.length;g++)f[g+wt]=o[g];return fn(_,f,f.length,u)>=0},e.sign.keyPair=function(){var o=new Uint8Array(kt),d=new Uint8Array($t);return zt(o,d),{publicKey:o,secretKey:d}},e.sign.keyPair.fromSecretKey=function(o){if(rt(o),o.length!==$t)throw new Error("bad secret key size");for(var d=new Uint8Array(kt),u=0;u<d.length;u++)d[u]=o[32+u];return{publicKey:d,secretKey:new Uint8Array(o)}},e.sign.keyPair.fromSeed=function(o){if(rt(o),o.length!==xn)throw new Error("bad seed size");for(var d=new Uint8Array(kt),u=new Uint8Array($t),f=0;f<32;f++)u[f]=o[f];return zt(d,u,!0),{publicKey:d,secretKey:u}},e.sign.publicKeyLength=kt,e.sign.secretKeyLength=$t,e.sign.seedLength=xn,e.sign.signatureLength=wt,e.hash=function(o){rt(o);var d=new Uint8Array(An);return nt(d,o,o.length),d},e.hash.hashLength=An,e.verify=function(o,d){return rt(o,d),o.length===0||d.length===0||o.length!==d.length?!1:x(o,0,d,0,o.length)===0},e.setPRNG=function(o){r=o},function(){var o=typeof self<"u"?self.crypto||self.msCrypto:null;if(o&&o.getRandomValues){var d=65536;e.setPRNG(function(u,f){var _,g=new Uint8Array(f);for(_=0;_<f;_+=d)o.getRandomValues(g.subarray(_,_+Math.min(f-_,d)));for(_=0;_<f;_++)u[_]=g[_];Wn(g)})}else typeof Fs<"u"&&(o=Hu,o&&o.randomBytes&&e.setPRNG(function(u,f){var _,g=o.randomBytes(f);for(_=0;_<f;_++)u[_]=g[_];Wn(g)}))}()})(t.exports?t.exports:self.nacl=self.nacl||{})}),Fn=Ys(function(t){(function(e,n){t.exports?t.exports=n():(e.nacl||(e.nacl={}),e.nacl.util=n())})(Ku,function(){var e={};function n(r){if(!/^(?:[A-Za-z0-9+\/]{2}[A-Za-z0-9+\/]{2})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/.test(r))throw new TypeError("invalid encoding")}return e.decodeUTF8=function(r){if(typeof r!="string")throw new TypeError("expected string");var i,s=unescape(encodeURIComponent(r)),l=new Uint8Array(s.length);for(i=0;i<s.length;i++)l[i]=s.charCodeAt(i);return l},e.encodeUTF8=function(r){var i,s=[];for(i=0;i<r.length;i++)s.push(String.fromCharCode(r[i]));return decodeURIComponent(escape(s.join("")))},typeof atob>"u"?typeof Buffer.from<"u"?(e.encodeBase64=function(r){return Buffer.from(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(Buffer.from(r,"base64"),0))}):(e.encodeBase64=function(r){return new Buffer(r).toString("base64")},e.decodeBase64=function(r){return n(r),new Uint8Array(Array.prototype.slice.call(new Buffer(r,"base64"),0))}):(e.encodeBase64=function(r){var i,s=[],l=r.length;for(i=0;i<l;i++)s.push(String.fromCharCode(r[i]));return btoa(s.join(""))},e.decodeBase64=function(r){n(r);var i,s=atob(r),l=new Uint8Array(s.length);for(i=0;i<s.length;i++)l[i]=s.charCodeAt(i);return l}),e})});function Ju(t){return typeof t>"u"||t==null?[]:Array.isArray(t)?t:[t]}function yr(t){return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}function Qr(t){const e=t.match(/.{1,2}(?=(.{2})+(?!.))|.{1,2}$/g);return new Uint8Array(e.map(n=>parseInt(n,16)))}function Hs(t,e=8){const n=new Array(e).fill(0);for(let r=0;r<n.length;r++){const i=t&255;n[r]=i,t=(t-i)/256}return n}Ht.util=Fn;function Js(){const t=Ht.box.keyPair(),e=yr(t.publicKey),n=yr(t.secretKey);return{privateKey:t.secretKey,publicKey:t.publicKey,privateKeyHex:n,publicKeyHex:e}}Ht.util=Fn;function Ws(t){return t.publicKeyHex&&!t.publicKey&&(t.publicKey=Qr(t.publicKeyHex)),t.privateKeyHex&&!t.privateKey&&(t.privateKey=Qr(t.privateKeyHex)),t}function Wu(t){return t!=null&&t.constructor==Object}function Zu(t,e){const n=new Uint8Array(t.length+1),r=new Uint8Array(1);return r[0]=e,n.set(r),n.set(t,r.length),n}var Gu=Cn;/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Object} opts Optional options object that alters the output.
 * @license MIT (© Joyent)
 */function Cn(t,e){var n={seen:[],stylize:Vu};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),Zs(e)?n.showHidden=e:e&&i0(n,e),jn(n.showHidden)&&(n.showHidden=!1),jn(n.depth)&&(n.depth=2),jn(n.colors)&&(n.colors=!1),jn(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Qu),gr(n,t,n.depth)}Cn.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]};Cn.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function Vu(t,e){return t}function Zs(t){return typeof t=="boolean"}function jn(t){return t===void 0}function Qu(t,e){var n=Cn.styles[e];return n?"\x1B["+Cn.colors[n][0]+"m"+t+"\x1B["+Cn.colors[n][1]+"m":t}function jr(t){return typeof t=="function"}function Gs(t){return typeof t=="string"}function Xu(t){return typeof t=="number"}function Vs(t){return t===null}function Qs(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Lr(t){return Sr(t)&&hi(t)==="[object RegExp]"}function Sr(t){return typeof t=="object"&&t!==null}function zr(t){return Sr(t)&&(hi(t)==="[object Error]"||t instanceof Error)}function Vf(t){return Sr(t)&&hi(t)==="[object Date]"}function hi(t){return Object.prototype.toString.call(t)}function e0(t){var e={};return t.forEach(function(n,r){e[n]=!0}),e}function t0(t,e,n,r,i){for(var s=[],l=0,c=e.length;l<c;++l)Qs(e,String(l))?s.push(Xr(t,e,n,r,String(l),!0)):s.push("");return i.forEach(function(a){a.match(/^\d+$/)||s.push(Xr(t,e,n,r,a,!0))}),s}function Br(t){return"["+Error.prototype.toString.call(t)+"]"}function gr(t,e,n){if(t.customInspect&&e&&jr(e.inspect)&&e.inspect!==Cn&&!(e.constructor&&e.constructor.prototype===e)){var r=e.inspect(n,t);return Gs(r)||(r=gr(t,r,n)),r}var i=n0(t,e);if(i)return i;var s=Object.keys(e),l=e0(s);try{t.showHidden&&Object.getOwnPropertyNames&&(s=Object.getOwnPropertyNames(e))}catch{}if(zr(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return Br(e);if(s.length===0){if(jr(e)){var c=e.name?": "+e.name:"";return t.stylize("[Function"+c+"]","special")}if(Lr(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(Vf(e))return t.stylize(Date.prototype.toString.call(e),"date");if(zr(e))return Br(e)}var a="",h=!1,p=["{","}"];if(Array.isArray(e)&&(h=!0,p=["[","]"]),jr(e)){var b=e.name?": "+e.name:"";a=" [Function"+b+"]"}if(Lr(e)&&(a=" "+RegExp.prototype.toString.call(e)),Vf(e)&&(a=" "+Date.prototype.toUTCString.call(e)),zr(e)&&(a=" "+Br(e)),s.length===0&&(!h||e.length==0))return p[0]+a+p[1];if(n<0)return Lr(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var m;return h?m=t0(t,e,n,l,s):m=s.map(function(y){return Xr(t,e,n,l,y,h)}),t.seen.pop(),r0(m,a,p)}function Xr(t,e,n,r,i,s){var l,c,a;a={value:void 0};try{a.value=e[i]}catch{}try{Object.getOwnPropertyDescriptor&&(a=Object.getOwnPropertyDescriptor(e,i)||a)}catch{}if(a.get?a.set?c=t.stylize("[Getter/Setter]","special"):c=t.stylize("[Getter]","special"):a.set&&(c=t.stylize("[Setter]","special")),Qs(r,i)||(l="["+i+"]"),c||(t.seen.indexOf(a.value)<0?(Vs(n)?c=gr(t,a.value,null):c=gr(t,a.value,n-1),c.indexOf(`
`)>-1&&(s?c=c.split(`
`).map(function(h){return"  "+h}).join(`
`).substr(2):c=`
`+c.split(`
`).map(function(h){return"   "+h}).join(`
`))):c=t.stylize("[Circular]","special")),jn(l)){if(s&&i.match(/^\d+$/))return c;l=JSON.stringify(""+i),l.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(l=l.substr(1,l.length-2),l=t.stylize(l,"name")):(l=l.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),l=t.stylize(l,"string"))}return l+": "+c}function n0(t,e){if(jn(e))return t.stylize("undefined","undefined");if(Gs(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(Xu(e))return t.stylize(""+e,"number");if(Zs(e))return t.stylize(""+e,"boolean");if(Vs(e))return t.stylize("null","null")}function r0(t,e,n){var r=t.reduce(function(i,s){return s.indexOf(`
`)>=0,i+s.replace(/\u001b\[\d\d?m/g,"").length+1},0);return r>60?n[0]+(e===""?"":e+`
 `)+" "+t.join(`,
  `)+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function i0(t,e){if(!e||!Sr(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}function un(t,e,...n){try{e==console.log?e(`${new Date().toLocaleString()} → ${Gu(...n).replace(/^'/,"").replace(/'$/,"")}`):typeof e=="function"?e(...n):e&&e.logOutput(t,{source:"connectome"},...n)}catch(r){console.log(r)}}class f0{write(e,...n){un(void 0,e,...n)}red(e,...n){un("red",e,...n)}green(e,...n){un("green",e,...n)}yellow(e,...n){un("yellow",e,...n)}blue(e,...n){un("blue",e,...n)}cyan(e,...n){un("cyan",e,...n)}magenta(e,...n){un("magenta",e,...n)}gray(e,...n){un("gray",e,...n)}white(e,...n){un("white",e,...n)}}var He=new f0;Ht.util=Fn;function s0({data:t,connector:e}){const{log:n}=e;Wu(t)&&(t=JSON.stringify(t));const r=new Uint8Array(Hs(2*e.sentCount,24));if(e.closed())He.red(n,`⚠️ Warning: "${t}" was not sent because connector is not ready`);else if(e.sentCount>1){let i=0;typeof t=="string"&&(i=1);const s=i==1?Ht.util.decodeUTF8(t):t,l=Zu(s,i),c=Ht.secretbox(l,r,e.sharedSecret);e.verbose&&(He.green(n,`Connector ${e.endpoint} → Sending encrypted message #${e.sentCount} ↴`),He.gray(n,t)),e.connection.websocket.send(c)}else e.verbose&&(He.green(n,`Connector ${e.endpoint} → Sending message #${e.sentCount} ↴`),He.cyan(n,t)),e.connection.websocket.send(t)}Ht.util=Fn;function o0(t){return Object.keys(t).includes("result")||Object.keys(t).includes("error")}function Xs({jsonData:t,encryptedData:e,rawMessage:n,wasEncrypted:r,connector:i}){const{log:s}=i;i.lastMessageAt=Date.now();const l=new Uint8Array(Hs(2*i.receivedCount+1,24));if(i.verbose&&!r&&He.magenta(s,`Connector ${i.endpoint} → Received message #${i.receivedCount} ↴`),t)t.jsonrpc?o0(t)?(i.verbose&&!r&&(He.magenta(s,`Connector ${i.endpoint} received plain-text rpc result ↴`),He.gray(s,t)),i.rpcClient.jsonrpcMsgReceive(n)):i.emit("json_rpc",n):i.emit("receive",{jsonData:t,rawMessage:n});else if(e){i.verbose=="extra"&&(He.magenta(s,`Connector ${i.endpoint} received bytes ↴`),He.cyan(s,e),He.green(s,JSON.stringify(e)),He.gray(s,`Connector ${i.endpoint} decrypting with shared secret ${i.sharedSecret}...`)),i.sharedSecret||He.red(s,`Connector ${i.endpoint} missing sharedSecret - should not happen...`);const c=Ht.secretbox.open(e,l,i.sharedSecret),a=c[0],h=c.subarray(1);if(a==1){const p=Ht.util.encodeUTF8(h);i.verbose&&He.yellow(s,`Connector ${i.endpoint} received message: ${p}`);try{const b=JSON.parse(p);b.jsonrpc?Xs({jsonData:b,rawMessage:p,wasEncrypted:!0,connector:i}):b.state?i.emit("receive_state",b.state):b.diff?i.emit("receive_diff",b.diff):b.signal?i.emit(b.signal,b.data):b.stateField?i.emit("receive_state_field",b.stateField):i.emit("receive",{jsonData:b,rawMessage:p})}catch(b){throw He.red(s,"Couldn't parse json message although the flag was for string ..."),He.red(s,p),b}}else i.verbose&&He.yellow(s,`Connector ${i.endpoint} received binary data`),i.emit("receive_binary",h)}}Ht.util=Fn;const l0=1;function c0({connector:t,afterFirstStep:e=()=>{}}){const{clientPrivateKey:n,clientPublicKey:r,clientPublicKeyHex:i,protocol:s,tag:l,endpoint:c,verbose:a}=t;return new Promise((h,p)=>{t.remoteObject("Auth").call("exchangePubkeys",{pubkey:i}).then(b=>{const m=Ht.box.before(Qr(b),n);if(e({sharedSecret:m,remotePubkeyHex:b}),a&&He.write(t.log,`Connector ${c} established shared secret through diffie-hellman exchange.`),t.connection.websocket.readyState==l0)t.remoteObject("Auth").call("finalizeHandshake",{protocol:s}).then(y=>{if(y&&y.error)console.log(y.error);else{h();const E=l?` (${l})`:"";He.cyan(t.log,`☑️  ${c}${E} ✓ Connection #${t.connection.websocket.__id} [ ${s||'"no-name"'} ] ready`)}}).catch(p);else{const y=l?` (${l})`:"";He.yellow(t.log,`${c}${y} ✖ Connection [ ${s||'"no-name"'} ] closed just before finalizeHandshake step`)}}).catch(p)})}class a0 extends Er{constructor(e){super(),this.connector=e}send(...e){this.connector.send(...e)}}var Jt={PARSE_ERROR:-32700,INVALID_REQUEST:-32600,METHOD_NOT_FOUND:-32601,INVALID_PARAMS:-32602,REMOTE_INTERNAL_ERROR:-32603,TIMEOUT:-32701};class eo{constructor({transports:e}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transportsToRegister=e,this.methods={}}setMethodPrefix(e){this.methodPrefix=e}expose(e){this.methods=e}registerTransport(e){e.onData(this._processRequest.bind(this,e))}async _processRequest(e,n){const r=JSON.parse(n);let i;return Array.isArray(r)?i=await Promise.all(r.map(s=>this._callMethod(s,e))):i=await this._callMethod(r,e),JSON.stringify(i)}async _callMethod(e,n){if(!e.hasOwnProperty("method"))return;const{method:i,params:s=[],id:l}=e;let c=i;if(c.includes("::")){const[p,b]=c.split("::");if(c=b,this.methodPrefix&&p!=this.methodPrefix)return}const a=!this.methods[c]||typeof this.methods[c]!="function"||c==="constructor"||c.startsWith("_")||this.methods[c]===Object.prototype[c];let h={};if(a)h={jsonrpc:"2.0",id:l,error:{code:Jt.METHOD_NOT_FOUND,message:`Method [${c}] not found on remote target object`}};else{this.currentTransport=n;try{const p=await this.methods[c].apply(this.methods,s);if(!l)return;h={jsonrpc:"2.0",result:typeof p>"u"?null:p,id:l}}catch(p){console.log(`Exposed RPC method ${i} internal error:`),console.log(p),console.log("Sending this error as a result to calling client ..."),h={jsonrpc:"2.0",error:{code:Jt.REMOTE_INTERNAL_ERROR,message:`Method [${i}] internal error: ${p.stack}`},id:l}}}return h}run(){for(const e of this.transportsToRegister)this.registerTransport(e);this.transportsToRegister=[]}}class Nn extends Error{constructor(e={}){if(super(),!e.code)throw new Error("Code required");if(!e.message)throw new Error("Message required");this.code=e.code,this.message=e.message}}class u0 extends Nn{constructor(e){super({code:Jt.METHOD_NOT_FOUND,message:e||"Method not found"})}}class d0 extends Nn{constructor(){super({code:Jt.INVALID_PARAMS,message:"Invalid params"})}}class h0 extends Nn{constructor(e){super({code:Jt.REMOTE_INTERNAL_ERROR,message:`Error originating at remote endpoint: ${e}`||"Remote Internal error"})}}class _0 extends Nn{constructor(){super({code:Jt.PARSE_ERROR,message:"Parse error"})}}class p0 extends Nn{constructor(){super({code:Jt.INVALID_REQUEST,message:"Invalid request"})}}class to extends Nn{}class b0 extends to{constructor(e,n){super({code:Jt.TIMEOUT,message:`Request exceeded maximum execution time (${n}ms): ${e}`})}}var Kr={Base:Nn,MethodNotFound:u0,InvalidRequest:p0,InvalidParams:d0,RemoteInternalError:h0,ServerError:to,ParseError:_0,RequestTimeout:b0};class no{constructor({transport:e,requestTimeout:n=2e4}){if(!e)throw new Error("TRANSPORT_REQUIRED");this.transport=e,this.requestTimeout=n,this.pendingRequest={},this.initialized=!1}setMethodPrefix(e){this.methodPrefix=e}async callMethod(e,n){this._init();const r=this.methodPrefix?`${this.methodPrefix}::${e}`:e,i=this._makeRequestObject({method:r,params:n});return this._sendRequest({object:i,id:i.id})}notify(e,n){this._init();const r=this._makeRequestObject({method:e,params:n,mode:"notify"});return this.transport.sendData(JSON.stringify(r)),!0}async runBatch(e){const n=this._generateId();let r=!0;const i=[];for(const[s,l,c]of e){const a=this._makeRequestObject({method:s,params:l,mode:c,batchId:n});a.id&&(r=!1),i.push(a)}return r?this.transport.sendData(JSON.stringify(i)):this._sendRequest({object:i,id:n})}_init(){this.initialized||(this.transport.onData(this._processResponse.bind(this)),this.initialized=!0)}_sendRequest({object:e,id:n}){const r=JSON.stringify(e);return new Promise((i,s)=>{this.pendingRequest[n]={resolve:i,reject:s,sentObject:e},setTimeout(()=>{this.pendingRequest[n]&&(delete this.pendingRequest[n],s(new Kr.RequestTimeout(r,this.requestTimeout)))},this.requestTimeout);try{this.transport.sendData(r)}catch(l){delete this.pendingRequest[n],s(l)}})}_processResponse(e){const n=JSON.parse(e);Array.isArray(n)?this._processBatchResponse(n):this._processSingleCallResponse(n)}_processSingleCallResponse(e){const n=e.hasOwnProperty("result")||!1,r=e.hasOwnProperty("error");if(!n&&!r)return;const i=this.pendingRequest[e.id];if(delete this.pendingRequest[e.id],!!i){if(n)i.resolve(e.result);else if(r){const s=this._makeErrorObject(e.error);i.reject(s)}}}_processBatchResponse(e){let n;const r={},i=[];for(const h of e)h.id?(n||(n=h.id.split("|")[0]),r[h.id]=h):h.error&&i.push(h.error);if(!this.pendingRequest[n])return;const{sentObject:s,resolve:l}=this.pendingRequest[n];delete this.pendingRequest[n];const c=[];let a=0;for(const h of s){if(!h.id){c.push(null);continue}const p=r[h.id];p?p.hasOwnProperty("result")||!1?c.push({success:!0,result:p.result}):c.push({success:!1,result:this._makeErrorObject(p.error)}):(c.push({success:!1,error:this._makeErrorObject(i[a])}),a++)}l(c)}_makeRequestObject({method:e,params:n,mode:r,batchId:i}){const s={jsonrpc:"2.0",method:e};return n&&n.length&&(s.params=n),r!=="notify"&&(s.id=i?`${i}|${this._generateId()}`:this._generateId()),s}_makeErrorObject(e){const n={[Jt.METHOD_NOT_FOUND]:()=>new Kr.MethodNotFound(e.message),[Jt.REMOTE_INTERNAL_ERROR]:()=>new Kr.RemoteInternalError(e.message)}[e.code];return n()}_generateId(){const e="bjectSymhasOwnProp-0123456789ABCDEFGHIJKLMNQRTUVWXYZ_dfgiklquvxz";let n=10,r="";for(;0<n--;)r+=e[Math.random()*64|0];return r}}function v0(t){const e=Qf(t.callMethod.bind(t)),n=Qf(t.notify.bind(t));return new Proxy(t,{get(r,i){if(i==="notify")return n;if(i==="callMethod")return e;if(i!=="then")return i==="setMethodPrefix"?(...s)=>t.setMethodPrefix(s):(...s)=>r.callMethod.call(r,i,s)}})}function Qf(t){return new Proxy(t,{get(e,n){return(...r)=>e.call(null,n,r)},apply(e,n,r){return e.apply(null,r)}})}class m0 extends no{constructor(...e){return super(...e),v0(this)}}class y0{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",e)}sendData(e){this.channel.send(e)}}class ro{constructor(e){this.channel=e}onData(e){this.channel.on("json_rpc",async n=>{const r=await e(n);r&&this.channel.send(r)})}}var g0=Object.freeze({__proto__:null,MoleServer:eo,MoleClient:no,MoleClientProxified:m0,ClientTransport:y0,ServerTransport:ro});class w0 extends Error{constructor(e,n){super(e),this.name=this.constructor.name,this.errorCode=n}errorCode(){return this.errorCode}}const{MoleClient:x0,ClientTransport:A0}=g0;class E0{constructor(e,n,r){this.moleChannel=new a0(e),this.methodPrefix=n,this.connectorOrServersideChannel=e,this.client=new x0({requestTimeout:r,transport:new A0(this.moleChannel)})}jsonrpcMsgReceive(e){this.moleChannel.emit("json_rpc",e)}call(e,n){return this.connectorOrServersideChannel.closed()?new Promise((r,i)=>{i(new w0(`Method call [${this.methodPrefix}::${e}] on closed channel or connector ignored. Please add a check for closed channel in your code.`,"CLOSED_CHANNEL"))}):this.client.callMethod(`${this.methodPrefix}::${e}`,n)}}const S0=1e4;class O0{constructor(e,n){this.connectorOrServersideChannel=e,this.remoteObjects={},this.requestTimeout=n||S0}remoteObject(e){return this.remoteObjects[e]||(this.remoteObjects[e]=new E0(this.connectorOrServersideChannel,e,this.requestTimeout)),this.remoteObjects[e]}jsonrpcMsgReceive(e){for(const n of Object.values(this.remoteObjects))n.jsonrpcMsgReceive(e)}}class k0{constructor({serversideChannel:e,serverMethods:n,methodPrefix:r}){const i=[new ro(e)];this.server=new eo({transports:i}),this.server.expose(n),this.server.setMethodPrefix(r),this.server.run()}}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var C0=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var s in i)i.hasOwnProperty(s)&&(r[s]=i[s])},t(e,n)};return function(e,n){t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),T0=Object.prototype.hasOwnProperty;function ei(t,e){return T0.call(t,e)}function ti(t){if(Array.isArray(t)){for(var n=new Array(t.length),e=0;e<n.length;e++)n[e]=""+e;return n}if(Object.keys)return Object.keys(t);var n=[];for(var r in t)ei(t,r)&&n.push(r);return n}function It(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function ni(t){for(var e=0,n=t.length,r;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function Sn(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function io(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function ri(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(ri(t[e]))return!0}else if(typeof t=="object"){for(var r=ti(t),i=r.length,e=0;e<i;e++)if(ri(t[r[e]]))return!0}}return!1}function Xf(t,e){var n=[t];for(var r in e){var i=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof i<"u"&&n.push(r+": "+i)}return n.join(`
`)}var fo=function(t){C0(e,t);function e(n,r,i,s,l){var c=this.constructor,a=t.call(this,Xf(n,{name:r,index:i,operation:s,tree:l}))||this;return a.name=r,a.index=i,a.operation=s,a.tree=l,Object.setPrototypeOf(a,c.prototype),a.message=Xf(n,{name:r,index:i,operation:s,tree:l}),a}return e}(Error),ht=fo,R0=It,Ln={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=wr(n,this.path);r&&(r=It(r));var i=Tn(n,{op:"remove",path:this.from}).removed;return Tn(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=wr(n,this.from);return Tn(n,{op:"add",path:this.path,value:It(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:nr(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},N0={add:function(t,e,n){return ni(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:Ln.move,copy:Ln.copy,test:Ln.test,_get:Ln._get};function wr(t,e){if(e=="")return t;var n={op:"_get",path:e};return Tn(t,n),n.value}function Tn(t,e,n,r,i,s){if(n===void 0&&(n=!1),r===void 0&&(r=!0),i===void 0&&(i=!0),s===void 0&&(s=0),n&&(typeof n=="function"?n(e,0,t,e.path):xr(e,0)),e.path===""){var l={newDocument:t};if(e.op==="add")return l.newDocument=e.value,l;if(e.op==="replace")return l.newDocument=e.value,l.removed=t,l;if(e.op==="move"||e.op==="copy")return l.newDocument=wr(t,e.from),e.op==="move"&&(l.removed=t),l;if(e.op==="test"){if(l.test=nr(t,e.value),l.test===!1)throw new ht("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l.newDocument=t,l}else{if(e.op==="remove")return l.removed=t,l.newDocument=null,l;if(e.op==="_get")return e.value=t,l;if(n)throw new ht("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,e,t);return l}}else{r||(t=It(t));var c=e.path||"",a=c.split("/"),h=t,p=1,b=a.length,m=void 0,y=void 0,E=void 0;for(typeof n=="function"?E=n:E=xr;;){if(y=a[p],i&&y=="__proto__")throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&m===void 0&&(h[y]===void 0?m=a.slice(0,p).join("/"):p==b-1&&(m=e.path),m!==void 0&&E(e,0,t,m)),p++,Array.isArray(h)){if(y==="-")y=h.length;else{if(n&&!ni(y))throw new ht("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,e,t);ni(y)&&(y=~~y)}if(p>=b){if(n&&e.op==="add"&&y>h.length)throw new ht("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,e,t);var l=N0[e.op].call(e,h,y,t);if(l.test===!1)throw new ht("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}}else if(y&&y.indexOf("~")!=-1&&(y=io(y)),p>=b){var l=Ln[e.op].call(e,h,y,t);if(l.test===!1)throw new ht("Test operation failed","TEST_OPERATION_FAILED",s,e,t);return l}h=h[y]}}}function _i(t,e,n,r,i){if(r===void 0&&(r=!0),i===void 0&&(i=!0),n&&!Array.isArray(e))throw new ht("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=It(t));for(var s=new Array(e.length),l=0,c=e.length;l<c;l++)s[l]=Tn(t,e[l],n,!0,i,l),t=s[l].newDocument;return s.newDocument=t,s}function D0(t,e,n){var r=Tn(t,e);if(r.test===!1)throw new ht("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function xr(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new ht("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(Ln[t.op]){if(typeof t.path!="string")throw new ht("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new ht('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new ht("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new ht("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&ri(t.value))throw new ht("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var i=t.path.split("/").length,s=r.split("/").length;if(i!==s+1&&i!==s)throw new ht("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new ht("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var l={op:"_get",path:t.from,value:void 0},c=so([l],n);if(c&&c.name==="OPERATION_PATH_UNRESOLVABLE")throw new ht("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new ht("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function so(t,e,n){try{if(!Array.isArray(t))throw new ht("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)_i(It(e),It(t),n||!0);else{n=n||xr;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(i){if(i instanceof ht)return i;throw i}}function nr(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),i,s,l;if(n&&r){if(s=t.length,s!=e.length)return!1;for(i=s;i--!==0;)if(!nr(t[i],e[i]))return!1;return!0}if(n!=r)return!1;var c=Object.keys(t);if(s=c.length,s!==Object.keys(e).length)return!1;for(i=s;i--!==0;)if(!e.hasOwnProperty(c[i]))return!1;for(i=s;i--!==0;)if(l=c[i],!nr(t[l],e[l]))return!1;return!0}return t!==t&&e!==e}var $0=Object.freeze({__proto__:null,JsonPatchError:ht,deepClone:R0,getValueByPointer:wr,applyOperation:Tn,applyPatch:_i,applyReducer:D0,validator:xr,validate:so,_areEquals:nr});/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var pi=new WeakMap,P0=function(){function t(e){this.observers=new Map,this.obj=e}return t}(),I0=function(){function t(e,n){this.callback=e,this.observer=n}return t}();function M0(t){return pi.get(t)}function U0(t,e){return t.observers.get(e)}function j0(t,e){t.observers.delete(e.callback)}function L0(t,e){e.unobserve()}function z0(t,e){var n=[],r,i=M0(t);if(!i)i=new P0(t),pi.set(t,i);else{var s=U0(i,e);r=s&&s.observer}if(r)return r;if(r={},i.value=It(t),e){r.callback=e,r.next=null;var l=function(){ii(r)},c=function(){clearTimeout(r.next),r.next=setTimeout(l)};typeof window<"u"&&(window.addEventListener("mouseup",c),window.addEventListener("keyup",c),window.addEventListener("mousedown",c),window.addEventListener("keydown",c),window.addEventListener("change",c))}return r.patches=n,r.object=t,r.unobserve=function(){ii(r),clearTimeout(r.next),j0(i,r),typeof window<"u"&&(window.removeEventListener("mouseup",c),window.removeEventListener("keyup",c),window.removeEventListener("mousedown",c),window.removeEventListener("keydown",c),window.removeEventListener("change",c))},i.observers.set(e,new I0(e,r)),r}function ii(t,e){e===void 0&&(e=!1);var n=pi.get(t.object);bi(n.value,t.object,t.patches,"",e),t.patches.length&&_i(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function bi(t,e,n,r,i){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var s=ti(e),l=ti(t),c=!1,a=l.length-1;a>=0;a--){var h=l[a],p=t[h];if(ei(e,h)&&!(e[h]===void 0&&p!==void 0&&Array.isArray(e)===!1)){var b=e[h];typeof p=="object"&&p!=null&&typeof b=="object"&&b!=null?bi(p,b,n,r+"/"+Sn(h),i):p!==b&&(i&&n.push({op:"test",path:r+"/"+Sn(h),value:It(p)}),n.push({op:"replace",path:r+"/"+Sn(h),value:It(b)}))}else Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+Sn(h),value:It(p)}),n.push({op:"remove",path:r+"/"+Sn(h)}),c=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!c&&s.length==l.length))for(var a=0;a<s.length;a++){var h=s[a];!ei(t,h)&&e[h]!==void 0&&n.push({op:"add",path:r+"/"+Sn(h),value:It(e[h])})}}}function B0(t,e,n){n===void 0&&(n=!1);var r=[];return bi(t,e,r,"",n),r}var K0=Object.freeze({__proto__:null,unobserve:L0,observe:z0,generate:ii,compare:B0}),q0=Object.assign({},$0,K0,{JsonPatchError:fo,deepClone:It,escapePathComponent:Sn,unescapePathComponent:io});const{applyPatch:Y0}=q0;class F0 extends Kn{constructor(e){super({}),this.connector=e,this.connector.on("receive_state",n=>{this.wireStateReceived=!0,this.set(n)}),this.connector.on("receive_diff",n=>{this.wireStateReceived&&(Y0(this.state,n),this.announceStateChange())})}field(e){return this.connector.connectionState.get(e)}}class H0 extends Kn{constructor(e){super({}),this.fields={},this.connector=e,this.connector.on("receive_state_field",({name:n,state:r})=>{this.get(n).set(r)})}get(e){return this.fields[e]||(this.fields[e]=new Kn),this.fields[e]}}Ht.util=Fn;const J0=700,W0=6e4,Z0=1;class G0 extends Er{constructor({endpoint:e,protocol:n,keypair:r=Js(),rpcRequestTimeout:i,verbose:s=!1,tag:l,log:c=console.log,autoDecommission:a=!1,dummy:h}={}){super(),this.protocol=n,this.log=c;const{privateKey:p,publicKey:b}=Ws(r);this.clientPrivateKey=p,this.clientPublicKey=b,this.clientPublicKeyHex=yr(b),this.rpcClient=new O0(this,i),this.endpoint=e,this.verbose=s,this.tag=l,this.autoDecommission=a,this.sentCount=0,this.receivedCount=0,this.successfulConnectsCount=0,h||(this.state=new F0(this),this.connectionState=new H0(this)),this.connected=new Kn,this.delayedAdjustConnectionStatus(),s&&He.green(this.log,`Connector ${this.endpoint} created`),this.decommissionCheckCounter=0,this.lastPongReceivedAt=Date.now(),this.on("pong",()=>{this.lastPongReceivedAt=Date.now()})}delayedAdjustConnectionStatus(){setTimeout(()=>{this.connected.get()==null&&this.connected.set(!1)},J0)}send(e){s0({data:e,connector:this}),this.sentCount+=1}signal(e,n){this.connected.get()?this.send({signal:e,data:n}):He.write(this.log,"Warning: trying to send signal over disconnected connector, this should be prevented by GUI")}userAction({action:e,scope:n,payload:r}){this.signal("__action",{action:e,scope:n,payload:r})}on(e,n){e=="ready"&&this.isReady()&&n(),super.on(e,n)}getSharedSecret(){return this.sharedSecret?yr(this.sharedSecret):void 0}wireReceive({jsonData:e,encryptedData:n,rawMessage:r}){Xs({jsonData:e,encryptedData:n,rawMessage:r,connector:this}),this.receivedCount+=1}field(e){return this.connectionState.get(e)}isReady(){return this.ready}closed(){return!this.transportConnected}connectStatus(e){if(e){this.sentCount=0,this.receivedCount=0,this.transportConnected=!0,this.successfulConnectsCount+=1,this.verbose&&He.white(this.log,`✓ Connector ${this.endpoint} connected (${this.successfulConnectsCount} total reconnects)`);const n=this.connection.websocket.__id;c0({connector:this,afterFirstStep:({sharedSecret:i,remotePubkeyHex:s})=>{this.sharedSecret=i,this._remotePubkeyHex=s}}).then(()=>{this.connectedAt=Date.now(),this.connected.set(!0),this.ready=!0,this.emit("ready")}).catch(i=>{this.connection.websocket.__id==n&&this.connection.websocket.readyState==Z0&&i.code==Jt.TIMEOUT&&(He.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] handshake error: "${i.message}"`),He.write(this.log,`${this.endpoint} Connector dropping stale websocket after handshake error`),this.connection.terminate()),i.code!=Jt.TIMEOUT&&He.write(this.log,`${this.endpoint} x Connector [ ${this.protocol} ] on:ready error: "${i.stack}" — (will not try to reconnect, fix the error and reload this gui)`)})}else{let n;this.transportConnected&&(n=!0),this.transportConnected==null&&He.write(this.log,`${this.endpoint} Connector was not able to connect at first try`),this.transportConnected=!1,this.ready=!1,this.sharedSecret=void 0,delete this.connectedAt,n&&(this.emit("disconnect"),e==null&&this.delayedAdjustConnectionStatus(),this.connected.set(e))}}checkForDecommission(){this.autoDecommission&&(this.decommissionCheckRequestedAt&&Date.now()-this.decommissionCheckRequestedAt>3e3&&(this.decommissionCheckCounter=0),this.decommissionCheckRequestedAt=Date.now(),this.decommissionCheckCounter+=1,this.decommissionCheckCounter>12&&Date.now()-this.lastPongReceivedAt>W0&&(He.write(this.log,`Decommissioning connector ${this.endpoint} (long inactive)`),this.decommission(),this.emit("decommission")))}decommission(){this.decommissioned=!0}remoteObject(e){return{call:(n,r=[])=>this.rpcClient.remoteObject(e).call(n,Ju(r))}}attachObject(e,n){new k0({serversideChannel:this,serverMethods:n,methodPrefix:e})}clientPubkey(){return this.clientPublicKeyHex}remotePubkeyHex(){return this._remotePubkeyHex}remoteAddress(){return this.endpoint}}const es=typeof window<"u";function V0({endpoint:t,host:e,port:n}){if(es&&t&&t.startsWith("/")&&(t=`${window.location.protocol.includes("s")?"wss":"ws"}://${window.location.host}${t}`),!t)if(es){e=e||window.location.hostname;const r=window.location.protocol.includes("s")?"wss":"ws";t=`${r}://${e}`,r=="wss"?t=`${r}://${e}/ws`:n?t=`${t}:${n}`:window.location.port&&(t=`${t}:${window.location.port}`)}else{if(!n)throw new Error(`Connectome determineEndpoint: No websocket port provided for ${e}`);t=`ws://${e||"localhost"}:${n}`}return t}const _n=typeof window<"u",Q0=0,oo=1,X0=1e3,e1=3,t1=5;function or(t,e,n){_n?n.addEventListener(t,e):n.on(t,e)}function Qn(t,e,n){_n?n.removeEventListener(t,e):n.off(t,e)}function n1({endpoint:t,host:e,port:n,protocol:r,keypair:i,remotePubkey:s,rpcRequestTimeout:l,autoDecommission:c,log:a,verbose:h,tag:p,dummy:b},{WebSocket:m}){t=V0({endpoint:t,host:e,port:n});const y=new G0({endpoint:t,protocol:r,rpcRequestTimeout:l,keypair:i,verbose:h,tag:p,log:a,autoDecommission:c,dummy:b}),E=()=>{i1({connector:y,endpoint:t},{WebSocket:m,reconnect:E,log:a,verbose:h})};y.connection={terminate(){this.websocket._removeAllCallbacks(),this.websocket.__closed=!0,this.websocket.close(),y.connectStatus(!1),E()},isOpen(){return this.websocket.readyState==oo&&!this.websocket.__closed},endpoint:t,checkTicker:0};const x=()=>{y.decommissioned||(r1({connector:y,reconnect:E,log:a}),setTimeout(x,X0))};return setTimeout(x,10),y}function r1({connector:t,reconnect:e,log:n}){const r=t.connection;if(s1(r)||t.decommissioned){t.decommissioned?(He.yellow(n,`${t.endpoint} Connection decommisioned, closing websocket #${r.websocket.__id}, will not retry again `),lo(t)):(t.emit("inactive_connection"),He.yellow(n,`${t.endpoint} ✖ Terminated inactive connection #${r.websocket.__id}`)),r.terminate();return}co(r)?r.websocket.send("ping"):(t.connected==null&&(He.write(n,`${t.endpoint} Setting connector status to FALSE because connector.connected is undefined`),t.connectStatus(!1)),e()),r.checkTicker+=1}function i1({connector:t,endpoint:e},{WebSocket:n,reconnect:r,log:i,verbose:s}){const l=t.connection;if(t.checkForDecommission(),t.decommissioned){lo(t);return}const c=Math.round(10**5*Math.random()).toString();if(l.currentlyTryingWS&&l.currentlyTryingWS.readyState==Q0){if(l.currentlyTryingWS._waitForConnectCounter<t1){l.currentlyTryingWS._waitForConnectCounter+=1;return}(s||_n)&&He.write(i,`${e} Reconnect timeout, creating new ws`),l.currentlyTryingWS._removeAllCallbacks(),l.currentlyTryingWS.__closed=!0,l.currentlyTryingWS.close()}else(s||_n)&&He.write(i,`${e} Created new websocket #${c}`);const a=new n(e);a.__id=c,l.currentlyTryingWS=a,l.currentlyTryingWS._waitForConnectCounter=0,_n&&(a.binaryType="arraybuffer"),_n||a.on("error",()=>{});const h=()=>{t.decommissioned||((s||_n)&&He.write(i,`${e} Websocket #${c} open`),l.currentlyTryingWS=null,l.checkTicker=0,f1({ws:a,connector:t,openCallback:h,reconnect:r},{log:i,verbose:s}),l.websocket=a,t.connectStatus(!0))};a._removeAllCallbacks=()=>{Qn("open",h,a)},or("open",h,a)}function f1({ws:t,connector:e,openCallback:n,reconnect:r},{log:i,verbose:s}){const l=e.connection,c=p=>{const b=`${e.endpoint} Websocket error`;console.log(b),console.log(p)},a=()=>{if(t.__closed=!0,He.blue(i,`${e.endpoint} ✖ Connection #${t.__id} [ ${e.protocol} ] closed`),e.decommissioned){e.connectStatus(!1);return}e.connectStatus(void 0),r()},h=p=>{if(e.decommissioned)return;l.checkTicker=0;const b=_n?p.data:p;if(t.__closed)return;if(b=="pong"){e.emit("pong");return}let m;try{m=JSON.parse(b)}catch{}if(m)e.wireReceive({jsonData:m,rawMessage:b});else{const y=_n?new Uint8Array(b):b;e.wireReceive({encryptedData:y})}};t._removeAllCallbacks=()=>{Qn("error",c,t),Qn("close",a,t),Qn("message",h,t),Qn("open",n,t)},or("error",c,t),or("close",a,t),or("message",h,t)}function lo(t){const e=t.connection;e.currentlyTryingWS&&(e.currentlyTryingWS._removeAllCallbacks(),e.currentlyTryingWS.__closed=!0,e.currentlyTryingWS.close(),e.currentlyTryingWS=null),e.websocket&&(e.websocket._removeAllCallbacks(),e.websocket.__closed=!0,e.websocket.close(),e.websocket=null),t.connectStatus(!1)}function co(t){return t.websocket&&t.websocket.readyState==oo&&!t.websocket.__closed}function s1(t){return co(t)&&t.checkTicker>e1}function o1(t){return t.log=t.log||console.log,n1(t,{WebSocket})}class l1{constructor({mcs:e,foreground:n,connectToDeviceKey:r}){this.mcs=e,this.foreground=n,this.connectToDeviceKey=r}createConnector({host:e,autoDecommission:n=!1}){const{port:r,protocol:i,rpcRequestTimeout:s,log:l,verbose:c,keypair:a}=this.mcs;return o1({host:e,port:r,protocol:i,keypair:a,rpcRequestTimeout:s,autoDecommission:n,log:l,verbose:c})}getDeviceKey(e){var n;return(n=e==null?void 0:e.device)==null?void 0:n.deviceKey}connectThisDevice({host:e}){const n=this.createConnector({host:e});let r=!1;return n.state.subscribe(i=>{var l;i.nearbyDevices||(i.nearbyDevices=[]),i.notifications||(i.notifications=[]);const s=this.getDeviceKey(i);if(s){r||(n.on("pong",()=>{this.mcs.emit("pong",{deviceKey:s})}),r=!0),this.thisDeviceAlreadySetup||(this.mcs.set({activeDeviceKey:s}),this.initNewConnector({deviceKey:s,connector:n}));const c=this.connectToDeviceKey&&this.connectToDeviceKey!=s;if(!c&&this.mcs.activeDeviceKey()==s){const a=(l=i.device)==null?void 0:l.deviceName;this.foreground.set(i,{optimisticDeviceName:a})}this.foreground.setSpecial(i),this.thisDeviceAlreadySetup||(c&&(this.mcs.switch({deviceKey:this.connectToDeviceKey}),delete this.connectToDeviceKey),this.thisDeviceAlreadySetup=!0)}}),n}connectOtherDevice({host:e,deviceKey:n}){if(!this.mcs.connectors[n]){const r=this.createConnector({host:e,autoDecommission:!0});r.on("decommission",()=>{delete this.mcs.connectors[n],r.__removeListeners&&r.__removeListeners()});const i=()=>{this.mcs.emit("pong",{deviceKey:n})};r.on("pong",i),this.initNewConnector({deviceKey:n,connector:r});const s=r.state.subscribe(l=>{if(this.mcs.activeDeviceKey()==n){const c=l.device?l.device.deviceName:null;this.foreground.set(l,{optimisticDeviceName:c})}});r.__removeListeners=()=>{r.off("pong",i),s()}}return this.mcs.connectors[n]}initNewConnector({deviceKey:e,connector:n}){this.mcs.connectors[e]=n,this.setConnectedStore({deviceKey:e,connector:n})}setConnectedStore({deviceKey:e,connector:n}){n.connected.subscribe(r=>{this.mcs.activeDeviceKey()==e&&this.mcs.connected.set(r)})}}function ao(t,e=0,n={}){const r=["day","h","min","s"],i=[24,60,60,1e3];if(e==r.length)return n.ms=t,n;e==0&&(n.totalSeconds=t/1e3);const s=i.slice(e).reduce((l,c)=>l*c,1);return n[r[e]]=Math.floor(t/s),ao(t%s,e+1,n)}function c1(t){const e=["day","h","min","s"];let n="";for(const r of e)t[r]>0&&(r!="s"||r=="s"&&t.totalSeconds<60)&&(n=`${n} ${t[r]} ${r}`);return n.trim()}function uo(t){if(t){const e=Date.now(),n=3e3;return t.filter(r=>e<r.expireAt).map(r=>({...r,relativeTimeAdded:e-r.addedAt<n?"now":`${c1(ao(e-r.addedAt))} ago`}))}return[]}class a1{constructor({mcs:e,thisDeviceStateKeys:n}){this.mcs=e,this.thisDeviceStateKeys=n}specialStoreKeys(){return this.thisDeviceStateKeys.concat(["activeDeviceKey","optimisticDeviceName"])}clear(){this.mcs.clearState({except:this.specialStoreKeys()})}set(e,{optimisticDeviceName:n=void 0}={}){this.clear();const r={};for(const i of Object.keys(e))this.specialStoreKeys().includes(i)||(r[i]=e[i]);n&&(r.optimisticDeviceName=n),this.mcs.setMerge(r)}setSpecial(e){const n={};for(const r of this.thisDeviceStateKeys)r=="notifications"?n[r]=uo(e[r]):n[r]=e[r];this.mcs.setMerge(n)}}class u1 extends Er{constructor({mcs:e,connectDevice:n,foreground:r}){super(),this.mcs=e,this.connectDevice=n,this.foreground=r}switchState({deviceKey:e,deviceName:n}){this.mcs.setMerge({activeDeviceKey:e});const{state:r,connected:i}=this.mcs.connectors[e];this.foreground.set(r.get(),{optimisticDeviceName:n}),this.mcs.connected.set(i.get())}switch({host:e,deviceKey:n,deviceName:r}){if(this.mcs.connectors[n])this.switchState({deviceKey:n,deviceName:r});else if(e)this.foreground.clear(),this.mcs.setMerge({activeDeviceKey:n,optimisticDeviceName:r}),this.connectDevice.connectOtherDevice({host:e,deviceKey:n});else{const i=this.mcs.localConnector.state.get(),{nearbyDevices:s}=i,l=s.find(c=>c.deviceKey==n&&!c.thisDevice);if(l){const{deviceKey:c,deviceName:a,ip:h}=l;this.switch({host:h,deviceKey:c,deviceName:a})}else this.emit("connect_to_device_key_failed"),this.switchState(i.device)}}}const d1=500;class h1 extends Bu{constructor({host:e,port:n,protocol:r,keypair:i=Js(),connectToDeviceKey:s,rpcRequestTimeout:l=3e3,log:c,verbose:a}){super();const h=["time","environment","nearbyDevices","nearbySensors","notifications"],{publicKey:p,privateKey:b}=Ws(i);this.publicKey=p,this.privateKey=b,this.keypair=i,this.port=n,this.protocol=r,this.log=c,this.rpcRequestTimeout=l,this.verbose=a,this.connectors={},this.connected=new Kn;const m=new a1({mcs:this,thisDeviceStateKeys:h}),y=new l1({mcs:this,foreground:m,connectToDeviceKey:s});this.connectDevice=y,this.switchDevice=new u1({mcs:this,connectDevice:y,foreground:m}),this.switchDevice.on("connect_to_device_key_failed",()=>{this.emit("connect_to_device_key_failed")}),this.localConnector=y.connectThisDevice({host:e}),this._notificationsExpireAndCalculateRelativeTime()}_notificationsExpireAndCalculateRelativeTime(){const{notifications:e}=this.get();this.setMerge({notifications:uo(e)}),setTimeout(()=>{this._notificationsExpireAndCalculateRelativeTime()},d1)}signal(e,n){this.activeConnector()?this.activeConnector().signal(e,n):console.log(`MCS: Error emitting remote signal ${e} / ${n}. Debug info: activeDeviceKey=${this.activeDeviceKey()}`)}signalLocalDevice(e,n){this.localConnector.signal(e,n)}remoteObject(e){if(this.activeConnector())return this.activeConnector().remoteObject(e);console.log(`Error obtaining remote object ${e}. Debug info: activeDeviceKey=${this.activeDeviceKey()}`)}preconnect({host:e,deviceKey:n,thisDevice:r}){return r?this.localConnector:this.connectDevice.connectOtherDevice({host:e,deviceKey:n})}switch({host:e,deviceKey:n,deviceName:r}){this.switchDevice.switch({host:e,deviceKey:n,deviceName:r})}activeConnector(){if(this.activeDeviceKey())return this.connectors[this.activeDeviceKey()]}activeDeviceKey(){return this.get().activeDeviceKey}}const _1=7780,p1="dmt/gui",ho=localStorage.getItem("current_device_key");console.log(`connectToDeviceKey: ${ho}`);const _o=new h1({port:_1,protocol:p1,connectToDeviceKey:ho,log:qt.log});_o.on("connect_to_device_key_failed",()=>{console.log("connect_to_device_key_failed FAILED"),localStorage.removeItem("current_device_key")});window.onerror=Mo(ys);new Mu({target:document.body,props:{store:_o,log:qt.log}});
